window.__require=function t(e,o,n){function r(a,s){if(!o[a]){if(!e[a]){var l=a.split("/");if(l=l[l.length-1],!e[l]){var m="function"==typeof __require&&__require;if(!s&&m)return m(l,!0);if(i)return i(l,!0);throw new Error("Cannot find module '"+a+"'")}a=l}var u=o[a]={exports:{}};e[a][0].call(u.exports,function(t){return r(e[a][1][t]||t)},u,u.exports,t,e,o,n)}return o[a].exports}for(var i="function"==typeof __require&&__require,a=0;a<n.length;a++)r(n[a]);return r}({AccRewardItem:[function(t,e,o){"use strict";cc._RF.push(e,"b0aa9JXgoFHUbwy26hxFQcG","AccRewardItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxyTurntable"),l=t("../../Manager/UserMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAccTimesLbl=null,e.mTag=null,e.mItem=null,e}return r(e,t),e.prototype.SetData=function(t){var e=s.default.Ins.mAccRewardsInfoArr[t-1];this.mAccTimesLbl.string=e[0]+"",this.mItem.SetData(e[1],e[2]+""),l.default.Ins.ClientInfo.turntableInfo.hasGotBoxCount>=t?this.mTag.opacity=255:this.mTag.opacity=0},e.prototype.UpdateState=function(t){l.default.Ins.ClientInfo.turntableInfo.hasGotBoxCount>=t?this.mTag.opacity=255:this.mTag.opacity=0},i([p(cc.Label)],e.prototype,"mAccTimesLbl",void 0),i([p(cc.Node)],e.prototype,"mTag",void 0),i([p(a.default)],e.prototype,"mItem",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyTurntable":"ProxyTurntable","./SimpleItem":"SimpleItem"}],ActCoinPanel:[function(t,e,o){"use strict";cc._RF.push(e,"c7c85CTt9xIUr30Osz3r329","ActCoinPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyLargeNum"),s=t("../../Manager/UserMgr"),l=t("../../Manager/BCMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGoldLbl=null,e.mMedalLbl=null,e.mADCoinLbl=null,e}return r(e,t),e.prototype.OnFirstOpen=function(){},e.prototype.OnOpen=function(){this.mGoldLbl.string=""+s.default.Ins.GetItemNum(m.ItemType.Gold),this.mMedalLbl.string=""+a.default.FormatNumber(s.default.Ins.GetItemNum(m.ItemType.Medal),1),this.mADCoinLbl.string=""+s.default.Ins.GetItemNum(m.ItemType.ADCoin)},e.prototype.Subscribe=function(){l.default.Subscribe(m.BCType.Common_UpdateItem,this._OnMsg_UpdateGoldUI,this)},e.prototype.Remove=function(){l.default.Remove(m.BCType.Common_UpdateItem,this._OnMsg_UpdateGoldUI,this)},e.prototype._OnMsg_UpdateGoldUI=function(t){switch(t){case m.ItemType.Gold:this.mGoldLbl.string=s.default.Ins.GetItemNum(m.ItemType.Gold)+"";break;case m.ItemType.Medal:this.mMedalLbl.string=a.default.FormatNumber(s.default.Ins.GetItemNum(m.ItemType.Medal),1);break;case m.ItemType.ADCoin:this.mADCoinLbl.string=s.default.Ins.GetItemNum(m.ItemType.ADCoin)+""}},i([c(cc.Label)],e.prototype,"mGoldLbl",void 0),i([c(cc.Label)],e.prototype,"mMedalLbl",void 0),i([c(cc.Label)],e.prototype,"mADCoinLbl",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum"}],AddPosWin:[function(t,e,o){"use strict";cc._RF.push(e,"6f54aqWvkhIYZqn/W8irNun","AddPosWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCostLbl=null,e.mNeedCost=0,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),u.default.PlaySFX(p.AudioName.UI_TanKuang,!0)},e.prototype.SetData=function(){this.mNeedCost=s.default.Ins.GetExtendPosCost(),this.mCostLbl.string=""+this.mNeedCost},e.prototype.Invoke_Cancel=function(){u.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Ok=function(){u.default.PlayBtnSound(),m.default.Ins.GetItemNum(p.ItemType.Gold)<this.mNeedCost?l.default.Ins.ShowTips("\u5143\u5b9d\u4e0d\u8db3~"):(m.default.Ins.UpdateItem(p.ItemType.Gold,-this.mNeedCost),this.CloseWin(),s.default.Ins.AddTeamPos())},i([f(cc.Label)],e.prototype,"mCostLbl",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","./WinBase":"WinBase"}],AddSkillPosWin:[function(t,e,o){"use strict";cc._RF.push(e,"972adIbYj1BP6iPXj5jozdz","AddSkillPosWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyImtSkill"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCostLbl=null,e.mNeedCost=0,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),u.default.PlaySFX(p.AudioName.UI_TanKuang,!0)},e.prototype.SetData=function(){this.mNeedCost=s.default.Ins.GetExtendPosCost(),this.mCostLbl.string=""+this.mNeedCost},e.prototype.Invoke_Cancel=function(){u.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Ok=function(){u.default.PlayBtnSound(),m.default.Ins.GetItemNum(p.ItemType.Gold)<this.mNeedCost?l.default.Ins.ShowTips("\u5143\u5b9d\u4e0d\u8db3~"):(m.default.Ins.UpdateItem(p.ItemType.Gold,-this.mNeedCost),this.CloseWin(),s.default.Ins.AddSkillSlotCount())},i([f(cc.Label)],e.prototype,"mCostLbl",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImtSkill":"ProxyImtSkill","./WinBase":"WinBase"}],AgeWin:[function(t,e,o){"use strict";cc._RF.push(e,"5a1064t9x9AZb/H4/wZSZ6I","AgeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Invoke_Close=function(){this.CloseWin()},i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./WinBase":"WinBase"}],AllSPActWin:[function(t,e,o){"use strict";cc._RF.push(e,"2a9bdEqlGpHC5Iyue5JTDY/","AllSPActWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/MyToggleGroup"),l=t("../Comp/AllSPTaskItem"),m=t("../Comp/AllSPImtPanel"),u=t("../Comp/AllSPHeroPanel"),p=t("../../Proxy/ProxyAllSP"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHeroPanel=null,e.mImtPanel=null,e.mToggleGroup=null,e.mTemplate=null,e.mTaskItemArr=[],e.mOriX=-226,e.mCellWidth=226,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init();for(var e=0;e<3;++e){if(0===e)this.mTaskItemArr.push(this.mTemplate);else{var o=cc.instantiate(this.mTemplate.node);o.parent=this.mTemplate.node.parent,this.mTaskItemArr.push(o.getComponent(l.default))}this.mTaskItemArr[e].node.x=this.mOriX+e*this.mCellWidth}this.mHeroPanel.OnFirstOpen(this),this.mImtPanel.OnFirstOpen(this),this._OnMsg_ClickToggle(0,!0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(f.BCType.ToggleGroup_AllSPAct,this._OnMsg_ClickToggle,this),c.default.Subscribe(f.BCType.AllSP_GetTaskRewards,this._OnMsg_OnGetTaskRewards,this),this.mHeroPanel.Subscribe(),this.mImtPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(f.BCType.ToggleGroup_AllSPAct,this._OnMsg_ClickToggle,this),this.mHeroPanel.Remove(),this.mImtPanel.Remove()},e.prototype._OnMsg_OnGetTaskRewards=function(t){t===p.AllSPTaskGroup.Hero?this.mHeroPanel.UpdateScoreInfo():this.mImtPanel.UpdateScoreInfo()},e.prototype._OnMsg_ClickToggle=function(t,e){switch(void 0===e&&(e=!1),e||d.default.PlayBtnSound(),t){case 0:this.mHeroPanel.node.active=!0,this.mImtPanel.node.active=!1,this.mHeroPanel.UpdateToggleUI();break;case 1:this.mHeroPanel.node.active=!1,this.mImtPanel.node.active=!0,this.mImtPanel.Open()}this.mToggleGroup.UpdateToggleBtnState(t)},i([g(u.default)],e.prototype,"mHeroPanel",void 0),i([g(m.default)],e.prototype,"mImtPanel",void 0),i([g(s.default)],e.prototype,"mToggleGroup",void 0),i([g(l.default)],e.prototype,"mTemplate",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","../Comp/AllSPHeroPanel":"AllSPHeroPanel","../Comp/AllSPImtPanel":"AllSPImtPanel","../Comp/AllSPTaskItem":"AllSPTaskItem","../Comp/MyToggleGroup":"MyToggleGroup","./WinBase":"WinBase"}],AllSPHeroPanel:[function(t,e,o){"use strict";cc._RF.push(e,"77334EYfihPcLfrHB8jTcxc","AllSPHeroPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MyToggleGroup"),s=t("./AllSPScoreRewardItem"),l=t("../../Proxy/ProxyAllSP"),m=t("../../Manager/UserMgr"),u=t("../../Manager/BCMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mToggleGroup=null,e.mScoreLbl=null,e.mBarSp=null,e.mTemplate=null,e.mItemArr=[],e.mAllSPWin=null,e.mOriPosX=-185,e.mCellWidth=95,e.mBarWidthArr=[95,190,285,380,475,570,620],e}return r(e,t),e.prototype.OnFirstOpen=function(t){this.mAllSPWin=t,this.mToggleGroup.Init(),this._OnMsg_ClickToggle(0,!0),this.InitScorePanel()},e.prototype.InitScorePanel=function(){this.mScoreLbl.string=m.default.Ins.ClientInfo.allSPInfo.heroScore+"";for(var t=0,e=l.default.Ins.mHeroScoreRewardsArr.length;t<e;++t){if(0===t)this.mItemArr.push(this.mTemplate);else{var o=cc.instantiate(this.mTemplate.node);o.parent=this.mTemplate.node.parent,this.mItemArr.push(o.getComponent(s.default))}this.mItemArr[t].SetData(l.AllSPTaskGroup.Hero,t),this.mItemArr[t].node.position=cc.v3(this.mOriPosX+t*this.mCellWidth,0,0)}this._SetBarWidth()},e.prototype._SetBarWidth=function(){for(var t=m.default.Ins.ClientInfo.allSPInfo.heroScore,e=l.default.Ins.mHeroScoreRewardsArr,o=0,n=0,r=!1,i=0,a=e.length;i<a;++i){var s=e[i][0];if(t<=s){r=!0,this.mBarSp.node.width=n+(t-o)/(s-o)*(this.mBarWidthArr[i]-n);break}o=s,n=this.mBarWidthArr[i]}if(!r){var u=this.mBarWidthArr[this.mBarWidthArr.length-2],p=this.mBarWidthArr[this.mBarWidthArr.length-1],c=e[e.length-1][0],d=u+(t-c)/(l.default.Ins.mHeroMaxScore-c)*(p-u);this.mBarSp.node.width=Math.min(p,d)}},e.prototype.UpdateScoreInfo=function(){this.mScoreLbl.string=m.default.Ins.ClientInfo.allSPInfo.heroScore+"";for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateState();this._SetBarWidth()},e.prototype.Subscribe=function(){u.default.Subscribe(c.BCType.ToggleGroup_AllSPHero,this._OnMsg_ClickToggle,this)},e.prototype.Remove=function(){u.default.Remove(c.BCType.ToggleGroup_AllSPHero,this._OnMsg_ClickToggle,this)},e.prototype.UpdateToggleUI=function(){-1!==this.mToggleGroup.CurToggleIdx&&this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!0)},e.prototype._OnMsg_ClickToggle=function(t,e){void 0===e&&(e=!1),e||p.default.PlayBtnSound();var o=t,n=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Hero,o,1),r=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Hero,o,2),i=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Hero,o,3);this.mAllSPWin.mTaskItemArr[0].SetData(n),this.mAllSPWin.mTaskItemArr[1].SetData(r),this.mAllSPWin.mTaskItemArr[2].SetData(i),this.mToggleGroup.UpdateToggleBtnState(t)},i([h(a.default)],e.prototype,"mToggleGroup",void 0),i([h(cc.Label)],e.prototype,"mScoreLbl",void 0),i([h(cc.Sprite)],e.prototype,"mBarSp",void 0),i([h(s.default)],e.prototype,"mTemplate",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","./AllSPScoreRewardItem":"AllSPScoreRewardItem","./MyToggleGroup":"MyToggleGroup"}],AllSPImtPanel:[function(t,e,o){"use strict";cc._RF.push(e,"9e8f10Op7pCoKUXD8rkkqsU","AllSPImtPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MyToggleGroup"),s=t("./AllSPScoreRewardItem"),l=t("../../Proxy/ProxyAllSP"),m=t("../../Manager/UserMgr"),u=t("../../Manager/BCMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mToggleGroup=null,e.mScoreLbl=null,e.mBarSp=null,e.mTemplate=null,e.mItemArr=[],e.mAllSPWin=null,e.mIsFirstOpen=!1,e.mOriPosX=-185,e.mCellWidth=95,e.mBarWidthArr=[95,190,285,380,475,570,620],e}return r(e,t),e.prototype.OnFirstOpen=function(t){this.mAllSPWin=t,this.mToggleGroup.Init()},e.prototype.Open=function(){this.mIsFirstOpen?this.UpdateToggleUI():(this.mIsFirstOpen=!0,this._OnMsg_ClickToggle(0,!0),this.InitScorePanel())},e.prototype.InitScorePanel=function(){this.mScoreLbl.string=m.default.Ins.ClientInfo.allSPInfo.imtScore+"";for(var t=0,e=l.default.Ins.mImtScoreRewardsArr.length;t<e;++t){if(0===t)this.mItemArr.push(this.mTemplate);else{var o=cc.instantiate(this.mTemplate.node);o.parent=this.mTemplate.node.parent,this.mItemArr.push(o.getComponent(s.default))}this.mItemArr[t].SetData(l.AllSPTaskGroup.Imt,t),this.mItemArr[t].node.position=cc.v3(this.mOriPosX+t*this.mCellWidth,0,0)}this._SetBarWidth()},e.prototype._SetBarWidth=function(){for(var t=m.default.Ins.ClientInfo.allSPInfo.imtScore,e=l.default.Ins.mImtScoreRewardsArr,o=0,n=0,r=!1,i=0,a=e.length;i<a;++i){var s=e[i][0];if(t<=s){r=!0,this.mBarSp.node.width=n+(t-o)/(s-o)*(this.mBarWidthArr[i]-n);break}o=s,n=this.mBarWidthArr[i]}if(!r){var u=this.mBarWidthArr[this.mBarWidthArr.length-2],p=this.mBarWidthArr[this.mBarWidthArr.length-1],c=e[e.length-1][0],d=u+(t-c)/(l.default.Ins.mImtMaxScore-c)*(p-u);this.mBarSp.node.width=Math.min(p,d)}},e.prototype.UpdateScoreInfo=function(){this.mScoreLbl.string=m.default.Ins.ClientInfo.allSPInfo.imtScore+"";for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateState();this._SetBarWidth()},e.prototype.UpdateToggleUI=function(){-1!==this.mToggleGroup.CurToggleIdx&&this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!0)},e.prototype.Subscribe=function(){u.default.Subscribe(c.BCType.ToggleGroup_AllSPImt,this._OnMsg_ClickToggle,this)},e.prototype.Remove=function(){u.default.Remove(c.BCType.ToggleGroup_AllSPImt,this._OnMsg_ClickToggle,this)},e.prototype._OnMsg_ClickToggle=function(t,e){void 0===e&&(e=!1),e||p.default.PlayBtnSound();var o=t,n=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Imt,o,1),r=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Imt,o,2),i=l.default.Ins.GetProgressData(l.AllSPTaskGroup.Imt,o,3);this.mAllSPWin.mTaskItemArr[0].SetData(n),this.mAllSPWin.mTaskItemArr[1].SetData(r),this.mAllSPWin.mTaskItemArr[2].SetData(i),this.mToggleGroup.UpdateToggleBtnState(t)},i([h(a.default)],e.prototype,"mToggleGroup",void 0),i([h(cc.Label)],e.prototype,"mScoreLbl",void 0),i([h(cc.Sprite)],e.prototype,"mBarSp",void 0),i([h(s.default)],e.prototype,"mTemplate",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","./AllSPScoreRewardItem":"AllSPScoreRewardItem","./MyToggleGroup":"MyToggleGroup"}],AllSPScoreRewardItem:[function(t,e,o){"use strict";cc._RF.push(e,"d6735wBg5xNtIcx4w+9xqnX","AllSPScoreRewardItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxyAllSP"),l=t("../../Manager/UserMgr"),m=t("../../Manager/AudioMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScoreLbl=null,e.mItem=null,e.mGotNode=null,e.mReachedNode=null,e.mCanGetSkNode=null,e.mCurTaskGroup=s.AllSPTaskGroup.Hero,e.mCurIdx=0,e.mNeedScore=1e4,e.mItemID=0,e.mItemNum=0,e}return r(e,t),e.prototype.SetData=function(t,e){var o=null;this.mCurTaskGroup=t,this.mCurIdx=e;var n=0;t===s.AllSPTaskGroup.Hero?(o=s.default.Ins.mHeroScoreRewardsArr[e],n=l.default.Ins.ClientInfo.allSPInfo.heroScore):(o=s.default.Ins.mImtScoreRewardsArr[e],n=l.default.Ins.ClientInfo.allSPInfo.imtScore),this.mNeedScore=o[0],this.mItemID=o[1],this.mItemNum=o[2],this.mScoreLbl.string=this.mNeedScore+"",this.mItem.SetData(this.mItemID,this.mItemNum+"");var r=n>=this.mNeedScore,i=s.default.Ins.CheckHasGotScoreReward(t,e);this.mReachedNode.opacity=r?255:0,this.mGotNode.opacity=i?255:0,this.mCanGetSkNode.opacity=r&&!i?255:0},e.prototype.UpdateState=function(){var t=(this.mCurTaskGroup===s.AllSPTaskGroup.Hero?l.default.Ins.ClientInfo.allSPInfo.heroScore:l.default.Ins.ClientInfo.allSPInfo.imtScore)>=this.mNeedScore,e=s.default.Ins.CheckHasGotScoreReward(this.mCurTaskGroup,this.mCurIdx);this.mReachedNode.opacity=t?255:0,this.mGotNode.opacity=e?255:0,this.mCanGetSkNode.opacity=t&&!e?255:0},e.prototype.Invoke_GetRewards=function(){m.default.PlayBtnSound();var t=null,e=0;this.mCurTaskGroup===s.AllSPTaskGroup.Hero?(t=s.default.Ins.mHeroScoreRewardsArr[this.mCurIdx],e=l.default.Ins.ClientInfo.allSPInfo.heroScore):(t=s.default.Ins.mImtScoreRewardsArr[this.mCurIdx],e=l.default.Ins.ClientInfo.allSPInfo.imtScore),this.mNeedScore=t[0],e<this.mNeedScore||s.default.Ins.CheckHasGotScoreReward(this.mCurTaskGroup,this.mCurIdx)||(s.default.Ins.GetScoreRewards(this.mCurTaskGroup,this.mCurIdx),this.UpdateState())},i([c(cc.Label)],e.prototype,"mScoreLbl",void 0),i([c(a.default)],e.prototype,"mItem",void 0),i([c(cc.Node)],e.prototype,"mGotNode",void 0),i([c(cc.Node)],e.prototype,"mReachedNode",void 0),i([c(cc.Node)],e.prototype,"mCanGetSkNode",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","./SimpleItem":"SimpleItem"}],AllSPTaskItem:[function(t,e,o){"use strict";cc._RF.push(e,"aab65t4c0FMBp7pJtIW6KXU","AllSPTaskItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyAllSP"),s=t("../../Manager/UserMgr"),l=t("../../Manager/AudioMgr"),m=t("../../MainGame"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScoreLbl=null,e.mTargetRT=null,e.mPB=null,e.mPBLbl=null,e.mGoldNumLbl=null,e.mGetBtnNode=null,e.mHasGotNode=null,e.mBtnBg=null,e.mData=null,e}return r(e,t),e.prototype.SetData=function(t){this.mData=t,this.mTargetRT.string=t.desc,this.mScoreLbl.string=t.score,this.mGoldNumLbl.string="x"+t.goldNum,this.UpdateState()},e.prototype.UpdateState=function(){var t=s.default.Ins.ClientInfo.allSPInfo.taskInfoMap.Get(this.mData.taskType),e=0,o=a.TaskState.Progress;t&&(e=t.progress,o=t.taskState),this.mPB.progress=e/this.mData.targetNum,this.mPBLbl.string=e+"/"+this.mData.targetNum,o===a.TaskState.Progress?(this.mGetBtnNode.active=!0,this.mHasGotNode.active=!1,this.mBtnBg.setMaterial(0,m.default.mGrayMat)):o===a.TaskState.Complete?(this.mGetBtnNode.active=!0,this.mHasGotNode.active=!1,this.mBtnBg.setMaterial(0,m.default.mDefaultMat)):o===a.TaskState.GotRewards&&(this.mGetBtnNode.active=!1,this.mHasGotNode.active=!0)},e.prototype.Invoke_GetRewards=function(){l.default.PlayBtnSound();var t=s.default.Ins.ClientInfo.allSPInfo.taskInfoMap.Get(this.mData.taskType);if(t&&t.taskState===a.TaskState.Complete){a.default.Ins.GetTaskRewards(this.mData.Id);var e=a.default.Ins.GetProgressData(this.mData.taskGroup,this.mData.tabGroup,this.mData.posId);this.SetData(e)}},i([c(cc.Label)],e.prototype,"mScoreLbl",void 0),i([c(cc.RichText)],e.prototype,"mTargetRT",void 0),i([c(cc.ProgressBar)],e.prototype,"mPB",void 0),i([c(cc.Label)],e.prototype,"mPBLbl",void 0),i([c(cc.Label)],e.prototype,"mGoldNumLbl",void 0),i([c(cc.Node)],e.prototype,"mGetBtnNode",void 0),i([c(cc.Node)],e.prototype,"mHasGotNode",void 0),i([c(cc.Sprite)],e.prototype,"mBtnBg",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyAllSP":"ProxyAllSP"}],AttackBehaviorBase:[function(t,e,o){"use strict";cc._RF.push(e,"30374/x95hES413hhmeSnVx","AttackBehaviorBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.mAttacker=null,this.mSkillCompCtrl=null}return t.prototype.Init=function(t){this.mSkillCompCtrl=t,this.mAttacker=this.mSkillCompCtrl.m_SkillCtrl.mEntity,this.InitWithCompData(this.mSkillCompCtrl.mSkillCompData)},t.prototype.InitWithCompData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.Trigger=function(){},t.prototype.TriggerByIdx=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t}();o.default=n,cc._RF.pop()},{}],AttackBehaviorBullet:[function(t,e,o){"use strict";cc._RF.push(e,"10e98Myqm1DlLrDgsLSMobH","AttackBehaviorBullet");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.InitWithCompData=function(e){t.prototype.InitWithCompData.call(this,e)},e.prototype.Trigger=function(){t.prototype.Trigger.call(this),this.mAttacker.Fire(this.mSkillCompCtrl)},e}(t("./AttackBehaviorBase").default);o.default=i,cc._RF.pop()},{"./AttackBehaviorBase":"AttackBehaviorBase"}],AttackBehaviorFactory:[function(t,e,o){"use strict";cc._RF.push(e,"3affcwy+1JK9bG7A9zNA4Hy","AttackBehaviorFactory"),Object.defineProperty(o,"__esModule",{value:!0}),o.AttackBehaviorType=void 0;var n,r=t("./AttackBehaviorXDist"),i=t("./AttackBehaviorSpecifyTarget"),a=t("./AttackBehaviorImtSkillRange"),s=t("./AttackBehaviorImtBullet"),l=t("./AttackBehaviorBullet");(function(t){t[t.None=0]="None",t[t.Bullet=1]="Bullet",t[t.XDist=2]="XDist",t[t.SpecifyTarget=3]="SpecifyTarget",t[t.ImtSkillRange=4]="ImtSkillRange",t[t.ImtSkillBullet=5]="ImtSkillBullet"})(n=o.AttackBehaviorType||(o.AttackBehaviorType={}));var m=function(){function t(){}return Object.defineProperty(t,"Instance",{get:function(){return null==t.m_Instance&&(t.m_Instance=new t),t.m_Instance},enumerable:!1,configurable:!0}),t.prototype.Create=function(t,e){var o=null;switch(t){case n.Bullet:o=new l.default;break;case n.XDist:o=new r.default;break;case n.SpecifyTarget:o=new i.default;break;case n.ImtSkillRange:o=new a.default;break;case n.ImtSkillBullet:o=new s.default}return null!==o&&o.Init(e),o},t.m_Instance=null,t}();o.default=m,cc._RF.pop()},{"./AttackBehaviorBullet":"AttackBehaviorBullet","./AttackBehaviorImtBullet":"AttackBehaviorImtBullet","./AttackBehaviorImtSkillRange":"AttackBehaviorImtSkillRange","./AttackBehaviorSpecifyTarget":"AttackBehaviorSpecifyTarget","./AttackBehaviorXDist":"AttackBehaviorXDist"}],AttackBehaviorImtBullet:[function(t,e,o){"use strict";cc._RF.push(e,"79bf22nclpH+rAnF5Wch5s4","AttackBehaviorImtBullet");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./AttackBehaviorBase"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.InitWithCompData=function(e){t.prototype.InitWithCompData.call(this,e)},e.prototype.TriggerByIdx=function(e){t.prototype.TriggerByIdx.call(this,e),this.mAttacker.Fire(this.mSkillCompCtrl)},i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./AttackBehaviorBase":"AttackBehaviorBase"}],AttackBehaviorImtSkillRange:[function(t,e,o){"use strict";cc._RF.push(e,"ad673yIyE9PiolhF1Dc/w/b","AttackBehaviorImtSkillRange");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./AttackBehaviorBase"),s=t("../../../UI/Win/BattleWin"),l=t("../../../Manager/PoolMgr"),m=t("../../../Common/Common"),u=cc._decorator,p=u.ccclass,c=(u.property,function(t){function e(){var e=t.call(this)||this;return e.mHitEff="",e.mDmgRangeCenterXArr=[],e.mDmgRangeWidthArr=[],e}return r(e,t),e.prototype.InitWithCompData=function(t){this.mHitEff=t.atkParam[0];for(var e=this.mSkillCompCtrl.m_SkillCtrl.mImtSkillData.skillDistance,o=0,n=e.length;o<n;++o)this.mDmgRangeCenterXArr.push(e[o][0]),this.mDmgRangeWidthArr.push(e[o][1])},e.prototype.TriggerByIdx=function(e){if(t.prototype.TriggerByIdx.call(this,e),e<0||e>=this.mDmgRangeCenterXArr.length)console.error("\u795e\u5175\u6280\u80fd\u68c0\u6d4b\u8303\u56f4\u8d85\u51fa\u957f\u5ea6: "+this.mSkillCompCtrl.m_SkillCtrl.SkillID+"   "+e);else for(var o=this.mAttacker.node.x,n=this.mDmgRangeCenterXArr[e]+o,r=this.mDmgRangeWidthArr[e],i=this.mAttacker.GetTargetArr(),a=0,s=i.length;a<s;++a){var l=i[a];if(void 0!==l&&Math.abs(l.node.x-n)<=r){var m=l.WorldMiddlePosition;this.mAttacker.Attack(l,this.mSkillCompCtrl,m),this._ShowHitEff(l,m)}}},e.prototype._ShowHitEff=function(t,e){l.default.Ins.Borrow(l.default.EFX_PATH_ROOT+this.mHitEff,"EfxBase",function(o){var n=o;n.node.parent=s.default.EfxRoot,t.node&&t.node.isValid&&(n.node.position=s.default.EfxRoot.convertToNodeSpaceAR(cc.v3(e)),n.node.angle=m.default.GetRandValueBetween(0,360))})},i([p],e)}(a.default));o.default=c,cc._RF.pop()},{"../../../Common/Common":"Common","../../../Manager/PoolMgr":"PoolMgr","../../../UI/Win/BattleWin":"BattleWin","./AttackBehaviorBase":"AttackBehaviorBase"}],AttackBehaviorSpecifyTarget:[function(t,e,o){"use strict";cc._RF.push(e,"0cad99DkJlGha/cJ1ko6yyI","AttackBehaviorSpecifyTarget");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../Buff/BuffFactory"),a=t("../../../Manager/DataMgr"),s=function(t){function e(){var e=t.call(this)||this;return e.mTargetType=0,e}return r(e,t),e.prototype.InitWithCompData=function(t){0===t.atkParam.length?this.mTargetType=0:this.mTargetType=Number(t.atkParam[0])},e.prototype.Trigger=function(){if(t.prototype.Trigger.call(this),1===this.mTargetType){for(var e=this.mAttacker.GetPartnerArr(),o=null,n=2,r=0,s=e.length;r<s;++r){var l=e[r].GetCurHPPercent();l<n&&(n=l,o=e[r])}if(null!==o){var m=a.default.Ins.m_DB.buffDB[this.mSkillCompCtrl.mSkillCompData.buff];if(null!==m){var u=i.default.Create(m.type);u.Init(this.mAttacker,o,m.lv,m.param),o.CheckCanAddBuff(u)&&(o.AddBuff(u),u.Trigger())}}}},e}(t("./AttackBehaviorBase").default);o.default=s,cc._RF.pop()},{"../../../Manager/DataMgr":"DataMgr","../../Buff/BuffFactory":"BuffFactory","./AttackBehaviorBase":"AttackBehaviorBase"}],AttackBehaviorXDist:[function(t,e,o){"use strict";cc._RF.push(e,"a78a3dYj+xCfq4NdL0fmVk5","AttackBehaviorXDist");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../UI/Win/BattleWin"),a=t("../../../Common/Common"),s=t("../../../Manager/PoolMgr"),l=t("../../AI/EntityState"),m=function(t){function e(){var e=t.call(this)||this;return e.mAtkRangeX=0,e.mHitEff="",e}return r(e,t),e.prototype.InitWithCompData=function(t){0===t.atkParam.length?this.mAtkRangeX=0:(this.mAtkRangeX=Number(t.atkParam[0]),this.mHitEff=t.atkParam[1])},e.prototype.Trigger=function(){if(t.prototype.Trigger.call(this),0===this.mAtkRangeX){if(null!==(a=this.mAttacker.mCurTargetEntity)&&a.mStateMachine.GetCurStateType()!==l.EntityStateType.Dead){var e=a.WorldMiddlePosition;this.mAttacker.Attack(a,this.mSkillCompCtrl,e),this._ShowHitEff(a,e)}}else for(var o=this.mAttacker.GetTargetArr(),n=this.mAtkRangeX,r=0,i=o.length;r<i;++r){var a;if(void 0!==(a=o[r])&&Math.abs(a.node.x-this.mAttacker.node.x)<=n){var s=a.WorldMiddlePosition;this.mAttacker.Attack(a,this.mSkillCompCtrl,s),this._ShowHitEff(a,s)}}},e.prototype._ShowHitEff=function(t,e){s.default.Ins.Borrow(s.default.EFX_PATH_ROOT+this.mHitEff,"EfxBase",function(o){var n=o;n.node.parent=i.default.EfxRoot,t.node&&t.node.isValid&&(n.node.position=i.default.EfxRoot.convertToNodeSpaceAR(cc.v3(e)),n.node.angle=a.default.GetRandValueBetween(0,360))})},e}(t("./AttackBehaviorBase").default);o.default=m,cc._RF.pop()},{"../../../Common/Common":"Common","../../../Manager/PoolMgr":"PoolMgr","../../../UI/Win/BattleWin":"BattleWin","../../AI/EntityState":"EntityState","./AttackBehaviorBase":"AttackBehaviorBase"}],AudioMgr:[function(t,e,o){"use strict";cc._RF.push(e,"b0113FxRNdMj5hsp7s7inG4","AudioMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./SaveMgr"),r=t("./ResMgr"),i=t("../Proxy/ProxySpeed"),a=t("../Common/EnumsDefine"),s=function(){function t(){}return t.Init=function(){var t=n.default.Get(n.default.SOUND_SWITCH);t&&(this.m_SFXSwitch=1===Number(t));var e=n.default.Get(n.default.MUSIC_SWITCH);e&&(this.m_MusicSwitch=1===Number(e))},t.FadeBGMVolume=function(t,e,o){void 0===o&&(o=null),this.m_BGMAudioID>=0&&(this.m_IsFadingVolume=!0,this.m_CurFadingDuration=t,this.m_FadingTiming=t,this.m_OriVolume=cc.audioEngine.getVolume(this.m_BGMAudioID),this.m_TargetVolume=e),this.m_FadeVolumeCallback=o},t.OnUpdate=function(t){if(this.m_IsFadingVolume){this.m_FadingTiming-=t;var e=this.m_FadingTiming/this.m_CurFadingDuration,o=this.m_OriVolume+(this.m_TargetVolume-this.m_OriVolume)*(1-e);cc.audioEngine.setVolume(this.m_BGMAudioID,o),this.m_FadingTiming<=0&&(cc.audioEngine.setVolume(this.m_BGMAudioID,this.m_TargetVolume),this.m_IsFadingVolume=!1,null!==this.m_FadeVolumeCallback&&this.m_FadeVolumeCallback(this.m_BGMAudioID))}},t._GetUrl=function(t){return"audio/"+t},t.SetSFXEnable=function(t){this.m_SFXSwitch=t,t||this.StopSFX(),n.default.Save(n.default.SOUND_SWITCH,t?1:0)},t.SetMusicEnable=function(t){this.m_MusicSwitch=t,t?(this.PlayBGM(a.AudioName.BGM_Normal),cc.audioEngine.resumeMusic()):this.StopBGM(),n.default.Save(n.default.MUSIC_SWITCH,t?1:0)},t.SetBGMVolume=function(t){this.m_BGMAudioID>=0&&cc.audioEngine.setVolume(this.m_BGMAudioID,t)},t.PlayFightSFX=function(t,e){void 0===e&&(e=!1),i.default.Ins.mIsUsingSpeedItem&&!e||this.PlaySFX(t,!0,this.m_BGMHookVolume)},t.PlaySFX=function(t,e,o,n,i){var a=this;if(void 0===e&&(e=!1),void 0===o&&(o=1),void 0===n&&(n=!1),void 0===i&&(i=!1),this.m_SFXSwitch&&(!this.mMuteOnAD&&!this.m_IsMuteNow||n)){var s=o,l=this,m=this._GetUrl(t);if(e){var u=this.m_AudioCache.get(t);if(u)return void(l.m_SFXAudioID=cc.audioEngine.play(u,!1,l.m_SFXVolume*s))}r.default.Ins.LoadAudioClip(m,function(o){e&&a.m_AudioCache.set(t,o),l.m_SFXAudioID=cc.audioEngine.play(o,!1,l.m_SFXVolume*s),i&&(l.m_LastGuideAudioID=l.m_SFXAudioID)})}},t.PlayLoopSFX=function(t,e,o,n){var i=this;if(void 0===o&&(o=!1),void 0===n&&(n=1),this.m_SFXSwitch){var a=this,s=this._GetUrl(t);if(o){var l=this.m_AudioCache.get(t);if(l){var m=cc.audioEngine.play(l,!0,a.m_SFXVolume*n);return void(e&&e(m))}}r.default.Ins.LoadAudioClip(s,function(r){o&&i.m_AudioCache.set(t,r);var s=cc.audioEngine.play(r,!0,a.m_SFXVolume*n);e&&e(s)})}},t.StopBGM=function(){this.m_BGMAudioID>=0&&cc.audioEngine.stop(this.m_BGMAudioID),cc.audioEngine.stopMusic()},t.PlayBGM=function(t,e,o){if(void 0===e&&(e=!1),void 0===o&&(o=1),this.m_MusicSwitch){var n=this._GetUrl(t);this.m_CurBGMKey=t,this.m_BGMAudioID>=0&&(cc.audioEngine.stop(this.m_BGMAudioID),this.m_BGMAudioID=-1),cc.audioEngine.stopMusic();var i=this;r.default.Ins.LoadAudioClip(n,function(t){i.m_BGMAudioID=cc.audioEngine.playMusic(t,!0),cc.audioEngine.setMusicVolume(i.m_BGMVolume)})}},t.StopSFX=function(){this.m_SFXAudioID>=0&&cc.audioEngine.stop(this.m_SFXAudioID)},t.ResumeVolume=function(){this.m_IsMuteNow=!1,this.m_BGMAudioID>=0&&cc.audioEngine.setVolume(this.m_BGMAudioID,this.m_BGMHookVolume),cc.audioEngine.resumeAll()},t.MuteVolume=function(){this.m_IsMuteNow=!0,this.m_BGMAudioID>=0&&cc.audioEngine.setVolume(this.m_BGMAudioID,0),cc.audioEngine.pauseAll()},t.MuteOnAD=function(){this.mMuteOnAD=!0},t.ResumeMuteOnAD=function(){this.mMuteOnAD=!1},t.PlayBtnSound=function(){this.PlaySFX(a.AudioName.Sound_Btn,!0)},t.PlayGuideAudio=function(t){this.m_LastGuideAudioID>0&&cc.audioEngine.stop(this.m_LastGuideAudioID),this.PlaySFX("guide/"+t,!1,1.3,!1,!0)},t.m_SFXVolume=1,t.m_BGMVolume=2,t.m_IsMuteNow=!1,t.mMuteOnAD=!1,t.m_MusicSwitch=!0,t.m_SFXSwitch=!0,t.m_BGMHookVolume=.3,t.m_BGMAudioID=-1,t.m_SFXAudioID=-1,t.m_LastGuideAudioID=-1,t.m_AudioCache=new Map,t.m_IsFadingVolume=!1,t.m_FadingTiming=0,t.m_CurFadingDuration=0,t.m_TargetVolume=0,t.m_OriVolume=0,t.m_FadeVolumeCallback=null,t}();o.default=s,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Proxy/ProxySpeed":"ProxySpeed","./ResMgr":"ResMgr","./SaveMgr":"SaveMgr"}],BCMgr:[function(t,e,o){"use strict";cc._RF.push(e,"2029eS8A4VH64Z8HQst1MbM","BCMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.Subscribe=function(t,e,o){void 0===this.mBCMap.get(t)&&this.mBCMap.set(t,[]),this.mBCMap.get(t).push({callback:e,target:o})},t.Remove=function(t,e,o){var n=this.mBCMap.get(t);if(void 0!==n)for(var r=n.length-1;r>=0;--r){var i=n[r];o==i.target&&e.toString()==i.callback.toString()&&n.splice(r,1)}},t.Dispatch=function(t,e,o,n){var r=this.mBCMap.get(t);if(void 0!==r)for(var i=0;i<r.length;++i){var a=r[i];a.callback.call(a.target,e,o,n)}},t.mBCMap=new Map,t}();o.default=n,cc._RF.pop()},{}],BackCityBoxItem:[function(t,e,o){"use strict";cc._RF.push(e,"49eb9zO8YRCfJTEl7/s3edO","BackCityBoxItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mUnlockLbl=null,e.mUnlockedTag=null,e.mTargetLevel=0,e}return r(e,t),e.prototype.SetTargetLevel=function(t){this.mUnlockLbl.string=t+"\u5173\n        \u89e3\u9501"},e.prototype.UpdateCurLevel=function(){},i([l(cc.Label)],e.prototype,"mUnlockLbl",void 0),i([l(cc.Node)],e.prototype,"mUnlockedTag",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],BackCityBoxPanel:[function(t,e,o){"use strict";cc._RF.push(e,"6a5b7qfxMtGE77bDucP+EqU","BackCityBoxPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BackCityBoxItem"),s=t("../../Proxy/ProxyBackCity"),l=t("../../Manager/UserMgr"),m=t("../../Manager/FuncMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBoxItemArr=[],e.mBoxPB=null,e.mBaseBoxLevel=100,e.mTargetBoxLevel=140,e}return r(e,t),e.prototype.OnOpen=function(){this.mBaseBoxLevel=m.default.GetCanBackCityLevel(),this.mTargetBoxLevel=s.default.Ins.GetBoxTargetLevel(),this.mBoxItemArr[0].SetTargetLevel(this.mBaseBoxLevel),this.mBoxItemArr[1].SetTargetLevel(this.mTargetBoxLevel);var t=l.default.Ins.ClientInfo.curLevel;this.UpdateByLevel(t)},e.prototype.UpdateByLevel=function(t){this.mBoxItemArr[0].UpdateCurLevel(t),this.mBoxItemArr[1].UpdateCurLevel(t)},i([c([a.default])],e.prototype,"mBoxItemArr",void 0),i([c(cc.ProgressBar)],e.prototype,"mBoxPB",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Manager/FuncMgr":"FuncMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyBackCity":"ProxyBackCity","./BackCityBoxItem":"BackCityBoxItem"}],BackCityInstructionWin:[function(t,e,o){"use strict";cc._RF.push(e,"b3ea6w26ZVFeKukTdsx459H","BackCityInstructionWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/WinMgr"),l=t("../../Manager/UserMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=(u.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Invoke_Close=function(){this.CloseWin(),l.default.Ins.ClientInfo.hasShownBackCityInstructionWin||(l.default.Ins.ClientInfo.hasShownBackCityInstructionWin=!0,l.default.Ins.Save(),s.default.Ins.Open(m.WinType.BackCityWin,null))},i([p],e)}(a.default));o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","./WinBase":"WinBase"}],BackCityRewardWin:[function(t,e,o){"use strict";cc._RF.push(e,"23487ZG4zZPmr4hr0YdUbNi","BackCityRewardWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Proxy/ProxyBackCity"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMedalNumLbl=null,e.mCurAddRevenueLbl=null,e.mCurAddLvLbl=null,e}return r(e,t),e.prototype.SetData=function(t){this.mMedalNumLbl.string="+"+s.default.FormatNumber(t),this.mCurAddRevenueLbl.string="+"+l.default.Ins.mBackRunningInfo.curWorkAddRevenue+"%",this.mCurAddLvLbl.string="+"+l.default.Ins.mBackRunningInfo.curWorkAddLv,m.default.PlaySFX(u.AudioName.UI_BackCity)},e.prototype.Invoke_Click=function(){m.default.PlayBtnSound(),this.CloseWin()},i([d(cc.Label)],e.prototype,"mMedalNumLbl",void 0),i([d(cc.Label)],e.prototype,"mCurAddRevenueLbl",void 0),i([d(cc.Label)],e.prototype,"mCurAddLvLbl",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Proxy/ProxyBackCity":"ProxyBackCity","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./WinBase":"WinBase"}],BackCityWin:[function(t,e,o){"use strict";cc._RF.push(e,"72b17aWZJRERaqwuSeUx1mk","BackCityWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/WorkDetailPanel"),l=t("../Comp/MedalDetailPanel"),m=t("../../Proxy/ProxyWork"),u=t("../../Proxy/ProxyOffline"),p=t("../../Proxy/ProxyLargeNum"),c=t("../../Proxy/ProxyHero"),d=t("../../Proxy/ProxyBackCity"),f=t("../../Platform/PlatformBase"),h=t("../../Manager/WinMgr"),y=t("../../Manager/UserMgr"),g=t("../../Manager/PlatformMgr"),I=t("../../Manager/FuncMgr"),S=t("../../Manager/FightMgr"),_=t("../../Manager/BCMgr"),v=t("../../Manager/AudioMgr"),C=t("../../Common/GameRunningData"),M=t("../../Common/EnumsDefine"),P=t("../../Common/Common"),T=cc._decorator,D=T.ccclass,A=T.property,O=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAddMedalNumLbl=null,e.mCurLevelLbl=null,e.mLevelAddLbl=null,e.mPlayerAddMedalLbl=null,e.mWorkAddRevenueLbl=null,e.mWorkAddLvLbl=null,e.mNormalAddMedalLbl=null,e.mADAddMedalLbl=null,e.mCanBackLevelLbl=null,e.mFastNode=null,e.mBackBtnRoot=null,e.medalDetailPanel=null,e.mWorkDetailPanel=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mCurAddMedalNum=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mCanBackLevelLbl.string=""+I.default.GetCanBackCityLevel(),this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&P.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._UpdateByLevel();var e=d.default.Ins.mBackRunningInfo;this.mPlayerAddMedalLbl.string="x"+d.default.Ins.GetPlayerAddMedal().toFixed(2);var o=e.curWorkAddRevenue+d.default.Ins.mWorkOnceAddRevenue,n=d.default.Ins.GetAddRevenueLimit();o>n&&(o=n),this.mWorkAddRevenueLbl.string=o+"%";var r=e.curWorkAddLv+d.default.Ins.mWorkOnceAddLv,i=d.default.Ins.GetAddLvLimit();r>i&&(r=i),this.mWorkAddLvLbl.string=""+r,v.default.PlaySFX(M.AudioName.UI_TanKuang,!0)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),_.default.Subscribe(M.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),_.default.Remove(M.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this)},e.prototype._UpdateByLevel=function(){var t=y.default.Ins.ClientInfo.curLevel;this.mCurLevelLbl.string=""+t,t>=I.default.GetCanBackCityLevel()?(this.mCanBackLevelLbl.node.opacity=0,this.mBackBtnRoot.active=!0):(this.mBackBtnRoot.active=!1,this.mCanBackLevelLbl.node.opacity=255,0===d.default.Ins.mBackSaveInfo.backTimes?this.mFastNode.opacity=255:this.mFastNode.opacity=0);var e=d.default.Ins.GetCanGetMedalNum();this.mCurAddMedalNum=e;var o=p.default.FormatNumber(e,1);this.mAddMedalNumLbl.string="+"+o,this.mNormalAddMedalLbl.string="+"+o;var n=2*e;this.mADAddMedalLbl.string="+"+p.default.FormatNumber(n,1),this.mLevelAddLbl.string="x"+d.default.Ins.GetCurLevelGetMedalSpeed()},e.prototype._OnMsg_ChangeLevel=function(){this._UpdateByLevel()},e.prototype.Invoke_Instruction=function(){v.default.PlayBtnSound(),h.default.Ins.Open(M.WinType.BackCityInstructionWin,null)},e.prototype.Invoke_MedalDetail=function(){v.default.PlayBtnSound(),this.medalDetailPanel.Open()},e.prototype.Invoke_WorkDetail=function(){v.default.PlayBtnSound(),this.mWorkDetailPanel.Open()},e.prototype.Invoke_BackCity=function(){v.default.PlayBtnSound(),y.default.Ins.UpdateItem(M.ItemType.Medal,this.mCurAddMedalNum),this._BackCityCommon(this.mCurAddMedalNum),d.default.Ins.mBackSaveInfo.backTimes>1&&g.default.mCurPlf.ShowInterstitial(f.ADUnitID.Interstitial_Func_ID,M.InsPoint.BackCityNormal)},e.prototype._BackCityCommon=function(t){y.default.Ins.BackCity(),d.default.Ins.BackCity(),C.default.Ins.TagFlyCoin(),c.default.Ins.BackCity(),m.default.Ins.BackCity(),null!==S.default.mNormalFightMode&&S.default.mNormalFightMode.BackCity(),u.default.Ins.OnAllAttrChanged(),_.default.Dispatch(M.BCType.BackCity),this.CloseWin(),h.default.Ins.Open(M.WinType.BackCityRewardWin,function(e){e.SetData(t)})},e.prototype.Invoke_DoubleBackCity=function(){v.default.PlayBtnSound(),P.default.WatchADForRewards(this._AdCallback.bind(this),f.ADUnitID.CommonVideoID_30,M.ADPoint.DoubleBackCity)},e.prototype._AdCallback=function(t){var e=2*this.mCurAddMedalNum;y.default.Ins.UpdateItem(M.ItemType.Medal,e),t&&(y.default.Ins.GetADExtraRewards(),h.default.Ins.Open(M.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"0")})),this._BackCityCommon(e)},e.prototype.Invoke_Close=function(){v.default.PlayBtnSound(),this.CloseWin()},i([A(cc.Label)],e.prototype,"mAddMedalNumLbl",void 0),i([A(cc.Label)],e.prototype,"mCurLevelLbl",void 0),i([A(cc.Label)],e.prototype,"mLevelAddLbl",void 0),i([A(cc.Label)],e.prototype,"mPlayerAddMedalLbl",void 0),i([A(cc.Label)],e.prototype,"mWorkAddRevenueLbl",void 0),i([A(cc.Label)],e.prototype,"mWorkAddLvLbl",void 0),i([A(cc.Label)],e.prototype,"mNormalAddMedalLbl",void 0),i([A(cc.Label)],e.prototype,"mADAddMedalLbl",void 0),i([A(cc.Label)],e.prototype,"mCanBackLevelLbl",void 0),i([A(cc.Node)],e.prototype,"mFastNode",void 0),i([A(cc.Node)],e.prototype,"mBackBtnRoot",void 0),i([A(l.default)],e.prototype,"medalDetailPanel",void 0),i([A(s.default)],e.prototype,"mWorkDetailPanel",void 0),i([A(cc.Node)],e.prototype,"mCloseBtn",void 0),i([A(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([D],e)}(a.default);o.default=O,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/GameRunningData":"GameRunningData","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/FightMgr":"FightMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyBackCity":"ProxyBackCity","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyOffline":"ProxyOffline","../../Proxy/ProxyWork":"ProxyWork","../Comp/MedalDetailPanel":"MedalDetailPanel","../Comp/WorkDetailPanel":"WorkDetailPanel","./WinBase":"WinBase"}],BattleBoxWin:[function(t,e,o){"use strict";cc._RF.push(e,"93d05//PJpPVqD53LDpCFiB","BattleBoxWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyBattleBox"),l=t("../../Platform/PlatformBase"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.goldNumLbl=null,e.mBackBtn=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.goldNumLbl.string="x"+s.default.Ins.mBoxGoldBaseNum},e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),c.default.PlaySFX(d.AudioName.UI_TanKuang,!0),this.mBackBtn.active=!1,this.scheduleOnce(function(){e.mBackBtn.active=!0},f.default.BACK_BTN_SHOW_DELAY_TIME)},e.prototype.Invoke_GetRewards=function(){c.default.PlayBtnSound(),f.default.WatchADForRewards(this._AdCallback.bind(this),l.ADUnitID.CommonVideoID_15,d.ADPoint.BattleGoldBox)},e.prototype._AdCallback=function(t){var e=s.default.Ins.GetGoldNum();u.default.Ins.UpdateItem(d.ItemType.Gold,e),t&&u.default.Ins.GetADExtraRewards(),u.default.Ins.ClientInfo.battleGoldBoxLeftCount--,u.default.Ins.Save(),m.default.Ins.Open(d.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(d.ItemType.Gold,e+""):n.SetDataSingle(d.ItemType.Gold,e+"")}),this.CloseWin(),p.default.Dispatch(d.BCType.BattleWin_HideBattleBox)},e.prototype.Invoke_Close=function(){c.default.PlayBtnSound(),this.CloseWin()},i([g(cc.Label)],e.prototype,"goldNumLbl",void 0),i([g(cc.Node)],e.prototype,"mBackBtn",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyBattleBox":"ProxyBattleBox","./WinBase":"WinBase"}],BattleCamera:[function(t,e,o){"use strict";cc._RF.push(e,"654eaZgYEVClrwhwbjuVap8","BattleCamera");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./AI/EntityState"),s=t("../Manager/FightMgr"),l=t("../Common/Common"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){var e=t.call(this)||this;return e.mMinX=0,e.mMaxX=720,e.mCurFollower=null,e.mPercentX=0,e.mCurX=0,e.mIsDraging=!1,e.mIsWaitingFollow=!1,e.mOffsetX=100,e.mCheckFollowerInterval=1,e.mCheckFollowerTiming=e.mCheckFollowerInterval,e.mTweenDuration=1,e.mTweenTiming=0,e.mIsTweening=!1,e.mStartPosX=0,e.mWaitTime=1,e.mWaitTiming=e.mWaitTime,e}return r(e,t),e.prototype.CheckUpdateTarget=function(t){if(void 0===t&&(t=!1),null!==s.default.mCurFightMode){var e=this._FindTarget(s.default.mCurFightMode.mHeroArr,!0);null===e&&(e=this._FindTarget(s.default.mCurFightMode.mEnemyArr,!1)),null===e||this.mCurFollower===e.node&&!t||this.SetFollower(e.node,!1)}},e.prototype._FindTarget=function(t,e){void 0===e&&(e=!0);var o=null,n=0;n=e?-1e3:1e3;for(var r=null,i=0,s=0,l=t.length;s<l;++s)(r=t[s]).GetCurStateType()!==a.EntityStateType.Dead&&(i=r.node.x,e?n<i&&(o=r,n=i):n>i&&(o=r,n=i));return o},e.prototype.Reset=function(){this.node.x=this.mMinX,this.mPercentX=0,this.mCurFollower=null,this.mIsTweening=!1},e.prototype.WaitToFollow=function(t){this.mIsWaitingFollow=!0,this.mWaitTiming=t||this.mWaitTime},e.prototype.MoveCam=function(t){if(this.mIsDraging){var e=this.node.x+t;e=l.default.Clamp(e,this.mMinX,this.mMaxX),this.node.x=e,this.mPercentX=e/this.mMaxX}},e.prototype.SetFollower=function(t,e){void 0===e&&(e=!0),this.mCurFollower=t,e?(this.mCurX=this.mCurFollower.x+this.mOffsetX,this.node.x=l.default.Clamp(this.mCurX,this.mMinX,this.mMaxX),this.mPercentX=this.node.x/this.mMaxX):(this.mIsTweening=!0,this.mTweenTiming=this.mTweenDuration,this.mStartPosX=this.node.x)},e.prototype.OnUpdate=function(t){if(!this.mIsDraging)if(this.mIsWaitingFollow)this.mWaitTiming-=t,this.mWaitTiming<=0&&(this.mIsWaitingFollow=!1,this.CheckUpdateTarget(!0));else{if(null!==this.mCurFollower)if(this.mIsTweening){this.mTweenTiming-=t,this.mTweenTiming<0&&(this.mTweenTiming=0,this.mIsTweening=!1);var e=this.mTweenTiming/this.mTweenDuration,o=this.mCurFollower.x+this.mOffsetX,n=this.mStartPosX*e+o*(1-e);n=l.default.Clamp(n,this.mMinX,this.mMaxX),this.node.x=n,this.mPercentX=n/this.mMaxX}else this.mCurX=this.mCurFollower.x+this.mOffsetX,n=l.default.Clamp(this.mCurX,this.mMinX,this.mMaxX),this.node.x=n,this.mPercentX=n/this.mMaxX;this.mCheckFollowerTiming-=t,this.mCheckFollowerTiming<=0&&(this.mCheckFollowerTiming=this.mCheckFollowerInterval,this.CheckUpdateTarget())}},i([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../Common/Common":"Common","../Manager/FightMgr":"FightMgr","./AI/EntityState":"EntityState"}],BattleWin:[function(t,e,o){"use strict";cc._RF.push(e,"aec71XuqKFKPo8skIO7o7t1","BattleWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/BgMap"),l=t("../../Proxy/ProxyWork"),m=t("../../Proxy/ProxyImmortal"),u=t("../../Proxy/ProxyBattleBox"),p=t("../../Manager/WinMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/FightMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../MainGame"),g=t("../../Common/EnumsDefine"),I=t("../../Common/Common"),S=t("../../Battle/AI/FightState"),_=cc._decorator,v=_.ccclass,C=_.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMapRoot=null,e.mEntityRoot=null,e.mEfxRoot=null,e.mHPRoot=null,e.mBulletRoot=null,e.mBuffRoot=null,e.map=null,e.mCoinBoxNode=null,e.mGoldBoxNode=null,e.mFloatNumRoot=null,e.mBossSk=null,e.mCamMoveNode=null,e.mSkillBgNode=null,e.mSkillBgAnim=null,e.mImmortalRoot=null,e.mShakeRoot=null,e.mLCrystalX=-210,e.mRCrystalX=930,e.mHeroSpawnX=-150,e.mLandMinY=120,e.mLandMaxY=220,e.mAirMinY=220,e.mAirMaxY=260,e.mBattleCam=null,e.mSkillBgTween=null,e}var o;return r(e,t),o=e,e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),o.EfxRoot=this.mEfxRoot,o.HPRoot=this.mHPRoot,o.BuffRoot=this.mBuffRoot,o.ShakeRoot=this.mShakeRoot,this.mCoinBoxNode.active=!1,this.mGoldBoxNode.active=!1;var e=I.default.DESIGN_HEIGHT/I.default.DESIGN_WIDTH,n=(I.default.ScreenHeight/I.default.ScreenWidth-e)/(2.3-e);n=I.default.Clamp(n,0,1);var r=I.default.Lerp(266,466,n);this.mBossSk.node.y=r,this.mBattleCam=y.default.mBattleCam,this.mCamMoveNode.on(cc.Node.EventType.TOUCH_START,this._OnEvent_TouchStart,this),this.mCamMoveNode.on(cc.Node.EventType.TOUCH_MOVE,this._OnEvent_TouchMove,this),this.mCamMoveNode.on(cc.Node.EventType.TOUCH_END,this._OnEvent_TouchEnd,this),this.mCamMoveNode.on(cc.Node.EventType.TOUCH_CANCEL,this._OnEvent_TouchCancel,this),this._OnMsg_ChangeMap(d.default.Ins.GetMapIDByCurLevel()),h.default.PlayBGM(g.AudioName.BGM_Normal)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this)},e.prototype.update=function(){null!==this.map&&this.map.OnUpdate()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),f.default.Subscribe(g.BCType.BattleWin_AddHero,this._OnMsg_AddHero,this),f.default.Subscribe(g.BCType.BattleWin_AddEnemy,this._OnMsg_AddEnemy,this),f.default.Subscribe(g.BCType.BattleWin_AddBullet,this._OnMsg_AddBullet,this),f.default.Subscribe(g.BCType.BattleWin_AddCrystal,this._OnMsg_AddCrystal,this),f.default.Subscribe(g.BCType.BattleWin_AddSkillItem,this._OnMsg_AddSkillItem,this),f.default.Subscribe(g.BCType.BattleWin_StartSkill,this._OnMsg_StartSkill,this),f.default.Subscribe(g.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this),f.default.Subscribe(g.BCType.BattleWin_HideBattleBox,this._OnMsg_OpenBox,this),f.default.Subscribe(g.BCType.BattleWin_ShowFloatNum,this._OnMsg_ShowFloatNum,this),f.default.Subscribe(g.BCType.BattleWin_ShowBOSSAnim,this._OnMsg_ShowBossAnim,this),f.default.Subscribe(g.BCType.BattleWin_ChangeMap,this._OnMsg_ChangeMap,this),f.default.Subscribe(g.BCType.Activity_UpdateBackUI,this._OnMsg_UpdateBackUI,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),f.default.Remove(g.BCType.BattleWin_AddHero,this._OnMsg_AddHero,this),f.default.Remove(g.BCType.BattleWin_AddEnemy,this._OnMsg_AddEnemy,this),f.default.Remove(g.BCType.BattleWin_AddBullet,this._OnMsg_AddBullet,this),f.default.Remove(g.BCType.BattleWin_AddCrystal,this._OnMsg_AddCrystal,this),f.default.Remove(g.BCType.BattleWin_AddSkillItem,this._OnMsg_AddSkillItem,this),f.default.Remove(g.BCType.BattleWin_StartSkill,this._OnMsg_StartSkill,this),f.default.Remove(g.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this),f.default.Remove(g.BCType.BattleWin_HideBattleBox,this._OnMsg_OpenBox,this),f.default.Remove(g.BCType.BattleWin_ShowFloatNum,this._OnMsg_ShowFloatNum,this),f.default.Remove(g.BCType.BattleWin_ShowBOSSAnim,this._OnMsg_ShowBossAnim,this),f.default.Remove(g.BCType.BattleWin_ChangeMap,this._OnMsg_ChangeMap,this),f.default.Remove(g.BCType.Activity_UpdateBackUI,this._OnMsg_UpdateBackUI,this)},e.prototype._OnEvent_TouchStart=function(){d.default.mCurFightingLevel>0&&(this.mBattleCam.mIsDraging=!0)},e.prototype._OnEvent_TouchMove=function(t){this.mBattleCam.MoveCam(-t.touch.getDelta().x)},e.prototype._OnEvent_TouchEnd=function(){this.mBattleCam.mIsDraging=!1,this.mBattleCam.WaitToFollow()},e.prototype._OnEvent_TouchCancel=function(){this.mBattleCam.mIsDraging=!1,this.mBattleCam.WaitToFollow()},e.prototype._OnMsg_AddHero=function(t){var e;t.node.parent=this.mEntityRoot,t.node.x=this.mHeroSpawnX,e=1===t.mEntityData.armType?I.default.GetRandValueBetween(this.mAirMinY,this.mAirMaxY):I.default.GetRandValueBetween(this.mLandMinY,this.mLandMaxY),t.node.y=e,t.node.zIndex=-e},e.prototype._OnMsg_AddEnemy=function(t){var e;t.node.parent=this.mEntityRoot,t.node.x=this.mRCrystalX,e=1===t.mEntityData.armType?I.default.GetRandValueBetween(this.mAirMinY,this.mAirMaxY):t.mIsBoss?130:I.default.GetRandValueBetween(this.mLandMinY,this.mLandMaxY),t.node.y=e,t.node.zIndex=-e},e.prototype._OnMsg_AddBullet=function(t,e){t.node.parent=this.mBulletRoot,t.node.setPosition(this.mBulletRoot.convertToNodeSpaceAR(e))},e.prototype._OnMsg_AddCrystal=function(t,e){t.node.parent=this.mEntityRoot,t.node.y=100,t.node.zIndex=-100,t.node.x=0===e?this.mLCrystalX:this.mRCrystalX},e.prototype._OnMsg_AddSkillItem=function(t){t.node.parent=this.mImmortalRoot},e.prototype._OnMsg_StartSkill=function(t,e){this.mSkillBgNode.active=!0,this.mSkillBgNode.opacity=0;var o=this;null!==this.mSkillBgTween&&this.mSkillBgTween.stop(),this.mSkillBgTween=cc.tween(this.mSkillBgNode).to(.2,{opacity:225}).delay(e).to(.2,{opacity:0}).call(function(){o.mSkillBgNode.active=!1}).start(),this.mSkillBgAnim.node.x=y.default.mBattleCam.node.x,this.mSkillBgAnim.skeletonData||c.default.Ins.LoadSpine("spine/suduxian_jineng",function(t){o&&o.mSkillBgAnim&&(o.mSkillBgAnim.skeletonData=t,o.mSkillBgAnim.setAnimation(0,"animation",!0))})},e.prototype._OnMsg_ChangeLevel=function(){var t=this,e=u.default.Ins.GetBoxType();this.scheduleOnce(function(){switch(e){case u.BattleBoxType.None:t.mCoinBoxNode.active=!1,t.mGoldBoxNode.active=!1;break;case u.BattleBoxType.Coin:t.mCoinBoxNode.active=!0,t.mGoldBoxNode.active=!1;break;case u.BattleBoxType.Gold:t.mCoinBoxNode.active=!1,t.mGoldBoxNode.active=!0}},.5)},e.prototype._OnMsg_OpenBox=function(){this.mCoinBoxNode.active=!1,this.mGoldBoxNode.active=!1},e.prototype._OnMsg_ShowFloatNum=function(t,e){t.node.parent=this.mFloatNumRoot;var o=this.mFloatNumRoot.convertToNodeSpaceAR(e);t.node.position=o},e.prototype._OnMsg_ShowBossAnim=function(){if(null===this.mBossSk.skeletonData){var t=this;this.mBossSk.setCompleteListener(this._OnAnimEvent_BossAnim.bind(this)),c.default.Ins.LoadSpine("spine/bosslaixi",function(e){t.mBossSk.skeletonData=e,t.mBossSk.node.active=!0,t.mBossSk.setAnimation(0,"animation",!1)})}else this.mBossSk.node.active=!0,this.mBossSk.setAnimation(0,"animation",!1);h.default.PlaySFX(g.AudioName.Fihgt_Boss)},e.prototype._OnMsg_ChangeMap=function(t){if(Number(this.map.node.name)!==t){var e=this;c.default.Ins.LoadPrefab("prefab/map/"+t,function(t){e.map.node.destroy(),e.map=cc.instantiate(t).getComponent(s.default),e.map.node.parent=e.mMapRoot,e.map.node.zIndex=-1,e.map.node.position=cc.v3(720,0,0)})}},e.prototype._OnMsg_UpdateBackUI=function(t){this.node.opacity=t?255:0},e.prototype._OnAnimEvent_BossAnim=function(){this.mBossSk.node.active=!1,d.default.mNormalFightMode.ChangeState(S.FightStateType.Fighting)},e.prototype._GetBoxCoinAddRate=function(){return 1+.01*m.default.Ins.GetAttrValue(g.ImtAttrType.BattleBoxCoinAdd)},e.prototype.Invoke_ClickCoinBox=function(){h.default.PlayBtnSound();var t=this.mCoinBoxNode.parent.convertToWorldSpaceAR(this.mCoinBoxNode.position);t.x-=y.default.mBattleCam.mCurX;var e=l.default.Ins.mRevenueCoinInSeconds.MultiplySingle(5*this._GetBoxCoinAddRate());I.default.GetFlyCoin(e,cc.v2(t),10),this.mCoinBoxNode.active=!1},e.prototype.Invoke_ClickGoldBox=function(){h.default.PlayBtnSound(),p.default.Ins.Open(g.WinType.BattleBoxWin,null)},e.EfxRoot=null,e.HPRoot=null,e.BuffRoot=null,e.ShakeRoot=null,i([C(cc.Node)],e.prototype,"mMapRoot",void 0),i([C(cc.Node)],e.prototype,"mEntityRoot",void 0),i([C(cc.Node)],e.prototype,"mEfxRoot",void 0),i([C(cc.Node)],e.prototype,"mHPRoot",void 0),i([C(cc.Node)],e.prototype,"mBulletRoot",void 0),i([C(cc.Node)],e.prototype,"mBuffRoot",void 0),i([C(s.default)],e.prototype,"map",void 0),i([C(cc.Node)],e.prototype,"mCoinBoxNode",void 0),i([C(cc.Node)],e.prototype,"mGoldBoxNode",void 0),i([C(cc.Node)],e.prototype,"mFloatNumRoot",void 0),i([C(sp.Skeleton)],e.prototype,"mBossSk",void 0),i([C(cc.Node)],e.prototype,"mCamMoveNode",void 0),i([C(cc.Node)],e.prototype,"mSkillBgNode",void 0),i([C(sp.Skeleton)],e.prototype,"mSkillBgAnim",void 0),i([C(cc.Node)],e.prototype,"mImmortalRoot",void 0),i([C(cc.Node)],e.prototype,"mShakeRoot",void 0),o=i([v],e)}(a.default);o.default=M,cc._RF.pop()},{"../../Battle/AI/FightState":"FightState","../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/FightMgr":"FightMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyBattleBox":"ProxyBattleBox","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyWork":"ProxyWork","../Comp/BgMap":"BgMap","./WinBase":"WinBase"}],BgMap:[function(t,e,o){"use strict";cc._RF.push(e,"3ed77vtAe9E9JolHzlV6S+r","BgMap");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../MainGame"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLayersArr=[],e.mDistArr=[],e.mTopRoot=null,e}return r(e,t),e.prototype.OnUpdate=function(){for(var t=a.default.mBattleCam.mPercentX,e=0,o=this.mLayersArr.length;e<o;++e)this.mLayersArr[e].x=this.mDistArr[e]*t},i([m([cc.Node])],e.prototype,"mLayersArr",void 0),i([m([cc.Integer])],e.prototype,"mDistArr",void 0),i([m(cc.Node)],e.prototype,"mTopRoot",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../MainGame":"MainGame"}],BlackSmithItem:[function(t,e,o){"use strict";cc._RF.push(e,"dcbbbGAy8BGx7SRWBK3wOAh","BlackSmithItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ForgeLockPanel"),s=t("./CDBtn"),l=t("../../Proxy/ProxySmith"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Proxy/ProxyImmortal"),p=t("../../Proxy/ProxyForge"),c=t("../../Platform/PlatformBase"),d=t("../../Manager/WinMgr"),f=t("../../Manager/UserMgr"),h=t("../../Manager/ResMgr"),y=t("../../Manager/GuideMgr"),g=t("../../Manager/FloatItemMgr"),I=t("../../Manager/DataMgr"),S=t("../../Common/EnumsDefine"),_=t("../../Common/Common"),v=cc._decorator,C=v.ccclass,M=v.property,P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBlackSmithSk=null,e.mTitleLbl=null,e.mTitleBg=null,e.mTitleRoot=null,e.mForgingRoot=null,e.mLeftTimeLbl=null,e.mTimePb=null,e.mLockPanel=null,e.mImtStarSk=null,e.mCDBtn=null,e.mCurSI=null,e.mForgeWin=null,e}return r(e,t),e.prototype.Init=function(t,e){this.mForgeWin=e,this.mCurSI=t,this.mTitleLbl.string=p.default.Ins.GetForgeTitleStr(t.title),this.mTitleBg.spriteFrame=this.mForgeWin.mTitleBgSF[t.title-1];var o=this;h.default.Ins.LoadSpine("spine/blacksmith/tiejiang_"+t.title,function(e){null!==o.mBlackSmithSk&&(o.mBlackSmithSk.skeletonData=e,o.SetState(t.forgeState))})},e.prototype._ShowForgeAnim=function(t){switch(t){case S.ForgeState.Lock:case S.ForgeState.BtnLock:this.mBlackSmithSk.setAnimation(0,"weijiesuo",!0);break;case S.ForgeState.Idle:this.mBlackSmithSk.setAnimation(0,"daiji",!0);break;case S.ForgeState.Forging:this.mBlackSmithSk.setAnimation(0,"dazaozhong",!0);break;case S.ForgeState.Completed:this.mBlackSmithSk.setAnimation(0,"wancheng",!0)}},e.prototype.SetState=function(t){switch(this._ShowForgeAnim(t),null!==this.mLockPanel&&(this.mLockPanel.node.active=!1),t){case S.ForgeState.Lock:case S.ForgeState.BtnLock:this.mLockPanel.node.active=!0,this.mLockPanel.SetData(this.mCurSI);break;case S.ForgeState.Idle:this.mTitleRoot.active=!0,this.mForgingRoot.active=!1,null!==this.mImtStarSk&&(this.mImtStarSk.node.active=!1);break;case S.ForgeState.Forging:this.mForgingRoot.active=!0,this.mLeftTimeLbl.string=_.default.FormatTimeBySeconds(this.mCurSI.leftTime),this.mTimePb.progress=this.mCurSI.leftTime/this.mCurSI.totalTime,this._ShowImtStarEfx(!1);break;case S.ForgeState.Completed:this.mForgingRoot.active=!1,this._ShowImtStarEfx(!0)}},e.prototype._ShowImtStarEfx=function(t){var e=I.default.Ins.m_DB.immortalDB[this.mCurSI.imtID].star+"";if(t){if(null!==this.mImtStarSk&&0!==this.mCurSI.imtID){var o=this;h.default.Ins.LoadSpine("spine/blacksmith/wancheng",function(t){null!==o.mImtStarSk&&(o.mImtStarSk.skeletonData=t,o.mImtStarSk.node.active=!0,o.mImtStarSk.setAnimation(0,e,!0))})}}else this.mImtStarSk.node.active=!1,this.mBlackSmithSk.setSkin(e)},e.prototype.RefreshState=function(){this.SetState(this.mCurSI.forgeState),null!==this.mCDBtn&&this.mCDBtn.UpdateUI()},e.prototype.UpdateSmithSk=function(){this.mTitleLbl.string=p.default.Ins.GetForgeTitleStr(this.mCurSI.title),this.mTitleBg.spriteFrame=this.mForgeWin.mTitleBgSF[this.mCurSI.title-1];var t=this;h.default.Ins.LoadSpine("spine/blacksmith/tiejiang_"+this.mCurSI.title,function(e){null!==t.mBlackSmithSk&&(t.mBlackSmithSk.skeletonData=e,t._ShowForgeAnim(t.mCurSI.forgeState))})},e.prototype.UpdateForgeTime=function(t){t<=0?this.RefreshState():(this.mTimePb.progress=this.mCurSI.leftTime/this.mCurSI.totalTime,this.mLeftTimeLbl.string=_.default.FormatTimeBySeconds(t))},e.prototype.Invoke_OpenBlackSmithWin=function(){var t=this;switch(this.mCurSI.forgeState){case S.ForgeState.Lock:case S.ForgeState.BtnLock:d.default.Ins.ShowTips("\u8bf7\u5148\u89e3\u9501~");break;case S.ForgeState.Completed:var e=this.mCurSI.imtID;if(p.default.Ins.GetForgeImt(this.mCurSI.id),this.SetState(this.mCurSI.forgeState),null!==u.default.Ins.GetImtSI(e)){var o=I.default.Ins.m_DB.immortalDB[e];if(o&&o.star<u.default.Ins.MAX_STAR-1&&_.default.GetRandValueBetween(0,100)<=u.default.Ins.mLuckyImtRate){d.default.Ins.Open(S.WinType.LuckyImtWin,function(t){t.SetData(e)});break}}var n=u.default.Ins.GetImt(e),r=!1;if(!n&&(r=l.default.Ins.CheckDoubleImt())){var i=u.default.Ins.GetConvertMat(e);f.default.Ins.UpdateItem(i[0],i[1]),g.default.Ins.ShowItem(i[0],m.default.FormatNumber(i[1],1))}d.default.Ins.Open(S.WinType.GetImtWin,function(t){t.SetData(e,n,r)});break;default:d.default.Ins.Open(S.WinType.SmithWin,function(e){e.SetData(t.mCurSI.id)})}},e.prototype.Invoke_SpeedUp=function(){this.mCurSI.forgeState===S.ForgeState.Forging?null!==this.mCDBtn&&this.mCDBtn.IsCDing()||(y.default.IsGuiding&&1===p.default.Ins.mForgeInfo.forgeTimes?(p.default.Ins.SpeedUp(this.mCurSI.id),this.RefreshState()):(null!==this.mCDBtn&&this.mCDBtn.StartClickCD(),_.default.WatchADForRewards(this._OnSpeedUp.bind(this),c.ADUnitID.CommonVideo,S.ADPoint.ForgeSpeedUp))):console.error("\u5f53\u524d\u4e0d\u5904\u4e8e\u6253\u9020\u72b6\u6001...\u68c0\u67e5\u903b\u8f91")},e.prototype._OnSpeedUp=function(t){p.default.Ins.SpeedUp(this.mCurSI.id),this.RefreshState(),t&&(null!==this.mCDBtn&&this.mCDBtn.StartOKCD(),f.default.Ins.GetADExtraRewards(),d.default.Ins.Open(S.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"0")}))},i([M(sp.Skeleton)],e.prototype,"mBlackSmithSk",void 0),i([M(cc.Label)],e.prototype,"mTitleLbl",void 0),i([M(cc.Sprite)],e.prototype,"mTitleBg",void 0),i([M(cc.Node)],e.prototype,"mTitleRoot",void 0),i([M(cc.Node)],e.prototype,"mForgingRoot",void 0),i([M(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([M(cc.ProgressBar)],e.prototype,"mTimePb",void 0),i([M(a.default)],e.prototype,"mLockPanel",void 0),i([M(sp.Skeleton)],e.prototype,"mImtStarSk",void 0),i([M(s.default)],e.prototype,"mCDBtn",void 0),i([C],e)}(cc.Component);o.default=P,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/DataMgr":"DataMgr","../../Manager/FloatItemMgr":"FloatItemMgr","../../Manager/GuideMgr":"GuideMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySmith":"ProxySmith","./CDBtn":"CDBtn","./ForgeLockPanel":"ForgeLockPanel"}],BossHPBar:[function(t,e,o){"use strict";cc._RF.push(e,"28161dFYTZM4Iikb/+bYG2h","BossHPBar");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./HPBar"),s=t("../../MainGame"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCampSp=null,e.mBg=null,e}return r(e,t),e.prototype.InitBossHPBar=function(e,o,n,r){t.prototype.Init.call(this,e,o,n),r===l.CampType.None?(this.mCampSp.node.opacity=0,this.mBg.opacity=0):(this.mBg.opacity=255,this.mCampSp.node.opacity=255,this.mCampSp.spriteFrame=s.default.mCampSFArr[r])},i([p(cc.Sprite)],e.prototype,"mCampSp",void 0),i([p(cc.Node)],e.prototype,"mBg",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","./HPBar":"HPBar"}],BuffBase:[function(t,e,o){"use strict";cc._RF.push(e,"a1ebalHIuBO/6Wibq1byC7P","BuffBase"),Object.defineProperty(o,"__esModule",{value:!0}),o.BuffType=void 0;var n,r=t("../../UI/Win/BattleWin"),i=t("../../Manager/ResMgr");(function(t){t[t.None=0]="None",t[t.Fire=1]="Fire",t[t.Poison=2]="Poison",t[t.Frsot=3]="Frsot",t[t.Vertigo=4]="Vertigo",t[t.Invincible=5]="Invincible",t[t.RecoverHP=6]="RecoverHP"})(n=o.BuffType||(o.BuffType={}));var a=function(){function t(){this.mTiming=0,this.mDuration=0,this.mIsUsing=!1,this.mCreator=null,this.mEntity=null,this.mInterval=0,this.mIntervalTiming=0,this.mSyncPosNode=null,this.mBuffEffNode=null,this.mBuffLv=0,this.m_Skeleton=null}return t.prototype.GetBuffType=function(){return n.None},t.prototype.GetBuffLv=function(){return this.mBuffLv},t.prototype.Init=function(t,e,o,n){this.mCreator=t,this.mEntity=e,this.mBuffLv=o,this._ParseParam(n)},t.prototype._ParseParam=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.Reset=function(){this.mTiming=0,this.mIntervalTiming=0},t.prototype.HasIconTag=function(){return!0},t.prototype.IsTriggerInstant=function(){return!1},t.prototype.EffectName=function(){return""},t.prototype.AnimName=function(){return"animation"},t.prototype.NeedSyncEntityPos=function(){return!1},t.prototype.SyncNode=function(t){this.mSyncPosNode=t},t.prototype.BuffLocalPos=function(){return cc.Vec2.ZERO},t.prototype.Trigger=function(){if(this.m_Skeleton=null,this.IsTriggerInstant()||(this.mIsUsing=!0),this.mTiming=0,this.mIntervalTiming=0,""!==this.EffectName()){var t=new cc.Node;this.mBuffEffNode=t,this.mEntity&&(this.NeedSyncEntityPos()?(t.setParent(r.default.BuffRoot),this.SyncNode(this.mEntity.BuffPosSyncNode)):(t.setParent(this.mEntity.node),t.setPosition(this.BuffLocalPos())));var e=t.addComponent(sp.Skeleton);this.m_Skeleton=e;var o=this;i.default.Ins.LoadSpine("spine/"+this.EffectName(),function(t){o&&null!==o.m_Skeleton&&(e.skeletonData=t,e.enableBatch=!0,e.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),e.setAnimation(0,o.AnimName(),!0),o.IsTriggerInstant()&&e.setCompleteListener(o._OnAnimCompleted.bind(o)))})}},t.prototype.OnUpdate=function(t){this.mIsUsing&&(this.NeedSyncEntityPos()&&null!==this.mSyncPosNode&&this.mSyncPosNode.isValid&&null!==this.mBuffEffNode&&this.mBuffEffNode.isValid&&(this.mBuffEffNode.position=cc.v3(this.mBuffEffNode.parent.convertToNodeSpaceAR(this.mSyncPosNode.convertToWorldSpaceAR(cc.Vec2.ZERO)))),this.mTiming+=t,0!==this.mInterval&&(this.mIntervalTiming+=t,this.mIntervalTiming>=this.mInterval&&(this.mIntervalTiming=0,this.OnTriggerIntervalEffect())),-1!==this.mDuration&&this.mTiming>=this.mDuration&&(this.mIsUsing=!1,this.mTiming=0,this.OnBuffEnd()))},t.prototype.OnTriggerIntervalEffect=function(){},t.prototype._OnAnimCompleted=function(){this.OnBuffEnd()},t.prototype.OnBuffEnd=function(){this.mEntity&&this.mEntity.RemoveBuff(this),this.OnDestroy()},t.prototype.OnDestroy=function(){null!==this.mBuffEffNode&&(this.m_Skeleton=null,this.mBuffEffNode.destroy())},t.prototype.EndBuff=function(){this.OnBuffEnd()},t}();o.default=a,cc._RF.pop()},{"../../Manager/ResMgr":"ResMgr","../../UI/Win/BattleWin":"BattleWin"}],BuffFactory:[function(t,e,o){"use strict";cc._RF.push(e,"d1e33yS48RHVZEXHtZ/Tw1u","BuffFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./BuffVertigo"),r=t("./BuffRecoverHP"),i=t("./BuffPoison"),a=t("./BuffFrost"),s=t("./BuffFire"),l=t("./BuffBase"),m=function(){function t(){}return t.Create=function(t){var e=null;switch(t){case l.BuffType.Fire:e=new s.default;break;case l.BuffType.Poison:e=new i.default;break;case l.BuffType.Vertigo:e=new n.default;break;case l.BuffType.Frsot:e=new a.default;break;case l.BuffType.RecoverHP:e=new r.default}return e},t}();o.default=m,cc._RF.pop()},{"./BuffBase":"BuffBase","./BuffFire":"BuffFire","./BuffFrost":"BuffFrost","./BuffPoison":"BuffPoison","./BuffRecoverHP":"BuffRecoverHP","./BuffVertigo":"BuffVertigo"}],BuffFire:[function(t,e,o){"use strict";cc._RF.push(e,"104a2p5O8xPl4TgUC/OmATf","BuffFire");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffBase"),a=t("../AI/EntityState"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Common/EnumsDefine"),m=function(t){function e(){var e=t.call(this)||this;return e.mDmgFactor=1,e.mSingleDmg=null,e}return r(e,t),e.prototype.GetBuffType=function(){return i.BuffType.Fire},e.prototype._ParseParam=function(t){this.mDmgFactor=Number(t[0]),this.mInterval=Number(t[1]),this.mDuration=Number(t[2]);var e=this.mCreator.mEntityAttr.mAttack;this.mSingleDmg=new s.LargeNumber(e.mBaseValue,e.mExpoValue),this.mSingleDmg.MultiplySelfSingle(this.mDmgFactor/(this.mDuration/this.mInterval))},e.prototype.Trigger=function(){t.prototype.Trigger.call(this)},e.prototype.EffectName=function(){return"zhuoshao"},e.prototype.AnimName=function(){return"animation"},e.prototype.OnTriggerIntervalEffect=function(){t.prototype.OnTriggerIntervalEffect.call(this),this.mEntity.GetCurStateType()!==a.EntityStateType.Dead&&this.mEntity.BeAttack(this.mCreator,this.mSingleDmg,l.AttackEffect.Normal,cc.Vec2.ZERO,!0)},e.prototype.OnBuffEnd=function(){t.prototype.OnBuffEnd.call(this)},e}(i.default);o.default=m,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../AI/EntityState":"EntityState","./BuffBase":"BuffBase"}],BuffFrost:[function(t,e,o){"use strict";cc._RF.push(e,"002c1M8A4VEJ5uDFVOr4MNz","BuffFrost");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffBase"),a=t("../AI/EntityState"),s=t("../../UI/Win/BattleWin"),l=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.GetBuffType=function(){return i.BuffType.Frsot},e.prototype._ParseParam=function(t){this.mDuration=Number(t[0])},e.prototype.Trigger=function(){t.prototype.Trigger.call(this),this.mEntity.ChangeState(a.EntityStateType.Frosted)},e.prototype.EffectName=function(){return"bingbuff"},e.prototype.AnimName=function(){return"xunhuan"},e.prototype.OnBuffEnd=function(){t.prototype.OnBuffEnd.call(this),this.mEntity.GetCurStateType()!==a.EntityStateType.Dead&&this.mEntity.ChangeState(a.EntityStateType.Idle)},e.prototype.OnDestroy=function(){if(this.m_Skeleton){var t=this.m_Skeleton.node.parent.convertToWorldSpaceAR(this.m_Skeleton.node.position);this.m_Skeleton.node.setParent(s.default.BuffRoot),this.m_Skeleton.node.setPosition(s.default.BuffRoot.convertToNodeSpaceAR(t)),this.m_Skeleton.setAnimation(0,"suilie",!1);var e=this;setTimeout(function(){e.mBuffEffNode.destroy(),e.m_Skeleton=null},1e3)}},e}(i.default);o.default=l,cc._RF.pop()},{"../../UI/Win/BattleWin":"BattleWin","../AI/EntityState":"EntityState","./BuffBase":"BuffBase"}],BuffPoison:[function(t,e,o){"use strict";cc._RF.push(e,"2ed69/++TdHt5cuuInzps7T","BuffPoison");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffBase"),a=t("../AI/EntityState"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Common/EnumsDefine"),m=function(t){function e(){var e=t.call(this)||this;return e.mDmgFactor=1,e.mSingleDmg=null,e}return r(e,t),e.prototype.GetBuffType=function(){return i.BuffType.Poison},e.prototype._ParseParam=function(t){this.mDmgFactor=Number(t[0]),this.mInterval=Number(t[1]),this.mDuration=Number(t[2]);var e=this.mCreator.mEntityAttr.mAttack;this.mSingleDmg=new s.LargeNumber(e.mBaseValue,e.mExpoValue),this.mSingleDmg.MultiplySelfSingle(this.mDmgFactor/(this.mDuration/this.mInterval))},e.prototype.Trigger=function(){t.prototype.Trigger.call(this)},e.prototype.EffectName=function(){return"zhongdu"},e.prototype.AnimName=function(){return"animation"},e.prototype.OnTriggerIntervalEffect=function(){t.prototype.OnTriggerIntervalEffect.call(this),this.mEntity.GetCurStateType()!==a.EntityStateType.Dead&&this.mEntity.BeAttack(this.mCreator,this.mSingleDmg,l.AttackEffect.Normal,cc.Vec2.ZERO,!0)},e.prototype.OnBuffEnd=function(){t.prototype.OnBuffEnd.call(this)},e}(i.default);o.default=m,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../AI/EntityState":"EntityState","./BuffBase":"BuffBase"}],BuffRecoverHP:[function(t,e,o){"use strict";cc._RF.push(e,"e42c8exXABNTIWCuEmhsoa3","BuffRecoverHP");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffBase"),a=t("../AI/EntityState"),s=t("../../Proxy/ProxyLargeNum"),l=function(t){function e(){var e=t.call(this)||this;return e.mHPFactor=1,e.mSingleHP=null,e}return r(e,t),e.prototype.GetBuffType=function(){return i.BuffType.RecoverHP},e.prototype.HasIconTag=function(){return!1},e.prototype._ParseParam=function(t){this.mHPFactor=Number(t[0]),this.mInterval=Number(t[1]),this.mDuration=Number(t[2]);var e=this.mCreator.mEntityAttr.mMaxHP;this.mSingleHP=new s.LargeNumber(e.mBaseValue,e.mExpoValue),this.mSingleHP.MultiplySelfSingle(this.mHPFactor/(this.mDuration/this.mInterval))},e.prototype.Trigger=function(){t.prototype.Trigger.call(this),this.mEntity.GetCurStateType()!==a.EntityStateType.Dead&&this.mEntity.AddHP(this.mCreator,this.mSingleHP)},e.prototype.IsTriggerInstant=function(){return!0},e.prototype.EffectName=function(){return"jiaxue"},e.prototype.AnimName=function(){return"animation"},e.prototype.OnTriggerIntervalEffect=function(){t.prototype.OnTriggerIntervalEffect.call(this)},e.prototype.OnBuffEnd=function(){t.prototype.OnBuffEnd.call(this)},e}(i.default);o.default=l,cc._RF.pop()},{"../../Proxy/ProxyLargeNum":"ProxyLargeNum","../AI/EntityState":"EntityState","./BuffBase":"BuffBase"}],BuffVertigo:[function(t,e,o){"use strict";cc._RF.push(e,"1a990GkCuZAW4VCtj1fBBuO","BuffVertigo");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./BuffBase"),a=t("../AI/EntityState"),s=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.GetBuffType=function(){return i.BuffType.Vertigo},e.prototype.BuffLocalPos=function(){return cc.v2(0,this.mEntity.node.height)},e.prototype._ParseParam=function(t){this.mDuration=Number(t[0])},e.prototype.Trigger=function(){t.prototype.Trigger.call(this),this.mEntity.ChangeState(a.EntityStateType.Vertigo)},e.prototype.EffectName=function(){return"xuanyun"},e.prototype.OnBuffEnd=function(){t.prototype.OnBuffEnd.call(this),this.mEntity.GetCurStateType()!==a.EntityStateType.Dead&&this.mEntity.ChangeState(a.EntityStateType.Idle)},e}(i.default);o.default=s,cc._RF.pop()},{"../AI/EntityState":"EntityState","./BuffBase":"BuffBase"}],BulletBase:[function(t,e,o){"use strict";cc._RF.push(e,"eed5dgp72VBlIPBwrYeBKst","BulletBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){var e=t.call(this)||this;return e.mSkillCompCtrl=null,e.mShooter=null,e.mSkillCompData=null,e.mAtkParam=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){this.node.active=!0},e.prototype.OnAfterBorrow=function(){},e.prototype.OnReturned=function(){this.node.active=!1},e.prototype.InitData=function(t,e){this.mSkillCompCtrl=t,this.mShooter=e,this.mSkillCompData=t.mSkillCompData,this.mAtkParam=this.mSkillCompData.atkParam},e.prototype.TriggerShoot=function(){},e.prototype.OnUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],BulletImtLine:[function(t,e,o){"use strict";cc._RF.push(e,"cca58CV2UpLfqU0DOehx7BO","BulletImtLine");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BulletLine"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return t.call(this)||this}return r(e,t),i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./BulletLine":"BulletLine"}],BulletLine:[function(t,e,o){"use strict";cc._RF.push(e,"ede5aMgyXVCgYiC00AjulH4","BulletLine");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BulletBase"),s=t("../../UI/Win/BattleWin"),l=t("../../Manager/PoolMgr"),m=t("../../Manager/FightMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=(c.property,function(t){function e(){var e=t.call(this)||this;return e.m_FlySpeed=0,e.mIsFlying=!1,e.mLifeTime=.7,e.mTimer=0,e.mCanHitCount=0,e.mHasHitCount=0,e.mHitIDsArr=[],e.mHitEffect="",e.mHitSound="",e.mConfigMaxCount=3,e}return r(e,t),e.prototype.InitData=function(e,o){t.prototype.InitData.call(this,e,o);var n=e.mSkillCompData.atkParam;if(this.m_FlySpeed=Number(n[1]),this.mHitEffect=n[2],this.mHitSound=n[3],n.length>=5&&(this.mLifeTime=n[4]),0===this.mHitIDsArr.length)for(var r=0;r<this.mConfigMaxCount;++r)this.mHitIDsArr.push(0);else for(r=0;r<this.mConfigMaxCount;++r)this.mHitIDsArr[r]=0},e.prototype.InitLineData=function(t,e){this.mMoveDir=t,this.mIsFlying=!1,this.mTimer=0,this.mCanHitCount=e,this.mHasHitCount=0,this.TriggerShoot()},e.prototype.TriggerShoot=function(){this.mIsFlying=!0,this.mTimer=0},e.prototype.OnUpdate=function(t){this.mIsFlying&&(this.node.position=this.node.position.add(cc.v3(this.mMoveDir.mul(this.m_FlySpeed*t))),this.mTimer+=t,this.CheckHitTarget(),(this.mTimer>=this.mLifeTime||this.mHasHitCount>=this.mCanHitCount)&&(this.mIsFlying=!1,m.default.mCurFightMode.RemoveBullet(this),l.default.Ins.Return(this)))},e.prototype.CheckHitTarget=function(){var t=this.mShooter.GetTargetArr();if(0!==t.length)for(var e=this.node.parent.convertToWorldSpaceAR(this.node.position),o=cc.v2(t[0].node.parent.convertToNodeSpaceAR(e)),n=function(e){var n=t[e];if(!n)return"continue";if(!r._CheckHasHitted(n)&&r.CheckIntersect(o,n.node)){r.mHasHitCount++,r._TagEntity(n);var i=n.WorldMiddlePosition;r.mShooter.AttackWithBullet(n,r.mSkillCompCtrl,i);var a=r;return l.default.Ins.Borrow(l.default.EFX_PATH_ROOT+r.mHitEffect,"EfxBase",function(t){var e=t;e.node.parent=s.default.EfxRoot,n.node&&n.node.isValid&&(e.node.position=s.default.EfxRoot.convertToNodeSpaceAR(cc.v3(i)),e.node.angle=-a.mMoveDir.signAngle(cc.Vec2.RIGHT_R)*p.default.m_Rad2Deg)}),r.mHitSound&&u.default.PlayFightSFX(r.mHitSound),{value:void 0}}},r=this,i=0,a=t.length;i<a;++i){var m=n(i);if("object"==typeof m)return m.value}},e.prototype.CheckIntersect=function(t,e){var o=e.position,n=.5*e.width,r=e.height;return o.x-n<=t.x&&t.x<=o.x+n&&o.y<=t.y&&t.y<=o.y+r},e.prototype._TagEntity=function(t){if(1!==this.mCanHitCount&&t)for(var e=0;e<this.mConfigMaxCount;++e)if(0===this.mHitIDsArr[e]){this.mHitIDsArr[e]=t.mInsID;break}},e.prototype._CheckHasHitted=function(t){if(1===this.mCanHitCount)return!1;for(var e=0;e<this.mConfigMaxCount;++e)if(this.mHitIDsArr[e]===t.mInsID)return!0;return!1},i([d],e)}(a.default));o.default=f,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/AudioMgr":"AudioMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../UI/Win/BattleWin":"BattleWin","./BulletBase":"BulletBase"}],BulletPorabolaArrow:[function(t,e,o){"use strict";cc._RF.push(e,"6b5e8GqFh5AKrpPCKIUyE5+","BulletPorabolaArrow");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BulletPorabolaBomb"),s=t("../../UI/Win/BattleWin"),l=t("../../Manager/PoolMgr"),m=t("../../Manager/FightMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=(d.property,function(t){function e(){var e=t.call(this)||this;return e.mGroundPosY=0,e.mIsHitGround=!1,e.mStartDisappear=!1,e.mIsDown=!1,e.mLastWorldPosY=-1e4,e}return r(e,t),e.prototype.OnBeforeBorrow=function(){t.prototype.OnBeforeBorrow.call(this),this.node.opacity=255},e.prototype.InitData=function(e,o){t.prototype.InitData.call(this,e,o)},e.prototype.InitParabolaData=function(e,o,n){t.prototype.InitParabolaData.call(this,e,o,n),this.mIsAir?this.mGroundPosY=this.mShooter.node.y:this.mGroundPosY=o.node.y},e.prototype.TriggerShoot=function(){this.m_IsFlying=!0,this.mTimer=0,this.mStartDisappear=!1,this.mIsHitGround=!1,this.mIsDown=!1,this.mLastWorldPosY=-1e4},e.prototype.OnUpdate=function(t){if(this.m_IsFlying){this.mTimer+=t;var e=this.mOriPos.x+this.mVx*this.mTimer,o=this.mOriPos.y+(this.mVy*this.mTimer+.5*this.mGravity*this.mTimer*this.mTimer),n=cc.v2(e,o),r=this.mCachedParent.convertToNodeSpaceAR(n);if(this.node.position=cc.v3(r),!this.mIsDown&&o<this.mLastWorldPosY&&(this.mIsDown=!0),this.mLastWorldPosY=o,this.node.y<this.mGroundPosY&&this.mIsDown&&(this.mIsHitGround=!0),this.mIsHitGround){if(!this.mStartDisappear){this.m_IsFlying=!1,this.mStartDisappear=!0,m.default.mCurFightMode.RemoveBullet(this);var i=this;cc.tween(this.node).delay(.5).to(.2,{opacity:0}).call(function(){l.default.Ins.Return(i)}).start()}}else if(this.CheckHitTarget())return this.m_IsFlying=!1,m.default.mCurFightMode.RemoveBullet(this),l.default.Ins.Return(this),""!==this.m_HitEffect&&l.default.Ins.Borrow("prefab/efx/"+this.m_HitEffect,"EfxBase",function(t){t&&(t.node.parent=s.default.EfxRoot,t.node.position=s.default.EfxRoot.convertToNodeSpaceAR(n))}),void(this.m_HitSound&&u.default.PlayFightSFX(this.m_HitSound));if(this.mNeedRotate){var a=n.sub(this.mLastPos).angle(cc.Vec2.UP_R)*c.default.m_Rad2Deg;this.mCurLookDir===p.LookDir.Right?this.node.angle=-a:this.node.angle=a,this.mLastPos=n}}},i([f],e)}(a.default));o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../UI/Win/BattleWin":"BattleWin","./BulletPorabolaBomb":"BulletPorabolaBomb"}],BulletPorabolaBomb:[function(t,e,o){"use strict";cc._RF.push(e,"20d5e4YcJJOgobHHWJFFFH5","BulletPorabolaBomb");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./BulletBase"),s=t("../../UI/Win/BattleWin"),l=t("../../Manager/PoolMgr"),m=t("../../Manager/FightMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNeedRotate=!1,e.mIsAir=!1,e.m_IsFlying=!1,e.mLastPos=cc.Vec2.ZERO,e.m_HitEffect="",e.m_HitSound="",e.mAirEffect="",e.mCachedParent=null,e.mGravity=-2200,e.mTime=0,e.mTimer=0,e.mVx=0,e.mVy=0,e.mTargetPos=cc.Vec2.ZERO,e.mOriPos=cc.Vec2.ZERO,e.mShooterLandPosY=0,e.mCurLookDir=p.LookDir.Right,e.mBombRangeX=0,e.mBombRangeY=0,e}return r(e,t),e.prototype.InitData=function(e,o){t.prototype.InitData.call(this,e,o),this.mShooterLandPosY=o.node.y,this.mBombRangeX=Number(this.mAtkParam[2]),this.mBombRangeY=Number(this.mAtkParam[3]),this.m_HitEffect=this.mAtkParam[1],this.mAirEffect=this.mAtkParam[4],this.m_HitSound=this.mAtkParam[5]},e.prototype.InitParabolaData=function(t,e,o){this.mCurLookDir=o,this.mCachedParent=this.node.parent,this.mIsAir=e.mArmType===p.ArmType.Air,this.mOriPos=t,this.mTargetPos=cc.v2(e.WorldPosition);var n=this.mSkillCompCtrl.m_SkillCtrl.mEntity.mAttackDist,r=this.mTargetPos.x-this.mOriPos.x,i=c.default.Clamp(Math.abs(r/n),.3,1),a=c.default.GetRandValueBetween(150,170)*i;a<this.mTargetPos.y-t.y?a=this.mTargetPos.y-t.y:a+=c.default.GetRandValueBetween(0,50);var s=a-this.mTargetPos.y+this.mOriPos.y,l=Math.sqrt(-2*a/this.mGravity),m=Math.sqrt(-2*s/this.mGravity);this.mTime=l+m,this.mVx=r/this.mTime,this.mVy=-this.mGravity*l,this.mLastPos=t,this.TriggerShoot()},e.prototype.TriggerShoot=function(){this.m_IsFlying=!0,this.mTimer=0},e.prototype.OnUpdate=function(t){if(this.m_IsFlying){this.mTimer+=t;var e=!1;!this.mIsAir&&this.mTimer>this.mTime&&(this.mTimer=this.mTime,e=!0);var o=this.mOriPos.x+this.mVx*this.mTimer,n=this.mOriPos.y+(this.mVy*this.mTimer+.5*this.mGravity*this.mTimer*this.mTimer),r=cc.v2(o,n),i=this.mCachedParent.convertToNodeSpaceAR(r);if(this.node.position=cc.v3(i),this.mIsAir){if(this.CheckHitTarget())return this.m_IsFlying=!1,m.default.mCurFightMode.RemoveBullet(this),l.default.Ins.Return(this),l.default.Ins.Borrow("prefab/efx/"+this.mAirEffect,"EfxBase",function(t){t&&(t.node.parent=s.default.EfxRoot,t.node.position=s.default.EfxRoot.convertToNodeSpaceAR(r))}),this.m_HitSound&&u.default.PlayFightSFX(this.m_HitSound),void(this.m_IsFlying=!1);this.node.y<=this.mShooterLandPosY&&(e=!0)}if(this.mNeedRotate){var a=r.sub(this.mLastPos).angle(cc.Vec2.UP_R)*c.default.m_Rad2Deg;this.mCurLookDir===p.LookDir.Right?this.node.angle=-a:this.node.angle=a,this.mLastPos=r}if(e){this.m_IsFlying=!1,m.default.mCurFightMode.RemoveBullet(this),l.default.Ins.Return(this);for(var d=this.mShooter.GetTargetArr(),f=this.mBombRangeX,h=this.mBombRangeY,y=0,g=d.length;y<g;++y){var I=d[y];void 0!==I&&Math.abs(I.node.x-this.node.x)<=f&&Math.abs(I.node.y-this.node.y)<=h&&this.mShooter.AttackWithBullet(I,this.mSkillCompCtrl,I.WorldMiddlePosition)}l.default.Ins.Borrow("prefab/efx/"+this.m_HitEffect,"EfxBase",function(t){t&&(t.node.parent=s.default.EfxRoot,t.node.position=s.default.EfxRoot.convertToNodeSpaceAR(r))}),this.m_HitSound&&u.default.PlayFightSFX(this.m_HitSound)}}},e.prototype.CheckHitTarget=function(){var t=this.mShooter.GetTargetArr();if(0!==t.length)for(var e=this.node.parent.convertToWorldSpaceAR(this.node.position),o=cc.v2(t[0].node.parent.convertToNodeSpaceAR(e)),n=0,r=t.length;n<r;++n){var i=t[n];if(i&&this.CheckIntersect(o,i.node))return this.mShooter.AttackWithBullet(i,this.mSkillCompCtrl,i.WorldMiddlePosition),!0}return!1},e.prototype.CheckIntersect=function(t,e){var o=e.position,n=.5*e.width,r=e.height;return o.x-n<=t.x&&t.x<=o.x+n&&o.y<=t.y&&t.y<=o.y+r},i([h(cc.Boolean)],e.prototype,"mNeedRotate",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../UI/Win/BattleWin":"BattleWin","./BulletBase":"BulletBase"}],BuyItemWin:[function(t,e,o){"use strict";cc._RF.push(e,"379894TcUdH/4pTFDUo1CJ9","BuyItemWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/WinMgr"),l=t("../../Manager/UserMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=t("../../Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mQualitySp=null,e.mSPTag=null,e.mNameLbl=null,e.mOwnNumLbl=null,e.mBuyNumLbl=null,e.mCostLbl=null,e.mCurLimitBuyNumLbl=null,e.mBuyItemID=0,e.mUnitCost=0,e.mCurBuyNum=0,e.mLimitNum=-1,e.mFromWinType=c.WinType.None,e.mBuyCompleteCallback=null,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),p.default.PlaySFX(c.AudioName.UI_TanKuang,!0)},e.prototype.SetData=function(t,e,o,n){void 0===e&&(e=null),void 0===o&&(o=-1),void 0===n&&(n=c.WinType.None),this.mFromWinType=n,this.mBuyItemID=t,this.mBuyCompleteCallback=e,this.mLimitNum=o;var r=u.default.Ins.m_DB.itemDB[t];m.default.Ins.LoadItemSprite(t,this.mIcon,null),m.default.Ins.LoadItemQualitySprite(r.quality,this.mQualitySp,null),this.mOwnNumLbl.string=""+l.default.Ins.GetItemNum(t),this.mUnitCost=r.goldPrice,this.mSPTag.active=r.quality==c.ItemQuality.SP,this.mNameLbl.string=r.name,this.mNameLbl.node.color=d.default.GetQualityColor(r.quality),this.mCurBuyNum=1,this._CheckCostLimit(),-1===this.mLimitNum?this.mCurLimitBuyNumLbl.string="":this.mCurLimitBuyNumLbl.string="\uff08\u5f53\u524d\u9650\u8d2d\uff1a"+this.mLimitNum+"\uff09"},e.prototype._CheckCostLimit=function(){var t=l.default.Ins.GetItemNum(c.ItemType.Gold);t<this.mUnitCost*this.mCurBuyNum&&(this.mCurBuyNum=Math.floor(t/this.mUnitCost)),-1!==this.mLimitNum&&this.mCurBuyNum>this.mLimitNum&&(this.mCurBuyNum=this.mLimitNum),this.mBuyNumLbl.string=""+this.mCurBuyNum,this.mCostLbl.string=""+this.mCurBuyNum*this.mUnitCost},e.prototype.Invoke_MinusOne=function(){p.default.PlayBtnSound(),this.mCurBuyNum--,this.mCurBuyNum<0&&(this.mCurBuyNum=0),this._CheckCostLimit()},e.prototype.Invoke_AddOne=function(){p.default.PlayBtnSound(),this.mCurBuyNum++,this._CheckCostLimit()},e.prototype.Invoke_MinusMultiple=function(){p.default.PlayBtnSound(),this.mCurBuyNum-=10,this.mCurBuyNum<0&&(this.mCurBuyNum=0),this._CheckCostLimit()},e.prototype.Invoke_AddMultiple=function(){p.default.PlayBtnSound(),this.mCurBuyNum+=10,this._CheckCostLimit()},e.prototype.Invoke_Max=function(){p.default.PlayBtnSound();var t=l.default.Ins.GetItemNum(c.ItemType.Gold);this.mCurBuyNum=Math.floor(t/this.mUnitCost),-1!==this.mLimitNum&&this.mCurBuyNum>this.mLimitNum&&(this.mCurBuyNum=this.mLimitNum),this.mBuyNumLbl.string=""+this.mCurBuyNum,this.mCostLbl.string=""+this.mCurBuyNum*this.mUnitCost},e.prototype.Invoke_Cancel=function(){p.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Buy=function(){if(p.default.PlayBtnSound(),0!==this.mCurBuyNum){var t=this.mCurBuyNum*this.mUnitCost;if(l.default.Ins.GetItemNum(c.ItemType.Gold)<t)console.error("\u5143\u5b9d\u4e0d\u8db3\uff0c\u8bf7\u68c0\u67e5\u903b\u8f91\u9519\u8bef");else{l.default.Ins.UpdateItem(c.ItemType.Gold,-t),l.default.Ins.UpdateItem(this.mBuyItemID,this.mCurBuyNum);var e=this;s.default.Ins.Open(c.WinType.GetRewardsWin,function(t){t.SetDataSingle(e.mBuyItemID,e.mCurBuyNum+"")}),this.CloseWin(),null!==this.mBuyCompleteCallback&&(this.mBuyCompleteCallback(this.mCurBuyNum),this.mBuyCompleteCallback=null)}}else this.CloseWin()},i([y(cc.Sprite)],e.prototype,"mIcon",void 0),i([y(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([y(cc.Node)],e.prototype,"mSPTag",void 0),i([y(cc.Label)],e.prototype,"mNameLbl",void 0),i([y(cc.Label)],e.prototype,"mOwnNumLbl",void 0),i([y(cc.Label)],e.prototype,"mBuyNumLbl",void 0),i([y(cc.Label)],e.prototype,"mCostLbl",void 0),i([y(cc.Label)],e.prototype,"mCurLimitBuyNumLbl",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","./WinBase":"WinBase"}],CDBtn:[function(t,e,o){"use strict";cc._RF.push(e,"67c29roju5LbZ6IQ9eodiGZ","CDBtn");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyCDBtn"),s=t("../../MainGame"),l=t("../../Common/Common"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mClickWait=5,e.mOKWait=0,e.mDefaultPanel=null,e.mCDPanel=null,e.mCDLbl=null,e.mBtnBg=null,e.mCurTiming=0,e.mIsCDing=!1,e}return r(e,t),e.prototype.IsCDing=function(){return this.mIsCDing},e.prototype.StartClickCD=function(){this.mCurTiming=this.mClickWait,this.mIsCDing=!0,a.default.Ins.AddBtn(this),this.UpdateUI()},e.prototype.StartOKCD=function(){this.mIsCDing?this.mOKWait>this.mClickWait&&(this.mCurTiming=this.mOKWait):this.mOKWait>0&&(this.mCurTiming=this.mOKWait,this.mIsCDing=!0,a.default.Ins.AddBtn(this)),this.UpdateUI()},e.prototype.EndCD=function(){this.mCurTiming=0,this.mIsCDing=!1,a.default.Ins.RemoveBtn(this),this.UpdateUI()},e.prototype.UpdateUI=function(){this.mIsCDing?(this.mCDPanel.active=!0,this.mDefaultPanel.active=!1,this.mCDLbl.string=l.default.FormatTimeWithSeconds(this.mCurTiming),null!==this.mBtnBg&&this.mBtnBg.setMaterial(0,s.default.mGrayMat)):(this.mCDPanel.active=!1,this.mDefaultPanel.active=!0,null!==this.mBtnBg&&this.mBtnBg.setMaterial(0,s.default.mDefaultMat))},e.prototype.OnUpdateTime=function(){this.mIsCDing&&(this.mCurTiming--,this.mCurTiming<=0?this.EndCD():this.mCDLbl.string=l.default.FormatTimeWithSeconds(this.mCurTiming))},i([p(cc.Integer)],e.prototype,"mClickWait",void 0),i([p(cc.Integer)],e.prototype,"mOKWait",void 0),i([p(cc.Node)],e.prototype,"mDefaultPanel",void 0),i([p(cc.Node)],e.prototype,"mCDPanel",void 0),i([p(cc.Label)],e.prototype,"mCDLbl",void 0),i([p(cc.Sprite)],e.prototype,"mBtnBg",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Common/Common":"Common","../../MainGame":"MainGame","../../Proxy/ProxyCDBtn":"ProxyCDBtn"}],CampBtn:[function(t,e,o){"use strict";cc._RF.push(e,"cd6c8/XLZxMWLL1o25S1nbh","CampBtn");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/UserMgr"),s=t("../../MainGame"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPriceRoot=null,e.mTimeRoot=null,e.mCostGoldLbl=null,e.mTimeLbl=null,e.mSp=null,e.mCurCamp=l.CampType.Wei,e.mOwnerWin=null,e.mIsActived=!1,e}return r(e,t),e.prototype.Init=function(t,e){this.mCurCamp=t,this.mOwnerWin=e,this.UpdateState()},e.prototype.UpdateState=function(){var t=a.default.Ins.ClientInfo.lottery;this.mIsActived=1===t.curLotteryCampStateArr[this.mCurCamp],this.mIsActived?(this.mSp.setMaterial(0,s.default.mDefaultMat),this.mTimeRoot.active=!0,this.mPriceRoot.active=!1):(this.mSp.setMaterial(0,s.default.mGrayMat),this.mTimeRoot.active=!1,this.mPriceRoot.active=!0),this.mCurCamp===t.curLotteryCamp?(this.mOwnerWin.mCurSelectedFrame.parent=this.mSp.node,this.mOwnerWin.mCurSelectedFrame.position=cc.v3(0,-40),this.node.y=30,this.mSp.node.height=600):(this.node.y=70,this.mSp.node.height=528)},e.prototype.UpdateTime=function(t){this.mTimeLbl.string=t},i([p(cc.Node)],e.prototype,"mPriceRoot",void 0),i([p(cc.Node)],e.prototype,"mTimeRoot",void 0),i([p(cc.Label)],e.prototype,"mCostGoldLbl",void 0),i([p(cc.Label)],e.prototype,"mTimeLbl",void 0),i([p(cc.Sprite)],e.prototype,"mSp",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/UserMgr":"UserMgr"}],CampLottery:[function(t,e,o){"use strict";cc._RF.push(e,"fa919cmwlFMWI4Z4NUeEtQE","CampLottery");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./CDBtn"),s=t("../../Proxy/ProxyLottery"),l=t("../../Proxy/ProxyHero"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/RedPointMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSk=null,e.mFirstTenHint=null,e.mSSRTimesLbl=null,e.mTicketNumLbl=null,e.mFreeTimesLbl=null,e.mDrawTimesLbl=null,e.mNormalBtnNode=null,e.mBuyBtnNode=null,e.mCostGoldLbl=null,e.mCDBtn=null,e.mTiming=2,e.mEnable=!0,e}return r(e,t),e.prototype.OnOpen=function(){this.mDrawTimesLbl.string=p.default.Ins.GetItemNum(y.ItemType.CampTicket)+"",this._UpadteHintUI();var t=d.default.Ins.m_DB.itemDB[y.ItemType.CampTicket];this.mCostGoldLbl.string=t.goldPrice,this.mFreeTimesLbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+p.default.Ins.ClientInfo.lottery.campADFreeTimes,this.mCDBtn.UpdateUI()},e.prototype.Subscribe=function(){f.default.Subscribe(y.BCType.Lottery_GetHero,this._OnMsg_OnLotteryCompleted,this),f.default.Subscribe(y.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshNewDay,this),f.default.Subscribe(c.RedPointType.MainLotteryBox_Ticket,this._OnMsg_UpdateDrawTimes,this)},e.prototype.Remove=function(){f.default.Remove(y.BCType.Lottery_GetHero,this._OnMsg_OnLotteryCompleted,this),f.default.Remove(y.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshNewDay,this),f.default.Remove(c.RedPointType.MainLotteryBox_Ticket,this._OnMsg_UpdateDrawTimes,this)},e.prototype.update=function(t){this.mEnable&&(this.mTiming-=t,this.mTiming<=0&&(this.mTiming=g.default.GetRandValueBetween(5,8),this._PlayAnim()))},e.prototype._PlayAnim=function(){this.mSk.setAnimation(0,"daiji_"+g.default.GetRandIntValueBetween(1,4,!0),!1)},e.prototype._UpadteHintUI=function(){var t=p.default.Ins.ClientInfo.lottery;this.mFirstTenHint.opacity=0,this.mSSRTimesLbl.node.parent.opacity=255,this.mSSRTimesLbl.string=""+t.campSSRWaterLevel,this.mTicketNumLbl.string=p.default.Ins.GetItemNum(y.ItemType.CampTicket)+"",this._IsTenDraw()||(p.default.Ins.GetItemNum(y.ItemType.CampTicket)>0?(this.mNormalBtnNode.active=!0,this.mBuyBtnNode.active=!1):(this.mBuyBtnNode.active=!0,this.mNormalBtnNode.active=!1))},e.prototype._IsTenDraw=function(){return!1},e.prototype._OnMsg_OnLotteryCompleted=function(){this._UpadteHintUI()},e.prototype._OnMsg_UpdateDrawTimes=function(){var t=p.default.Ins.GetItemNum(y.ItemType.CampTicket)+"";this.mDrawTimesLbl.string=t,this.mTicketNumLbl.string=t},e.prototype._OnMsg_RefreshNewDay=function(){this.mFreeTimesLbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+p.default.Ins.ClientInfo.lottery.campADFreeTimes},e.prototype.Invoke_Instruction=function(){h.default.PlayBtnSound(),u.default.Ins.Open(y.WinType.LotteryCampInstructionWin,null)},e.prototype.Invoke_AD=function(){h.default.PlayBtnSound(),this.mCDBtn.IsCDing()||(p.default.Ins.ClientInfo.lottery.campADFreeTimes<=0?u.default.Ins.ShowTips("\u4eca\u65e5\u514d\u8d39\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u4e3b\u516c\u660e\u5929\u518d\u6765\u54e6~"):(this.mCDBtn.StartClickCD(),g.default.WatchADForRewards(this._ADCallback.bind(this),m.ADUnitID.CommonVideoID_30,y.ADPoint.FreeLottery)))},e.prototype._ADCallback=function(t){t&&(p.default.Ins.GetADExtraRewards(),this.mCDBtn.StartOKCD()),s.default.Ins.ADLottery();var e=s.default.Ins.CampLottery(1),o=l.default.Ins.GetHero(e);u.default.Ins.Open(y.WinType.LotteryOpenWin,function(t){t.SetData(y.LotteryType.Camp,e,o)}),this.mFreeTimesLbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+p.default.Ins.ClientInfo.lottery.campADFreeTimes},e.prototype.Invoke_Buy=function(){h.default.PlayBtnSound();var t=d.default.Ins.m_DB.itemDB[y.ItemType.CampTicket];if(p.default.Ins.GetItemNum(y.ItemType.Gold)<t.goldPrice)u.default.Ins.ShowTips("\u5143\u5b9d\u4e0d\u8db3~");else{var e=this;u.default.Ins.Open(y.WinType.BuyItemWin,function(t){t.SetData(y.ItemType.CampTicket,function(){e._UpadteHintUI()},-1,y.WinType.LotteryWin)})}},e.prototype.Invoke_One=function(){h.default.PlayBtnSound();var t=1;if(this._IsTenDraw()&&(t=10),p.default.Ins.GetItemNum(y.ItemType.CampTicket)<t)u.default.Ins.Open(y.WinType.BuyItemWin,function(t){t.SetData(y.ItemType.CampTicket,null,-1,y.WinType.LotteryWin)});else{p.default.Ins.UpdateItem(y.ItemType.CampTicket,-t);var e=s.default.Ins.CampLottery(t),o=l.default.Ins.GetHero(e);u.default.Ins.Open(y.WinType.LotteryOpenWin,function(t){t.SetData(y.LotteryType.Camp,e,o)})}},i([_(sp.Skeleton)],e.prototype,"mSk",void 0),i([_(cc.Node)],e.prototype,"mFirstTenHint",void 0),i([_(cc.Label)],e.prototype,"mSSRTimesLbl",void 0),i([_(cc.Label)],e.prototype,"mTicketNumLbl",void 0),i([_(cc.Label)],e.prototype,"mFreeTimesLbl",void 0),i([_(cc.Label)],e.prototype,"mDrawTimesLbl",void 0),i([_(cc.Node)],e.prototype,"mNormalBtnNode",void 0),i([_(cc.Node)],e.prototype,"mBuyBtnNode",void 0),i([_(cc.Label)],e.prototype,"mCostGoldLbl",void 0),i([_(a.default)],e.prototype,"mCDBtn",void 0),i([S],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/RedPointMgr":"RedPointMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery","./CDBtn":"CDBtn"}],CampSelectWin:[function(t,e,o){"use strict";cc._RF.push(e,"7ed92EL9UZKOLGmScHGNbLP","CampSelectWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/CampBtn"),l=t("../../Proxy/ProxyLottery"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCurSelectedFrame=null,e.mCampBtnArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=0,o=this.mCampBtnArr.length;e<o;++e)this.mCampBtnArr[e].Init(e,this)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),p.default.Subscribe(d.BCType.CampUnlockWin_UpdateCamp,this._OnMsg_UpdateCamp,this),p.default.Subscribe(d.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),p.default.Remove(d.BCType.CampUnlockWin_UpdateCamp,this._OnMsg_UpdateCamp,this),p.default.Remove(d.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this)},e.prototype._OnMsg_UpdateCamp=function(){for(var t=0,e=this.mCampBtnArr.length;t<e;++t)this.mCampBtnArr[t].UpdateState()},e.prototype._OnMsg_UpdateTime=function(){for(var t=f.default.FormatTimeWithSeconds(l.default.Ins.mCampLeftUpdateTime),e=0,o=this.mCampBtnArr.length;e<o;++e)this.mCampBtnArr[e].UpdateTime(t)},e.prototype.Invoke_ClickCamp=function(t,e){c.default.PlayBtnSound();var o=parseInt(e);1===u.default.Ins.ClientInfo.lottery.curLotteryCampStateArr[o]?l.default.Ins.ActiveLotteryCamp(o):m.default.Ins.Open(d.WinType.CampUnlockWin,function(t){t.SetData(o)})},e.prototype.Invoke_Back=function(){c.default.PlayBtnSound(),this.CloseWin()},i([g(cc.Node)],e.prototype,"mCurSelectedFrame",void 0),i([g([s.default])],e.prototype,"mCampBtnArr",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLottery":"ProxyLottery","../Comp/CampBtn":"CampBtn","./WinBase":"WinBase"}],CampUnlockWin:[function(t,e,o){"use strict";cc._RF.push(e,"b13abDFDnxMHbFmYx4MhR8o","CampUnlockWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLottery"),l=t("../../Manager/UserMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNeedGoldLbl=null,e.mOwnGoldLbl=null,e.mUnlockCampDescLbl=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mNeedGoldLbl.string=""+s.default.Ins.mUnlockCampGold,this.mOwnGoldLbl.string=""+l.default.Ins.GetItemNum(u.ItemType.Gold)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),m.default.PlaySFX(u.AudioName.UI_TanKuang,!0)},e.prototype.SetData=function(t){this.mCurCamp=t;var e="";switch(t){case u.CampType.Wei:e="\u89e3\u9501\u9b4f\u56fd\u9635\u8425\u5361\u6c60";break;case u.CampType.Shu:e="\u89e3\u9501\u8700\u56fd\u9635\u8425\u5361\u6c60";break;case u.CampType.Wu:e="\u89e3\u9501\u5434\u56fd\u9635\u8425\u5361\u6c60";break;case u.CampType.Qun:e="\u89e3\u9501\u7fa4\u96c4\u9635\u8425\u5361\u6c60"}this.mUnlockCampDescLbl.string=e},e.prototype.Invoke_Close=function(){m.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Confirm=function(){m.default.PlayBtnSound(),this.CloseWin()},i([d(cc.Label)],e.prototype,"mNeedGoldLbl",void 0),i([d(cc.Label)],e.prototype,"mOwnGoldLbl",void 0),i([d(cc.Label)],e.prototype,"mUnlockCampDescLbl",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyLottery":"ProxyLottery","./WinBase":"WinBase"}],ChallengeWin:[function(t,e,o){"use strict";cc._RF.push(e,"f226ddZdONHfqtTyMHT2xp+","ChallengeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/WinMgr"),l=t("../../Manager/UserMgr"),m=t("../../Manager/PlatformMgr"),u=t("../../Manager/FuncMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mExploreLockRoot=null,e.mExploreLevelLbl=null,e}return r(e,t),e.prototype._OnClose=function(){t.prototype._OnClose.call(this),s.default.Ins.Close(d.WinType.ImtBossWin),s.default.Ins.Close(d.WinType.ExploreWin)},e.prototype._OnFirstOpen=function(){this.mExploreLevelLbl.string=""+u.default.GetUnlockLevel(u.FuncType.Explore),l.default.Ins.ClientInfo.hasOpenedChallengeWin||(l.default.Ins.ClientInfo.hasOpenedChallengeWin=!0,l.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(d.HuoShanEventType.Challenge_Open))},e.prototype._OnOpen=function(){u.default.IsUnlock(u.FuncType.Explore)?this.mExploreLockRoot.active=!1:this.mExploreLockRoot.active=!0},e.prototype.Invoke_Boss=function(){c.default.PlayBtnSound();var t=this;s.default.Ins.Open(d.WinType.ImtBossWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO,p.default.Dispatch(d.BCType.MainWin_ChangeCoinType,d.CoinType.ForgeMat)},!0)},e.prototype.Invoke_Explore=function(){if(c.default.PlayBtnSound(),u.default.IsUnlock(u.FuncType.Explore)){var t=this;s.default.Ins.Open(d.WinType.ExploreWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO},!0)}},i([y(cc.Node)],e.prototype,"mExploreLockRoot",void 0),i([y(cc.Label)],e.prototype,"mExploreLevelLbl",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","./WinBase":"WinBase"}],ComicAnimEvent:[function(t,e,o){"use strict";cc._RF.push(e,"f9d1fyw/QtHgahA1a5m0QAW","ComicAnimEvent");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/BCMgr"),s=t("../../Common/EnumsDefine"),l=cc._decorator,m=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.OnAnimEvent=function(){a.default.Dispatch(s.BCType.ComicCompleted)},i([m],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr"}],ComicPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5edb6ewDIxJ6rroy5AzYjEk","ComicPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PlatformMgr"),s=t("../../Manager/BCMgr"),l=t("../../Manager/AudioMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnim=null,e.mCancelLbl=null,e.mOkLbl=null,e.mCancelNode=null,e.mOKNode=null,e.mCurClickTimes=0,e}return r(e,t),e.prototype.Invoke_ClickCancel=function(){l.default.PlayBtnSound(),this.mCurClickTimes++,1===this.mCurClickTimes?(this.mCancelNode.scale=.75,this.mCancelNode.position=cc.v3(-80,-460),this.mCancelLbl.node.position=cc.v3(-80,-400),this.mCancelLbl.string="(\u6211\u95ea)",a.default.ReportEvent(m.BIPoint.Guide_LastComicBtn,{btnID:"1",clickCount:"1"})):2===this.mCurClickTimes?(this.mCancelNode.scale=.5,this.mCancelNode.position=cc.v3(-175,-380),this.mCancelLbl.node.position=cc.v3(-175,-331),this.mCancelLbl.string="(\u6211\u518d\u95ea)",a.default.ReportEvent(m.BIPoint.Guide_LastComicBtn,{btnID:"1",clickCount:"2"})):3===this.mCurClickTimes&&(this.mCancelNode.active=!1,this.mCancelLbl.string="",this.mOKNode.position=cc.v3(0,-412.5),this.mOkLbl.node.position=cc.v3(0,-340),this.mOkLbl.string="(\u82f1\u96c4\uff01\u53ea\u8981\u4f60\u6765\u6551\u6211\u4eec\uff0c\u6211\u5c31\u628a\u5b9d\u8d1d\u59b9\u59b9\u5b59\u5c1a\u9999\u4ecb\u7ecd\u7ed9\u4f60\uff01)",a.default.ReportEvent(m.BIPoint.Guide_LastComicBtn,{btnID:"1",clickCount:"3"}))},e.prototype.Invoke_ClickOK=function(){l.default.PlayBtnSound(),s.default.Dispatch(m.BCType.ComicAllCompleted),a.default.ReportEvent(m.BIPoint.Guide_LastComicBtn,{btnID:"2"})},i([c(cc.Animation)],e.prototype,"mAnim",void 0),i([c(cc.Label)],e.prototype,"mCancelLbl",void 0),i([c(cc.Label)],e.prototype,"mOkLbl",void 0),i([c(cc.Node)],e.prototype,"mCancelNode",void 0),i([c(cc.Node)],e.prototype,"mOKNode",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/PlatformMgr":"PlatformMgr"}],ComicWin:[function(t,e,o){"use strict";cc._RF.push(e,"33b9bOylplG/a6OL4WNz3oL","ComicWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ComicPanel"),l=t("../../Manager/UserMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/PoolMgr"),p=t("../../Manager/PlatformMgr"),c=t("../../Manager/BCMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mComicRoot=null,e.mContinueRoot=null,e.mCurComicID=1,e.mTotalComicID=4,e.mEndCallback=null,e.mComicPathRoot="prefab/comic/",e.mCurAnimPanel=null,e.mNextAnimPanel=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){var t=this;this.mContinueRoot.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickContinue,this),this.mContinueRoot.active=!1;var e=this;m.default.Ins.LoadPrefab(this.mComicPathRoot+""+this.mCurComicID,function(o){var n=cc.instantiate(o).getComponent(s.default);n.node.parent=e.mComicRoot,n.node.position=cc.Vec3.ZERO,n.mAnim.play(),e.mCurAnimPanel=n,p.default.ReportEvent(d.BIPoint.Guide_Comic1Show),m.default.Ins.LoadPrefab("prefab/win/MainWin",null,null),m.default.Ins.LoadPrefab(t.mComicPathRoot+""+(e.mCurComicID+1),function(t){var o=cc.instantiate(t).getComponent(s.default);o.node.parent=e.mComicRoot,o.node.position=cc.Vec3.ZERO,e.mNextAnimPanel=o,o.node.active=!1})}),p.default.ReportEvent(d.BIPoint.Guide_ComicShow)},e.prototype.SetData=function(t){this.mEndCallback=t},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(d.BCType.ComicCompleted,this._OnMsg_ComicCompleted,this),c.default.Subscribe(d.BCType.ComicAllCompleted,this._OnMsg_ComicOK,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(d.BCType.ComicCompleted,this._OnMsg_ComicCompleted,this),c.default.Remove(d.BCType.ComicAllCompleted,this._OnMsg_ComicOK,this)},e.prototype._OnEvent_ClickContinue=function(){if(this.mCurComicID<this.mTotalComicID&&null!==this.mNextAnimPanel&&(this.mContinueRoot.active=!1,this.mCurAnimPanel.node.active=!1,this.mCurAnimPanel.destroy(),this.mCurAnimPanel=this.mNextAnimPanel,this.mCurAnimPanel.node.active=!0,this.mCurAnimPanel.mAnim.play(),this.mCurComicID++,2===this.mCurComicID?p.default.ReportEvent(d.BIPoint.Guide_Comic2Show):3===this.mCurComicID?(p.default.ReportEvent(d.BIPoint.Guide_Comic3Show),m.default.Ins.LoadPrefab(u.default.HERO_PATH_ROOT+"sunshangxiang",function(){},null)):4===this.mCurComicID&&(m.default.Ins.LoadPrefab(u.default.ENEMY_PATH_ROOT+"zhangjiao",function(){},null),p.default.ReportEvent(d.BIPoint.Guide_Comic4Show),cc.resources.preload(["prefab/win/BattleWin"],cc.Prefab,null,function(t){t&&console.error(t)})),this.mCurComicID<this.mTotalComicID)){var t=this;m.default.Ins.LoadPrefab(this.mComicPathRoot+""+(this.mCurComicID+1),function(e){var o=cc.instantiate(e).getComponent(s.default);o.node.parent=t.mComicRoot,o.node.position=cc.Vec3.ZERO,t.mNextAnimPanel=o,o.node.active=!1})}},e.prototype._OnMsg_ComicCompleted=function(){switch(this.mContinueRoot.active=!0,this.mCurComicID){case 1:p.default.ReportEvent(d.BIPoint.Guide_Comic1Complete);break;case 2:p.default.ReportEvent(d.BIPoint.Guide_Comic2Complete);break;case 3:p.default.ReportEvent(d.BIPoint.Guide_Comic3Complete)}},e.prototype._OnMsg_ComicOK=function(){this.mEndCallback(),l.default.Ins.ClientInfo.hasLookComic=!0,l.default.Ins.Save()},i([y(cc.Node)],e.prototype,"mComicRoot",void 0),i([y(cc.Node)],e.prototype,"mContinueRoot",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../Comp/ComicPanel":"ComicPanel","./WinBase":"WinBase"}],CommonActivity:[function(t,e,o){"use strict";cc._RF.push(e,"3dfddUrXtZLMqe5bJKB4xWU","CommonActivity");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/MyToggleGroup"),l=t("../Comp/ActCoinPanel"),m=t("../../Manager/WinMgr"),u=t("../../Manager/BCMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=t("../../Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTopRoot=null,e.mActWinlRoot=null,e.mCoinPanel=null,e.mToggleGroup=null,e.mActMask=null,e.mCurOpenedWin=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init(),this.mTopRoot.y=d.default.TOP_SAFE_OFFSET},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mActMask.active=!1,this.mCoinPanel.OnOpen(),this._OnMsg_ClickToggle(0,!0)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),u.default.Subscribe(c.BCType.ToggleGroup_Activity,this._OnMsg_ClickToggle,this),u.default.Subscribe(c.BCType.Activity_SetMaskState,this._OnMsg_SetMaskState,this),this.mCoinPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),u.default.Remove(c.BCType.ToggleGroup_Activity,this._OnMsg_ClickToggle,this),u.default.Remove(c.BCType.Activity_SetMaskState,this._OnMsg_SetMaskState,this),this.mCoinPanel.Remove()},e.prototype._OnClose=function(){t.prototype._OnClose.call(this),null!==this.mCurOpenedWin&&(this.mCurOpenedWin.CloseWin(),this.mToggleGroup.CurToggleIdx=-1)},e.prototype._OnMsg_ClickToggle=function(t,e){void 0===e&&(e=!1),e||p.default.PlayBtnSound(),this.mToggleGroup.CurToggleIdx!==t&&null!==this.mCurOpenedWin&&m.default.Ins.Close(this.mCurOpenedWin.mWinType);var o=this;switch(t){case 0:m.default.Ins.Open(c.WinType.FreeGoldActWin,function(t){o.mCurOpenedWin=t,t.node.parent!==o.mActWinlRoot&&(t.node.parent=o.mActWinlRoot,t.node.position=cc.Vec3.ZERO)},!0);break;case 1:m.default.Ins.Open(c.WinType.SignWin,function(t){o.mCurOpenedWin=t,t.node.parent!==o.mActWinlRoot&&(t.node.parent=o.mActWinlRoot,t.node.position=cc.Vec3.ZERO)},!0);break;case 2:m.default.Ins.Open(c.WinType.TurntableWin,function(t){o.mCurOpenedWin=t,t.node.parent!==o.mActWinlRoot&&(t.node.parent=o.mActWinlRoot,t.node.position=cc.Vec3.ZERO)},!0);break;case 3:m.default.Ins.Open(c.WinType.AllSPActWin,function(t){o.mCurOpenedWin=t,t.node.parent!==o.mActWinlRoot&&(t.node.parent=o.mActWinlRoot,t.node.position=cc.Vec3.ZERO)},!0)}this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._OnMsg_SetMaskState=function(t){this.mActMask.active=t},e.prototype.Invoke_Close=function(){p.default.PlayBtnSound(),u.default.Dispatch(c.BCType.Activity_UpdateBackUI,!0),this.CloseWin()},i([y(cc.Node)],e.prototype,"mTopRoot",void 0),i([y(cc.Node)],e.prototype,"mActWinlRoot",void 0),i([y(l.default)],e.prototype,"mCoinPanel",void 0),i([y(s.default)],e.prototype,"mToggleGroup",void 0),i([y(cc.Node)],e.prototype,"mActMask",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr","../Comp/ActCoinPanel":"ActCoinPanel","../Comp/MyToggleGroup":"MyToggleGroup","./WinBase":"WinBase"}],CommonDialogWin:[function(t,e,o){"use strict";cc._RF.push(e,"16081qTWFRJT6/ACfzpOQn4","CommonDialogWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mDescLbl=null,e.mConfirmCallback=null,e.mCancelCallback=null,e}return r(e,t),e.prototype.SetData=function(t,e,o){this.mConfirmCallback=e,this.mCancelCallback=o,this.mDescLbl.string=t},e.prototype.Invoke_Confirm=function(){null!==this.mConfirmCallback&&this.mConfirmCallback(),this.CloseWin()},e.prototype.Invoke_Cancel=function(){null!==this.mCancelCallback&&this.mCancelCallback(),this.CloseWin()},i([m(cc.Label)],e.prototype,"mDescLbl",void 0),i([l],e)}(a.default);o.default=u,cc._RF.pop()},{"./WinBase":"WinBase"}],Common:[function(t,e,o){"use strict";cc._RF.push(e,"980d6IJGmBHwLY+j1R76mLq","Common"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./SwitchConfig"),r=t("./EnumsDefine"),i=t("../Proxy/ProxyTask"),a=t("../Proxy/ProxyHero"),s=t("../Manager/UserMgr"),l=t("../Manager/PoolMgr"),m=t("../Manager/PlatformMgr"),u=t("../Manager/AudioMgr"),p=function(){function t(){}return t.Init=function(){this.mCommonRed=new cc.Color(254,68,68,255),t.m_Rad2Deg=180/Math.PI,t.m_Deg2Rad=Math.PI/180,t.LOG10_LV_FACTOR=Math.log10(a.default.LV_FACTOR),t.LOG10_GOLD_LV_FACTOR=Math.log10(a.default.LV_GOLD_FACTOR),this.CAMP_STR_ARR=["\u9b4f\u56fd","\u8700\u56fd","\u5434\u56fd","\u7fa4\u96c4"],this.mArmAttackedRelationshipArr=[[1,1,1,1,1,1,1],[0,0,0,1,1,1,1]],this.mQualityColorArr=[new cc.Color(0,255,0,255),new cc.Color(77,114,215,255),new cc.Color(162,79,224,255),new cc.Color(226,129,70,255),new cc.Color(218,70,181,255)]},t.GetQualityColor=function(t){return this.mQualityColorArr[t+1]},t.CanAttack=function(t,e){return 1===this.mArmAttackedRelationshipArr[e][t]},t.IsAnotherDay=function(t,e){return new Date(t).toDateString()!=new Date(e).toDateString()},t.Split2NumArr=function(t,e){void 0===e&&(e="|");for(var o=t.split(e),n=[],r=0,i=o.length;r<i;++r)n.push(Number(o[r]));return n},t.Clamp=function(t,e,o){return t>o?o:t<e?e:t},t.Lerp=function(t,e,o){return t+(e-t)*o},t.GetRandArr=function(t){for(var e=t.length-1;e>=0;--e){var o=Math.floor(Math.random()*(e+1)),n=t[o];t[o]=t[e],t[e]=n}return t},t.GetRandValueInArr=function(t){var e=t.length;return t[this.GetRandIntValueBetween(0,e,!1)]},t.GetRandValueBetween=function(t,e){return t+Math.random()*(e-t)},t.GetRandIntValueBetween=function(t,e,o){var n=0;return o&&(n=1),Math.floor(t+Math.random()*(e-t+n))},t.GetRandIdxByWeight=function(t,e){if(e>t.length)return console.error("\u8fd4\u56de\u6570\u636e\u6570\u91cf\u5927\u4e8e\u539f\u59cb\u6570\u636e\u6570\u91cf"),null;var o=[];if(e===t.length){for(var n=0;n<e;++n)o.push(n);return o}for(var r=[],i=(n=0,t.length);n<i;++n)r.push({weight:t[n],oriIdx:n});for(var a=0;a<e;++a){var s=0,l=[];for(n=0,i=r.length;n<i;++n)s+=r[n].weight,l.push({weight:s,oriIdx:r[n].oriIdx});var m=this.GetRandValueBetween(0,s);for(n=0,i=l.length;n<i;++n)if(m<=l[n].weight){o.push(l[n].oriIdx),r.splice(n,1);break}}return o},t.GetBezierValueByRate=function(t,e,o,n){return(1-n)*(1-n)*t+2*n*(1-n)*e+n*n*o},t.GetBezierVec2ByRate=function(e,o,n,r){var i=t.GetBezierValueByRate(e.x,o.x,n.x,r),a=t.GetBezierValueByRate(e.y,o.y,n.y,r);return cc.v2(i,a)},t.ResetSpriteSize=function(t,e,o){void 0===o&&(o=0);var n=e.getOriginalSize();if(0!==o){var r=n.height/n.width*o;t.node.width=o,t.node.height=r}else t.node.width=n.width,t.node.height=n.height},t.FormatTimeWithSeconds=function(t){var e=Math.floor(t/3600),o=t-3600*e,n=Math.floor(o/60),r=o-60*n;return e>0?(e<10?"0"+e:e)+":"+(n<10?"0"+n:n)+":"+(r<10?"0"+r:r):n>0?(n<10?"0"+n:n)+":"+(r<10?"0"+r:r):""+(r<10?"0"+r:r)},t.FormatTimeBySeconds=function(t){var e=Math.floor(t/3600/24),o=t-86400*e,n=Math.floor(o/3600);o-=3600*n;var r=Math.floor(o/60),i=o-60*r,a=n<10?"0"+n:n,s=r<10?"0"+r:r,l=i<10?"0"+i:i;return e>0?e+"\u5929"+a+":"+s+":"+l:a+":"+s+":"+l},t.WatchADForRewards=function(t,e,o,n){void 0===n&&(n=r.GetRewardsType.AD),this.HandleLingQuType(n,function(){t(!1)},function(){t(!0)},e,o,null)},t.HandleLingQuType=function(e,o,a,l,p,c){if(e===r.GetRewardsType.Share)m.default.mCurPlf.Share(function(t){t&&o()});else if(e===r.GetRewardsType.AD){if(t.mIsAding)return void setTimeout(function(){t.mIsAding=!1},2e3);u.default.MuteVolume(),t.mIsAding=!0,m.default.ReportEvent(r.BIPoint.AD_Click,{id:p}),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.AD_Btn_Click,{id:p}),m.default.mCurPlf.WatchAd(l,p,function(e){if(e){a(),m.default.ReportEvent(r.BIPoint.AD_Completed,{id:p}),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.AD_End,{id:p}),i.default.Ins.UpdateTaskProgress(i.DailyTaskType.Video,1),s.default.Ins.ClientInfo.accVideoCount++,10===s.default.Ins.ClientInfo.accVideoCount&&m.default.mCurPlf.ReportPay();var o=s.default.Ins.ClientInfo;switch(o.reachedECPM80&&(o.accVideoCount>=15&&!o.reportedECPM80Times15&&(o.reportedECPM80Times15=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E80_T15),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E80_T15)),o.accVideoCount>=10&&!o.reportedECPM80Times10&&(o.reportedECPM80Times10=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E80_T10),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E80_T10)),o.accVideoCount>=5&&!o.reportedECPM80Times5&&(o.reportedECPM80Times5=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E80_T5),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E80_T5))),o.reachedECPM100&&(o.accVideoCount>=15&&!o.reportedECPM100Times15&&(o.reportedECPM100Times15=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E100_T15),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E100_T15)),o.accVideoCount>=10&&!o.reportedECPM100Times10&&(o.reportedECPM100Times10=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E100_T10),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E100_T10)),o.accVideoCount>=5&&!o.reportedECPM100Times5&&(o.reportedECPM100Times5=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.E100_T5),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E100_T5))),o.reachedECPM150&&(o.accVideoCount>=15&&!o.reportedECPM150Times15&&(o.reportedECPM150Times15=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E150_T15)),o.accVideoCount>=10&&!o.reportedECPM150Times10&&(o.reportedECPM150Times10=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E150_T10)),o.accVideoCount>=5&&!o.reportedECPM150Times5&&(o.reportedECPM150Times5=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E150_T5))),o.reachedECPM200&&(o.accVideoCount>=15&&!o.reportedECPM200Times15&&(o.reportedECPM200Times15=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E200_T15)),o.accVideoCount>=10&&!o.reportedECPM200Times10&&(o.reportedECPM200Times10=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E200_T10)),o.accVideoCount>=5&&!o.reportedECPM200Times5&&(o.reportedECPM200Times5=!0,s.default.Ins.Save(),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.E200_T5))),s.default.Ins.ClientInfo.accVideoCount){case 10:m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.AD_Complete_10),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.AD_Complete_10);break;case 15:m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.AD_Complete_15),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.AD_Complete_15);break;case 20:m.default.mCurPlf.ReportTrackingEvent(r.TrackingEventType.AD_Complete_20),m.default.mCurPlf.ReportHuoShanEvent(r.HuoShanEventType.AD_Complete_20)}s.default.Ins.Save()}u.default.ResumeMuteOnAD(),t.mIsAding=!1},function(){n.default.mForceGetRewardsType!==r.GetRewardsType.AD?n.default.mCurPlatformType!==m.PlfTP.WeChat&&n.default.mCurPlatformType!==m.PlfTP.QQ||m.default.mCurPlf.Share(function(t){t&&o()}):console.error("\u83b7\u53d6\u89c6\u9891\u5931\u8d25\uff0c\u8bf7\u7a0d\u540e\u518d\u8bd5")},function(){t.mIsAding=!1,u.default.ResumeVolume()})}else c()},t.GetFlyCoin=function(e,o,n){void 0===n&&(n=1);for(var r=function(n){var r=n,i=o;0!==r&&(i=cc.v2(o.x+t.GetRandValueBetween(-30,30),o.y-60)),setTimeout(function(){l.default.Ins.Borrow(l.default.FLY_COIN,"FlyCoin",function(t){var n=t;0==r?n.InitData(e,o,i):n.InitData(null,o,i),n.TriggerFly()})},100*n-15*r)},i=0;i<n;++i)r(i)},t.FormatContent=function(t,e){if(e&&e.length>0){var o=t.match(this._pattern);if(!o)return t;o.length!=e.length&&console.error("\u586b\u5145\u7684\u53c2\u6570\u4e2a\u6570\u4e0d\u5339\u914d: "+t);for(var n=0,r=o.length;n<r;++n)t=t.replace(o[n],e[n])}return t},t.m_Rad2Deg=1,t.m_Deg2Rad=1,t.ScreenWidth=0,t.ScreenHeight=0,t.RealAspect=1,t.DESIGN_WIDTH=720,t.DESIGN_HEIGHT=1280,t.TOP_SAFE_OFFSET=0,t.OUT_SCREEN_POS=cc.v2(1e4,1e4),t.CAMP_STR_ARR=null,t.MainScene="MainGame",t.mArmAttackedRelationshipArr=[],t.mCommonRed=null,t.LOG10_LV_FACTOR=1,t.LOG10_GOLD_LV_FACTOR=1,t.BACK_BTN_SHOW_DELAY_TIME=2,t.mQualityColorArr=[],t.mIsAding=!1,t._pattern=/\{(.*?)\}/g,t}();o.default=p,cc._RF.pop()},{"../Manager/AudioMgr":"AudioMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/PoolMgr":"PoolMgr","../Manager/UserMgr":"UserMgr","../Proxy/ProxyHero":"ProxyHero","../Proxy/ProxyTask":"ProxyTask","./EnumsDefine":"EnumsDefine","./SwitchConfig":"SwitchConfig"}],CounterFloatNum:[function(t,e,o){"use strict";cc._RF.push(e,"a4e32pNiK1PJ7F6XJqCxFgO","CounterFloatNum");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=t("../../MainGame"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCounterSp=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.SetData=function(t){this.mCounterSp.spriteFrame=s.default.mCounterSFArr[t],this._Trigger()},e.prototype._Trigger=function(){var t=cc.tween,e=this;t(this.node).delay(.15).parallel(t().to(1.3,{opacity:0}),t().by(.8,{position:cc.v3(0,30,0)})).call(function(){e.Return()}).start()},e.prototype.Return=function(){a.default.Ins.Return(this)},i([u(cc.Sprite)],e.prototype,"mCounterSp",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../MainGame":"MainGame","../../Manager/PoolMgr":"PoolMgr"}],CounterPanel:[function(t,e,o){"use strict";cc._RF.push(e,"bde7587xHZIOa5zcDMCBkxc","CounterPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMask=null,e.mCloseCallback=null,e}return r(e,t),e.prototype.Open=function(t){void 0===t&&(t=null),this.mCloseCallback=t,this.node.active=!0,this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_Click,this)},e.prototype._OnEvent_Click=function(){this.node.active=!1,null!==this.mCloseCallback&&this.mCloseCallback()},i([l(cc.Node)],e.prototype,"mMask",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],Crystal:[function(t,e,o){"use strict";cc._RF.push(e,"b3babacVvhLy5n99IW9VPuY","Crystal");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Entity"),s=t("../../Proxy/ProxyWork"),l=t("../../Proxy/ProxyLargeNum"),m=t("../../Proxy/ProxyCrystal"),u=t("../../Manager/UserMgr"),p=t("../../Manager/FightMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=(h.property,function(t){function e(){var e=t.call(this)||this;return e.mCrystalType=d.CrystalType.Hero,e}return r(e,t),e.prototype.SetData=function(t){this.mCrystalType=t},e.prototype._InitOnce=function(e,o){this.mEntityType=d.EntityType.Crystal,t.prototype._InitOnce.call(this,e,o)},e.prototype.InitEntityAttr=function(){var e=this;switch(t.prototype.InitEntityAttr.call(this),this.mOwnerFightMode.CurFightModeType){case d.FightModeType.Normal:var o=this.mOwnerFightMode,n=o.mLevelNum,r=o.GetEnemyHP(this.mEntityID,n).MultiplySingle(.5);this.mEntityAttr.mMaxHP=r,this.mEntityAttr.mCurHP=new l.LargeNumber(r.mBaseValue,r.mExpoValue),this.mEntityAttr.mAttack=new l.LargeNumber(0,0),this.mEntityAttr.mDefend=o.GetEnemyDefend(this.mEntityID,n)}this.scheduleOnce(function(){e.mSkeleton.setAnimation(0,"daiji",!0)},0)},e.prototype._OnAudio=function(t){var e=t.stringValue;e&&c.default.PlayFightSFX(e,!0)},e.prototype._DropCoin=function(){if(t.prototype._DropCoin.call(this),this.mCrystalType===d.CrystalType.Enemy){var e=s.default.Ins.mRevenueCoinInSeconds;e.mBaseValue<=1&&0===e.mExpoValue&&(e.mBaseValue=15);var o=this.WorldMiddlePosition;o.x-=f.default.DESIGN_WIDTH,f.default.GetFlyCoin(e,cc.v2(o),5),m.default.Ins.GetFlyCrystal(m.default.Ins.GetCrystalNum(m.CrystalDropType.Crystal),cc.v2(o),3)}},e.prototype._ReturnEntity=function(){t.prototype._ReturnEntity.call(this),p.default.mCurFightMode.OnCrystalDestroyed(this.mCrystalType)},e.prototype._RemoveFromFight=function(){p.default.mCurFightMode.RemoveHero(this)},e.prototype.BeAttack=function(e,o,n,r,i){void 0===i&&(i=!1),this.mCrystalType===d.CrystalType.Hero&&u.default.Ins.ClientInfo.bestLevel<=1||t.prototype.BeAttack.call(this,e,o,n,r,i)},e.prototype.IdleState_OnEnter=function(){},e.prototype.IdleState_OnUpdate=function(){},e.prototype.MoveState_OnEnter=function(){this.mSkeleton.setAnimation(0,"daiji",!0)},e.prototype.MoveState_OnUpdate=function(){},e.prototype.MoveState_OnExit=function(){},e.prototype.AttackState_OnEnter=function(){},e.prototype.DeadState_OnEnter=function(){this.mSkeleton.setAnimation(0,"siwang",!1)},e.prototype.HitBackState_OnEnter=function(){},e.prototype.HitBackState_OnUpdate=function(){},e.prototype.HitBackState_OnExit=function(){},e.prototype.WaitState_OnEnter=function(){},i([y],e)}(a.default));o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/FightMgr":"FightMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyWork":"ProxyWork","./Entity":"Entity"}],CustomSkt:[function(t,e,o){"use strict";cc._RF.push(e,"b63f2euor1C5p9STS21N9aw","CustomSkt");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Manager/DataMgr"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){var e=t.call(this)||this;return e._time=0,e.mCurAnimName="",e.setStartListener(e.startHandler.bind(e)),e}return r(e,t),e.prototype.startHandler=function(){this._time=0},e.prototype.eventCallback=function(t){this._fun=t},e.prototype.setAnimation=function(e,o,n){this.mCurAnimName=o;var r=a.default.Ins.m_DB.spineDB[o];return r?(this._events=r.events,this._totalTime=r.time):this._events=null,t.prototype.setAnimation.call(this,e,o,n)},e.prototype.update=function(e){if(t.prototype.update.call(this,e),!this.paused&&null!=this._events&&this._fun){for(var o=this._events.length,n=0;n<o;n++){var r=this._events[n][0];this._time<r&&this._time+e>=r&&this._fun(this._events[n][1])}this._time+=e,this._time>=this._totalTime&&(this._time=0)}},i([l],e)}(sp.Skeleton));o.default=m,cc._RF.pop()},{"../Manager/DataMgr":"DataMgr"}],DailySocreItem:[function(t,e,o){"use strict";cc._RF.push(e,"9d73eErHi9Mg4JxFOwwGizO","DailySocreItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyTask"),s=t("../../Manager/WinMgr"),l=t("../../Manager/AudioMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSocreLbl=null,e.mReachedNode=null,e.mBoxAnim=null,e.mBoxSp=null,e.mCurIdx=0,e.mDailyTaskWin=null,e.mScoreRewardInfo=null,e.mNeedScore=1e3,e.mShowItemsArr=null,e}return r(e,t),e.prototype.Init=function(t,e){this.mScoreRewardInfo=a.default.Ins.mScoreRewardsArr[t],this.mCurIdx=t,this.mDailyTaskWin=e,this.mBoxSp.spriteFrame=e.mBoxSFArr[t],this.mNeedScore=this.mScoreRewardInfo[0],this.mSocreLbl.string=this.mNeedScore+"",this.mShowItemsArr=[];for(var o=1;o<this.mScoreRewardInfo.length;o+=2)this.mShowItemsArr.push([this.mScoreRewardInfo[o],this.mScoreRewardInfo[o+1]]);this.UpdateState()},e.prototype.UpdateState=function(){a.default.Ins.mDailyTaskInfo.curScore>=this.mNeedScore?(this.mReachedNode.opacity=255,a.default.Ins.CheckHasGotScoreReward(this.mCurIdx)?(this.mBoxSp.spriteFrame=this.mDailyTaskWin.mBoxGotSFArr[this.mCurIdx],this.mBoxAnim.stop(),this.mBoxAnim.node.angle=0,this.mBoxAnim.node.y=0):this.mBoxAnim.play()):(this.mReachedNode.opacity=0,this.mBoxAnim.stop(),this.mBoxAnim.node.angle=0,this.mBoxAnim.node.y=0)},e.prototype.Invoke_OpenBox=function(){l.default.PlayBtnSound();var t=a.default.Ins.mDailyTaskInfo.curScore,e=a.default.Ins.CheckHasGotScoreReward(this.mCurIdx),o=t>=this.mNeedScore,n=this;s.default.Ins.Open(m.WinType.RewardPreviewWin,function(t){t.SetData(n.mShowItemsArr,"\u5b9d\u7bb1\u5956\u52b1",e,o,function(){a.default.Ins.GetScoreRewards(n.mCurIdx),n.UpdateState()})})},i([c(cc.Label)],e.prototype,"mSocreLbl",void 0),i([c(cc.Node)],e.prototype,"mReachedNode",void 0),i([c(cc.Animation)],e.prototype,"mBoxAnim",void 0),i([c(cc.Sprite)],e.prototype,"mBoxSp",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyTask":"ProxyTask"}],DailyTaskItem:[function(t,e,o){"use strict";cc._RF.push(e,"6d0e1t4x19M26RGDDZ6GXqN","DailyTaskItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxyTask"),l=t("../../Proxy/ProxyAllSP"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../MainGame"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScoreLbl=null,e.mContentLbl=null,e.mPB=null,e.mPBLbl=null,e.mItem=null,e.mGetBtnNode=null,e.mBtnSp=null,e.mHasGotNode=null,e.mTaskData=0,e.mDailyTaskWin=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mDailyTaskWin=e,this.mTaskData=t,this.mScoreLbl.string=t.score,this.mContentLbl.string=t.desc;var o=0,n=l.TaskState.Progress,r=s.default.Ins.GetTaskSI(t.taskType);null!==r&&(o=r.progress,n=r.taskState),this.mPB.progress=o/t.targetNum,this.mPBLbl.string=o+"/"+t.targetNum;var i=u.default.Ins.GetConfigItemNum(t.rewards[0][0],t.rewards[0][1]);this.mItem.SetData(t.rewards[0][0],i+""),n===l.TaskState.GotRewards?(this.mGetBtnNode.active=!1,this.mHasGotNode.opacity=255):(this.mGetBtnNode.active=!0,this.mHasGotNode.opacity=0,n===l.TaskState.Complete?this.mBtnSp.setMaterial(0,d.default.mDefaultMat):this.mBtnSp.setMaterial(0,d.default.mGrayMat))},e.prototype.Invoke_GetRewards=function(){if(c.default.PlayBtnSound(),s.default.Ins.mIsNew)m.default.Ins.ShowTips("\u4efb\u52a1\u5df2\u5237\u65b0"),p.default.Dispatch(f.BCType.DailyTask_SortTask),s.default.Ins.mIsNew=!1;else{var t=s.default.Ins.GetTaskSI(this.mTaskData.taskType);null!==t&&t.taskState!==l.TaskState.Complete||(s.default.Ins.GetTaskRewards(this.mTaskData.Id),p.default.Dispatch(f.BCType.DailyTask_SortTask))}},i([g(cc.Label)],e.prototype,"mScoreLbl",void 0),i([g(cc.Label)],e.prototype,"mContentLbl",void 0),i([g(cc.ProgressBar)],e.prototype,"mPB",void 0),i([g(cc.Label)],e.prototype,"mPBLbl",void 0),i([g(a.default)],e.prototype,"mItem",void 0),i([g(cc.Node)],e.prototype,"mGetBtnNode",void 0),i([g(cc.Sprite)],e.prototype,"mBtnSp",void 0),i([g(cc.Node)],e.prototype,"mHasGotNode",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","../../Proxy/ProxyTask":"ProxyTask","./SimpleItem":"SimpleItem"}],DailyTaskWin:[function(t,e,o){"use strict";cc._RF.push(e,"564a8ZiwthH34ezVXLCfKU1","DailyTaskWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/DailyTaskItem"),l=t("../Comp/DailySocreItem"),m=t("../../Proxy/ProxyTask"),u=t("../../Proxy/ProxyAllSP"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mScoreTemplate=null,e.mContentNode=null,e.mTotalScoreLbl=null,e.mScorePB=null,e.mBoxSFArr=[],e.mBoxGotSFArr=[],e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mScoreItemArr=[],e.mItemArr=[],e.mOriY=-65,e.mCellHeight=130,e.mOriX=-207,e.mBarWidth=450,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=m.default.Ins.mTaskDataArr,o=0,n=e.length;o<n;++o)0===o?this.mItemArr.push(this.mTemplate):((i=cc.instantiate(this.mTemplate.node)).parent=this.mContentNode,this.mItemArr.push(i.getComponent(s.default))),this.mItemArr[o].node.setPosition(0,this.mOriY-this.mCellHeight*o);this.mContentNode.height=this.mCellHeight*e.length;var r=m.default.Ins.mScoreRewardsArr;for(o=0,n=r.length;o<n;++o){var i;0===o?this.mScoreItemArr.push(this.mScoreTemplate):((i=cc.instantiate(this.mScoreTemplate.node)).parent=this.mScoreTemplate.node.parent,this.mScoreItemArr.push(i.getComponent(l.default))),this.mScoreItemArr[o].Init(o,this);var a=this.mBarWidth/r[r.length-1][0];this.mScoreItemArr[o].node.position=cc.v3(this.mOriX+a*r[o][0],0,0)}var u=m.default.Ins.mDailyTaskInfo.curScore;this.mTotalScoreLbl.string=m.default.Ins.mDailyTaskInfo.curScore+"",this.mScorePB.progress=u/m.default.Ins.mScoreRewardsArr[2][0],this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&f.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),m.default.Ins.mIsNew=!1;var e=m.default.Ins.mTaskDataArr;e.sort(this._CompareFunc);for(var o=0,n=e.length;o<n;++o)this.mItemArr[o].SetData(e[o],this)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),p.default.Subscribe(d.BCType.DailyTask_SortTask,this._OnMsg_SortTask,this),p.default.Subscribe(d.BCType.DailyTask_OnGetRewards,this._OnMsg_GetRewarsd,this),p.default.Subscribe(d.BCType.DailyTask_GetScoreRewards,this._OnMsg_GetScoreRewards,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),p.default.Remove(d.BCType.DailyTask_SortTask,this._OnMsg_SortTask,this),p.default.Remove(d.BCType.DailyTask_OnGetRewards,this._OnMsg_GetRewarsd,this),p.default.Remove(d.BCType.DailyTask_GetScoreRewards,this._OnMsg_GetScoreRewards,this)},e.prototype._CompareFunc=function(t,e){if(t.taskType===m.DailyTaskType.TaskCount)return-1;if(e.taskType===m.DailyTaskType.TaskCount)return 1;var o=m.default.Ins.GetTaskSI(t.taskType),n=m.default.Ins.GetTaskSI(e.taskType);if(null!==o&&null!==n){if(o.taskState===n.taskState)return t.Id-e.Id;if(o.taskState===u.TaskState.Complete||n.taskState===u.TaskState.GotRewards)return-1;if(n.taskState===u.TaskState.Complete||o.taskState===u.TaskState.GotRewards)return 1}else{if(null===o&&null===n)return t.Id-e.Id;if(null!==o&&null===n)return o.taskState===u.TaskState.Complete?-1:o.taskState===u.TaskState.GotRewards?1:t.Id-e.Id;if(null===o&&null!==n)return n.taskState===u.TaskState.Complete?1:n.taskState===u.TaskState.GotRewards?-1:t.Id-e.Id}return t.Id-e.Id},e.prototype.UpdateScoreInfo=function(){var t=m.default.Ins.mDailyTaskInfo.curScore;this.mTotalScoreLbl.string=t+"";for(var e=0,o=this.mScoreItemArr.length;e<o;++e)this.mScoreItemArr[e].UpdateState();this.mScorePB.progress=t/m.default.Ins.mScoreRewardsArr[2][0]},e.prototype._OnMsg_SortTask=function(){var t=m.default.Ins.mTaskDataArr;t.sort(this._CompareFunc);for(var e=0,o=t.length;e<o;++e)this.mItemArr[e].SetData(t[e],this)},e.prototype._OnMsg_GetRewarsd=function(){this.UpdateScoreInfo()},e.prototype._OnMsg_GetScoreRewards=function(){this.UpdateScoreInfo()},e.prototype.Invoke_Close=function(){c.default.PlayBtnSound(),this.CloseWin()},i([g(s.default)],e.prototype,"mTemplate",void 0),i([g(l.default)],e.prototype,"mScoreTemplate",void 0),i([g(cc.Node)],e.prototype,"mContentNode",void 0),i([g(cc.Label)],e.prototype,"mTotalScoreLbl",void 0),i([g(cc.ProgressBar)],e.prototype,"mScorePB",void 0),i([g([cc.SpriteFrame])],e.prototype,"mBoxSFArr",void 0),i([g([cc.SpriteFrame])],e.prototype,"mBoxGotSFArr",void 0),i([g(cc.Node)],e.prototype,"mCloseBtn",void 0),i([g(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","../../Proxy/ProxyTask":"ProxyTask","../Comp/DailySocreItem":"DailySocreItem","../Comp/DailyTaskItem":"DailyTaskItem","./WinBase":"WinBase"}],DataMgr:[function(t,e,o){"use strict";cc._RF.push(e,"79054IogbxJTaa7egHTQUw1","DataMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Proxy/ProxyWork"),r=t("../Proxy/ProxyTurntable"),i=t("../Proxy/ProxyTask"),a=t("../Proxy/ProxySpeed"),s=t("../Proxy/ProxySkin"),l=t("../Proxy/ProxyOffline"),m=t("../Proxy/ProxyMainTask2"),u=t("../Proxy/ProxyLottery"),p=t("../Proxy/ProxyImtSkill"),c=t("../Proxy/ProxyImtBoss"),d=t("../Proxy/ProxyImmortal"),f=t("../Proxy/ProxyHeroMap"),h=t("../Proxy/ProxyHero"),y=t("../Proxy/ProxyForge"),g=t("../Proxy/ProxyBattleBox"),I=t("../Proxy/ProxyAllSP"),S=t("../InitGame"),_=function(){function t(){this.m_DB={heroCardDB:{},entityDB:{},levelDB:{},skillDB:{},skillCompDB:{},passiveDB:{},itemDB:{},workDB:{},paramDB:{},lotteryDB:{},boxRewardsDB:{},professionDB:{},funcDB:{},buffDB:{},plotDB:{},guideDB:{},mainTask2DB:{},sevenDaysDB:{},immortalDB:{},blackSmithDB:{},forgePoolDB:{},smithStepDB:{},imtBossLevelDB:{},imtSkillDB:{},turntableDB:{},signDB:{},allSPTaskDB:{},dailyTaskDB:{},vipDB:{},skinDB:{},skinPoolDB:{},officeDB:{},spineDB:{},heroMapDB:{},keyEventDB:{}},this.mBossLevelInterval=50,this.mEnemyReviveTime=3,this.mMaxLevelID=1e4,this.mNoLimitCampLevelNum=400,this.mKeyEventMap=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.Initialize=function(){var t=this;cc.loader.loadRes("data/db.txt",function(e,o){if(!e&&o){var n=window.pako.inflate(o.text,{gzip:!0,to:"string"}),r=JSON.parse(n);for(var i in r)t.m_DB[i]=r[i];S.default.HasDataLoaded=!0,t._InitParams(),cc.loader.release("data/db.txt")}else t.Initialize()})},t.prototype._InitParams=function(){h.default.Ins.InitParam(),u.default.Ins.InitParamData(),g.default.Ins.InitParam(),n.default.Ins.InitParamData(),l.default.Ins.InitParamData(),a.default.Ins.InitParamData(),m.default.Ins.InitParamData(),d.default.Ins.InitParamData(),p.default.Ins.InitParamData(),y.default.Ins.InitParamData(),c.default.Ins.InitParamData(),r.default.Ins.InitParamData(),I.default.Ins.InitParamData(),i.default.Ins.InitParamData(),s.default.Ins.InitData(),f.default.Ins.InitParamData(),this.InitKeyEventMap();var e=t.Ins.m_DB.paramDB;this.mEnemyReviveTime=Number(e.ENEMY_REVIVE_TIME.value)},t.prototype.GetLevelDataByID=function(t){var e=this.m_DB.levelDB,o=null;for(var n in e)if(e.hasOwnProperty(n))if(1==(o=e[n]).levelId.length){if(t===o.levelId[0])return o}else if(o.levelId[0]<=t&&t<=o.levelId[1])return o},t.prototype.InitKeyEventMap=function(){if(null===this.mKeyEventMap){this.mKeyEventMap=new Map;var t=this.m_DB.keyEventDB,e=null;for(var o in t)if(t.hasOwnProperty(o)){e=t[o];var n=this.mKeyEventMap.get(e.ecpmArrStr);n||(n=[],this.mKeyEventMap.set(e.ecpmArrStr,n)),n.push(e)}var r=this;this.mKeyEventMap.forEach(function(t){t.sort(r._Compare)})}},t.prototype._Compare=function(t,e){return-(t-e)},t.mIns=null,t}();o.default=_,cc._RF.pop()},{"../InitGame":"InitGame","../Proxy/ProxyAllSP":"ProxyAllSP","../Proxy/ProxyBattleBox":"ProxyBattleBox","../Proxy/ProxyForge":"ProxyForge","../Proxy/ProxyHero":"ProxyHero","../Proxy/ProxyHeroMap":"ProxyHeroMap","../Proxy/ProxyImmortal":"ProxyImmortal","../Proxy/ProxyImtBoss":"ProxyImtBoss","../Proxy/ProxyImtSkill":"ProxyImtSkill","../Proxy/ProxyLottery":"ProxyLottery","../Proxy/ProxyMainTask2":"ProxyMainTask2","../Proxy/ProxyOffline":"ProxyOffline","../Proxy/ProxySkin":"ProxySkin","../Proxy/ProxySpeed":"ProxySpeed","../Proxy/ProxyTask":"ProxyTask","../Proxy/ProxyTurntable":"ProxyTurntable","../Proxy/ProxyWork":"ProxyWork"}],EfxBase:[function(t,e,o){"use strict";cc._RF.push(e,"09ac7cibEBM64Zj7yjJVqUl","EfxBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySpeed"),s=t("../../Manager/PoolMgr"),l=t("../../Manager/FightMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Skeleton=null,e.m_IsLoop=!1,e.m_isUseTimeRecycle=!0,e.m_LifeTime=.5,e.mAnimName="animation",e.m_Timer=0,e.mKey="",e.m_AnimCompletedCallback=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,null!==this.m_Skeleton&&this.m_Skeleton.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.active=!0,this.m_Timer=0,this.m_isUseTimeRecycle&&l.default.mCurFightMode.AddEfx(this),this.m_Skeleton.setAnimation(0,this.mAnimName,this.m_IsLoop)},e.prototype.OnReturned=function(){this.node.active=!1,this.m_isUseTimeRecycle&&l.default.mCurFightMode.RemoveEfx(this)},e.prototype.SetData=function(t){void 0===t&&(t=null),this.m_AnimCompletedCallback=t},e.prototype._OnAnimCompleted=function(){this.m_isUseTimeRecycle||(s.default.Ins.Return(this),null!==this.m_AnimCompletedCallback&&(this.m_AnimCompletedCallback(),this.m_AnimCompletedCallback=null))},e.prototype.OnUpdate=function(t){this.m_isUseTimeRecycle&&(this.m_Timer+=t,this.m_LifeTime>=0&&this.m_Timer>=this.m_LifeTime&&s.default.Ins.Return(this))},e.prototype.UpdateGameSpeed=function(){null!==this.m_Skeleton&&(this.m_Skeleton.timeScale=a.default.Ins.mSpeedFactor)},i([p(sp.Skeleton)],e.prototype,"m_Skeleton",void 0),i([p(cc.Boolean)],e.prototype,"m_IsLoop",void 0),i([p(cc.Boolean)],e.prototype,"m_isUseTimeRecycle",void 0),i([p(cc.Float)],e.prototype,"m_LifeTime",void 0),i([p(cc.String)],e.prototype,"mAnimName",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../Proxy/ProxySpeed":"ProxySpeed"}],EnemySpawnController:[function(t,e,o){"use strict";cc._RF.push(e,"f1e2cKZKo1DEoT9nSOGwOwZ","EnemySpawnController"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../Manager/PoolMgr"),r=t("../../Manager/DataMgr"),i=t("../../Manager/BCMgr"),a=t("../../Common/EnumsDefine"),s=function(){function t(t,e){this.mOwnerLevelController=null,this.mTotalCount=0,this.mCurSpawnCount=0,this.mIsSpawning=!1,this.mIsSpawnInterupt=!1,this.mCurEntityID=0,this.mDelayTime=0,this.mInterval=0,this.mTiming=0,this.mOwnerLevelController=e,this.mCurEntityID=t[0],this.mTotalCount=t[1],this.mDelayTime=t[2],this.mInterval=t[3],this.mIsSpawning=!0,this.mIsSpawnInterupt=!1,this.mTiming=this.mDelayTime,this.mCurSpawnCount=0,this.mEntityData=r.default.Ins.m_DB.entityDB[this.mCurEntityID]}return t.prototype.OnUpdate=function(t){this.mIsSpawning&&(this.mTiming-=t,this.mTiming<=0&&(this._SpawnEnemy(),this.mTiming=this.mInterval,this.mCurSpawnCount++,this.mCurSpawnCount>=this.mTotalCount&&this._SpawnCompleted()))},t.prototype._SpawnEnemy=function(){if(this.mEntityData){var t=this;n.default.Ins.Borrow(n.default.ENEMY_PATH_ROOT+this.mEntityData.model,"Enemy",function(e){if(t.mIsSpawnInterupt)n.default.Ins.Return(e);else{var o=e;o.Init(t.mCurEntityID,t.mEntityData,t.mOwnerLevelController.mOwerFightMode,t.mOwnerLevelController.mCounterType,t.mOwnerLevelController.mLimitDmgCampType,t.mOwnerLevelController.mIsBossLevel),i.default.Dispatch(a.BCType.BattleWin_AddEnemy,o),t.mOwnerLevelController.mOwerFightMode.AddEnemy(o)}})}},t.prototype._SpawnCompleted=function(){this.mIsSpawning=!1},t.prototype.Stop=function(){this.mIsSpawnInterupt=!0,this.mIsSpawning=!1},t}();o.default=s,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/PoolMgr":"PoolMgr"}],Enemy:[function(t,e,o){"use strict";cc._RF.push(e,"bda554z+QVPfLRqvtD05h8A","Enemy");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Entity"),s=t("../AI/EntityState"),l=t("../../Proxy/ProxyWork"),m=t("../../Proxy/ProxySpeed"),u=t("../../Proxy/ProxyLargeNum"),p=t("../../Proxy/ProxyCrystal"),c=t("../../Manager/PoolMgr"),d=t("../../Manager/FightMgr"),f=t("../../Manager/DataMgr"),h=t("../../Manager/BCMgr"),y=t("../../Manager/AudioMgr"),g=t("../../MainGame"),I=t("../../Common/EnumsDefine"),S=t("../../Common/Common"),_=cc._decorator,v=_.ccclass,C=(_.property,function(t){function e(){var e=t.call(this)||this;return e.mIsInBossLevel=!1,e.mReviveTiming=10,e}var o;return r(e,t),o=e,e.prototype.OnSpawned=function(e){t.prototype.OnSpawned.call(this,e)},e.prototype.OnBeforeBorrow=function(){this.node.active=!0},e.prototype.OnReturned=function(){t.prototype.OnReturned.call(this)},e.prototype.Init=function(e,n,r,i,a,l){void 0===a&&(a=I.CampType.None),void 0===l&&(l=!1),t.prototype.Init.call(this,e,n,r,i,a),this.mInsID=++o.mEnemyInsID,this.mAttackDist=this.mEntityData.attackDist+S.default.GetRandValueBetween(-20,20),this.mCounterType=i,this.mIsInBossLevel=l,this.SetLookDirection(I.LookDir.Left),this.mStateMachine.ChangeState(s.EntityStateType.Move)},e.prototype._InitOnce=function(e,o){this.mEntityType=I.EntityType.Enemy,t.prototype._InitOnce.call(this,e,o)},e.prototype.InitEntityAttr=function(){switch(t.prototype.InitEntityAttr.call(this),this.mOwnerFightMode.CurFightModeType){case I.FightModeType.Normal:var e=this.mOwnerFightMode,o=e.mLevelNum,n=e.GetEnemyHP(this.mEntityID,o);this.mEntityAttr.mMaxHP=n,this.mEntityAttr.mCurHP=new u.LargeNumber(n.mBaseValue,n.mExpoValue),this.mEntityAttr.mAttack=e.GetEnemyAtk(this.mEntityID,o),this.mEntityAttr.mDefend=e.GetEnemyDefend(this.mEntityID,o);break;case I.FightModeType.ImtBoss:var r=this.mOwnerFightMode,i=r.GetEnemyHP(this.mEntityID);this.mEntityAttr.mMaxHP=i,this.mEntityAttr.mCurHP=new u.LargeNumber(i.mBaseValue,i.mExpoValue),this.mEntityAttr.mAttack=r.GetEnemyAtk(this.mEntityID),this.mEntityAttr.mDefend=r.GetEnemyDefend(this.mEntityID)}},e.prototype._DropCoin=function(){t.prototype._DropCoin.call(this);var e=null;(e=this.mIsBoss?l.default.Ins.mRevenueCoinInSeconds.MultiplySingle(15):l.default.Ins.mRevenueCoinInSeconds.MultiplySingle(.02)).mBaseValue<1&&0===e.mExpoValue&&(e.mBaseValue=1);var o=this.WorldMiddlePosition;o.x-=g.default.mBattleCam.mCurX,S.default.GetFlyCoin(e,cc.v2(o)),d.default.mCurFightMode.CurFightModeType===I.FightModeType.Normal&&(this.mIsBoss?p.default.Ins.GetFlyCrystal(p.default.Ins.GetCrystalNum(p.CrystalDropType.Boss),cc.v2(o),6):2===this.mEntityData.isBoss&&p.default.Ins.GetFlyCrystal(p.default.Ins.GetCrystalNum(p.CrystalDropType.Elite),cc.v2(o),5))},e.prototype._ReturnEntity=function(){t.prototype._ReturnEntity.call(this),this.mIsBoss&&d.default.mCurFightMode.OnCrystalDestroyed(I.CrystalType.Enemy)},e.prototype._RemoveFromFight=function(){},e.prototype._Revive=function(){this._Reset(),h.default.Dispatch(I.BCType.BattleWin_AddEnemy,this),this.node.active=!0},e.prototype.GetTargetArr=function(){for(var t=[],e=d.default.mCurFightMode.mHeroArr,o=0,n=e.length;o<n;++o)S.default.CanAttack(this.mWpCtrl.mWpType,e[o].mArmType)&&e[o].GetCurStateType()!==s.EntityStateType.Dead&&t.push(e[o]);return t},e.prototype.GetPartnerArr=function(){for(var t=[],e=d.default.mCurFightMode.mEnemyArr,o=0,n=e.length;o<n;++o)e[o].GetCurStateType()!==s.EntityStateType.Dead&&t.push(e[o]);return t},e.prototype.MoveState_OnEnter=function(){t.prototype.MoveState_OnEnter.call(this),this.SetLookDirection(I.LookDir.Left)},e.prototype.MoveState_OnUpdate=function(e){t.prototype.MoveState_OnUpdate.call(this,e)},e.prototype.MoveState_OnExit=function(){},e.prototype.DeadState_OnEnter=function(){if(this.mCurTargetEntity=null,this.mSkeleton.timeScale=m.default.Ins.mSpeedFactor,this.mIsBoss)this.mSkeleton.setAnimation(0,"siwang",!1),y.default.PlayFightSFX(I.AudioName.Fight_EntityDead);else{this._ReturnEntity();var t=this.node.position,e=this.node.parent;c.default.Ins.Borrow(c.default.DEAD_EXPLOSION,"EfxBase",function(o){o.node.setParent(e),o.node.setPosition(t),y.default.PlayFightSFX(I.AudioName.Fight_EntityDestroy,!0)})}this.mReviveTiming=f.default.Ins.mEnemyReviveTime},e.prototype.DeadState_OnUpdate=function(t){this.mIsInBossLevel&&!this.mIsBoss&&(this.mReviveTiming-=t,this.mReviveTiming<=0&&this._Revive())},e.mEnemyInsID=0,o=i([v],e)}(a.default));o.default=C,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySpeed":"ProxySpeed","../../Proxy/ProxyWork":"ProxyWork","../AI/EntityState":"EntityState","./Entity":"Entity"}],EntityAttr:[function(t,e,o){"use strict";cc._RF.push(e,"2086dXt+hFDarGWM22O2PsK","EntityAttr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../Proxy/ProxyLargeNum"),r=t("../../Common/EnumsDefine"),i=function(){function t(t){this.mOwnerEntity=null,this.mAttack=new n.LargeNumber(1,0),this.mMaxHP=new n.LargeNumber(1,0),this.mCurHP=new n.LargeNumber(1,0),this.mDefend=new n.LargeNumber(1,0),this.mDodgeRate=0,this.mCrit=0,this.mAirCritRate=0,this.mCritDmgAdd=100,this.mResist=0,this.mVertigoRate=0,this.mDropGoldAdd=0,this.mHasShiled=!1,this.mCurShield=null,this.mMaxShield=null,this.mProfession=r.ProfessionType.Archer,this.mOwnerEntity=t}return t.prototype.InitByEntityData=function(t){this.mDodgeRate=t.dodge,this.mCrit=t.crit,this.mCritDmgAdd=t.critDmgAdd,this.mAirCritRate=this.mCrit,this.mResist=t.resist,this.mProfession=t.profession,this.mProfession===r.ProfessionType.Archer&&(this.mAirCritRate=100)},t.prototype.AfterInitRealAttr=function(){this.mProfession===r.ProfessionType.Knight&&this.CreateShiled(.3)},t.prototype.CreateShiled=function(t){this.mHasShiled=!0,this.mMaxShield=this.mMaxHP.MultiplySingle(t),this.mCurShield=new n.LargeNumber(this.mMaxShield.mBaseValue,this.mMaxShield.mExpoValue)},t}();o.default=i,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Proxy/ProxyLargeNum":"ProxyLargeNum"}],EntityState:[function(t,e,o){"use strict";cc._RF.push(e,"058ccBi09NCJ7+6PvxdXIqD","EntityState");var n,r,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.EntityStateMachine=o.EntityWaitState=o.EntityVertigoState=o.EntityFrostedState=o.EntityHitBackState=o.EntityDeadState=o.EntityAttackState=o.EntityMoveState=o.EntityIdleState=o.EntityStateType=void 0,function(t){t[t.None=-1]="None",t[t.Idle=0]="Idle",t[t.Move=1]="Move",t[t.Attack=2]="Attack",t[t.Dead=3]="Dead",t[t.HitBack=4]="HitBack",t[t.Wait=5]="Wait",t[t.Frosted=6]="Frosted",t[t.Vertigo=7]="Vertigo"}(r=o.EntityStateType||(o.EntityStateType={}));var a=function(){function t(){}return t.prototype.GetStateType=function(){return r.None},t.prototype.OnEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.OnUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.OnExit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t}();o.default=a;var s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Idle},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.IdleState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.IdleState_OnUpdate(e)},e}(a);o.EntityIdleState=s;var l=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Move},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.MoveState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.MoveState_OnUpdate(e)},e.prototype.OnExit=function(e){t.prototype.OnExit.call(this,e)},e}(a);o.EntityMoveState=l;var m=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Attack},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.AttackState_OnEnter()},e}(a);o.EntityAttackState=m;var u=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Dead},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.DeadState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.DeadState_OnUpdate(e)},e}(a);o.EntityDeadState=u;var p=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.HitBack},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.HitBackState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.HitBackState_OnUpdate(e)},e.prototype.OnExit=function(t){t.HitBackState_OnExit()},e}(a);o.EntityHitBackState=p;var c=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Frosted},e.prototype.OnEnter=function(t){t.FrostState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.FrostState_OnUpdate(e)},e.prototype.OnExit=function(t){t.FrostState_OnExit()},e}(a);o.EntityFrostedState=c;var d=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Vertigo},e.prototype.OnEnter=function(t){t.VertigoState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.VertigoState_OnUpdate(e)},e.prototype.OnExit=function(t){t.VertigoState_OnExit()},e}(a);o.EntityVertigoState=d;var f=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetStateType=function(){return r.Wait},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.WaitState_OnEnter()},e}(a);o.EntityWaitState=f;var h=function(){function t(t){this.mEntity=null,this.mCurState=null,this.mPreviousState=null,this.mEntity=t}return t.prototype.OnUpdate=function(t){null!==this.mCurState&&this.mCurState.OnUpdate(this.mEntity,t)},t.prototype.GetCurStateType=function(){return null===this.mCurState?r.None:this.mCurState.GetStateType()},t.prototype.ChangeState=function(t){this.mPreviousState=this.mCurState,null!==this.mPreviousState&&this.mPreviousState.OnExit(this.mEntity),this.mCurState=this._GetState(t),this.mCurState.OnEnter(this.mEntity)},t.prototype._GetState=function(e){switch(e){case r.Idle:return t.mIdleState;case r.Move:return t.mMovetate;case r.Attack:return t.mAttackState;case r.Dead:return t.mDeadState;case r.HitBack:return t.mHitBackState;case r.Frosted:return t.mFrostState;case r.Vertigo:return t.mVertigoState;case r.Wait:return t.mWaitState;default:return console.error("\u4e0d\u5b58\u5728\u8be5\u7c7b\u578b\u7684\u72b6\u6001:"+e.toString()),null}},t.mIdleState=new s,t.mMovetate=new l,t.mAttackState=new m,t.mDeadState=new u,t.mHitBackState=new p,t.mFrostState=new c,t.mVertigoState=new d,t.mWaitState=new f,t}();o.EntityStateMachine=h,cc._RF.pop()},{}],Entity:[function(t,e,o){"use strict";cc._RF.push(e,"2ae3bzjhOZCvqG6wVvXL2WH","Entity");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WeaponController"),s=t("./EntityAttr"),l=t("../Skill/SkillCtrl"),m=t("../Skill/Passive/PassiveSkillCtrl"),u=t("../HitBehavior/HitBackBehavior"),p=t("../Buff/BuffFactory"),c=t("../AI/EntityState"),d=t("../../UI/Win/BattleWin"),f=t("../../Proxy/ProxySpeed"),h=t("../../Proxy/ProxyLargeNum"),y=t("../../Manager/UserMgr"),g=t("../../Manager/ShakeMgr"),I=t("../../Manager/ResMgr"),S=t("../../Manager/PoolMgr"),_=t("../../Manager/ImtBossDmgMgr"),v=t("../../Manager/FightMgr"),C=t("../../Manager/DataMgr"),M=t("../../Manager/BCMgr"),P=t("../../Manager/AudioMgr"),T=t("../../Common/EnumsDefine"),D=t("../../Common/Common"),A=cc._decorator,O=A.ccclass,k=A.property,B=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkeleton=null,e.mLimitDmgShieldSk=null,e.mItemSk=null,e.mHPSyncNode=null,e.mEntityAttr=null,e.mInsID=0,e.mEntityID=0,e.mEntityData=null,e.mArmType=T.ArmType.Land,e.mSkillCtrl=null,e.mStateMachine=null,e.mCurLookDir=T.LookDir.Right,e.mAttackDist=0,e.mCurTargetEntity=null,e.mMuzzleBone=null,e.m_ShootTargetBone=null,e.mOwnerFightMode=null,e.mBuffArr=[],e.mCounterType=T.CounterType.None,e.mCurCamp=T.CampType.None,e.mHitBackBehavior=null,e.mIsBoss=!1,e.mHPBar=null,e.mCanNotDie=!1,e.mPassiveCtrl=null,e.mWpCtrl=null,e.mMoveSpeed=0,e.mLookDirFactor=1,e.mBuffPosSyncNode=null,e.mNextSkillID=0,e.mCurSkillID=0,e.mCurSkillEndCallback=null,e.mLimitCampDmg=T.CampType.None,e.mInted=!1,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,this.mStateMachine=new c.EntityStateMachine(this)},e.prototype.OnBeforeBorrow=function(){this.node.active=!0},e.prototype.OnAfterBorrow=function(){},e.prototype.OnReturned=function(){this.node.active=!1,this.mHPBar&&(S.default.Ins.Return(this.mHPBar),this.mHPBar=null)},Object.defineProperty(e.prototype,"BuffPosSyncNode",{get:function(){return null===this.mBuffPosSyncNode&&(this.mBuffPosSyncNode=this.node),this.mBuffPosSyncNode},enumerable:!1,configurable:!0}),e.prototype.Init=function(t,e,o,n,r){for(var i=[],a=5;a<arguments.length;a++)i[a-5]=arguments[a];if(void 0===n&&(n=T.CounterType.None),void 0===r&&(r=T.CampType.None),this.mOwnerFightMode=o,this.mInsID=t,this._InitOnce(t,e),this.mLimitCampDmg=r,this.mLimitCampDmg!==T.CampType.None&&null!==this.mLimitDmgShieldSk){var s=this;I.default.Ins.LoadSpine("spine/hudun",function(t){s.mLimitDmgShieldSk.skeletonData=t,s.mLimitDmgShieldSk.setAnimation(0,I.default.Ins.mCampSFArr[r],!0)})}this._Reset(),this.mSkeleton.timeScale=f.default.Ins.mSpeedFactor},e.prototype._Reset=function(){this.mCurTargetEntity=null,null!==this.mSkillCtrl&&this.mSkillCtrl.Reset(),this.mStateMachine.ChangeState(c.EntityStateType.Move),this.InitEntityAttr(),this.AfterInitRealAttr(),null===this.mHPBar?this._InitHPBar():(this.mIsBoss?this.mHPBar.InitBossHPBar(this.mHPSyncNode,this.mCounterType,this.mEntityAttr.mHasShiled,this.mLimitCampDmg):this.mHPBar.Init(this.mHPSyncNode,this.mCounterType,this.mEntityAttr.mHasShiled),this.mHPBar.UpdateBuffIcon(null),this.mHPBar.UpdateHP(this.GetCurHPPercent(),!0),this.mEntityAttr.mHasShiled&&this.mHPBar.UpdateShiled(this._GetCurShiledPercent()))},e.prototype.GetCurHPPercent=function(){return this.mEntityAttr.mCurHP.GetHPPercent(this.mEntityAttr.mMaxHP)},e.prototype._GetCurShiledPercent=function(){return this.mEntityAttr.mHasShiled?this.mEntityAttr.mCurShield.GetHPPercent(this.mEntityAttr.mMaxShield):0},e.prototype.InitEntityAttr=function(){this.mEntityAttr.InitByEntityData(this.mEntityData)},e.prototype.AfterInitRealAttr=function(){this.mEntityAttr.AfterInitRealAttr()},e.prototype.UpdateEntityAttr=function(){},e.prototype.UpdateGameSpeed=function(){null!==this.mSkeleton&&this.GetCurStateType()!==c.EntityStateType.Frosted&&(this.mSkeleton.timeScale=f.default.Ins.mSpeedFactor)},e.prototype._InitOnce=function(t,e){var o=this;if(!this.mInted&&(this.mInted=!0,this.mRedAct=cc.sequence(cc.callFunc(function(){o.mSkeleton.node.color=new cc.Color(255,50,0,255)}),cc.delayTime(.05),cc.callFunc(function(){o.mSkeleton.node.color=cc.Color.WHITE})),this.mHitBackBehavior=new u.default(this),this.mEntityAttr=new s.default(this),this.mEntityID=t,this.mEntityData=e,this.mArmType=this.mEntityData.armType,this.mMoveSpeed=this.mEntityData.moveSpeed,this.mAttackDist=this.mEntityData.attackDist,this.mIsBoss=1===e.isBoss,this.mEntityType!==T.EntityType.Hero&&setTimeout(function(){o.mMuzzleBone=o.mSkeleton.findBone("muzzle"),o.m_ShootTargetBone=o.mSkeleton.findBone("shootTarget")},1),this.mSkeleton.setCompleteListener(this._OnAnimCompleted.bind(this)),this.mSkeleton.setEventListener(this._OnAnimEventListener.bind(this)),0!==this.mEntityData.normalSkillId&&(this.mSkillCtrl=new l.default(this),this.mSkillCtrl.InitOnce()),this.mWpCtrl=new a.default(this),this.mPassiveCtrl=new m.default(this),null!==this.mItemSk)){var n=this;I.default.Ins.LoadSpine("spine/shuijing",function(t){n.mItemSk.skeletonData=t,n.mItemSk.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),n.mItemSk.setAnimation(0,"animation",!0)})}},e.prototype._InitHPBar=function(){var t=this,e=this;this.mIsBoss?S.default.Ins.Borrow(S.default.BOSS_HPBAR_PATH,"BossHPBar",function(o){var n=o;e&&e.mHPSyncNode&&e.mHPSyncNode.isValid&&(n.InitBossHPBar(e.mHPSyncNode,e.mCounterType,t.mEntityAttr.mHasShiled,e.mLimitCampDmg),e.mHPBar=n,e.mHPBar.UpdateHP(e.GetCurHPPercent(),!0),e.mHPBar.UpdateBuffIcon(null),t.mEntityAttr.mHasShiled&&e.mHPBar.UpdateShiled(t._GetCurShiledPercent()),1===y.default.Ins.ClientInfo.bestLevel?e.mHPBar.node.opacity=0:e.mHPBar.node.opacity=255)}):S.default.Ins.Borrow(S.default.HPBAR_PATH,"HPBar",function(o){var n=o;e&&e.mHPSyncNode&&e.mHPSyncNode.isValid&&(n.Init(e.mHPSyncNode,e.mCounterType,t.mEntityAttr.mHasShiled),e.mHPBar=n,e.mHPBar.UpdateHP(t.GetCurHPPercent(),!0),e.mHPBar.UpdateBuffIcon(null),t.mEntityAttr.mHasShiled&&e.mHPBar.UpdateShiled(t._GetCurShiledPercent()))})},e.prototype._OnAnimCompleted=function(t){var e=null!==t.animation?t.animation.name:"";null!==this.mSkillCtrl&&this.mSkillCtrl.SkillData&&e===this.mSkillCtrl.SkillData.animName?(this.mSkillCtrl.EndSkill(!0),this.mStateMachine.GetCurStateType()!==c.EntityStateType.Dead&&this.mStateMachine.ChangeState(c.EntityStateType.Idle)):"siwang"===e&&this._ReturnEntity()},e.prototype._OnAnimEventListener=function(t,e){if("onSkill"===e.data.name){var o=this.mSkillCtrl.GetSkillCompCtrl();null!==o&&o.Trigger()}else if("onAudio"===e.data.name)this._OnAudio(e);else if("onShake"===e.data.name){var n=e.stringValue;if(n){var r=D.default.Split2NumArr(n,"|");g.default.AddShakeEvent(d.default.ShakeRoot,r[0],r[1],r[2],g.default.CAM_TAG)}}},e.prototype._OnAudio=function(t){var e=t.stringValue;e&&P.default.PlayFightSFX(e)},e.prototype._ReturnEntity=function(){S.default.Ins.Return(this),this.RemoveAllBuff()},e.prototype.SetLookDirection=function(t){t!==this.mCurLookDir&&(this.mCurLookDir=t,this.node.scaleX*=-1),t===T.LookDir.Right?this.mLookDirFactor=1:this.mLookDirFactor=-1},e.prototype.OnUpdate=function(t){null!==this.mStateMachine&&this.mStateMachine.OnUpdate(t),null!==this.mSkillCtrl&&this.mSkillCtrl.OnUpdate(t);for(var e=this.mBuffArr.length-1;e>=0;--e)this.mBuffArr[e].OnUpdate(t)},e.prototype.GetBuff=function(t){for(var e=0,o=this.mBuffArr.length;e<o;++e)if(this.mBuffArr[e].GetBuffType()===t)return this.mBuffArr[e];return null},e.prototype.CheckCanAddBuff=function(t){var e=this.GetBuff(t.GetBuffType());if(null===e)return!0;var o=e.GetBuffLv(),n=t.GetBuffLv();return o<n?(e.EndBuff(),!0):o===n?(e.Reset(),!1):void 0},e.prototype.AddBuff=function(t){this.mBuffArr.push(t),this._OnBuffAdd(t)},e.prototype.RemoveBuff=function(t){var e=this.mBuffArr.indexOf(t);-1!==e&&(this.mBuffArr.splice(e,1),this._OnBuffEnd())},e.prototype.RemoveAllBuff=function(){for(var t=this.mBuffArr.length-1;t>=0;--t)this.mBuffArr[t].EndBuff();null!==this.mHPBar&&this.mHPBar.UpdateBuffIcon(null)},e.prototype._OnBuffAdd=function(t){null!==this.mHPBar&&this.mHPBar.UpdateBuffIcon(t)},e.prototype._OnBuffEnd=function(){null!==this.mHPBar&&(0!==this.mBuffArr.length?this.mHPBar.UpdateBuffIcon(this.mBuffArr[0]):this.mHPBar.UpdateBuffIcon(null))},e.prototype.TriggerSkill=function(t,e){if(void 0===t&&(t=0),void 0===e&&(e=null),null!==this.mCurTargetEntity&&(this.mCurTargetEntity.node.x-this.node.x>=0?this.SetLookDirection(T.LookDir.Right):this.SetLookDirection(T.LookDir.Left)),null!==this.m_ShootTargetBone&&null!==this.mCurTargetEntity){var o=this.mCurTargetEntity.WorldMiddlePosition,n=this.mSkeleton.node.convertToNodeSpaceAR(o);this.m_ShootTargetBone.x=n.x,this.m_ShootTargetBone.y=n.y}this.mCurSkillID=0===t?this.mNextSkillID:t,this.mCurSkillEndCallback=e,this.ChangeState(c.EntityStateType.Attack),this.mNextSkillID=0,this.mPassiveCtrl.CheckPassive(T.PassiveCheckTimeType.Attack)},e.prototype.Fire=function(t){this.mWpCtrl.Fire(this.mCurTargetEntity,t)},e.prototype._CalculateDmg=function(t,e,o){var n=T.AttackEffect.Normal;if(e.mIsBoss&&e.mLimitCampDmg!==T.CampType.None&&t.mCurCamp!==e.mLimitCampDmg)return[new h.LargeNumber(0,0),T.AttackEffect.Immune];if(D.default.GetRandValueBetween(0,100)<=e.mEntityAttr.mDodgeRate)return[new h.LargeNumber(0,0),T.AttackEffect.Dodge];var r=t.mEntityAttr.mAttack,i=e.mEntityAttr.mDefend,a=r.Minus(i);if(a.IsLessEqualThanZero())return[a=new h.LargeNumber(0,0),T.AttackEffect.Normal];a.MultiplySelfSingle(o.mSkillCompData.damage);var s=!0,l=v.default.Ins.GetCounterRelationship(t.mCounterType,e.mCounterType);if(1===l?(n=T.AttackEffect.Counter,s=!1):-1===l&&(n=T.AttackEffect.DisCounter),a=a.MultiplySingle(v.default.Ins.GetCounterFactor(t.mCounterType,e.mCounterType)),s){var m=this.mEntityAttr.mCrit,u=1;e.mEntityData.armType===T.ArmType.Air&&(m=this.mEntityAttr.mAirCritRate),D.default.GetRandValueBetween(0,100)<=m&&(n=T.AttackEffect.Crit,u+=this.mEntityAttr.mCritDmgAdd,a=a.MultiplySingle(u))}return[a,n]},e.prototype._HandleEnemyBuff=function(t,e){var o=this;if(t.mEntityType!==T.EntityType.Crystal&&null!==e){var n=e.mSkillCompData;if(null!==n&&0!==n.prob&&0!==n.buff&&Math.random()<=n.prob)if(100*Math.random()<=t.mEntityAttr.mResist)S.default.Ins.Borrow(S.default.SIMPLE_BATTLE_FLOAT,"SimpleBattleFloat",function(e){var n=e,r=o.node.parent.convertToWorldSpaceAR(t.LocalTopFloatNumPos);M.default.Dispatch(T.BCType.BattleWin_ShowFloatNum,e,r),n.SetData(T.BattleFloatType.Resist)});else{var r=C.default.Ins.m_DB.buffDB[n.buff];if(null!==r){var i=p.default.Create(r.type);i.Init(this,t,r.lv,r.param),t.CheckCanAddBuff(i)&&(t.AddBuff(i),i.Trigger())}}}},e.prototype._HandleHitBehavior=function(t,e){this.mIsBoss||this.GetCurStateType()===c.EntityStateType.Dead||e===T.AttackEffect.Dodge||e===T.AttackEffect.Immune||0===t.mSkillCompData.hitBehaviorType||(this.mHitBackBehavior.SetSkillCompParam(t.mSkillCompData.hitParam),this.mHitBackBehavior.CanTrigger()&&this.ChangeState(c.EntityStateType.HitBack))},e.prototype.AttackWithBullet=function(t,e,o){this._HandleEnemyBuff(t,e);var n=this._CalculateDmg(this,t,e);t.BeAttack(this,n[0],n[1],o),t._HandleHitBehavior(e,n[1])},e.prototype.Attack=function(t,e,o){this._HandleEnemyBuff(t,e);var n=this._CalculateDmg(this,t,e);t.BeAttack(this,n[0],n[1],o),t._HandleHitBehavior(e,n[1])},e.prototype.BeAttack=function(t,e,o,n,r){var i=this;void 0===r&&(r=!1),t.mEntityType===T.EntityType.Hero&&v.default.mCurFightMode.CurFightModeType===T.FightModeType.ImtBoss&&_.default.Ins.StatHeroDmg(t.mEntityID,e);var a=!1;this.mEntityAttr.mHasShiled?(this.mEntityAttr.mCurShield.MinusSelf(e),1===this.mEntityAttr.mCurShield.Compare(this.mEntityAttr.mMaxShield)?this.mEntityAttr.mCurShield.SetValue(this.mEntityAttr.mMaxShield):this.mEntityAttr.mCurShield.IsLessEqualThanZero()&&(this.mEntityAttr.mCurShield=new h.LargeNumber(0,0),a=!0)):(this.mEntityAttr.mCurHP.MinusSelf(e),1===this.mEntityAttr.mCurHP.Compare(this.mEntityAttr.mMaxHP)?(this.mEntityAttr.mCurHP.mBaseValue=this.mEntityAttr.mMaxHP.mBaseValue,this.mEntityAttr.mCurHP.mExpoValue=this.mEntityAttr.mMaxHP.mExpoValue):this.mEntityAttr.mCurHP.IsLessEqualThanZero()&&(this.mEntityAttr.mCurHP=new h.LargeNumber(0,0))),null!==this.mHPBar&&(0===this.mHPBar.node.opacity&&(this.mHPBar.node.opacity=255),this.mEntityAttr.mHasShiled||this.mHPBar.UpdateHP(this.GetCurHPPercent()),a?(this.mHPBar.UpdateShiled(0),this.mEntityAttr.mHasShiled=!1):this.mEntityAttr.mHasShiled&&this.mHPBar.UpdateShiled(this._GetCurShiledPercent()));var s=this.LocalTopFloatNumPos,l=T.BattleFloatType.None;switch(o){case T.AttackEffect.Counter:S.default.Ins.Borrow(S.default.COUNTER_FLOAT_NUM,"CounterFloatNum",function(e){var o=e,n=i.node.parent.convertToWorldSpaceAR(s);M.default.Dispatch(T.BCType.BattleWin_ShowFloatNum,e,n),o.SetData(t.mCounterType)});break;case T.AttackEffect.DisCounter:break;case T.AttackEffect.Immune:l=T.BattleFloatType.Immune;break;case T.AttackEffect.Crit:l=T.BattleFloatType.Crit;break;case T.AttackEffect.Dodge:l=T.BattleFloatType.Dodge}if(l!==T.BattleFloatType.None&&S.default.Ins.Borrow(S.default.SIMPLE_BATTLE_FLOAT,"SimpleBattleFloat",function(t){var e=t,o=i.node.parent.convertToWorldSpaceAR(s);M.default.Dispatch(T.BCType.BattleWin_ShowFloatNum,t,o),e.SetData(l)}),this.mEntityAttr.mCurHP.IsLessEqualThanZero()&&!this.mCanNotDie)this.Die(),r||(t.mCurTargetEntity=null),this._DropCoin();else{var m;m=r?this.node.x:this.node.x-t.node.x,this.mSkeleton.node.x=6*Math.sign(m);var u=this;this.scheduleOnce(function(){u.mSkeleton.node.x=0},.08),this.mEntityType!==T.EntityType.Enemy&&this.mEntityType!==T.EntityType.Hero||this.mSkeleton.node.runAction(this.mRedAct)}},e.prototype.AddHP=function(t,e){this.mEntityAttr.mCurHP.AddSelf(e),1===this.mEntityAttr.mCurHP.Compare(this.mEntityAttr.mMaxHP)&&(this.mEntityAttr.mCurHP.mBaseValue=this.mEntityAttr.mMaxHP.mBaseValue,this.mEntityAttr.mCurHP.mExpoValue=this.mEntityAttr.mMaxHP.mExpoValue),null!==this.mHPBar&&(0===this.mHPBar.node.opacity&&(this.mHPBar.node.opacity=255),this.mHPBar.UpdateHP(this.GetCurHPPercent()))},e.prototype._DropCoin=function(){},e.prototype.GetCurStateType=function(){return this.mStateMachine.GetCurStateType()},e.prototype.ChangeState=function(t){this.mStateMachine.ChangeState(t)},e.prototype._RemoveFromFight=function(){},e.prototype.Die=function(){this.GetCurStateType()!==c.EntityStateType.Dead&&(this.ChangeState(c.EntityStateType.Dead),this.mHPBar&&(this.mHPBar.node.opacity=0),this._RemoveFromFight())},e.prototype.PutOffTeam=function(){this._ReturnEntity()},e.prototype.IdleState_OnEnter=function(){this.mSkeleton.setAnimation(0,"daiji",!0)},e.prototype.IdleState_OnUpdate=function(){null!==this.mCurTargetEntity&&this.mCurTargetEntity.mStateMachine.GetCurStateType()!==c.EntityStateType.Dead?Math.abs(this.mCurTargetEntity.node.x-this.node.x)>=this.mAttackDist+10?(this.mCurTargetEntity=null,this.ChangeState(c.EntityStateType.Move)):null===this.mSkillCtrl||this.mSkillCtrl.IsCDing||this.TriggerSkill():(this.mCurTargetEntity=null,this.mStateMachine.ChangeState(c.EntityStateType.Move))},e.prototype.MoveState_OnEnter=function(){this.mIsBoss?this.mSkeleton.setAnimation(0,"daiji",!0):this.mSkeleton.setAnimation(0,"zoulu",!0)},e.prototype.GetTargetArr=function(){return null},e.prototype.GetPartnerArr=function(){return null},e.prototype.FindTarget=function(){var t=null,e=this.GetTargetArr();if(null!==e)for(var o=0,n=e.length;o<n;++o)if(Math.abs(e[o].node.x-this.node.x)<=this.mAttackDist&&null!==(t=e[o])&&t.GetCurStateType()!==c.EntityStateType.Dead)return t;return t},e.prototype.MoveState_OnUpdate=function(t){if(null!==this.mCurTargetEntity&&this.mCurTargetEntity.mStateMachine.GetCurStateType()!==c.EntityStateType.Dead){if(Math.abs(this.mCurTargetEntity.node.x-this.node.x)<=this.mAttackDist)return null===this.mSkillCtrl||this.mSkillCtrl.IsCDing?void this.mStateMachine.ChangeState(c.EntityStateType.Idle):void this.TriggerSkill()}else{this.mCurTargetEntity=null;var e=this.GetTargetArr();if(null!==e)for(var o=0,n=e.length;o<n;++o)if(Math.abs(e[o].node.x-this.node.x)<=this.mAttackDist&&(this.mCurTargetEntity=e[o],null!==this.mCurTargetEntity&&this.mCurTargetEntity.GetCurStateType()!==c.EntityStateType.Dead))return null===this.mSkillCtrl||this.mSkillCtrl.IsCDing?void this.mStateMachine.ChangeState(c.EntityStateType.Idle):void this.TriggerSkill()}this.node.x+=this.mMoveSpeed*f.default.Ins.mSpeedFactor*t*this.mLookDirFactor},e.prototype.MoveState_OnExit=function(){},e.prototype.AttackState_OnEnter=function(){null!==this.mSkillCtrl&&this.mSkillCtrl.TriggerSkill(this.mCurSkillID,this.mCurSkillEndCallback)},e.prototype.DeadState_OnEnter=function(){this.mCurTargetEntity=null,this.mSkeleton.setAnimation(0,"siwang",!1),this.mSkeleton.timeScale=f.default.Ins.mSpeedFactor,P.default.PlayFightSFX(T.AudioName.Fight_EntityDead)},e.prototype.DeadState_OnUpdate=function(){},e.prototype.HitBackState_OnEnter=function(){this.mHitBackBehavior.Trigger()},e.prototype.HitBackState_OnUpdate=function(t){this.mHitBackBehavior.OnUpdate(t)},e.prototype.HitBackState_OnExit=function(){},e.prototype.WaitState_OnEnter=function(){this.mSkeleton.setAnimation(0,"daiji",!0)},e.prototype.FrostState_OnEnter=function(){this.mSkeleton.timeScale=0},e.prototype.FrostState_OnUpdate=function(){},e.prototype.FrostState_OnExit=function(){this.mSkeleton.timeScale=f.default.Ins.mSpeedFactor},e.prototype.VertigoState_OnEnter=function(){this.mSkeleton.setAnimation(0,"daiji",!0)},e.prototype.VertigoState_OnUpdate=function(){},e.prototype.VertigoState_OnExit=function(){},Object.defineProperty(e.prototype,"WorldPosition",{get:function(){return this.node.parent.convertToWorldSpaceAR(this.node.position)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"WorldMiddlePosition",{get:function(){return this.node.parent.convertToWorldSpaceAR(this.LocalMiddlePos)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LocalMiddlePos",{get:function(){return cc.v2(this.node.position.x,this.node.position.y+.5*this.node.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LocalTopPos",{get:function(){return cc.v2(this.node.position.x,this.node.position.y+this.node.height)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"LocalTopFloatNumPos",{get:function(){return cc.v2(this.node.position.x,this.node.position.y+this.node.height+50)},enumerable:!1,configurable:!0}),i([k(sp.Skeleton)],e.prototype,"mSkeleton",void 0),i([k(sp.Skeleton)],e.prototype,"mLimitDmgShieldSk",void 0),i([k(sp.Skeleton)],e.prototype,"mItemSk",void 0),i([k(cc.Node)],e.prototype,"mHPSyncNode",void 0),i([O],e)}(cc.Component);o.default=B,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/ImtBossDmgMgr":"ImtBossDmgMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Manager/ShakeMgr":"ShakeMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySpeed":"ProxySpeed","../../UI/Win/BattleWin":"BattleWin","../AI/EntityState":"EntityState","../Buff/BuffFactory":"BuffFactory","../HitBehavior/HitBackBehavior":"HitBackBehavior","../Skill/Passive/PassiveSkillCtrl":"PassiveSkillCtrl","../Skill/SkillCtrl":"SkillCtrl","./EntityAttr":"EntityAttr","./WeaponController":"WeaponController"}],EnumsDefine:[function(t,e,o){"use strict";cc._RF.push(e,"f76c4eaWOFEzZRG9vh0R8Fx","EnumsDefine"),Object.defineProperty(o,"__esModule",{value:!0}),o.HuoShanEventType=o.TrackingEventType=o.ExploreState=o.CDState=o.CoinType=o.ForgeType=o.BlackSmithTitle=o.ForgeState=o.ImtAttrType=o.InsPoint=o.ADPoint=o.BIPoint=o.BattleFloatType=o.AddAllAttrType=o.AttributeType=o.CounterType=o.AudioName=o.LotteryType=o.GetRewardsType=o.ItemType=o.ItemQuality=o.HeroQuality=o.ProfessionType=o.SexType=o.CampType=o.ToggleGroupType=o.PassiveEffectType=o.PassiveCheckLogicType=o.PassiveCheckTimeType=o.CrystalType=o.TrajectoryType=o.ArmType=o.WeaponType=o.AttackEffect=o.LookDir=o.EntityType=o.FightModeType=o.WinType=o.CloseMode=o.BCType=o.BattleModeType=void 0,function(t){t[t.None=-1]="None",t[t.Normal=0]="Normal"}(o.BattleModeType||(o.BattleModeType={})),function(t){t.ComicCompleted="ComicCompleted",t.ComicAllCompleted="ComicAllCompleted",t.ProblemWin_OK="ProblemWin_OK",t.BattleWin_AddHero="BattleWin_AddHero",t.BattleWin_AddEnemy="BattleWin_AddEnemy",t.BattleWin_AddCrystal="BattleWin_AddCrystal",t.BattleWin_AddBullet="BattleWin_AddBullet",t.BattleWin_HideBattleBox="BattleWin_OpenBox",t.BattleWin_ShowFloatNum="BattleWin_ShowFloatNum",t.BattleWin_ShowBOSSAnim="BattleWin_ShowBOSSAnim",t.BattleWin_AddSkillItem="BattleWin_AddSkillItem",t.BattleWin_StartSkill="BattleWin_StartSkill",t.BattleWin_ChangeMap="BattleWin_ChangeMap",t.MainWin_GetSecondDayGift="MainWin_GetSecondDayGift",t.MainWin_Transition1="MainWin_Transition1",t.MainWin_FlyCoin="MainWin_FlyCoin",t.MainWin_FlyCrystal="MainWin_FlyCrystal",t.MainWin_PlotToFight="MainWin_PlotToFight",t.MainWin_ShowBtns="MainWin_ShowBtns",t.MainWin_OpenHeroWin="_OnMsg_OpenHeroWin",t.MainWin_ChangeCoinType="MainWin_ChangeCoinType",t.MainWin_SetShowState="MainWin_SetShowState",t.MainWin_UseSpeedItem="MainWin_UseSpeedItem",t.MainWin_UseMultipleItem="MainWin_UseMultipleItem",t.MainWin_ShowGuideSkillBtn="MainWin_ShowGuideSkillBtn",t.HeroWin_AddGuideBtn="HeroWin_AddGuideBtn",t.WorkWin_UpdateTimeState="WorkWin_UpdateTimeState",t.WorkWin_UpdateRevenue="WorkWin_UpdateRevenue",t.SmithWin_Forge="SmithWin_Forge",t.SmithWin_StepSucess="SmithWin_StepSucess",t.SmithWin_UpdateMat="SmithWin_UpdateMat",t.SmithWin_UpdateTitle="SmithWin_UpdateTitle",t.Common_ChangeCoin="Common_ChangeCoin",t.Common_UpdateItem="Common_UpdateItem",t.Common_OnSecondsPassed="Common_OnSecondsPassed",t.Common_RefreshOnNewDay="Common_RefreshOnNewDay",t.HeroAdjustTeamWin_AddPos="HeroAdjustTeamWin_AddPos",t.HeroAdjustTeamWin_PutHeroOnTeam="HeroAdjustTeamWin_PutHeroOnTeam",t.HeroAdjustTeamWin_PutHeroOffTeam="HeroAdjustTeamWin_PutHeroOffTeam",t.HeroWin_ScrollToTop="HeroWin_ScrollToTop",t.HeroDetailWin_ClickQuickIcon="HeroDetailWin_ClickQuickIcon",t.OnUpgradeHeroMedalLv="OnUpgradeHeroMedalLv",t.OnUpgradeHeroStarLv="OnUpgradeHeroStarLv",t.OnUpgradeHeroQuality="OnUpgradeHeroQuality",t.OnUpdateADH="OnUpdateADH",t.ToggleGroup_MainWin="ToggleGroup_MainWin",t.ToggleGroup_HeroTeam="ToggleGroup_HeroTeam",t.ToggleGroup_HeroPicture="ToggleGroup_HeroPicture",t.ToggleGroup_HeroDetail="ToggleGroup_HeroDetail",t.ToggleGroup_SmithWin="ToggleGroup_SmithWin",t.ToggleGroup_Activity="ToggleGroup_Activity",t.ToggleGroup_AllSPAct="ToggleGroup_AllSPAct",t.ToggleGroup_AllSPHero="ToggleGroup_AllSPHero",t.ToggleGroup_AllSPImt="ToggleGroup_AllSPImt",t.ToggleGroup_Shop="ToggleGroup_Shop",t.CampUnlockWin_UpdateCamp="CampUnlockWin_ActiveCamp",t.Lottery_GetHero="Lottery_GetHero",t.Lottery_GetFirstHero="Lottery_GetFirstHero",t.Lottery_UpdateCrystalState="Lottery_UpdateCrystalState",t.Lottery_OnDrawCrystal="Lottery_OnDrawCrystal",t.UpdateHeroFragment="UpdateHeroFragment",t.GetNewHero="GetNewHero",t.Fight_PassBestLevel="Fight_PassBestLevel",t.Fight_ChangeLevel="Fight_ChangeLevel",t.BackCity="BackCity",t.LevelReward_UnlockLuxury="LevelReward_UnlockLuxury",t.LevelReward_GetRewards="LevelReward_GetRewards",t.Offline_UpdateHighestLevelID="Offline_UpdateHighestLevelID",t.GameSpeed_UpdateTime="GameSpeed_UpdateTime",t.GameSpeed_OnInit="GameSpeed_OnInit",t.MultipleCrystal_UpdateTime="MultipleCrystal_UpdateTime",t.MainTask_GetRewards="MainTask_GetRewards",t.UpdateForgeTime="UpdateForgeTime",t.RefreshSmithState="RefreshSmithState",t.ImtWin_GetNewImt="ImtWin_GetNewImt",t.ImtBoss_UpdateChallengeTimes="ImtBoss_UpdateChallengeTimes",t.ImtBoSS_UpdateRecoverTime="ImtBoSS_UpdateRecoverTime",t.ImtBoss_UpdateFightTime="ImtBoss_UpdateFightTime",t.ImtBoss_UpdateHeroDmg="ImtBoss_UpdateHeroDmg",t.ImtBoss_UpdateLevelItem="ImtBoss_UpdateLevelItem",t.ImtSkill_UpdateCD="ImtSkill_UpdateCD",t.ImtSkill_UpdateSkillTeam="ImtSkill_UpdateSkillTeam",t.ImtSkill_UpdateSkill="ImtSkill_UpdateSkill",t.SimpleItem_TouchStart="SimpleItem_TouchStart",t.SimpleItem_TouchEnd="SimpleItem_TouchEnd",t.SimpleItem_TouchCancel="SimpleItem_TouchCancel",t.SignItem_TouchStart="SignItem_TouchStart",t.SignItem_TouchEnd="SignItem_TouchEnd",t.SignItem_TouchCancel="SignItem_TouchCancel",t.Activity_UpdateBackUI="Activity_UpdateBackUI",t.Activity_SetMaskState="Activity_SetMaskState",t.Turntadble_AccLeftTime="Turntadble_AccLeftTime",t.SignAct_OnSigned="SignAct_OnSigned",t.AllSP_GetTaskRewards="AllSP_GetScoreRewards",t.DailyTask_SortTask="DailyTask_SortTask",t.DailyTask_OnGetRewards="DailyTask_OnGetRewards",t.DailyTask_GetScoreRewards="DailyTask_GetScoreRewards",t.VIP_OnUpgraded="VIP_OnUpgraded",t.VIP_GetReward="VIP_GetReward",t.VIP_BuyGift="VIP_BuyGift",t.Shop_RefreshHeroFragment="Shop_RefreshHeroFragment",t.Skin_GetNew="Skin_GetNew",t.Skin_Equip="Skin_Equip",t.Office_Upgraded="Office_Upgraded",t.Guide_End="Guide_End",t.Plot_End="Plot_End",t.MainTask2_StartTask="MainTask2_StartTask",t.MainTask2_UpdateState="MainTask2_UpdateState",t.NewHeroShow_AppearEfx="NewHeroShow_AppearEfx",t.HeroMapWin_UnlockSSR="HeroMapWin_UnlockSSR",t.UpdateExploreTime="UpdateExploreTime",t.ShowMainTaskGuidePanel="ShowMainTaskGuidePanel"}(o.BCType||(o.BCType={})),function(t){t[t.Hide=0]="Hide",t[t.Destroy=1]="Destroy",t[t.Opacity=2]="Opacity"}(o.CloseMode||(o.CloseMode={})),function(t){t[t.None=-1]="None",t.ComicWin="ComicWin",t.PrivacyWin="PrivacyWin",t.BattleWin="BattleWin",t.MainWin="MainWin",t.HeroWin="HeroWin",t.HeroAdjustTeamWin="HeroAdjustTeamWin",t.AddPosWin="AddPosWin",t.RecycleMedalWin="RecycleMedalWin",t.WorkWin="WorkWin",t.HeroPictureWin="HeroPictureWin",t.LotteryWin="LotteryWin",t.LotteryOpenWin="LotteryOpenWin",t.CampSelectWin="CampSelectWin",t.CampUnlockWin="CampUnlockWin",t.LotteryInstructionWin="LotteryInstructionWin",t.LotteryCampInstructionWin="LotteryCampInstructionWin",t.LotteryScoreRewardWin="LotteryScoreRewardWin",t.TipsWin="TipsWin",t.GetRewardsWin="GetRewardsWin",t.NewHeroShowWin="NewHeroShowWin",t.HeroDetailWin="HeroDetailWin",t.StarSuccessWin="StarSuccessWin",t.QualitySuccessWin="QualitySuccessWin",t.GoldForCoinWin="GoldForCoinWin",t.BuyItemWin="BuyItemWin",t.BackCityWin="BackCityWin",t.BackCityRewardWin="BackCityRewardWin",t.BattleBoxWin="BattleBoxWin",t.LevelRewardWin="LevelRewardWin",t.UnlockLevelLuxuryWin="UnlockLevelLuxuryWin",t.ItemHintWin="ItemHintWin",t.OfflineCoinWin="OfflineCoinWin",t.OfflineMedalWin="OfflineMedalWin",t.PlotWin="PlotWin",t.MainTaskWin="MainTaskWin",t.SevenDaysWin="SevenDaysWin",t.BackCityInstructionWin="BackCityInstructionWin",t.ImmortalWin="ImmortalWin",t.ForgeWin="ForgeWin",t.SmithWin="SmithWin",t.SmithFailWin="SmithFailWin",t.SmithBookWin="SmithBookWin",t.ImtDetailWin="ImtDetailWin",t.GetImtWin="GetImtWin",t.ImtPictureWin="ImtPictureWin",t.LuckyImtWin="LuckyImtWin",t.ImtRefineFailWin="ImtRefineFailWin",t.ChallengeWin="ChallengeWin",t.ImtBossWin="ImtBossWin",t.ImtBossLevelWin="ImtBossLevelWin",t.ImtBossLevelIntroduceWin="ImtBossLevelIntroduceWin",t.ImtBossFightWin="ImtBossFightWin",t.ImtBossVictoryWin="ImtBossVictoryWin",t.ImtBossFailWin="ImtBossFailWin",t.MopResultWin="MopResultWin",t.CommonDialogWin="CommonDialogWin",t.FreeRewardWin="FreeRewardWin",t.ImtSkillWin="ImtSkillWin",t.AddSkillPosWin="AddSkillPosWin",t.CommonActivity="CommonActivity",t.FreeGoldActWin="FreeGoldActWin",t.TurntableWin="TurntableWin",t.TurntableAccRewardsWin="TurntableAccRewardsWin",t.TurntableInsWin="TurntableInsWin",t.SignWin="SignWin",t.AllSPActWin="AllSPActWin",t.DailyTaskWin="DailyTaskWin",t.RewardPreviewWin="RewardPreviewWin",t.VipWin="VipWin",t.VIPUpgradeWin="VIPUpgradeWin",t.ShopWin="ShopWin",t.RefreshShopHeroWin="RefreshShopHeroWin",t.SkinPreviewWin="SkinPreviewWin",t.GiftOpenWin="GiftOpenWin",t.GetSkinWin="GetSkinWin",t.OfficeWin="OfficeWin",t.OfficePreviewWin="OfficePreviewWin",t.OfficeUpgradeWin="OfficeUpgradeWin",t.FuncUnlockWin="FuncUnlockWin",t.VIPGiftWin="VIPGiftWin",t.ImtInsWin="ImtInsWin",t.FightFailWin="FightFailWin",t.ProblemWin="ProblemWin",t.SecondDayWin="SecondDayWin",t.HeroMapWin="HeroMapWin",t.HeroUnlockWin="HeroUnlockWin",t.ExploreWin="ExploreWin",t.RepeatHeroWin="RepeatHeroWin",t.SetWin="SetWin",t.ServiceWin="ServiceWin",t.AgeWin="AgeWin"}(o.WinType||(o.WinType={})),function(t){t[t.None=-1]="None",t[t.Normal=0]="Normal",t[t.ImtBoss=1]="ImtBoss"}(o.FightModeType||(o.FightModeType={})),function(t){t[t.None=0]="None",t[t.Hero=1]="Hero",t[t.Enemy=2]="Enemy",t[t.Crystal=3]="Crystal",t[t.ImtSkill=4]="ImtSkill"}(o.EntityType||(o.EntityType={})),function(t){t[t.Right=0]="Right",t[t.Left=1]="Left"}(o.LookDir||(o.LookDir={})),function(t){t[t.Normal=0]="Normal",t[t.Crit=1]="Crit",t[t.HeadShot=2]="HeadShot",t[t.Dodge=3]="Dodge",t[t.Counter=4]="Counter",t[t.DisCounter=5]="DisCounter",t[t.Immune=6]="Immune"}(o.AttackEffect||(o.AttackEffect={})),function(t){t[t.None=-1]="None",t[t.Sword=0]="Sword",t[t.Boxing=1]="Boxing",t[t.MG=2]="MG",t[t.Sniper=3]="Sniper",t[t.Scatter=4]="Scatter",t[t.Missile=5]="Missile",t[t.Arrow=6]="Arrow"}(o.WeaponType||(o.WeaponType={})),function(t){t[t.Land=0]="Land",t[t.Air=1]="Air"}(o.ArmType||(o.ArmType={})),function(t){t[t.None=-1]="None",t[t.Line=0]="Line",t[t.Porabola=1]="Porabola"}(o.TrajectoryType||(o.TrajectoryType={})),function(t){t[t.Hero=0]="Hero",t[t.Enemy=1]="Enemy"}(o.CrystalType||(o.CrystalType={})),function(t){t[t.Instant=1]="Instant",t[t.Attack=2]="Attack"}(o.PassiveCheckTimeType||(o.PassiveCheckTimeType={})),function(t){t[t.None=0]="None",t[t.Prob=1]="Prob",t[t.Times=2]="Times"}(o.PassiveCheckLogicType||(o.PassiveCheckLogicType={})),function(t){t[t.None=0]="None",t[t.UseSkill=1]="UseSkill",t[t.AddAttr=2]="AddAttr",t[t.AddAllAttr=3]="AddAllAttr"}(o.PassiveEffectType||(o.PassiveEffectType={})),function(t){t[t.MainWin=0]="MainWin",t[t.AdjustTeamWin=1]="AdjustTeamWin",t[t.HeroPicture=2]="HeroPicture",t[t.HeroDetail=3]="HeroDetail",t[t.SmithWin=4]="SmithWin",t[t.Activity=5]="Activity",t[t.AllSPAct=6]="AllSPAct",t[t.AllSPActHero=7]="AllSPActHero",t[t.AllSPActImt=8]="AllSPActImt",t[t.Shop=9]="Shop"}(o.ToggleGroupType||(o.ToggleGroupType={})),function(t){t[t.None=-1]="None",t[t.Wei=0]="Wei",t[t.Shu=1]="Shu",t[t.Wu=2]="Wu",t[t.Qun=3]="Qun",t[t.All=4]="All"}(o.CampType||(o.CampType={})),function(t){t[t.Male=0]="Male",t[t.Female=1]="Female"}(o.SexType||(o.SexType={})),function(t){t[t.None=-1]="None",t[t.Archer=0]="Archer",t[t.Warrior=1]="Warrior",t[t.Berserker=2]="Berserker",t[t.Knight=3]="Knight",t[t.Missile=4]="Missile",t[t.MG=5]="MG",t[t.Sniper=6]="Sniper",t[t.Assist=7]="Assist"}(o.ProfessionType||(o.ProfessionType={})),function(t){t[t.R=0]="R",t[t.SR=1]="SR",t[t.SSR=2]="SSR",t[t.SP=3]="SP"}(o.HeroQuality||(o.HeroQuality={})),function(t){t[t.N=-1]="N",t[t.R=0]="R",t[t.SR=1]="SR",t[t.SSR=2]="SSR",t[t.SP=3]="SP"}(o.ItemQuality||(o.ItemQuality={})),function(t){t[t.Coin=1]="Coin",t[t.Gold=2]="Gold",t[t.LuckyTicket=3]="LuckyTicket",t[t.CampTicket=4]="CampTicket",t[t.Medal=5]="Medal",t[t.Awake=6]="Awake",t[t.ADCoin=7]="ADCoin",t[t.ForgeExp=8]="ForgeExp",t[t.ImtForgeMat=9]="ImtForgeMat",t[t.MopTicket=13]="MopTicket",t[t.ChallengeTimes=14]="ChallengeTimes",t[t.TurnCoin=15]="TurnCoin",t[t.VIPExp=16]="VIPExp",t[t.SpeedUp2=17]="SpeedUp2",t[t.SkinFrag=18]="SkinFrag",t[t.Crystal=19]="Crystal",t[t.MultipleCrystal=20]="MultipleCrystal",t[t.RandomHero=100]="RandomHero",t[t.RandomHeroSkin=200]="RandomHeroSkin",t[t.HeroFragment=1001]="HeroFragment",t[t.HeroSkin=2e3]="HeroSkin",t[t.Immortal=1e4]="Immortal"}(o.ItemType||(o.ItemType={})),function(t){t[t.Default=-1]="Default",t[t.AD=0]="AD",t[t.Share=1]="Share",t[t.Direct=10]="Direct"}(o.GetRewardsType||(o.GetRewardsType={})),function(t){t[t.Lucky=0]="Lucky",t[t.Camp=1]="Camp"}(o.LotteryType||(o.LotteryType={})),function(t){t.BGM_Normal="bgm_1",t.Sound_Btn="ui_dianjianniu",t.Fight_CrystalDestroy="shuijingposui",t.Fight_EntityDead="siwangdaodi",t.Fight_EntityDestroy="siwangposui",t.Fight_HeroShow="wujiangchuxian",t.Fihgt_Boss="bossLaiXi",t.UI_ClickPlot="ui_dianjiduihua",t.UI_GetRewards="ui_gongxihuode",t.UI_BackCity="ui_huicheng",t.UI_R="ui_r",t.UI_SR="ui_sr",t.UI_SSR="ui_ssr",t.UI_CoinUpgrade="ui_yinbishengji",t.UI_MedalUpgrade="ui_xunzhangshengji",t.UI_CoinDouble="ui_dianjijiabei",t.UI_GetCoin="ui_yinbilingqu",t.UI_FlyCoin="ui_huodeyinbi",t.UI_TanKuang="ui_tankuang",t.UI_UpgradeSuccess="ui_shengjichenggong",t.UI_UpgradeFailed="ui_shengjishibai",t.UI_UpgradeStar="ui_xingxing",t.UI_SmithStep="ui_tiejiangtupo"}(o.AudioName||(o.AudioName={})),function(t){t[t.None=-1]="None",t[t.Rock=0]="Rock",t[t.Scissor=1]="Scissor",t[t.Paper=2]="Paper"}(o.CounterType||(o.CounterType={})),function(t){t[t.None=-1]="None",t[t.Atk=0]="Atk",t[t.Def=1]="Def",t[t.HP=2]="HP",t[t.Crit=3]="Crit",t[t.CritDmg=4]="CritDmg",t[t.AtkSpeed=5]="AtkSpeed",t[t.MoveSpeed=6]="MoveSpeed",t[t.Resist=7]="Resist",t[t.Dodge=8]="Dodge",t[t.Vertigo=9]="Vertigo"}(o.AttributeType||(o.AttributeType={})),function(t){t[t.Profession=0]="Profession",t[t.Camp=1]="Camp"}(o.AddAllAttrType||(o.AddAllAttrType={})),function(t){t[t.None=-1]="None",t[t.Crit=0]="Crit",t[t.Resist=1]="Resist",t[t.Immune=2]="Immune",t[t.Dodge=3]="Dodge"}(o.BattleFloatType||(o.BattleFloatType={})),function(t){t.Guide_NewPlayer="10000101",t.Guide_NewPlayerProgressComplete="10000102",t.Guide_ProblemWinOpened="10000103",t.Guide_ProblemWinClosed="10000104",t.Guide_BattleWinOpened="10000105",t.Guide_ZhangJiaoShow="10000106",t.Guide_ZhangJiaoSpeak="10000107",t.Guide_StartAskForHelp="10000108",t.Guide_ClickForHelp="10000109",t.Guide_ClickImtBtn="10000110",t.Guide_ImtSkillEnd="10000111",t.Guide_ZhangJiaoBeginBack="10000112",t.Guide_ShenmirenSpeak="10000113",t.Guide_Level1="10000114",t.Guide_Unlock_7Day="10000200",t.Guide_Unlock_Activity="10000201",t.Guide_Unlock_Office="10000202",t.Guide_Unlock_Shop="10000203",t.Guide_FirstOpenImt="10000204",t.GetSecondDayGift="10000300",t.Guide_PlotDialogFirstShow="1000020001",t.Guide_PlotEnd="10000500",t.Guide_GuideEnd="10000501",t.MainTask_End="10000600",t.ADCoinItem="10000700",t.Reached_Best_Level="100002001",t.VIP_Level="100003001",t.Seven_Day_Get="100004001",t.ExploreHero_Begin="100005001",t.ExploreHero_Get="100005002",t.MAX_HERO_STAR="100006001",t.MAX_IMT_STAR="100007001",t.MAX_SMITH="100008001",t.Video_Click_Task="100009001",t.AD_Scene="1000010000",t.AD_Click="1000010001",t.AD_Show="1000010002",t.AD_Completed="1000010003",t.InsAD_Show="1000010005",t.InsAD_Completed="1000010006",t.Guide_ComicShow="100001002",t.Guide_Comic1Show="1000010011",t.Guide_Comic1Complete="1000010012",t.Guide_Comic2Show="1000010021",t.Guide_Comic2Complete="1000010022",t.Guide_Comic3Show="1000010031",t.Guide_Comic3Complete="1000010032",t.Guide_Comic4Show="1000010041",t.Guide_LastComicBtn="100001003"}(o.BIPoint||(o.BIPoint={})),function(t){t.SevenDayOnceMore="1",t.SpeedUp="2",t.NewImtGold="3",t.LuckyImtRefine="4",t.FreeMopTicket="5",t.FreeChallengeTimes="6",t.SmithStepSuccessGold="7",t.SmithStepFailRetainMat="8",t.FreeGoldAct="9",t.FreeTurnCoin="10",t.ForgeSpeedUp="11",t.DoubleBackCity="12",t.BattleGoldBox="13",t.OfflineDoubleMedal="14",t.RecycleMedal="15",t.WorkForCoin="16",t.ManualRefreshHeroFrag="17",t.OfficeShare="18",t.VIPGift="19",t.MultipleCrystal="20",t.FreeLottery="21",t.NewHeroGold="22",t.DoubleHeroFragment="23",t.ExploreDouble="24",t.SmithUpgradeMedicine="25"}(o.ADPoint||(o.ADPoint={})),function(t){t.PassLevelSuccess="1",t.PassLeveLFail="2",t.OfficeUpgrade="3",t.BackCityNormal="4",t.SecondDayGift="5",t.ADCoin_Skin="6",t.ADCoin_ImtBox="7",t.ImtBossVictoryBack="8"}(o.InsPoint||(o.InsPoint={})),function(t){t[t.Atk=1]="Atk",t[t.Def=2]="Def",t[t.HP=3]="HP",t[t.MedalAdd=4]="MedalAdd",t[t.HeroUpgradeReduce=5]="HeroUpgradeReduce",t[t.WorkRevenueAdd=6]="WorkRevenueAdd",t[t.WorkTimeReduce=7]="WorkTimeReduce",t[t.WorkUpgradeReduce=8]="WorkUpgradeReduce",t[t.WorkInitLevelAdd=9]="WorkInitLevelAdd",t[t.ImtMatAdd=10]="ImtMatAdd",t[t.SkipLevel=11]="SkipLevel",t[t.BattleBoxCoinAdd=12]="BattleBoxCoinAdd",t[t.CoinOfflineTimeLimitAdd=13]="CoinOfflineTimeLimitAdd",t[t.MedalOfflineTimeLimitAdd=14]="MedalOfflineTimeLimitAdd",t[t.OfflinePassLevelSpeedAdd=15]="OfflinePassLevelSpeedAdd",t[t.MedalOfflineNumAdd=16]="MedalOfflineNumAdd"}(o.ImtAttrType||(o.ImtAttrType={})),function(t){t[t.None=-1]="None",t[t.Lock=0]="Lock",t[t.BtnLock=1]="BtnLock",t[t.Idle=2]="Idle",t[t.Forging=3]="Forging",t[t.Completed=4]="Completed"}(o.ForgeState||(o.ForgeState={})),function(t){t[t.Trainee=1]="Trainee",t[t.Skilled=2]="Skilled",t[t.Master=3]="Master",t[t.Artist=4]="Artist",t[t.God=5]="God",t[t.Glory=6]="Glory",t[t.MAX=6]="MAX"}(o.BlackSmithTitle||(o.BlackSmithTitle={})),function(t){t[t.Normal=0]="Normal",t[t.Advance=1]="Advance"}(o.ForgeType||(o.ForgeType={})),function(t){t[t.Common=0]="Common",t[t.ForgeMat=1]="ForgeMat",t[t.Shop=2]="Shop"}(o.CoinType||(o.CoinType={})),function(t){t[t.Ready=0]="Ready",t[t.CDing=1]="CDing"}(o.CDState||(o.CDState={})),function(t){t[t.None=-1]="None",t[t.Idle=0]="Idle",t[t.Exploring=1]="Exploring",t[t.Completed=2]="Completed"}(o.ExploreState||(o.ExploreState={})),function(t){t.AD_Complete_10="event_1",t.AD_Complete_15="event_2",t.AD_Complete_20="event_3",t.E80_T5="event_4",t.E80_T10="event_5",t.E80_T15="event_6",t.E100_T5="event_7",t.E100_T10="event_8",t.E100_T15="event_9",t.Sign_3="event_10",t.Sign_5="event_11",t.Sign_7="event_12"}(o.TrackingEventType||(o.TrackingEventType={})),function(t){t.StartGuide="start_guide",t.EnterGame="enter_game",t.EndGuide="end_guide",t.UnlockHeroFunc="unlock_hero_func",t.EnterLevel="enter_level",t.AD_Btn_Click="ad_btn_click",t.AD_Show="ad_show",t.AD_Click="ad_click",t.AD_End="ad_end",t.Imt_Open="weapon_open",t.Challenge_Open="challenge_open",t.AD_Complete_10="event_1",t.AD_Complete_15="event_2",t.AD_Complete_20="event_3",t.E80_T5="event_4",t.E80_T10="event_5",t.E80_T15="event_6",t.E100_T5="event_7",t.E100_T10="event_8",t.E100_T15="event_9",t.Sign_3="event_10",t.Sign_5="event_11",t.Sign_7="event_12",t.E150_T5="event_13",t.E150_T10="event_14",t.E150_T15="event_15",t.E200_T5="event_16",t.E200_T10="event_17",t.E200_T15="event_18",t.ARPU_0_5="event_19",t.ARPU_1="event_20",t.ARPU_1_5="event_21",t.ARPU_2="event_22",t.ARPU_2_5="event_23",t.ARPU_3="event_24",t.DAY_2="event_30"}(o.HuoShanEventType||(o.HuoShanEventType={})),cc._RF.pop()},{}],ExploreItem:[function(t,e,o){"use strict";cc._RF.push(e,"ba98azWH1JAv6cOpsdJPvtA","ExploreItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyExplore"),s=t("../../Manager/AudioMgr"),l=t("../../Common/EnumsDefine"),m=t("../../Common/Common"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBtnNode=null,e.mBtnBg=null,e.mBtnLbl=null,e.mDefaultRoot=null,e.mExploreRoot=null,e.mTotalLbl=null,e.mLeftTimeLbl=null,e.mExploringHint=null,e.mPb=null,e.mID=1,e.mCurSI=null,e.mExploreWin=null,e.mTotalTime=a.default.Ins.mLeftNeedTime,e.mBtnLblArr=["\u62db\u8058","\u8bf7\u795e"],e}return r(e,t),e.prototype.SetData=function(t,e){this.mID=t,this.mExploreWin=e,this.mCurSI=a.default.Ins.GetExploreItemSI(t),this.RefreshState(),this.mTotalTime=a.default.Ins.mLeftNeedTime,2===this.mID&&(this.mTotalTime=a.default.Ins.mRightNeedTime)},e.prototype.UpdateTime=function(t){t<=0?this.RefreshState():(this.mLeftTimeLbl.string=m.default.FormatTimeBySeconds(t),this.mPb.progress=t/this.mTotalTime)},e.prototype.RefreshState=function(){this.SetState(this.mCurSI.state)},e.prototype.SetState=function(t){switch(t){case l.ExploreState.Idle:this.mExploringHint.opacity=0,this.mBtnNode.active=!0,this.mBtnBg.spriteFrame=this.mExploreWin.mBtnSFArr[0],this.mBtnLbl.string=this.mBtnLblArr[this.mID-1];var e=a.default.Ins.mLeftNeedTime;2===this.mID&&(e=a.default.Ins.mRightNeedTime),this.mLeftTimeLbl.string=m.default.FormatTimeBySeconds(e),this.mTotalLbl.string=m.default.FormatTimeBySeconds(e),this.mDefaultRoot.active=!0,this.mExploreRoot.active=!1;break;case l.ExploreState.Exploring:this.mExploringHint.opacity=255,this.mBtnNode.active=!1,this.UpdateTime(this.mCurSI.leftTime),this.mDefaultRoot.active=!1,this.mExploreRoot.active=!0;break;case l.ExploreState.Completed:this.mExploringHint.opacity=0,this.mBtnNode.active=!0,this.mBtnBg.spriteFrame=this.mExploreWin.mBtnSFArr[1],this.mBtnLbl.string="\u9886\u53d6",this.mLeftTimeLbl.string="\u5df2\u5b8c\u6210",this.mDefaultRoot.active=!1,this.mExploreRoot.active=!0,this.mPb.progress=0}},e.prototype.Invoke_ClickBtn=function(){switch(s.default.PlayBtnSound(),this.mCurSI.state){case l.ExploreState.Idle:a.default.Ins.StartExplore(this.mID),this.RefreshState();break;case l.ExploreState.Exploring:break;case l.ExploreState.Completed:a.default.Ins.GetExploreRewards(this.mID),this.RefreshState()}},i([c(cc.Node)],e.prototype,"mBtnNode",void 0),i([c(cc.Sprite)],e.prototype,"mBtnBg",void 0),i([c(cc.Label)],e.prototype,"mBtnLbl",void 0),i([c(cc.Node)],e.prototype,"mDefaultRoot",void 0),i([c(cc.Node)],e.prototype,"mExploreRoot",void 0),i([c(cc.Label)],e.prototype,"mTotalLbl",void 0),i([c(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([c(cc.Node)],e.prototype,"mExploringHint",void 0),i([c(cc.ProgressBar)],e.prototype,"mPb",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Proxy/ProxyExplore":"ProxyExplore"}],ExploreWin:[function(t,e,o){"use strict";cc._RF.push(e,"36a0dD5hH1KV4ffTN/6hxzc","ExploreWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ExploreItem"),l=t("../../Manager/WinMgr"),m=t("../../Manager/BCMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemArr=[],e.mBtnSFArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].SetData(e+1,this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].RefreshState()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),m.default.Subscribe(p.BCType.UpdateExploreTime,this._OnMsg_UpadteTime,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),m.default.Remove(p.BCType.UpdateExploreTime,this._OnMsg_UpadteTime,this)},e.prototype._OnMsg_UpadteTime=function(t,e){this.mItemArr[t].UpdateTime(e)},e.prototype.Invoke_Back=function(){u.default.PlayBtnSound(),this.CloseWin(),l.default.Ins.Open(p.WinType.ChallengeWin,null,!0)},i([f([s.default])],e.prototype,"mItemArr",void 0),i([f([cc.SpriteFrame])],e.prototype,"mBtnSFArr",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr","../Comp/ExploreItem":"ExploreItem","./WinBase":"WinBase"}],FightFailWin:[function(t,e,o){"use strict";cc._RF.push(e,"4db5fnWJxhK0795B0kBjwNg","FightFailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/UserMgr"),l=t("../../Manager/AudioMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOKBtn=null,e}return r(e,t),e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this);var o=!0;s.default.Ins.ClientInfo.hasShownFailWin?this.mOKBtn.active=!1:(o=!1,this.mOKBtn.active=!0);var n=cc.tween;this.mTweenAnimRoot.opacity=0,this.mTweenAnimRoot.position=cc.v3(0,-280,0),o?n(this.mTweenAnimRoot).parallel(n().to(.3,{opacity:255}),n().to(.3,{position:cc.v3(0,-180,0)})).delay(2.5).parallel(n().to(.3,{opacity:0}),n().to(.3,{position:cc.v3(0,-280,0)})).call(function(){e.CloseWin()}).start():n(this.mTweenAnimRoot).parallel(n().to(.3,{opacity:255}),n().to(.3,{position:cc.v3(0,-180,0)})).start()},e.prototype.Invoke_OK=function(){l.default.PlayBtnSound(),this.CloseWin(),s.default.Ins.ClientInfo.hasShownFailWin=!0,s.default.Ins.Save()},i([p(cc.Node)],e.prototype,"mOKBtn",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","./WinBase":"WinBase"}],FightItemUI:[function(t,e,o){"use strict";cc._RF.push(e,"08735EwoaBO8q0ynKCZA0oW","FightItemUI");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySpeed"),s=t("../../Proxy/ProxyCrystal"),l=t("../../Platform/PlatformBase"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/ResMgr"),c=t("../../Manager/RedPointMgr"),d=t("../../Manager/FuncMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGetSFArr=[],e.mSpdItem=null,e.mSpdPb=null,e.mSpdGetTypeSp=null,e.mSpdLeftTimeLbl=null,e.mSpdLeftNumLbl=null,e.mMultipleItem=null,e.mMultiplePb=null,e.mMulGetTypeSp=null,e.mMultipleLeftTimeLbl=null,e.mMultipleLeftNumLbl=null,e.mSk=null,e.mCurGetType=y.GetRewardsType.AD,e.mIsAdded=!1,e}return r(e,t),e.prototype.OnFirstOpen=function(){d.default.IsUnlock(d.FuncType.LotteryBox)?(this.mMultipleItem.active=!0,this.mSpdItem.active=!0):(this.mMultipleItem.active=!1,this.mSpdItem.active=!1),this._InitMultipleUI(),this._InitSpeedUI(),this.mSk.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype.OnUnlock=function(){this.mMultipleItem.active=!0,this.mSpdItem.active=!0,this._InitSpeedUI(),this._InitMultipleUI()},e.prototype._InitSpeedUI=function(){a.default.Ins.mIsUsingSpeedItem?(this.mSpdPb.node.active=!0,this.mSpdLeftTimeLbl.string=g.default.FormatTimeWithSeconds(a.default.Ins.mSpeedTiming),this.mSpdPb.progress=a.default.Ins.mSpeedTiming/a.default.Ins.mCurMaxTime):(this.mSpdLeftTimeLbl.string="",this.mSpdPb.node.active=!1),this._UpdateSpdItemNum()},e.prototype._UpdateSpdItemNum=function(){var t=u.default.Ins.GetItemNum(y.ItemType.SpeedUp2);t>0?(this.mSpdLeftNumLbl.string=t+"",this.mSpdGetTypeSp.node.opacity=0):(this.mSpdLeftNumLbl.string="",this.mSpdGetTypeSp.node.opacity=255)},e.prototype._InitMultipleUI=function(){s.default.Ins.mIsUsingItem?(this.mMultiplePb.node.active=!0,this.mMultipleLeftTimeLbl.string=g.default.FormatTimeWithSeconds(s.default.Ins.mSpeedTiming),this.mMultiplePb.progress=s.default.Ins.mSpeedTiming/s.default.Ins.mCurMaxTime):(this.mMultipleLeftTimeLbl.string="",this.mMultiplePb.node.active=!1),this._UpdateMultipleItemNum()},e.prototype._UpdateMultipleItemNum=function(){var t=u.default.Ins.GetItemNum(y.ItemType.MultipleCrystal);t>0?(this.mMultipleLeftNumLbl.string=t+"",this.mMulGetTypeSp.node.opacity=0):(this.mMultipleLeftNumLbl.string="",this.mMulGetTypeSp.node.opacity=255)},e.prototype.Subscribe=function(){this.mIsAdded||(this.mIsAdded=!0,f.default.Subscribe(y.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this)),f.default.Subscribe(y.BCType.MainWin_UseSpeedItem,this._OnMsg_UseSpedItem,this),f.default.Subscribe(y.BCType.GameSpeed_UpdateTime,this._OnMsg_UpdateSpdTime,this),f.default.Subscribe(y.BCType.MainWin_UseMultipleItem,this._OnMsg_UseMultipleItem,this),f.default.Subscribe(y.BCType.MultipleCrystal_UpdateTime,this._OnMsg_UpdateTime,this),f.default.Subscribe(y.BCType.GameSpeed_OnInit,this._OnMsg_InitGameSpeedUI,this)},e.prototype.Remove=function(){f.default.Remove(y.BCType.MainWin_UseSpeedItem,this._OnMsg_UseSpedItem,this),f.default.Remove(y.BCType.GameSpeed_UpdateTime,this._OnMsg_UpdateSpdTime,this),f.default.Remove(y.BCType.MainWin_UseMultipleItem,this._OnMsg_UseMultipleItem,this),f.default.Remove(y.BCType.MultipleCrystal_UpdateTime,this._OnMsg_UpdateTime,this),f.default.Remove(y.BCType.GameSpeed_OnInit,this._OnMsg_InitGameSpeedUI,this)},e.prototype._PlayAnim=function(t){if(this.mSk.node.opacity=255,null===this.mSk.skeletonData){var e=this;p.default.Ins.LoadSpine("spine/jiasu",function(o){e.mSk.skeletonData=o,e.mSk.setAnimation(0,t,!1)})}else this.mSk.setAnimation(0,t,!1)},e.prototype._OnAnimCompleted=function(){this.mSk.node.opacity=0},e.prototype._OnMsg_UseSpedItem=function(){this._PlayAnim("tuiguansudu"),this.mSpdPb.node.active=!0,this.mSpdLeftTimeLbl.string=g.default.FormatTimeWithSeconds(a.default.Ins.mSpeedTiming),this.mSpdPb.progress=a.default.Ins.mSpeedTiming/a.default.Ins.mCurMaxTime},e.prototype._OnMsg_UpdateSpdTime=function(t){t<=0?(this.mSpdLeftTimeLbl.string="",this.mSpdPb.node.active=!1):(this.mSpdLeftTimeLbl.string=g.default.FormatTimeWithSeconds(t),this.mSpdPb.progress=a.default.Ins.mSpeedTiming/a.default.Ins.mCurMaxTime)},e.prototype._OnMsg_UseMultipleItem=function(){this._PlayAnim("shuijingdiaoluo"),this.mMultiplePb.node.active=!0,this.mMultipleLeftTimeLbl.string=g.default.FormatTimeWithSeconds(s.default.Ins.mSpeedTiming),this.mMultiplePb.progress=s.default.Ins.mSpeedTiming/s.default.Ins.mCurMaxTime},e.prototype._OnMsg_UpdateTime=function(t){t<=0?(this.mMultipleLeftTimeLbl.string="",this.mMultiplePb.node.active=!1):(this.mMultipleLeftTimeLbl.string=g.default.FormatTimeWithSeconds(t),this.mMultiplePb.progress=s.default.Ins.mSpeedTiming/s.default.Ins.mCurMaxTime)},e.prototype._OnMsg_UpdateItem=function(t){t===y.ItemType.MultipleCrystal?(c.default.SetInvokeData(c.RedPointType.MainMultiple,u.default.Ins.GetItemNum(y.ItemType.MultipleCrystal)),this._UpdateMultipleItemNum()):t===y.ItemType.SpeedUp2&&(c.default.SetInvokeData(c.RedPointType.MainSpeed,u.default.Ins.GetItemNum(y.ItemType.SpeedUp2)),this._UpdateSpdItemNum())},e.prototype._OnMsg_InitGameSpeedUI=function(){this._InitSpeedUI()},e.prototype.Invoke_SpeedUp=function(){h.default.PlayBtnSound();var t=u.default.Ins.GetItemNum(y.ItemType.SpeedUp2);t>0?(u.default.Ins.UpdateItem(y.ItemType.SpeedUp2,-1),u.default.Ins.Save(),a.default.Ins.UseSpeedItem(),c.default.SetInvokeData(c.RedPointType.MainSpeed,t-1),this._UpdateSpdItemNum()):g.default.WatchADForRewards(this._SpeedUp.bind(this),l.ADUnitID.CommonVideoID_30,y.ADPoint.SpeedUp,this.mCurGetType)},e.prototype._SpeedUp=function(t){void 0===t&&(t=!0),t&&(u.default.Ins.GetADExtraRewards(),m.default.Ins.Open(y.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"1")})),a.default.Ins.UseSpeedItem()},e.prototype.Invoke_ClickMultipleItem=function(){h.default.PlayBtnSound();var t=u.default.Ins.GetItemNum(y.ItemType.MultipleCrystal);t>0?(u.default.Ins.UpdateItem(y.ItemType.MultipleCrystal,-1),u.default.Ins.Save(),s.default.Ins.UseMultipleItem(),c.default.SetInvokeData(c.RedPointType.MainMultiple,t-1),this._UpdateMultipleItemNum()):g.default.WatchADForRewards(this._MultipleADCallback.bind(this),l.ADUnitID.CommonVideoID_30,y.ADPoint.MultipleCrystal,this.mCurGetType)},e.prototype._MultipleADCallback=function(t){t&&(u.default.Ins.GetADExtraRewards(),m.default.Ins.Open(y.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"1")})),s.default.Ins.UseMultipleItem()},i([_([cc.SpriteFrame])],e.prototype,"mGetSFArr",void 0),i([_(cc.Node)],e.prototype,"mSpdItem",void 0),i([_(cc.ProgressBar)],e.prototype,"mSpdPb",void 0),i([_(cc.Sprite)],e.prototype,"mSpdGetTypeSp",void 0),i([_(cc.Label)],e.prototype,"mSpdLeftTimeLbl",void 0),i([_(cc.Label)],e.prototype,"mSpdLeftNumLbl",void 0),i([_(cc.Node)],e.prototype,"mMultipleItem",void 0),i([_(cc.ProgressBar)],e.prototype,"mMultiplePb",void 0),i([_(cc.Sprite)],e.prototype,"mMulGetTypeSp",void 0),i([_(cc.Label)],e.prototype,"mMultipleLeftTimeLbl",void 0),i([_(cc.Label)],e.prototype,"mMultipleLeftNumLbl",void 0),i([_(sp.Skeleton)],e.prototype,"mSk",void 0),i([S],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/RedPointMgr":"RedPointMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxySpeed":"ProxySpeed"}],FightMgr:[function(t,e,o){"use strict";cc._RF.push(e,"b7ed7VtLJdP/pQ+iOAC10+k","FightMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./UserMgr"),r=t("../Proxy/ProxyHero"),i=t("../Common/EnumsDefine"),a=t("../Battle/FightMode/FightModeNormal"),s=t("../Battle/FightMode/FightModeImtBoss"),l=t("../Battle/AI/FightState"),m=function(){function t(){this.mCounterFactorArr=[[1,4,.5],[.5,1,4],[4,.5,1]],this.mCounterRelationship=[[0,1,-1],[-1,0,1],[1,-1,0]],this.mLoopMapIDArr=[1,101,102,103,104],this.mInterval=50}return Object.defineProperty(t,"Ins",{get:function(){return null==t.m_Ins&&(t.m_Ins=new t),t.m_Ins},enumerable:!1,configurable:!0}),t.prototype.CreateFightMode=function(e){switch(e){case i.FightModeType.Normal:t.mNormalFightMode=new a.default,t.mCurFightMode=t.mNormalFightMode;break;case i.FightModeType.ImtBoss:t.mImtBossFightMode=new s.default,t.mCurFightMode=t.mImtBossFightMode}return t.mCurFightMode.InitOnce(),t.mCurFightMode},t.prototype.OnUpdate=function(e){null!==t.mCurFightMode&&t.mCurFightMode.OnUpdate(e)},t.prototype.ChangeFightMode=function(e,o){return null!==t.mCurFightMode&&t.mCurFightMode.ChangeState(l.FightStateType.End),t.mCurFightMode=this._GetFightMode(e),t.mCurFightMode.SetData(o),t.mCurFightMode.ChangeState(l.FightStateType.Ready),t.mCurFightMode.OnModeChanged(),t.mCurFightMode},t.prototype._GetFightMode=function(e){switch(e){case i.FightModeType.Normal:return null!==t.mNormalFightMode?t.mNormalFightMode:this.CreateFightMode(e);case i.FightModeType.ImtBoss:return null!==t.mImtBossFightMode?t.mImtBossFightMode:this.CreateFightMode(e)}},t.prototype.UpdateAllHeroAttr=function(){for(var t=r.default.Ins.mHeroInfo.heroTeam,e=0,o=t.length;e<o;++e)0!==t[e]&&this.UpdateHeroAttr(t[e])},t.prototype.UpdateHeroAttr=function(e){t.mCurFightMode.UpdateHeroAttr(e)},t.prototype.GetCounterFactor=function(t,e){return t===i.CounterType.None||e===i.CounterType.None?1:this.mCounterFactorArr[t][e]},t.prototype.GetCounterRelationship=function(t,e){return t===i.CounterType.None||e===i.CounterType.None?0:this.mCounterRelationship[t][e]},t.prototype.GetMapIDByCurLevel=function(){var t=n.default.Ins.ClientInfo.curLevel;if(t<=5)return 1;if(5<t&&t<=25)return 101;if(25<t&&t<=50)return 102;if(50<t&&t<=75)return 103;if(75<t&&t<=100)return 104;var e=Math.floor((t-100-1)/this.mInterval),o=Math.floor(e%this.mLoopMapIDArr.length);return this.mLoopMapIDArr[o]},t.m_Ins=null,t.mNormalFightMode=null,t.mImtBossFightMode=null,t.mCurFightMode=null,t.mCurFightingLevel=0,t.mBossLevelInterval=50,t.mEliteLevelInterval=10,t}();o.default=m,cc._RF.pop()},{"../Battle/AI/FightState":"FightState","../Battle/FightMode/FightModeImtBoss":"FightModeImtBoss","../Battle/FightMode/FightModeNormal":"FightModeNormal","../Common/EnumsDefine":"EnumsDefine","../Proxy/ProxyHero":"ProxyHero","./UserMgr":"UserMgr"}],FightModeBase:[function(t,e,o){"use strict";cc._RF.push(e,"8eec5ZuDiVCW7Mx7lDsR8oO","FightModeBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../AI/FightState"),r=t("../../Proxy/ProxyLargeNum"),i=t("../../Manager/PoolMgr"),a=t("../../Common/EnumsDefine"),s=function(){function t(){this.mEfxArr=new Array,this.mHeroArr=new Array,this.mEnemyArr=new Array,this.mImtSkillArr=new Array,this.mBulletArr=new Array,this.m_StateMachine=null}return Object.defineProperty(t.prototype,"CurFightModeType",{get:function(){return a.FightModeType.None},enumerable:!1,configurable:!0}),t.prototype.InitOnce=function(){this.m_StateMachine=new n.FightStateMachine(this)},t.prototype.SetData=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.OnUpdate=function(t){if(0!==this.mHeroArr.length)for(var e=this.mHeroArr.length-1;e>=0;--e)this.mHeroArr[e].OnUpdate(t);if(0!==this.mEnemyArr.length)for(e=this.mEnemyArr.length-1;e>=0;--e)this.mEnemyArr[e].OnUpdate(t);if(0!==this.mEfxArr.length)for(e=this.mEfxArr.length-1;e>=0;--e)this.mEfxArr[e].OnUpdate(t);if(0!==this.mBulletArr.length)for(e=this.mBulletArr.length-1;e>=0;--e)this.mBulletArr[e].OnUpdate(t)},t.prototype.UpdateGameSpeed=function(){for(var t=this.mHeroArr.length-1;t>=0;--t)this.mHeroArr[t].UpdateGameSpeed();for(t=this.mEnemyArr.length-1;t>=0;--t)this.mEnemyArr[t].UpdateGameSpeed();for(t=this.mImtSkillArr.length-1;t>=0;--t)this.mImtSkillArr[t].UpdateGameSpeed();for(t=this.mEfxArr.length-1;t>=0;--t)this.mEfxArr[t].UpdateGameSpeed()},t.prototype.AddHero=function(t){this.mHeroArr.push(t)},t.prototype.RemoveHero=function(t){var e=this.mHeroArr.indexOf(t);-1!==e&&this.mHeroArr.splice(e,1)},t.prototype.AddEnemy=function(t){this.mEnemyArr.push(t)},t.prototype.RemoveEnemy=function(t){var e=this.mEnemyArr.indexOf(t);-1!==e&&this.mEnemyArr.splice(e,1)},t.prototype.AddImtSkill=function(t){this.mImtSkillArr.push(t)},t.prototype.RemoveImtSkill=function(t){var e=this.mImtSkillArr.indexOf(t);-1!==e&&this.mImtSkillArr.splice(e,1)},t.prototype.AddEfx=function(t){this.mEfxArr.push(t)},t.prototype.RemoveEfx=function(t){var e=this.mEfxArr.indexOf(t);-1!==e&&this.mEfxArr.splice(e,1)},t.prototype.AddBullet=function(t){this.mBulletArr.push(t)},t.prototype.RemoveBullet=function(t){var e=this.mBulletArr.indexOf(t);-1!==e&&this.mBulletArr.splice(e,1)},t.prototype.OnCrystalDestroyed=function(t){t===a.CrystalType.Enemy?this.ChangeState(n.FightStateType.Win):this.ChangeState(n.FightStateType.Lose)},t.prototype.PutHeroOff=function(){},t.prototype.PutHeroOn=function(){},t.prototype.FindHeroByID=function(t){for(var e=0,o=this.mHeroArr.length;e<o;++e)if(this.mHeroArr[e].mEntityID===t)return this.mHeroArr[e];return null},t.prototype.GetHeroAtk=function(){return null},t.prototype.GetHeroHP=function(){return null},t.prototype.GetHeroDefend=function(){return null},t.prototype.UpdateHeroAttr=function(){},t.prototype.GetMaxHeroAtk=function(){for(var t=new r.LargeNumber(0,0),e=0;e<this.mHeroArr.length;++e)-1===t.Compare(this.mHeroArr[e].mEntityAttr.mAttack)&&(t=this.mHeroArr[e].mEntityAttr.mAttack);return t},t.prototype.EquipSkin=function(t,e){var o=this.FindHeroByID(t);null!==o&&o.EquipSkin(e)},t.prototype.OnModeChanged=function(){},t.prototype.ChangeState=function(t){this.m_StateMachine.ChangeState(t)},t.prototype.ReadyState_OnEnter=function(){},t.prototype.FightingState_OnEnter=function(){},t.prototype.FightingState_OnUpdate=function(){},t.prototype.WinState_OnEnter=function(){},t.prototype.LoseState_OnEnter=function(){},t.prototype.EndState_OnEnter=function(){this._ClearFight()},t.prototype._ClearArr=function(t){for(var e=t.length-1;e>=0;--e)i.default.Ins.Return(t[e]);t.splice(0,t.length)},t.prototype._ClearFight=function(){this._ClearArr(this.mHeroArr),this._ClearArr(this.mEnemyArr),this._ClearArr(this.mImtSkillArr),this._ClearArr(this.mEfxArr),this._ClearArr(this.mBulletArr)},t}();o.default=s,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/PoolMgr":"PoolMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../AI/FightState":"FightState"}],FightModeImtBoss:[function(t,e,o){"use strict";cc._RF.push(e,"125721v/YNO07kbRGxVPkcG","FightModeImtBoss");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./ImtBossLevelController"),a=t("./HeroSpawnController"),s=t("./FightModeBase"),l=t("../AI/FightState"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Proxy/ProxyImtSkill"),p=t("../../Proxy/ProxyImtBoss"),c=t("../../Proxy/ProxyHero"),d=t("../../Proxy/ProxyCrystal"),f=t("../../Platform/PlatformBase"),h=t("../../Manager/WinMgr"),y=t("../../Manager/UserMgr"),g=t("../../Manager/PoolMgr"),I=t("../../Manager/PlatformMgr"),S=t("../../Manager/ImtBossDmgMgr"),_=t("../../Manager/FightMgr"),v=t("../../Manager/DataMgr"),C=t("../../Manager/BCMgr"),M=t("../../MainGame"),P=t("../../Common/EnumsDefine"),T=function(t){function e(){var e=t.call(this)||this;return e.mCurBossID=1,e.mCurLevelID=1,e.mBossIDArr=[30001,30002,30003,30004],e.mMapIDArr=[101,102,103,104],e.mHeroSapwnController=null,e.mLevelController=null,e.mCrystalID=10001,e.mCrystalData=null,e.mLeftFightTime=100,e.mHasHandled=!1,e.mUpdateInternal=1,e.mTiming=e.mUpdateInternal,e}return r(e,t),Object.defineProperty(e.prototype,"CurFightModeType",{get:function(){return P.FightModeType.ImtBoss},enumerable:!1,configurable:!0}),e.prototype.InitOnce=function(){t.prototype.InitOnce.call(this),this.mHeroSapwnController=new a.default(this),this.mLevelController=new i.default(this),null===this.mCrystalData&&(this.mCrystalData=v.default.Ins.m_DB.entityDB[this.mCrystalID])},e.prototype.SetData=function(t){this.mCurBossID=t.bossID,this.mCurLevelID=t.levelID,this.mLevelController.InitData(this.mCurBossID,this.mCurLevelID),this._InitCrystal(),C.default.Dispatch(P.BCType.BattleWin_ChangeMap,this.mMapIDArr[this.mCurBossID-1]),M.default.mBattleCam.Reset()},e.prototype.OnUpdate=function(e){t.prototype.OnUpdate.call(this,e),null!==this.mHeroSapwnController&&this.mHeroSapwnController.OnUpdate(e),null!==this.mLevelController&&this.mLevelController.OnUpdate(e),this.m_StateMachine.OnUpdate(e)},e.prototype._InitCrystal=function(){var t=this;g.default.Ins.Borrow(g.default.CRYSTAL,"Crystal",function(e){var o=e;o.Init(t.mCrystalID,t.mCrystalData,t),o.SetData(P.CrystalType.Hero),o.node.opacity=255,C.default.Dispatch(P.BCType.BattleWin_AddCrystal,e,0),_.default.mCurFightMode.AddHero(e)})},e.prototype.GetHeroAtk=function(t){return c.default.Ins.GetHeroAtk(t,!1)},e.prototype.GetHeroHP=function(t){return c.default.Ins.GetHeroHP(t,!1)},e.prototype.GetHeroDefend=function(t){return c.default.Ins.GetHeroDef(t,!1)},e.prototype.GetEnemyAtk=function(t){var e=v.default.Ins.m_DB.entityDB[t],o=v.default.Ins.m_DB.imtBossLevelDB[this.mCurLevelID],n=m.default.Pow(c.default.LV_FACTOR,o.recLv);return n.MultiplySelfSingle(e.attack),n},e.prototype.GetEnemyHP=function(t){var e=v.default.Ins.m_DB.entityDB[t],o=v.default.Ins.m_DB.imtBossLevelDB[this.mCurLevelID],n=m.default.Pow(c.default.LV_FACTOR,o.recLv);return n.MultiplySelfSingle(e.hp),n},e.prototype.GetEnemyDefend=function(t){var e=v.default.Ins.m_DB.entityDB[t],o=v.default.Ins.m_DB.imtBossLevelDB[this.mCurLevelID],n=m.default.Pow(c.default.LV_FACTOR,o.recLv);return n.MultiplySelfSingle(e.defend),n},e.prototype.BackToNormalMode=function(t){void 0===t&&(t=!1),this.mHasHandled&&!t||(this.mHasHandled=!0,C.default.Dispatch(P.BCType.MainWin_Transition1,function(){_.default.Ins.ChangeFightMode(P.FightModeType.Normal,y.default.Ins.ClientInfo.curLevel),M.default.mBattleCam.Reset(),C.default.Dispatch(P.BCType.BattleWin_ChangeMap,_.default.Ins.GetMapIDByCurLevel())}),h.default.Ins.Close(P.WinType.ImtBossFightWin),h.default.Ins.Open(P.WinType.MainWin,null),C.default.Dispatch(P.BCType.ImtBoss_UpdateLevelItem))},e.prototype.OnModeChanged=function(){d.default.Ins.SetItemState(!0)},e.prototype.ReadyState_OnEnter=function(){this.m_StateMachine.ChangeState(l.FightStateType.Fighting),this.mHasHandled=!1;var t=this.GetEnemyHP(this.mBossIDArr[this.mCurBossID-1]);S.default.Ins.StartStat(t),C.default.Dispatch(P.BCType.BattleWin_HideBattleBox)},e.prototype.FightingState_OnEnter=function(){this.mHeroSapwnController.StartSpawnHero(),this.mLevelController.StartSpawn(),this.mLeftFightTime=p.default.Ins.mFightTime,u.default.Ins.ResumeImtSkill()},e.prototype.FightingState_OnUpdate=function(t){this.mTiming-=t,this.mTiming<=0&&(this.mTiming=this.mUpdateInternal,this.mLeftFightTime-=this.mUpdateInternal,C.default.Dispatch(P.BCType.ImtBoss_UpdateFightTime,this.mLeftFightTime),this.mLeftFightTime<=0&&this.ChangeState(l.FightStateType.Lose))},e.prototype.WinState_OnEnter=function(){if(t.prototype.WinState_OnEnter.call(this),!this.mHasHandled){this.mHasHandled=!0;var e=p.default.Ins.PassLevel(this.mCurBossID,this.mCurLevelID),o=this;h.default.Ins.Open(P.WinType.ImtBossVictoryWin,function(t){t.SetData(function(){o.BackToNormalMode(!0),Math.random()<=.5&&I.default.mCurPlf.ShowInterstitial(f.ADUnitID.Interstitial_Func_ID,P.InsPoint.ImtBossVictoryBack)},o.mCurBossID,o.mCurLevelID,e)})}},e.prototype.LoseState_OnEnter=function(){this._ClearFight(),h.default.Ins.Open(P.WinType.ImtBossFailWin,null)},e.prototype.EndState_OnEnter=function(){t.prototype.EndState_OnEnter.call(this),this.mHeroSapwnController.StopSpawn()},e}(s.default);o.default=T,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/ImtBossDmgMgr":"ImtBossDmgMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../../Proxy/ProxyImtSkill":"ProxyImtSkill","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../AI/FightState":"FightState","./FightModeBase":"FightModeBase","./HeroSpawnController":"HeroSpawnController","./ImtBossLevelController":"ImtBossLevelController"}],FightModeNormal:[function(t,e,o){"use strict";cc._RF.push(e,"b0838Agj7NIELsqB6APVWK/","FightModeNormal");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./LevelController"),a=t("./HeroSpawnController"),s=t("./FightModeBase"),l=t("../AI/FightState"),m=t("../../Proxy/ProxySpeed"),u=t("../../Proxy/ProxyOffice"),p=t("../../Proxy/ProxyMainTask2"),c=t("../../Proxy/ProxyLargeNum"),d=t("../../Proxy/ProxyImmortal"),f=t("../../Proxy/ProxyHeroMap"),h=t("../../Proxy/ProxyHero"),y=t("../../Proxy/ProxyForge"),g=t("../../Proxy/ProxyCrystal"),I=t("../../Proxy/ProxyBackCity"),S=t("../../Manager/WinMgr"),_=t("../../Manager/UserMgr"),v=t("../../Manager/PoolMgr"),C=t("../../Manager/PlatformMgr"),M=t("../../Manager/FightMgr"),P=t("../../Manager/DataMgr"),T=t("../../Manager/BCMgr"),D=t("../../MainGame"),A=t("../../Common/SwitchConfig"),O=t("../../Common/GameRunningData"),k=t("../../Common/EnumsDefine"),B=function(t){function e(){var e=t.call(this)||this;return e.mLevelNum=1,e.mBossIDArr=[30004,30002,30001,30003],e.mEliteIDArr=[6002,6001,5003,6001,0,6002],e.mHeroSapwnController=null,e.mLevelController=null,e.mCrystalID=10001,e.mCrystalData=null,e}return r(e,t),Object.defineProperty(e.prototype,"CurFightModeType",{get:function(){return k.FightModeType.Normal},enumerable:!1,configurable:!0}),e.prototype.InitOnce=function(){t.prototype.InitOnce.call(this),this.mHeroSapwnController=new a.default(this),this.mLevelController=new i.default(this),null===this.mCrystalData&&(this.mCrystalData=P.default.Ins.m_DB.entityDB[this.mCrystalID])},e.prototype._InitCrystal=function(){var t=this,e=this;v.default.Ins.Borrow(v.default.CRYSTAL,"Crystal",function(o){var n=o;n.Init(t.mCrystalID,t.mCrystalData,t),n.SetData(k.CrystalType.Hero),0===e.mLevelNum?n.node.opacity=0:n.node.opacity=255,T.default.Dispatch(k.BCType.BattleWin_AddCrystal,o,0),M.default.mCurFightMode.AddHero(o)}),this.IsBossLevel()||v.default.Ins.Borrow(v.default.CRYSTAL,"Crystal",function(e){var o=e;o.Init(t.mCrystalID,t.mCrystalData,t),o.SetData(k.CrystalType.Enemy),o.node.opacity=255,T.default.Dispatch(k.BCType.BattleWin_AddCrystal,e,1),M.default.mCurFightMode.AddEnemy(e)})},e.prototype.IsBossLevel=function(){return 0!==this.mLevelNum&&this.mLevelNum%50==0},e.prototype.IsEliteLevel=function(){return!this.IsBossLevel()&&0!==this.mLevelNum&&this.mLevelNum%M.default.mEliteLevelInterval==0},e.prototype.GetBossID=function(){var t=this.mBossIDArr.length,e=this.mLevelNum%(100*t);return e/=50,--e<0&&(e+=2*t),e=Math.floor(e/2),this.mBossIDArr[e]},e.prototype.GetEliteID=function(){var t=this.mEliteIDArr.length,e=this.mLevelNum/M.default.mEliteLevelInterval;return e%=t+1,--e<0&&(e=0),this.mEliteIDArr[e]},e.prototype.GetLimitDmgCampType=function(t){if(t<=P.default.Ins.mNoLimitCampLevelNum)return k.CampType.None;if(t%100==0){var e=(t-P.default.Ins.mNoLimitCampLevelNum)%P.default.Ins.mNoLimitCampLevelNum/100;return--e<0&&(e+=4),e}return k.CampType.None},e.prototype.GetCounterType=function(){var t=this.mLevelNum%150;return 0===t?k.CounterType.Paper:1<=t&&t<=50?k.CounterType.Rock:51<=t&&t<=100?k.CounterType.Scissor:k.CounterType.Paper},e.prototype.SetData=function(t){this.mLevelNum=t,this.mLevelController.Init(t),this._InitCrystal(),M.default.mCurFightingLevel=this.mLevelNum},e.prototype.OnUpdate=function(e){t.prototype.OnUpdate.call(this,e),0!==this.mLevelNum&&(null!==this.mHeroSapwnController&&this.mHeroSapwnController.OnUpdate(e),null!==this.mLevelController&&this.mLevelController.OnUpdate(e))},e.prototype.ChangeToLevel=function(t,e){void 0===e&&(e=null),_.default.Ins.ClientInfo.curLevel=t,_.default.Ins.ClientInfo.bestLevel<t&&(_.default.Ins.ClientInfo.bestLevel=t,T.default.Dispatch(k.BCType.Fight_PassBestLevel)),_.default.Ins.Save(),this._ClearFight();var o=this;T.default.Dispatch(k.BCType.MainWin_Transition1,function(){o._ResetFight(),null!==e&&e()}),T.default.Dispatch(k.BCType.Fight_ChangeLevel),T.default.Dispatch(k.BCType.BattleWin_ChangeMap,M.default.Ins.GetMapIDByCurLevel())},e.prototype._GetSkillLevelRate=function(){return.01*d.default.Ins.GetAttrValue(k.ImtAttrType.SkipLevel)},e.prototype._ChangeDeltaLevel=function(t){var e=_.default.Ins.ClientInfo.curLevel,o=e+t;if(t<0&&(e-1)%P.default.Ins.mBossLevelInterval==0&&(o=e),o<1&&(o=1),t>0&&o<_.default.Ins.ClientInfo.bestLevel&&o%P.default.Ins.mBossLevelInterval!=0&&Math.random()<=this._GetSkillLevelRate()&&(o++,S.default.Ins.ShowTips("\u7a7f\u8d8a\u65f6\u7a7a\u96a7\u9053\uff0c\u5173\u5361\u6570+2")),_.default.Ins.ClientInfo.curLevel=o,p.default.Ins.CheckPassCurLevel(),p.default.Ins.CheckBackCity(),_.default.Ins.ClientInfo.bestLevel<o){_.default.Ins.ClientInfo.bestLevel=o,y.default.Ins.CheckUnlock(),u.default.Ins.CheckCanUpgrade(),f.default.Ins.CheckOnPassBestLevel(),T.default.Dispatch(k.BCType.Fight_PassBestLevel);var n=_.default.Ins.ClientInfo.bestLevel;n%5==0&&C.default.ReportEvent(k.BIPoint.Reached_Best_Level,{level:n}),9===_.default.Ins.ClientInfo.bestLevel&&C.default.mCurPlf.ReportHuoShanEvent(k.HuoShanEventType.EndGuide),C.default.mCurPlf.ReportHuoShanEvent(k.HuoShanEventType.EnterLevel,{level:_.default.Ins.ClientInfo.bestLevel})}_.default.Ins.Save(),this._ClearFight();var r=this;T.default.Dispatch(k.BCType.MainWin_Transition1,function(){r._ResetFight()}),T.default.Dispatch(k.BCType.Fight_ChangeLevel),T.default.Dispatch(k.BCType.BattleWin_ChangeMap,M.default.Ins.GetMapIDByCurLevel()),m.default.Ins.SpecialUpdateSpeed(),I.default.Ins.mBackSaveInfo.backTimes>=1&&t>0&&(O.default.Ins.mPassFailCount=0,O.default.Ins.mPassLevelCount++,O.default.Ins.mPassLevelCount>=10&&(C.default.mCurPlf.ShowIOSFullAD(),O.default.Ins.mPassLevelCount=0))},e.prototype._ResetFight=function(){D.default.mBattleCam.Reset(),this.SetData(_.default.Ins.ClientInfo.curLevel),this.ChangeState(l.FightStateType.Ready)},e.prototype.BackCity=function(){this._ClearFight();var t=this;T.default.Dispatch(k.BCType.MainWin_Transition1,function(){t._ResetFight()}),T.default.Dispatch(k.BCType.Fight_ChangeLevel),T.default.Dispatch(k.BCType.BattleWin_ChangeMap,M.default.Ins.GetMapIDByCurLevel())},e.prototype.PutHeroOff=function(t){this.mHeroSapwnController.PutHeroOff(t);var e=this.FindHeroByID(t);null!==e&&(e.PutOffTeam(),e.node.x=-1e3,this.RemoveHero(e),D.default.mBattleCam.CheckUpdateTarget())},e.prototype.PutHeroOn=function(t){this.mHeroSapwnController.PutHeroOn(t)},e.prototype.GetHeroAtk=function(t){return h.default.Ins.GetHeroAtk(t)},e.prototype.GetHeroHP=function(t){return h.default.Ins.GetHeroHP(t)},e.prototype.GetHeroDefend=function(t){return h.default.Ins.GetHeroDef(t)},e.prototype.UpdateHeroAttr=function(t){var e=this.FindHeroByID(t);null!==e&&e.UpdateEntityAttr()},e.prototype.AddPassiveSkill=function(t){var e=this.FindHeroByID(t);null!==e&&e.AddPassiveSkill()},e.prototype.GetEnemyAtk=function(t,e){var o=P.default.Ins.m_DB.entityDB[t],n=c.default.Pow(h.default.LV_FACTOR,e);return n.MultiplySelfSingle(o.attack),n},e.prototype.GetEnemyHP=function(t,e){var o=P.default.Ins.m_DB.entityDB[t],n=c.default.Pow(h.default.LV_FACTOR,e);return n.MultiplySelfSingle(o.hp),n},e.prototype.GetEnemyDefend=function(t,e){var o=P.default.Ins.m_DB.entityDB[t],n=c.default.Pow(h.default.LV_FACTOR,e);return n.MultiplySelfSingle(o.defend),n},e.prototype._GetEnemy=function(t){for(var e=0,o=this.mEnemyArr.length;e<o;++e)if(this.mEnemyArr[e].mEntityID===t)return this.mEnemyArr[e];return null},e.prototype.RevertCrystalAttr=function(){this._GetEnemy(this.mCrystalID).mEntityAttr.mDefend=this.GetEnemyDefend(this.mCrystalID,this.mLevelNum)},e.prototype.OnModeChanged=function(){g.default.Ins.SetItemState(!1)},e.prototype.ReadyState_OnEnter=function(){if(this.IsBossLevel())T.default.Dispatch(k.BCType.BattleWin_ShowBOSSAnim);else{var t=I.default.Ins.mBackSaveInfo;A.default.mGuideOpen&&0===t.backTimes&&this.mLevelNum,this.m_StateMachine.ChangeState(l.FightStateType.Fighting)}},e.prototype.FightingState_OnEnter=function(){this.mHeroSapwnController.StartSpawnHero(),this.mLevelController.StartSpawn()},e.prototype.WinState_OnEnter=function(){t.prototype.WinState_OnEnter.call(this),this._ChangeDeltaLevel(1)},e.prototype.LoseState_OnEnter=function(){this._ChangeDeltaLevel(-1),I.default.Ins.mBackSaveInfo.backTimes>=1&&S.default.Ins.Open(k.WinType.FightFailWin,null)},e.prototype.EndState_OnEnter=function(){t.prototype.EndState_OnEnter.call(this),this.mHeroSapwnController.StopSpawn()},e}(s.default);o.default=B,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Common/GameRunningData":"GameRunningData","../../Common/SwitchConfig":"SwitchConfig","../../MainGame":"MainGame","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyBackCity":"ProxyBackCity","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyHeroMap":"ProxyHeroMap","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../../Proxy/ProxyOffice":"ProxyOffice","../../Proxy/ProxySpeed":"ProxySpeed","../AI/FightState":"FightState","./FightModeBase":"FightModeBase","./HeroSpawnController":"HeroSpawnController","./LevelController":"LevelController"}],FightState:[function(t,e,o){"use strict";cc._RF.push(e,"02baeh9u4pCvYM6sWWK/iFQ","FightState");var n,r,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0}),o.FightStateMachine=o.FightStateEnd=o.FightStateLose=o.FightStateWin=o.FightStateFighting=o.FightStateReady=o.FightStateBase=o.FightStateType=void 0,function(t){t[t.None=-1]="None",t[t.Ready=0]="Ready",t[t.Fighting=1]="Fighting",t[t.Win=2]="Win",t[t.Lose=3]="Lose",t[t.End=4]="End"}(r=o.FightStateType||(o.FightStateType={}));var a=function(){function t(){}return t.prototype.GetFightStateType=function(){return r.None},t.prototype.OnEnter=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.OnUpdate=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.OnExit=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t}();o.FightStateBase=a;var s=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetFightStateType=function(){return r.Ready},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.ReadyState_OnEnter()},e}(a);o.FightStateReady=s;var l=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetFightStateType=function(){return r.Fighting},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.FightingState_OnEnter()},e.prototype.OnUpdate=function(t,e){t.FightingState_OnUpdate(e)},e}(a);o.FightStateFighting=l;var m=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetFightStateType=function(){return r.Win},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.WinState_OnEnter()},e}(a);o.FightStateWin=m;var u=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetFightStateType=function(){return r.Lose},e.prototype.OnEnter=function(e){t.prototype.OnEnter.call(this,e),e.LoseState_OnEnter()},e}(a);o.FightStateLose=u;var p=function(t){function e(){return t.call(this)||this}return i(e,t),e.prototype.GetFightStateType=function(){return r.End},e.prototype.OnEnter=function(t){t.EndState_OnEnter()},e}(a);o.FightStateEnd=p;var c=function(){function t(t){this.m_CurState=null,this.m_FightMode=null,this.m_PreviousState=null,this.m_FightMode=t}return t.prototype.OnUpdate=function(t){null!==this.m_CurState&&this.m_CurState.OnUpdate(this.m_FightMode,t)},t.prototype.ChangeState=function(t){this.m_PreviousState=this.m_CurState,null!==this.m_PreviousState&&this.m_PreviousState.OnExit(this.m_FightMode),this.m_CurState=this._GetState(t),this.m_CurState.OnEnter(this.m_FightMode)},t.prototype._GetState=function(e){switch(e){case r.Ready:return t.m_FightStateReady;case r.Fighting:return t.m_FightStateFighting;case r.Win:return t.m_FightStateWin;case r.Lose:return t.m_FightStateLose;case r.End:return t.m_FightStateEnd;default:return console.error("\u6ca1\u6709\u8be5\u7c7b\u578b\u7684\u6218\u6597\u72b6\u6001: "+e),null}},t.m_FightStateReady=new s,t.m_FightStateFighting=new l,t.m_FightStateWin=new m,t.m_FightStateLose=new u,t.m_FightStateEnd=new p,t}();o.FightStateMachine=c,cc._RF.pop()},{}],FloatItemMgr:[function(t,e,o){"use strict";cc._RF.push(e,"7d593y+XcNFGbOB9bxRMt6Y","FloatItemMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./WinMgr"),r=t("./PoolMgr"),i=function(){function t(){this.mItemArr=[],this.mEnable=!1,this.mTimeInterval=.45,this.mTiming=this.mTimeInterval,this.mInitPosY=0}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.Init=function(){this.mInitPosY=300},t.prototype.ShowItemArr=function(t){for(var e=0,o=t.length;e<o;++e)this.ShowItem(Number(t[e][0]),t[e][1])},t.prototype.ShowItem=function(e,o){var i=this;this.mEnable||(this.mTiming=0),r.default.Ins.Borrow(r.default.FLOAT_ITEM,"FloatItem",function(r){t.Ins.mItemArr.push(r);var a=r;a.SetData(e,o),a.node.parent=n.default.Ins.TopRoot,a.node.x=0,a.node.y=i.mInitPosY,i.mEnable=!0})},t.prototype._RealShowItem=function(){this.mItemArr.length>0&&(this.mItemArr.shift().Trigger(),0===this.mItemArr.length&&(this.mEnable=!1))},t.prototype.OnUpdate=function(t){this.mEnable&&(this.mTiming-=t,this.mTiming<=0&&(this.mTiming=this.mTimeInterval,this._RealShowItem()))},t.mIns=null,t}();o.default=i,cc._RF.pop()},{"./PoolMgr":"PoolMgr","./WinMgr":"WinMgr"}],FloatItem:[function(t,e,o){"use strict";cc._RF.push(e,"55c9fG02zZA6a/mBnXMwbU1","FloatItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Manager/PoolMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mOffset=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255,this.mOffset.y=0},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.SetData=function(t,e){this.mItem.SetData(t,e),this.mOffset.opacity=0},e.prototype.Trigger=function(){var t=this;this.mOffset.scale=0,this.mOffset.opacity=255;var e=cc.tween;e(this.mOffset).to(.15,{scale:1}).parallel(e().to(1,{position:cc.v3(0,200,0)}),e().delay(.7).to(.3,{opacity:0})).call(function(){s.default.Ins.Return(t)}).start()},i([u(a.default)],e.prototype,"mItem",void 0),i([u(cc.Node)],e.prototype,"mOffset",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr","./SimpleItem":"SimpleItem"}],FloatNum:[function(t,e,o){"use strict";cc._RF.push(e,"bde10kKRwNBu70EbJQnt+Xi","FloatNum");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.numLbl=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.SetData=function(t){this.numLbl.string="+"+t},e.prototype.Trigger=function(){var t=cc.tween,e=this;t(this.node).delay(.15).parallel(t().to(.8,{opacity:0}),t().by(.8,{position:cc.v3(0,30,0)})).call(function(){e.Return()}).start()},e.prototype.Return=function(){a.default.Ins.Return(this)},i([m(cc.Label)],e.prototype,"numLbl",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr"}],FlyCoin:[function(t,e,o){"use strict";cc._RF.push(e,"97ce0SX+1pDd6KoL4z52Wa9","FlyCoin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/WinMgr"),s=t("../../Manager/BCMgr"),l=t("../../Common/GameRunningData"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=(u.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIsObselete=!1,e.mCoinNum=null,e.mSpawnPos=null,e.mShowWorldPos=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,this.node.parent=a.default.Ins.TopRoot},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255,l.default.Ins.AddFlyCoin(this)},e.prototype.OnReturned=function(){this.node.opacity=0,l.default.Ins.RemoveFlyCoin(this)},e.prototype.InitData=function(t,e,o){this.mCoinNum=t,this.mSpawnPos=e,this.mShowWorldPos=o,this.mIsObselete=!1},e.prototype.TriggerFly=function(){var t=this;this.node.scale=0,this.node.position=cc.v3(a.default.Ins.TopRoot.convertToNodeSpaceAR(this.mSpawnPos));var e=cc.v3(a.default.Ins.TopRoot.convertToNodeSpaceAR(this.mShowWorldPos)),o=cc.tween;o(this.node).parallel(o().to(.3,{position:e}),o().to(.3,{scale:1.5})).call(function(){s.default.Dispatch(m.BCType.MainWin_FlyCoin,t)}).start()},i([p],e)}(cc.Component));o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Common/GameRunningData":"GameRunningData","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr"}],FlyCrystal:[function(t,e,o){"use strict";cc._RF.push(e,"478f7aSVclPDpkNBXrUyRDb","FlyCrystal");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/WinMgr"),s=t("../../Manager/BCMgr"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCrystalNum=0,e.mSpawnPos=null,e.mShowWorldPos=null,e.mCallback=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,this.node.parent=a.default.Ins.TopRoot},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.InitData=function(t,e,o,n){void 0===n&&(n=null),this.mCrystalNum=t,this.mSpawnPos=e,this.mShowWorldPos=o,this.mCallback=n},e.prototype.TriggerFly=function(){var t=this;this.node.scale=0,this.node.position=cc.v3(a.default.Ins.TopRoot.convertToNodeSpaceAR(this.mSpawnPos));var e=cc.v3(a.default.Ins.TopRoot.convertToNodeSpaceAR(this.mShowWorldPos)),o=cc.tween;o(this.node).parallel(o().to(.3,{position:e}),o().to(.3,{scale:1.5})).call(function(){s.default.Dispatch(l.BCType.MainWin_FlyCrystal,t)}).start()},i([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr"}],ForgeLockPanel:[function(t,e,o){"use strict";cc._RF.push(e,"8597eNn+LRAbI+M/YrhScBZ","ForgeLockPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyForge"),s=t("../../Manager/WinMgr"),l=t("../../Manager/UserMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCond1Lbl=null,e.mCond2Lbl=null,e.mADCoinBtn=null,e.mPassedColor=new cc.Color(0,255,0,255),e}return r(e,t),e.prototype.SetData=function(t){var e=l.default.Ins.ClientInfo;switch(t.id){case 1:break;case 2:this.mCond1Lbl.string="\u901a\u8fc7\u7b2c"+a.default.Ins.mSmith2PassedLevel+"\u5173",this.mCond2Lbl.string="\u6210\u4e3aVIP"+a.default.Ins.mSmith2NeedVIPLv,e.bestLevel>a.default.Ins.mSmith2PassedLevel?this.mCond1Lbl.node.color=this.mPassedColor:this.mCond1Lbl.node.color=cc.Color.WHITE,e.vip.lv>=a.default.Ins.mSmith2NeedVIPLv?this.mCond2Lbl.node.color=this.mPassedColor:this.mCond2Lbl.node.color=cc.Color.WHITE;break;case 3:this.mCond1Lbl.string="\u901a\u8fc7\u7b2c"+a.default.Ins.mSmith3PassedLevel+"\u5173",this.mCond2Lbl.string="\u82b1\u8d39\u5e7f\u544a\u5e01      x3",t.forgeState===u.ForgeState.BtnLock&&(this.mADCoinBtn.active=!0,this.mCond1Lbl.node.opacity=0,this.mCond2Lbl.node.opacity=0);break;case 4:this.mCond1Lbl.string="\u901a\u8fc7\u7b2c"+a.default.Ins.mSmith4PassedLevel+"\u5173",this.mCond2Lbl.string="\u6210\u4e3aVIP"+a.default.Ins.mSmith4NeedVIPLv,e.bestLevel>a.default.Ins.mSmith4PassedLevel?this.mCond1Lbl.node.color=this.mPassedColor:this.mCond1Lbl.node.color=cc.Color.WHITE,e.vip.lv>=a.default.Ins.mSmith4NeedVIPLv?this.mCond2Lbl.node.color=this.mPassedColor:this.mCond2Lbl.node.color=cc.Color.WHITE}},e.prototype.Invoke_UnlockForge3=function(){m.default.PlayBtnSound(),l.default.Ins.GetItemNum(u.ItemType.ADCoin)<3?s.default.Ins.Open(u.WinType.ItemHintWin,function(t){t.SetData(u.ItemType.ADCoin)}):a.default.Ins.UnlockForge(3)},i([d(cc.Label)],e.prototype,"mCond1Lbl",void 0),i([d(cc.Label)],e.prototype,"mCond2Lbl",void 0),i([d(cc.Node)],e.prototype,"mADCoinBtn",void 0),i([c],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyForge":"ProxyForge"}],ForgeWin:[function(t,e,o){"use strict";cc._RF.push(e,"cbf37ip1zVO74EvYJlCCmdR","ForgeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/BlackSmithItem"),l=t("../../Proxy/ProxyForge"),m=t("../../Proxy/ProxyAllSP"),u=t("../../Manager/WinMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemArr=[],e.mTitleBgSF=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=l.default.Ins.mForgeInfo.blackSmithArr,o=0,n=this.mItemArr.length;o<n;++o)this.mItemArr[o].Init(e[o],this);l.default.Ins.mForgeInfo.hasUnlockFirstSmith||(l.default.Ins.mForgeInfo.hasUnlockFirstSmith=!0,l.default.Ins.Save(),m.default.Ins.UpdateTaskProgress(m.AllSPTaskType.UnlockSmith,1))},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].RefreshState()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),p.default.Subscribe(d.BCType.SmithWin_Forge,this._OnMsg_OnForge,this),p.default.Subscribe(d.BCType.UpdateForgeTime,this._OnMsg_UpdateForgeTime,this),p.default.Subscribe(d.BCType.RefreshSmithState,this._OnMsg_RefreshSmithState,this),p.default.Subscribe(d.BCType.SmithWin_StepSucess,this._OnMsg_RefreshSmithSk,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),p.default.Remove(d.BCType.SmithWin_Forge,this._OnMsg_OnForge,this),p.default.Remove(d.BCType.UpdateForgeTime,this._OnMsg_UpdateForgeTime,this),p.default.Remove(d.BCType.RefreshSmithState,this._OnMsg_RefreshSmithState,this),p.default.Remove(d.BCType.SmithWin_StepSucess,this._OnMsg_RefreshSmithSk,this)},e.prototype._OnMsg_OnForge=function(t){var e=t.id;this.mItemArr[e-1].SetState(t.forgeState)},e.prototype._OnMsg_UpdateForgeTime=function(t,e){this.mItemArr[t].UpdateForgeTime(e)},e.prototype._OnMsg_RefreshSmithState=function(t){this.mItemArr[t-1].RefreshState()},e.prototype._OnMsg_RefreshSmithSk=function(t){this.mItemArr[t.id-1].UpdateSmithSk()},e.prototype.Invoke_Back=function(){c.default.PlayBtnSound(),this.CloseWin(),u.default.Ins.Open(d.WinType.ImmortalWin,null,!0)},e.prototype.Invoke_ImtPicture=function(){var t=this;u.default.Ins.Open(d.WinType.ImtPictureWin,function(e){var o=e;t.node.active=!1,o.node.parent=t.node.parent,o.node.position=cc.Vec3.ZERO},!0)},i([y(s.default)],e.prototype,"mItemArr",void 0),i([y([cc.SpriteFrame])],e.prototype,"mTitleBgSF",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyAllSP":"ProxyAllSP","../../Proxy/ProxyForge":"ProxyForge","../Comp/BlackSmithItem":"BlackSmithItem","./WinBase":"WinBase"}],FreeGoldActWin:[function(t,e,o){"use strict";cc._RF.push(e,"193b5al7dhBuoC8XffG/HtC","FreeGoldActWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyFreeGoldAct"),l=t("../../Platform/PlatformBase"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=t("../../Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNormalTitleRoot=null,e.mAdvTitleRoot=null,e.mCardSp=null,e.mSFArr=[],e.mHintLblNode=null,e.mGoldLbl=null,e.mGetGoldBtnNode=null,e.mHasGotNode=null,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);var e=u.default.Ins.ClientInfo.freeGoldActInfo;e.hasUpgraded?(this.mNormalTitleRoot.active=!1,this.mAdvTitleRoot.active=!0,this.mCardSp.spriteFrame=this.mSFArr[1],this.mHintLblNode.opacity=0,this.mGoldLbl.string="x"+s.default.Ins.mAdvGoldNum):(this.mNormalTitleRoot.active=!0,this.mAdvTitleRoot.active=!1,this.mCardSp.spriteFrame=this.mSFArr[0],this.mGoldLbl.string="x"+s.default.Ins.mNormalGoldNum),e.hasGot?(this.mGetGoldBtnNode.active=!1,this.mHasGotNode.active=!0):(this.mGetGoldBtnNode.active=!0,this.mHasGotNode.active=!1)},e.prototype.Invoke_Upgrade=function(){p.default.PlayBtnSound(),u.default.Ins.ClientInfo.freeGoldActInfo.hasUpgraded||d.default.WatchADForRewards(this._ADCallback.bind(this),l.ADUnitID.CommonVideoID_30,c.ADPoint.FreeGoldAct)},e.prototype._ADCallback=function(t){if(s.default.Ins.Upgrade(),u.default.Ins.ClientInfo.freeGoldActInfo.hasGot){var e=s.default.Ins.mAdvGoldNum-s.default.Ins.mNormalGoldNum;u.default.Ins.UpdateItem(c.ItemType.Gold,e),t&&(u.default.Ins.GetADExtraRewards(),m.default.Ins.Open(c.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(c.ItemType.Gold,""+e)}))}else t&&(u.default.Ins.GetADExtraRewards(),m.default.Ins.Open(c.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"1")}));u.default.Ins.Save(),this.mCardSp.spriteFrame=this.mSFArr[1],this.mGoldLbl.string="x"+s.default.Ins.mAdvGoldNum,this.mNormalTitleRoot.active=!1,this.mAdvTitleRoot.active=!0,this.mHintLblNode.opacity=0},e.prototype.Invoke_GetRewards=function(){if(p.default.PlayBtnSound(),u.default.Ins.ClientInfo.freeGoldActInfo.hasGot)m.default.Ins.ShowTips("\u4eca\u65e5\u4efd\u5df2\u9886\u53d6\uff0c\u4e3b\u516c\uff0c\u660e\u5929\u518d\u6765\u54e6~");else{var t=s.default.Ins.GetGold();m.default.Ins.Open(c.WinType.GetRewardsWin,function(e){e.SetDataSingle(c.ItemType.Gold,""+t)}),this.mGetGoldBtnNode.active=!1,this.mHasGotNode.active=!0}},i([y(cc.Node)],e.prototype,"mNormalTitleRoot",void 0),i([y(cc.Node)],e.prototype,"mAdvTitleRoot",void 0),i([y(cc.Sprite)],e.prototype,"mCardSp",void 0),i([y([cc.SpriteFrame])],e.prototype,"mSFArr",void 0),i([y(cc.Node)],e.prototype,"mHintLblNode",void 0),i([y(cc.Label)],e.prototype,"mGoldLbl",void 0),i([y(cc.Node)],e.prototype,"mGetGoldBtnNode",void 0),i([y(cc.Node)],e.prototype,"mHasGotNode",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyFreeGoldAct":"ProxyFreeGoldAct","./WinBase":"WinBase"}],FreeRewardWin:[function(t,e,o){"use strict";cc._RF.push(e,"3f5a7Ev7RBOaL/gU7+KQ044","FreeRewardWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Platform/PlatformBase"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemSp=null,e.mDescLbl=null,e.mNumLbl=null,e.mLeftTimesLbl=null,e.mItemID=0,e.mItemNum=0,e.mOKCallback=null,e.mClickCallback=null,e.mLeftTimes=-1,e.mCallback=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_Click,this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this)},e.prototype._OnEvent_Click=function(){this.CloseWin()},e.prototype.SetData=function(t,e,o,n,r,i){void 0===n&&(n=null),void 0===r&&(r=null),void 0===i&&(i=-1),this.mItemID=e,this.mItemNum=o,this.mDescLbl.string=t,this.mClickCallback=n,this.mOKCallback=r,this.mLeftTimes=i,u.default.Ins.LoadItemSprite(e,this.mItemSp,null),this.mNumLbl.string="x"+this.mItemNum,-1===this.mLeftTimes?this.mLeftTimesLbl.string="":this.mLeftTimesLbl.string="\uff08\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+this.mLeftTimes+"\uff09"},e.prototype.SetFreeChallengeTimes=function(t,e,o,n){this.mClickCallback=o,this.mCallback=n,this.mItemID=0,this.mDescLbl.string=t,u.default.Ins.LoadItemSprite(p.ItemType.ChallengeTimes,this.mItemSp,null),this.mNumLbl.string="x"+e},e.prototype.Invoke_Get=function(){if(null!==this.mClickCallback&&this.mClickCallback(),0!==this.mLeftTimes){var t=p.ADPoint.FreeMopTicket;this.mItemID===p.ItemType.MopTicket?t=p.ADPoint.FreeMopTicket:0===this.mItemID?t=p.ADPoint.FreeChallengeTimes:this.mItemID===p.ItemType.TurnCoin&&(t=p.ADPoint.FreeTurnCoin),c.default.WatchADForRewards(this._ADCallback.bind(this),s.ADUnitID.CommonVideoID_30,t)}else l.default.Ins.ShowTips("\u4eca\u65e5\u514d\u8d39\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u4e3b\u516c\u660e\u5929\u518d\u6765\u554a~")},e.prototype._ADCallback=function(t){var e=this;t&&m.default.Ins.GetADExtraRewards(),0!==this.mItemID?(m.default.Ins.UpdateItem(this.mItemID,this.mItemNum),l.default.Ins.Open(p.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(e.mItemID,""+e.mItemNum):n.SetDataSingle(e.mItemID,""+e.mItemNum)}),null!==this.mOKCallback&&this.mOKCallback()):null!==this.mCallback&&this.mCallback(t),m.default.Ins.Save(),this.CloseWin()},i([h(cc.Sprite)],e.prototype,"mItemSp",void 0),i([h(cc.Label)],e.prototype,"mDescLbl",void 0),i([h(cc.Label)],e.prototype,"mNumLbl",void 0),i([h(cc.Label)],e.prototype,"mLeftTimesLbl",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","./WinBase":"WinBase"}],FuncHintPanel:[function(t,e,o){"use strict";cc._RF.push(e,"f9992hguodIFqwFEJ+9zS0h","FuncHintPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=t("../../Manager/FuncMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFuncSp=null,e.mNameLbl=null,e.mDescLbl=null,e.mUnlockLbl=null,e.mCurFuncID=-1,e}return r(e,t),e.prototype.SetData=function(t){var e=s.default.GetNextUnlockFuncData(t);null===e?this.node.active=!1:this.mCurFuncID!==e.Id&&(a.default.Ins.LoadSpriteFrame(e.atlas,e.icon,this.mFuncSp,null),this.mNameLbl.string=e.name,this.mDescLbl.string=e.desc,this.mUnlockLbl.string="\u7b2c"+e.unlockCondition+"\u5173\u5f00\u542f",this.mCurFuncID=e.Id)},i([u(cc.Sprite)],e.prototype,"mFuncSp",void 0),i([u(cc.Label)],e.prototype,"mNameLbl",void 0),i([u(cc.Label)],e.prototype,"mDescLbl",void 0),i([u(cc.Label)],e.prototype,"mUnlockLbl",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/FuncMgr":"FuncMgr","../../Manager/ResMgr":"ResMgr"}],FuncMgr:[function(t,e,o){"use strict";cc._RF.push(e,"5b84cw9qeJASZP+KRoT/+nv","FuncMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.FuncType=void 0;var n,r=t("./WinMgr"),i=t("./UserMgr"),a=t("./DataMgr"),s=t("../Proxy/ProxyBackCity");(function(t){t[t.None=-1]="None",t[t.Hero=0]="Hero",t[t.Work=1]="Work",t[t.BackCity=2]="BackCity",t[t.Immortal=3]="Immortal",t[t.Challenge=4]="Challenge",t[t.Shop=5]="Shop",t[t.Activity=6]="Activity",t[t.Weapon=7]="Weapon",t[t.SevenDays=8]="SevenDays",t[t.VIP=9]="VIP",t[t.Office=10]="Office",t[t.DailyTask=11]="DailyTask",t[t.LotteryBox=12]="LotteryBox",t[t.SecondDayGift=13]="SecondDayGift",t[t.MoreBtn=14]="MoreBtn",t[t.Explore=15]="Explore"})(n=o.FuncType||(o.FuncType={}));var l=function(){function t(){}return t.Init=function(){if(null===this.mFuncMap){this.mFuncMap=new Map;var t=a.default.Ins.m_DB.funcDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];this.mFuncMap.set(o.Id,o),0===o.type&&-1!==o.unlockCondition&&this.mLevelDataArr.push(o)}this.mLevelDataArr.sort(this._LevelDataSort)}},t._LevelDataSort=function(t,e){return t.unlockCondition-e.unlockCondition},t.IsUnlock=function(t,e){void 0===e&&(e=!1);var o=this.mFuncMap.get(t);if(!o)return console.error("\u4e0d\u5b58\u5728\u8be5\u529f\u80fd\u914d\u7f6e: "+t),!1;var n=!1;if(1===o.type)!(n=s.default.Ins.mBackSaveInfo.backTimes>=o.unlockCondition)&&e&&r.default.Ins.ShowTips("\u56de\u57ce"+o.unlockCondition+"\u6b21\u540e\u89e3\u9501"+o.name);else{var a=i.default.Ins.ClientInfo.bestLevel;!(n=-1!==o.unlockCondition&&a>=o.unlockCondition)&&e&&(-1==o.unlockCondition?r.default.Ins.ShowTips("\u529f\u80fd\u6b63\u5728\u5f00\u53d1\uff0c\u656c\u8bf7\u671f\u5f85"):r.default.Ins.ShowTips("\u5230\u8fbe\u7b2c"+o.unlockCondition+"\u5173\u540e\u89e3\u9501"+o.name))}return n},t.GetFuncState=function(t){var e=this.GetFuncData(t);if(1===e.type){var o=i.default.Ins.ClientInfo.bestLevel,n=s.default.Ins.mBackSaveInfo.backTimes,r=e.showCondition,a=e.unlockCondition;return o<r?[-1]:r<=o&&n<a?[0,a]:[1]}o=i.default.Ins.ClientInfo.bestLevel,r=e.showCondition;var l=e.unlockCondition;return o<r?[-1]:r<=o&&o<l?[0,l]:[1]},t.GetFuncData=function(t){return this.mFuncMap.get(t)},t.GetCanBackCityLevel=function(){if(0===this.mCanBackLevel){var t=this.mFuncMap.get(n.BackCity);this.mCanBackLevel=t.unlockCondition}return this.mCanBackLevel},t.GetUnlockLevel=function(t){var e=this.mFuncMap.get(t);return e?e.unlockCondition:0},t.GetNextUnlockFuncData=function(t){for(var e=0,o=this.mLevelDataArr.length;e<o;++e)if(t<this.mLevelDataArr[e].unlockCondition)return this.mLevelDataArr[e];return null},t.mFuncMap=null,t.mLevelDataArr=[],t.mCanBackLevel=0,t}();o.default=l,cc._RF.pop()},{"../Proxy/ProxyBackCity":"ProxyBackCity","./DataMgr":"DataMgr","./UserMgr":"UserMgr","./WinMgr":"WinMgr"}],FuncUnlockWin:[function(t,e,o){"use strict";cc._RF.push(e,"ac501VUqw1MqZ6Mahtuj4WV","FuncUnlockWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/ResMgr"),l=t("../../Manager/FuncMgr"),m=t("../../Manager/AudioMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFuncIcon=null,e.mNameLbl=null,e.mIconRoot=null,e.mDescLbl=null,e}return r(e,t),e.prototype.SetData=function(t){var e=l.default.GetFuncData(t);this.mNameLbl.string=e.name,s.default.Ins.LoadSpriteFrame(e.atlas,e.icon,this.mFuncIcon,null),this.mDescLbl.string=e.desc;var o=cc.tween;this.mTweenAnimRoot.opacity=0,this.mTweenAnimRoot.position=cc.v3(0,0,0),o(this.mTweenAnimRoot).parallel(o().to(.3,{opacity:255}),o().to(.3,{position:cc.v3(0,100,0)})).start()},e.prototype.Invoke_OK=function(){m.default.PlayBtnSound(),this.CloseWin()},i([c(cc.Sprite)],e.prototype,"mFuncIcon",void 0),i([c(cc.Label)],e.prototype,"mNameLbl",void 0),i([c(cc.Node)],e.prototype,"mIconRoot",void 0),i([c(cc.Label)],e.prototype,"mDescLbl",void 0),i([p],e)}(a.default);o.default=d,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/ResMgr":"ResMgr","./WinBase":"WinBase"}],GameMgr:[function(t,e,o){"use strict";cc._RF.push(e,"cb516wLkUBIpYvaMsDC27yy","GameMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./WinMgr"),r=t("./UserMgr"),i=t("./RedPointMgr"),a=t("./PlotMgr"),s=t("./PlatformMgr"),l=t("./MainTaskGuideMgr"),m=t("./FightMgr"),u=t("./BCMgr"),p=t("../Proxy/ProxyOffline"),c=t("../Common/SwitchConfig"),d=t("../Common/GameRunningData"),f=t("../Common/EnumsDefine"),h=function(){function t(){}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.InitOnLoginSuccess=function(){},t.OnGameSceneLoaded=function(){i.default.Init(),l.default.Init(),a.default.Ins.Subscribe(),!r.default.Ins.ClientInfo.passedGuideLevel&&c.default.mGuideOpen?(d.default.Ins.mProblemWinOK=!1,n.default.Ins.Open(f.WinType.ProblemWin,function(t){t.SetData(function(){u.default.Dispatch(f.BCType.ProblemWin_OK)})}),n.default.Ins.Open(f.WinType.BattleWin,function(){t._OnBattleWinOpened(),n.default.Ins.Open(f.WinType.MainWin,function(t){t.HideMainWin()})})):n.default.Ins.Open(f.WinType.BattleWin,function(){t._OnBattleWinOpened(),p.default.Ins.mNeedOpenCoinWin&&n.default.Ins.Open(f.WinType.OfflineCoinWin,function(e){e.SetData(p.default.Ins.mOfflineCoinNum,p.default.Ins.mPassedLevelNum,p.default.Ins.mOfflineTime,t._OnCloseOfflineCoinWin)}),n.default.Ins.Open(f.WinType.MainWin,null)})},t._OnCloseOfflineCoinWin=function(){p.default.Ins.mNeedOpenMedalWin&&setTimeout(function(){n.default.Ins.Open(f.WinType.OfflineMedalWin,null)},1e4)},t._OnBattleWinOpened=function(){!r.default.Ins.ClientInfo.passedGuideLevel&&c.default.mGuideOpen?(m.default.Ins.ChangeFightMode(f.FightModeType.Normal,0),a.default.Ins.TriggerSpecialPlot(),s.default.ReportEvent(f.BIPoint.Guide_BattleWinOpened)):m.default.Ins.ChangeFightMode(f.FightModeType.Normal,r.default.Ins.ClientInfo.curLevel)},t.mIns=null,t}();o.default=h,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/GameRunningData":"GameRunningData","../Common/SwitchConfig":"SwitchConfig","../Proxy/ProxyOffline":"ProxyOffline","./BCMgr":"BCMgr","./FightMgr":"FightMgr","./MainTaskGuideMgr":"MainTaskGuideMgr","./PlatformMgr":"PlatformMgr","./PlotMgr":"PlotMgr","./RedPointMgr":"RedPointMgr","./UserMgr":"UserMgr","./WinMgr":"WinMgr"}],GameRunningData:[function(t,e,o){"use strict";cc._RF.push(e,"dd44eZ7WWFAXZdN7YQDUJvW","GameRunningData"),Object.defineProperty(o,"__esModule",{value:!0}),o.MainPanelState=void 0;var n,r=t("../Manager/PlatformMgr");(function(t){t[t.Down=0]="Down",t[t.Up=1]="Up"})(n=o.MainPanelState||(o.MainPanelState={}));var i=function(){function t(){this.mFlyingCoinArr=[],this.mMainWinPanelState=n.Down,this.mProblemWinOK=!0,this.mPassLevelCount=0,this.mPassFailCount=0,this.mCanShowTemplateInter=!0,this.mTemplateInterCD2=45,this.mTemplateInterTiming2=45}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.AddFlyCoin=function(t){this.mFlyingCoinArr.push(t)},t.prototype.RemoveFlyCoin=function(t){var e=this.mFlyingCoinArr.indexOf(t);-1!==e&&this.mFlyingCoinArr.splice(e,1)},t.prototype.TagFlyCoin=function(){for(var t=0,e=this.mFlyingCoinArr.length;t<e;++t)this.mFlyingCoinArr[t].mIsObselete=!0},t.prototype.OnShowTemplateInter=function(){},t.prototype.CheckAutoTemplateInterTime=function(t){this.mTemplateInterTiming2-=t,this.mTemplateInterTiming2<=0&&(this.mTemplateInterTiming2=this.mTemplateInterCD2,r.default.mCurPlf.ShowTemplateInter(!0))},t.mIns=null,t}();o.default=i,cc._RF.pop()},{"../Manager/PlatformMgr":"PlatformMgr"}],GetImtWin:[function(t,e,o){"use strict";cc._RF.push(e,"9acfcw+D1FEvKqjnPDDNblm","GetImtWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Proxy/ProxyImmortal"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTagSp=null,e.mImtSp=null,e.mNameLbl=null,e.mStarSp=null,e.mStarSFArr=[],e.mTagSFArr=[],e.mBg=null,e.mSkillInfoRoot=null,e.mSkillIcon=null,e.mSkillNameLbl=null,e.mSkillDescLbl=null,e.mAttr1Lbl=null,e.mAttr2Lbl=null,e.mNewImtBtnRoot=null,e.mOkBtnRoot=null,e.mMatRoot=null,e.mMatIcon=null,e.mMatNumLbl=null,e.mGoldNumLbl=null,e.mNewRootUpAnim=null,e.mNewRootBottomAnim=null,e.mCurID=0,e.mIsNew=!1,e.mIsDouble=!1,e.mImtData=null,e.mItemData=null,e}return r(e,t),e.prototype.SetData=function(t,e,o){var n=this;if(this.mCurID=t,this.mIsNew=e,this.mIsDouble=o,this.mImtData=d.default.Ins.m_DB.immortalDB[t],this.mItemData=d.default.Ins.m_DB.itemDB[t],this.mTagSp.node.opacity=0,this.mIsNew)this.mTagSp.node.opacity=255,this.mTagSp.spriteFrame=this.mTagSFArr[0],this.mOkBtnRoot.active=!1,this.mNewImtBtnRoot.active=!0,this.mMatRoot.active=!1,this.mGoldNumLbl.string="x"+l.default.Ins.GetNewImtGoldNum(this.mImtData.star),this.mNewRootUpAnim.node.scale=0,this.mNewRootBottomAnim.node.scale=0,this.scheduleOnce(function(){n.mNewRootUpAnim.play("btnAppear",0)},.5),this.scheduleOnce(function(){n.mNewRootBottomAnim.play("btnAppear",0)},1);else{this.mNewImtBtnRoot.active=!1,this.mOkBtnRoot.active=!0,this.mMatRoot.active=!0;var r=this.mImtData.cost;c.default.Ins.LoadItemSprite(r[0],this.mMatIcon,null);var i=l.default.Ins.GetImtSI(t),a=new s.LargeNumber(r[1],r[2]).ToNormalNum()*i.lv;this.mIsDouble&&(a*=2),this.mMatNumLbl.string="x"+s.default.FormatNumber(a,0)}if(this.mAttr1Lbl.string=l.default.Ins.GetAttrDesc(t,1,!0),0===this.mImtData.attr2.length?this.mAttr2Lbl.node.opacity=0:(this.mAttr2Lbl.node.opacity=255,this.mAttr2Lbl.string=l.default.Ins.GetAttrDesc(t,2,!0)),this.mIsDouble&&(this.mTagSp.node.opacity=255,this.mTagSp.spriteFrame=this.mTagSFArr[1]),c.default.Ins.LoadItemSprite(t,this.mImtSp,null),this.mNameLbl.string=this.mItemData.name,this.mStarSp.spriteFrame=this.mStarSFArr[this.mImtData.star-1],0!==this.mImtData.skill){this.mSkillInfoRoot.active=!0,c.default.Ins.LoadImtSkillSp(t,this.mSkillIcon,null);var m=d.default.Ins.m_DB.imtSkillDB[this.mImtData.skill];this.mSkillNameLbl.string=m.name,this.mSkillDescLbl.string=m.desc,this.mBg.node.height=260}else this.mSkillInfoRoot.active=!1,this.mBg.node.height=160},e.prototype.Invoke_Close=function(){f.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_GetRewards=function(){f.default.PlayBtnSound(),y.default.WatchADForRewards(this._ADCallback.bind(this),m.ADUnitID.CommonVideoID_30,h.ADPoint.NewImtGold)},e.prototype._ADCallback=function(t){var e=l.default.Ins.GetNewImtGoldNum(this.mImtData.star);p.default.Ins.UpdateItem(h.ItemType.Gold,e),t&&p.default.Ins.GetADExtraRewards(),this.CloseWin(),u.default.Ins.Open(h.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(h.ItemType.Gold,e+""):n.SetDataSingle(h.ItemType.Gold,e+"")}),p.default.Ins.Save()},i([S(cc.Sprite)],e.prototype,"mTagSp",void 0),i([S(cc.Sprite)],e.prototype,"mImtSp",void 0),i([S(cc.Label)],e.prototype,"mNameLbl",void 0),i([S(cc.Sprite)],e.prototype,"mStarSp",void 0),i([S([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([S([cc.SpriteFrame])],e.prototype,"mTagSFArr",void 0),i([S(cc.Sprite)],e.prototype,"mBg",void 0),i([S(cc.Node)],e.prototype,"mSkillInfoRoot",void 0),i([S(cc.Sprite)],e.prototype,"mSkillIcon",void 0),i([S(cc.Label)],e.prototype,"mSkillNameLbl",void 0),i([S(cc.Label)],e.prototype,"mSkillDescLbl",void 0),i([S(cc.Label)],e.prototype,"mAttr1Lbl",void 0),i([S(cc.Label)],e.prototype,"mAttr2Lbl",void 0),i([S(cc.Node)],e.prototype,"mNewImtBtnRoot",void 0),i([S(cc.Node)],e.prototype,"mOkBtnRoot",void 0),i([S(cc.Node)],e.prototype,"mMatRoot",void 0),i([S(cc.Sprite)],e.prototype,"mMatIcon",void 0),i([S(cc.Label)],e.prototype,"mMatNumLbl",void 0),i([S(cc.Label)],e.prototype,"mGoldNumLbl",void 0),i([S(cc.Animation)],e.prototype,"mNewRootUpAnim",void 0),i([S(cc.Animation)],e.prototype,"mNewRootBottomAnim",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./WinBase":"WinBase"}],GetRewardsWin:[function(t,e,o){"use strict";cc._RF.push(e,"51ae8Y8yhxHbLlEqUP6v6Gw","GetRewardsWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyVIP"),m=t("../../Manager/UserMgr"),u=t("../../Manager/PlatformMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/SwitchConfig"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemRoot=null,e.mItemTemplate=null,e.mTitleSk=null,e.mADCoinHintRT=null,e.mNeedItemCount=0,e.mItemsArr=[],e.mCellWidth=120,e.mCellHeight=150,e.mEnableClose=!1,e.mCloseCallback=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mItemsArr.push(this.mItemTemplate),c.default.mNeedLimitADCoin||(this.mADCoinHintRT.string="")},e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),p.default.PlaySFX(d.AudioName.UI_GetRewards,!0,1,!0),this.mEnableClose=!1,this.scheduleOnce(function(){e.mEnableClose=!0},.5),this.mTitleSk.setAnimation(0,"gongxihuode",!1)},e.prototype._ShowBanner=function(){f.default.RealAspect>=this.m_ShowBannerAspect&&u.default.ShowBanner()},e.prototype._OnClose=function(){this._RemoveListener(),this.m_NeedBanner&&this._HideBanner()},e.prototype._OnEvent_ClickMask=function(){this.mEnableClose&&(this.CloseWin(),null!==this.mCloseCallback&&(this.mCloseCallback(),this.mCloseCallback=null))},e.prototype.SetCloseCallback=function(t){this.mCloseCallback=t},e.prototype.SetDataSingle=function(t,e){var o=[];o.push([t+"",e]),this.SetData(o)},e.prototype.SetDataWithADCoin=function(t,e,o){var n=this;void 0===o&&(o="1");var r=[];0!==t&&r.push([t+"",e]),(!c.default.mNeedLimitADCoin||m.default.Ins.ClientInfo.todayADCoinFromAD<=c.default.mADCoinLimitNum)&&r.push([d.ItemType.ADCoin+"",o]),r.push([d.ItemType.VIPExp+"",l.default.Ins.mOnceADExp]),this.SetData(r),c.default.mNeedLimitADCoin&&(m.default.Ins.ClientInfo.todayADCoinFromAD>c.default.mADCoinLimitNum?(this.mADCoinHintRT.node.active=!0,this.scheduleOnce(function(){n.mADCoinHintRT.string="<b>Tips\uff1a\u5e7f\u544a\u5e01\u6bcf\u65e5\u83b7\u5f97<color=#F96060>\u5df2\u8fbe\u4e0a\u9650</color>\uff01\u6b21\u65e5<color=#F96060>0\u70b9\u5237\u65b0</color>\uff01</b>"},.1)):(this.mADCoinHintRT.node.active=!0,this.scheduleOnce(function(){n.mADCoinHintRT.string="<b>Tips\uff1a\u5e7f\u544a\u5e01\u6bcf\u65e5\u83b7\u5f97\u4e0a\u9650<color=#F96060>"+c.default.mADCoinLimitNum+"</color>\u4e2a\uff0c\u4eca\u65e5\u5df2\u83b7\u5f97<color=#F96060>"+m.default.Ins.ClientInfo.todayADCoinFromAD+"</color>\u4e2a\uff01</b>"},.1)))},e.prototype.SetData=function(t){this.mNeedItemCount=t.length;var e=this.mItemsArr.length;if(this.mNeedItemCount>e)for(var o=this.mNeedItemCount-e,n=0;n<o;++n){var r=cc.instantiate(this.mItemTemplate.node);r.setParent(this.mItemRoot),this.mItemsArr.push(r.getComponent(s.default))}for(var i=-(Math.min(this.mNeedItemCount,5)-1)*this.mCellWidth*.5,a=Math.floor((this.mNeedItemCount-1)/5)*this.mCellHeight*.5,l=(n=0,this.mItemsArr.length);n<l;++n)if(n<this.mNeedItemCount){this.mItemsArr[n].SetData(parseInt(t[n][0]),t[n][1]);var m=n%5*this.mCellWidth+i,u=-Math.floor(n/5)*this.mCellHeight+a;this.mItemsArr[n].node.setPosition(m,u),this.mItemsArr[n].node.active=!0}else this.mItemsArr[n].node.active=!1;this.mADCoinHintRT.node.active=!1,this.mADCoinHintRT.string=""},e.prototype.Invoke_Close=function(){p.default.PlayBtnSound(),this._OnEvent_ClickMask()},i([g(cc.Node)],e.prototype,"mItemRoot",void 0),i([g(s.default)],e.prototype,"mItemTemplate",void 0),i([g(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([g(cc.RichText)],e.prototype,"mADCoinHintRT",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyVIP":"ProxyVIP","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],GetSkinWin:[function(t,e,o){"use strict";cc._RF.push(e,"41ee76ipdtBbaLTq7hnyeXr","GetSkinWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxySkin"),l=t("../../Proxy/ProxyHero"),m=t("../../Manager/WinMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/AudioMgr"),d=t("../../MainGame"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTagSp=null,e.mQualityTagSp=null,e.mSkinSk=null,e.mNameLbl=null,e.mQualityTagSFArr=[],e.mAttr1Lbl=null,e.mNewSkinBtnRoot=null,e.mHeroHintNode=null,e.mEquipBtnBg=null,e.mOkBtnRoot=null,e.mMatRoot=null,e.mMatNumLbl=null,e.mCurSkinID=0,e.mSkinData=null,e.mHeroID=0,e.mIsNew=!1,e}return r(e,t),e.prototype.SetData=function(t,e){this.mCurSkinID=t,this.mIsNew=e,this.mSkinData=p.default.Ins.m_DB.skinDB[t],this.mHeroID=this.mSkinData.entityID,this.mQualityTagSp.spriteFrame=this.mQualityTagSFArr[this.mSkinData.quality];var o=this;u.default.Ins.LoadSpine("spine/hero/"+this.mSkinData.model,function(t){o&&o.mSkinSk&&(o.mSkinSk.skeletonData=t,o.mSkinSk.setAnimation(0,"daiji",!0))}),e?(this.mTagSp.node.opacity=255,this.mMatRoot.opacity=0,this.mNewSkinBtnRoot.active=!0,this.mOkBtnRoot.active=!1,null===l.default.Ins.GetHeroSI(this.mHeroID)?(this.mHeroHintNode.opacity=255,this.mEquipBtnBg.setMaterial(0,d.default.mGrayMat)):(this.mHeroHintNode.opacity=0,this.mEquipBtnBg.setMaterial(0,d.default.mDefaultMat))):(this.mMatRoot.opacity=255,this.mTagSp.node.opacity=0,this.mMatNumLbl.string="x"+this.mSkinData.repeatNum,this.mNewSkinBtnRoot.active=!1,this.mOkBtnRoot.active=!0),this.mNameLbl.string=this.mSkinData.name,this.mAttr1Lbl.string=s.default.Ins.GetAttrDesc(this.mSkinData.attr)},e.prototype.Invoke_Close=function(){c.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Equip=function(){c.default.PlayBtnSound(),null!==l.default.Ins.GetHeroSI(this.mHeroID)?(l.default.Ins.EquipSkin(this.mCurSkinID),this.CloseWin()):m.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u60a8\u8fd8\u672a\u62e5\u6709\u8be5\u76ae\u80a4\u5bf9\u5e94\u7684\u6b66\u5c06\u5462...")},i([y(cc.Sprite)],e.prototype,"mTagSp",void 0),i([y(cc.Sprite)],e.prototype,"mQualityTagSp",void 0),i([y(sp.Skeleton)],e.prototype,"mSkinSk",void 0),i([y(cc.Label)],e.prototype,"mNameLbl",void 0),i([y([cc.SpriteFrame])],e.prototype,"mQualityTagSFArr",void 0),i([y(cc.Label)],e.prototype,"mAttr1Lbl",void 0),i([y(cc.Node)],e.prototype,"mNewSkinBtnRoot",void 0),i([y(cc.Node)],e.prototype,"mHeroHintNode",void 0),i([y(cc.Sprite)],e.prototype,"mEquipBtnBg",void 0),i([y(cc.Node)],e.prototype,"mOkBtnRoot",void 0),i([y(cc.Node)],e.prototype,"mMatRoot",void 0),i([y(cc.Label)],e.prototype,"mMatNumLbl",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxySkin":"ProxySkin","./WinBase":"WinBase"}],GiftOpenWin:[function(t,e,o){"use strict";cc._RF.push(e,"0a29dA851tC+JDBVij1eIAc","GiftOpenWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/ResMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSk=null,e.mOpendCallback=null,e.mBoxPath="",e.mIsOpening=!1,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mSk.setEventListener(this._OnAnimEventListener.bind(this))},e.prototype.SetData=function(t,e){if(this.mOpendCallback=e,this.mIsOpening=!1,this.mBoxPath!==t){this.mBoxPath=t,this.mSk.skeletonData=null;var o=this;s.default.Ins.LoadSpine("spine/"+t,function(t){o&&null!==o.mSk&&(o.mSk.skeletonData=t,o.ShowGiftBox())})}else this.ShowGiftBox()},e.prototype.ShowGiftBox=function(){this.mSk.setAnimation(0,"chuxian",!1),this.mSk.addAnimation(0,"daiji",!0)},e.prototype._OnAnimEventListener=function(t,e){"open"===e.data.name&&(this.CloseWin(),null!==this.mOpendCallback&&(this.mOpendCallback(),this.mOpendCallback=null))},e.prototype.Invoke_OpenGiftBox=function(){this.mIsOpening||(this.mIsOpening=!0,this.mSk.setAnimation(0,"dakai",!1))},i([u(sp.Skeleton)],e.prototype,"mSk",void 0),i([m],e)}(a.default);o.default=p,cc._RF.pop()},{"../../Manager/ResMgr":"ResMgr","./WinBase":"WinBase"}],GoldForCoinWin:[function(t,e,o){"use strict";cc._RF.push(e,"22900zQIttJCIqO2UgeRjyZ","GoldForCoinWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyWork"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCostGoldLbl=null,e.mGetCoinNumLbl=null,e.mAddCoinNum=null,e}return r(e,t),e.prototype.SetData=function(){this.mCostGoldLbl.string=s.default.mExchangeCoinCostGoldNum+"",this.mAddCoinNum=s.default.Ins.mRevenueCoinInSeconds.MultiplySingle(1800),this.mGetCoinNumLbl.string=this.mAddCoinNum.ToString(1),u.default.PlaySFX(p.AudioName.UI_TanKuang,!0)},e.prototype.Invoke_Close=function(){u.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Confirm=function(){if(u.default.PlayBtnSound(),m.default.Ins.GetItemNum(p.ItemType.Gold)<s.default.mExchangeCoinCostGoldNum)l.default.Ins.ShowTips("\u5143\u5b9d\u4e0d\u8db3~");else{m.default.Ins.UpdateItem(p.ItemType.Gold,-s.default.mExchangeCoinCostGoldNum),m.default.Ins.AddCoin(this.mAddCoinNum);var t=this.mAddCoinNum.ToString(1);l.default.Ins.Open(p.WinType.GetRewardsWin,function(e){e.SetDataSingle(p.ItemType.Coin,t)}),this.CloseWin()}},i([f(cc.Label)],e.prototype,"mCostGoldLbl",void 0),i([f(cc.Label)],e.prototype,"mGetCoinNumLbl",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyWork":"ProxyWork","./WinBase":"WinBase"}],GuideBtn:[function(t,e,o){"use strict";cc._RF.push(e,"d2b19R/XCRCH5+0rF5GGs3D","GuideBtn");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./GuideFinger"),s=t("../../Manager/WinMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/GuideMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_GuideBtnID=0,e.m_HasClicked=!1,e.mNeedDisable=!1,e}return r(e,t),e.prototype.Init=function(t,e){void 0===e&&(e=!1),this.m_GuideBtnID=t,this.mNeedDisable=e,m.default.AddGuideBtn(this)},e.prototype.onEnable=function(){m.default.AddGuideBtn(this)},e.prototype.onDisable=function(){m.default.RemoveGuideBtn(this)},e.prototype.onDestroy=function(){m.default.RemoveGuideBtn(this)},e.prototype._OnClickGuideBtn=function(){m.default.OnClickGuideBtn(this),this.m_HasClicked=!0},e.prototype.TriggerGuide=function(t){var e=this;this.node.once(cc.Node.EventType.TOUCH_END,this._OnClickGuideBtn,this),this.m_HasClicked=!1;var o=this;if(null===m.default.m_Finger)l.default.Ins.LoadPrefab("prefab/ui/Finger",function(e){var n=cc.instantiate(e);m.default.m_Finger=n.getComponent(a.default);var r=o.node.position.add(cc.v3(t.fingerPosOffset[0],t.fingerPosOffset[1]));m.default.m_Finger.node.setParent(s.default.Ins.GuideRoot);var i=s.default.Ins.GuideRoot.convertToNodeSpaceAR(o.node.parent.convertToWorldSpaceAR(r));m.default.m_Finger.node.setPosition(i),m.default.m_Finger.node.angle=t.fingerPosOffset[2]});else{m.default.m_Finger.node.active=!0;var n=o.node.position.add(cc.v3(t.fingerPosOffset[0],t.fingerPosOffset[1])),r=s.default.Ins.GuideRoot.convertToNodeSpaceAR(o.node.parent.convertToWorldSpaceAR(n));m.default.m_Finger.node.setPosition(r),m.default.m_Finger.node.angle=t.fingerPosOffset[2]}var i=s.default.Ins.GuideMask,u=this.node.getBoundingBoxToWorld(),p=i.parent.convertToNodeSpaceAR(u.center);if(i.setPosition(p),0===t.maskParam.length)i.width=u.width,i.height=u.height,(c=s.default.Ins.GuideMaskHeiDi).opacity=255;else{var c=s.default.Ins.GuideMaskHeiDi;t.maskParam.length>4&&(i.y+=t.maskParam[4],u.y=u.y+t.maskParam[4]),t.maskParam.length>3&&(i.x+=t.maskParam[3],u.x=u.x+t.maskParam[3]),t.maskParam.length>2&&(i.height=u.height+t.maskParam[2],u.height=u.height+t.maskParam[2]),t.maskParam.length>1&&(i.width=u.width+t.maskParam[1],u.width=u.width+t.maskParam[1]),t.maskParam.length>0&&(c.opacity=t.maskParam[0])}i.active=!0;var d=s.default.Ins.GuideMaskHeiDi;d.on(cc.Node.EventType.TOUCH_START,function(t){!e.m_HasClicked&&u.contains(t.getLocation())?d._touchListener.setSwallowTouches(!1):(d._touchListener.setSwallowTouches(!0),null!==m.default.m_Finger&&m.default.m_Finger.Focus())},this);var f=t.tips;f?null===m.default.m_GuideTip?l.default.Ins.LoadPrefab("prefab/ui/GuideTip",function(e){var n=cc.instantiate(e);n.setParent(s.default.Ins.GuideRoot),m.default.m_GuideTip=n.getComponent("GuideTip");var r=o.node.position.add(cc.v3(t.tipsPosOffset[0],t.tipsPosOffset[1])),i=s.default.Ins.GuideRoot.convertToNodeSpaceAR(o.node.parent.convertToWorldSpaceAR(r));m.default.m_GuideTip.node.setPosition(i),m.default.m_GuideTip.Show(f)}):(n=o.node.position.add(cc.v3(t.tipsPosOffset[0],t.tipsPosOffset[1])),r=s.default.Ins.GuideRoot.convertToNodeSpaceAR(o.node.parent.convertToWorldSpaceAR(n)),m.default.m_GuideTip.node.setPosition(r),m.default.m_GuideTip.Show(f)):null!==m.default.m_GuideTip&&m.default.m_GuideTip.Hide()},i([c(cc.Integer)],e.prototype,"m_GuideBtnID",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Manager/GuideMgr":"GuideMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","./GuideFinger":"GuideFinger"}],GuideFinger:[function(t,e,o){"use strict";cc._RF.push(e,"30011YY9ilADoVvMOamsEJe","GuideFinger");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFocusSk=null,e}return r(e,t),e.prototype.Focus=function(){if(null===this.mFocusSk.skeletonData){var t=this;a.default.Ins.LoadSpine("spine/jujiao",function(e){t&&t.mFocusSk&&(t.mFocusSk.skeletonData=e,t.mFocusSk.timeScale=1.3,t.mFocusSk.setAnimation(0,"animation",!1))})}else this.mFocusSk.setAnimation(0,"animation",!1)},i([m(sp.Skeleton)],e.prototype,"mFocusSk",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/ResMgr":"ResMgr"}],GuideListener:[function(t,e,o){"use strict";cc._RF.push(e,"973c81J4Y5OsI+KO9kyKco0","GuideListener"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./PlatformMgr"),r=t("./BCMgr"),i=t("../Common/EnumsDefine"),a=function(){function t(){}return t.Init=function(){this._Subscribe()},t._Subscribe=function(){r.default.Subscribe(i.BCType.Guide_End,this.OnMsg_GuideEnd,this)},t.OnMsg_GuideEnd=function(t){n.default.ReportEvent(i.BIPoint.Guide_GuideEnd,{id:t})},t}();o.default=a,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","./BCMgr":"BCMgr","./PlatformMgr":"PlatformMgr"}],GuideMgr:[function(t,e,o){"use strict";cc._RF.push(e,"548f3z8eEFGM7eeBzxRjkwu","GuideMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./WinMgr"),r=t("./UserMgr"),i=t("./DataMgr"),a=t("./BCMgr"),s=t("../Common/SwitchConfig"),l=t("../Common/EnumsDefine"),m=function(){function t(){}return Object.defineProperty(t,"IsGuiding",{get:function(){return this.m_IsGuiding},enumerable:!1,configurable:!0}),t.AddGuideBtn=function(t){var e=t.m_GuideBtnID;this.m_GuideBtnMap.has(e)&&console.error("\u5f53\u524d\u5f15\u5bfc\u6309\u94ae\u4e2d\u5df2\u7ecf\u5b58\u5728\u5f15\u5bfc\u6309\u94aeID\u4e3a"+e+"\u7684\u6309\u94ae"),this.m_GuideBtnMap.set(e,t)},t.RemoveGuideBtn=function(t){var e=t.m_GuideBtnID;this.m_GuideBtnMap.has(e)&&this.m_GuideBtnMap.delete(e)},t.CacheGuideDatas=function(){if(null===this.m_AllGuideDatasMap){this.m_AllGuideDatasMap=new Map;var t=i.default.Ins.m_DB.guideDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e],n=this.m_AllGuideDatasMap.get(o.guideId);n||(n=[],this.m_AllGuideDatasMap.set(o.guideId,n)),n.push(o)}}},t.GetGudieTaskDatas=function(t){return this.CacheGuideDatas(),this.m_AllGuideDatasMap.get(t)},t.IsPassGuide=function(t){return r.default.Ins.ClientInfo.guideID>=t},t.TriggerNextGuide=function(t){void 0===t&&(t=!1),this.TriggerGuide(r.default.Ins.ClientInfo.guideID+1,t)},t.TriggerGuide=function(t,e){return void 0===e&&(e=!1),!(!s.default.mGuideOpen&&!e||(this.m_CurGuideDatasArr=this.GetGudieTaskDatas(t),this.m_CurGuideDatasArr?this.IsPassGuide(t)&&!e?(console.log("\u5df2\u7ecf\u5f15\u5bfc\u8fc7\u8be5\u4efb\u52a1"),1):0===this.m_CurGuideDatasArr.length?(console.error("\u6ca1\u6709\u5f15\u5bfc\u4efb\u52a1\u6570\u636e"),1):(this.m_IsGuiding=!0,this.m_CurGuideID=t,this.m_CurGuideIdx=0,this._PrepareGuideStep(this.m_CurGuideDatasArr[0]),0):(console.error("\u83b7\u53d6\u5f15\u5bfc\u4efb\u52a1\u6570\u636e\u5931\u8d25: "+t),1)))},t._PrepareGuideStep=function(t){var e=n.default.Ins.GuideMask,o=n.default.Ins.GuideMaskHeiDi;e.width=0,e.height=0,e.active=!0,o.opacity=1,this.m_NextGuideData=t,this.m_IsWaitGuideBtnAppear=!0},t._OnUpdateWaitGuideBtn=function(){this.m_IsWaitGuideBtnAppear&&null!==this.m_NextGuideData&&this.m_GuideBtnMap.has(this.m_NextGuideData.guideBtnId)&&(this.m_IsWaitGuideBtnAppear=!1,this.m_NextGuideData.delayTime<=0?this._TriggerGuideStep():(this.m_DelayTimer=this.m_NextGuideData.delayTime,this.m_IsDelay=!0))},t._OnUpdateDelay=function(t){this.m_IsDelay&&(this.m_DelayTimer-=t,this.m_DelayTimer<=0&&(this._TriggerGuideStep(),this.m_IsDelay=!1))},t._TriggerGuideStep=function(){this.m_CurGuideData=this.m_NextGuideData,this.m_NextGuideData=null;var t=null;0!==this.m_CurGuideData.guideBtnId&&(t=this.m_GuideBtnMap.get(this.m_CurGuideData.guideBtnId)),t?t.TriggerGuide(this.m_CurGuideData):this.EndGuide()},t.OnUpdate=function(t){this.m_IsGuiding&&(this._OnUpdateWaitGuideBtn(),this._OnUpdateDelay(t))},t.OnClickGuideBtn=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];null!==t.m_GuideTip&&t.m_GuideTip.Hide(),null!==t.m_Finger&&(t.m_Finger.node.active=!1),n.default.Ins.GuideMask.active=!1,this._EndGuideStep()},t._EndGuideStep=function(){this.m_CurGuideIdx+1<this.m_CurGuideDatasArr.length?(this.m_CurGuideIdx++,this.m_NextGuideData=this.m_CurGuideDatasArr[this.m_CurGuideIdx],this._PrepareGuideStep(this.m_NextGuideData)):(this._SaveGuideProgress(this.m_CurGuideID),0!==this.m_CurGuideData.nextGuideId?this.TriggerGuide(this.m_CurGuideData.nextGuideId):this.EndGuide())},t.EndGuide=function(){this.m_IsWaitGuideBtnAppear=!1,this.m_IsGuiding=!1,a.default.Dispatch(l.BCType.Guide_End,this.m_CurGuideID),this.m_CurGuideID=0},t._SaveGuideProgress=function(t){-1===t&&(t=0),r.default.Ins.ClientInfo.guideID=t,r.default.Ins.Save()},t.m_CurGuideID=0,t.m_Finger=null,t.m_GuideTip=null,t.m_AllGuideDatasMap=null,t.m_CurGuideDatasArr=null,t.m_CurGuideIdx=0,t.m_CurGuideData=null,t.m_NextGuideData=null,t.m_GuideBtnMap=new Map,t.m_IsWaitGuideBtnAppear=!1,t.m_DelayTimer=0,t.m_IsDelay=!1,t.m_IsGuiding=!1,t}();o.default=m,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","./BCMgr":"BCMgr","./DataMgr":"DataMgr","./UserMgr":"UserMgr","./WinMgr":"WinMgr"}],GuideTip:[function(t,e,o){"use strict";cc._RF.push(e,"ce9acXB1Q9Ni40iyz5B4Iwx","GuideTip");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mContentRT=null,e}return r(e,t),e.prototype.Show=function(t){this.node.active=!0,this.mContentRT.string=t},e.prototype.Hide=function(){this.node.active=!1},i([l(cc.RichText)],e.prototype,"mContentRT",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],HPBar:[function(t,e,o){"use strict";cc._RF.push(e,"501a1pDB3dPEoiwm+JDls0T","HPBar");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Win/BattleWin"),s=t("../../MainGame"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ProgressBar=null,e.m_AnimHP=null,e.mCounterSp=null,e.ShieldBar=null,e.mBuffIcon=null,e.m_SyncPosNode=null,e.m_HPAnimDuration=.3,e.m_HPAnimSpeed=1,e.m_IsAniming=!1,e.m_CurAnimHPWidth=0,e.m_TargetAnimHPWidth=0,e.m_MaxHPWidth=0,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,this.node.parent=a.default.HPRoot},e.prototype.OnBeforeBorrow=function(){this.m_IsAniming=!1,this.m_ProgressBar.progress=1,this.node.opacity=0},e.prototype.OnAfterBorrow=function(){},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.Init=function(t,e,o){void 0===o&&(o=!1),this.m_SyncPosNode=t,this.m_MaxHPWidth=this.m_ProgressBar.node.width,this.m_CurAnimHPWidth=this.m_MaxHPWidth,this.m_IsAniming=!1,e!==l.CounterType.None?(this.mCounterSp.node.opacity=255,this.mCounterSp.spriteFrame=s.default.mCounterSFArr[e]):this.mCounterSp.node.opacity=0,null!==this.ShieldBar&&(this.ShieldBar.node.opacity=o?255:0)},e.prototype.UpdateShiled=function(t){null!==this.ShieldBar&&(t<=0&&(t=0,this.ShieldBar.node.opacity=0),this.ShieldBar.progress=t)},e.prototype.UpdateHP=function(t,e){void 0===e&&(e=!1),t<0&&(t=0),this.m_ProgressBar.progress=t,this.m_TargetAnimHPWidth=this.m_MaxHPWidth*t,e?this.m_AnimHP.width=this.m_TargetAnimHPWidth:(this.m_IsAniming=!0,this.m_HPAnimSpeed=(this.m_TargetAnimHPWidth-this.m_CurAnimHPWidth)/this.m_HPAnimDuration)},e.prototype.UpdateBuffIcon=function(t){null!==this.mBuffIcon&&(null===t?this.mBuffIcon.node.opacity=0:t.HasIconTag()&&(this.mBuffIcon.node.opacity=255,this.mBuffIcon.spriteFrame=s.default.mBuffIconArr[t.GetBuffType()-1]))},e.prototype.update=function(t){null!==this.m_SyncPosNode&&this.m_SyncPosNode.isValid&&(this.node.position=cc.v3(this.node.parent.convertToNodeSpaceAR(this.m_SyncPosNode.convertToWorldSpaceAR(cc.Vec2.ZERO)))),this.m_IsAniming&&(this.m_CurAnimHPWidth+=this.m_HPAnimSpeed*t,this.m_AnimHP.width=this.m_CurAnimHPWidth,this.m_HPAnimSpeed<=0&&this.m_CurAnimHPWidth<=this.m_TargetAnimHPWidth?(this.m_AnimHP.width=this.m_TargetAnimHPWidth,this.m_IsAniming=!1):this.m_HPAnimSpeed>=0&&this.m_CurAnimHPWidth>=this.m_TargetAnimHPWidth&&(this.m_AnimHP.width=this.m_TargetAnimHPWidth,this.m_IsAniming=!1))},i([p(cc.ProgressBar)],e.prototype,"m_ProgressBar",void 0),i([p(cc.Node)],e.prototype,"m_AnimHP",void 0),i([p(cc.Sprite)],e.prototype,"mCounterSp",void 0),i([p(cc.ProgressBar)],e.prototype,"ShieldBar",void 0),i([p(cc.Sprite)],e.prototype,"mBuffIcon",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../Win/BattleWin":"BattleWin"}],HeroAddItem:[function(t,e,o){"use strict";cc._RF.push(e,"88496fBmSpGSbeqxcbx0lpl","HeroAddItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/WinMgr"),s=t("../../Manager/AudioMgr"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOwnerWin=null,e}return r(e,t),e.prototype.SetData=function(t){this.mOwnerWin=t},e.prototype.Invoke_AddHero=function(){s.default.PlayBtnSound();var t=this;a.default.Ins.Open(l.WinType.HeroAdjustTeamWin,function(e){t.mOwnerWin.node.active=!1,e.node.parent=t.mOwnerWin.node.parent,e.node.position=cc.Vec3.ZERO},!0)},i([u],e)}(cc.Component));o.default=p,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/WinMgr":"WinMgr"}],HeroAdjustTeamWin:[function(t,e,o){"use strict";cc._RF.push(e,"785c6HFD+1PiqQq/WrWEUxY","HeroAdjustTeamWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/TeamHeroIcon"),l=t("../Comp/MyToggleGroup"),m=t("../../Proxy/ProxyHero"),u=t("../../Manager/WinMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTeamRoot=null,e.mIdleRoot=null,e.mToggleGroup=null,e.mTemplate=null,e.mHeroIconCacheRoot=null,e.mEmptyHeroTemplate=null,e.mAddPlaceBtn=null,e.mCampTitleArr=[],e.mStarTitleArr=[],e.mQualityTitleArr=[],e.mCounterTitleArr=[],e.mProfessionTitleArr=[],e.mEmptyHint=null,e.mExtendCostLbl=null,e.mItemMaps=new Map,e.mEmptyNodeArr=new Array,e.mHasSubscribed=!1,e.mLastTitleRoot=null,e._teamOriX=58,e._teamIconWidth=100,e._OriCampTitleY=30,e._IconOffsetTilteY=80,e._TitleOffsetIconY=118,e._IconWidth=115,e._IconHeight=140,e._ColumnCount=6,e._IconOriX=-285,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init(),this.mEmptyNodeArr.push(this.mEmptyHeroTemplate)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);var e=m.default.Ins.mHeroInfo.heroMap.obj,o=null;for(var n in e)if(e.hasOwnProperty(n)&&(o=e[n],!this.mItemMaps.get(o.id))){var r=cc.instantiate(this.mTemplate);r.active=!0;var i=r.getComponent(s.default);i.SetData(o.id),this.mItemMaps.set(o.id,i),r.parent=this.mHeroIconCacheRoot}this.mExtendCostLbl.string=m.default.Ins.GetExtendPosCost()+"",0===this._openedTimes?(this._OnMsg_ClickToggle(2,!0),this._PlaceTeamHeros()):this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!0)},e.prototype._PlaceTeamHeros=function(){for(var t=this,e=0,o=0,n=this.mEmptyNodeArr.length;o<n;++o)this.mEmptyNodeArr[o].opacity=0;var r=m.default.Ins.mHeroInfo.heroTeam.length;this.mTeamRoot.width=r*this._teamIconWidth+110;var i=function(o){var n=m.default.Ins.mHeroInfo.heroTeam[o];if(0!==n){var r=a.mItemMaps.get(n);if(void 0===r){var i=cc.instantiate(a.mTemplate);i.active=!0,(r=i.getComponent(s.default)).SetData(n),a.mItemMaps.set(n,r)}r.node.parent!==a.mTeamRoot&&(r.node.parent=a.mTeamRoot),r.node.x=a._teamOriX+a._teamIconWidth*o,r.node.y=12,r.node.scale=.9,r.SetCallback(function(){t._ClickTeamIcon(r)})}else{if(e++,a.mEmptyNodeArr.length<e){var l=cc.instantiate(a.mEmptyHeroTemplate);l.parent!==a.mTeamRoot&&(l.parent=a.mTeamRoot,l.y=12),a.mEmptyNodeArr.push(l)}a.mEmptyNodeArr[e-1].opacity=255,a.mEmptyNodeArr[e-1].x=a._teamOriX+a._teamIconWidth*o}},a=this;for(o=0;o<r;++o)i(o);r<m.default.HERO_MAX_NUM?this.mAddPlaceBtn.x=this._teamOriX+this._teamIconWidth*r:this.mAddPlaceBtn.active=!1},e.prototype._PlaceCamp=function(){null!==this.mLastTitleRoot&&(this.mLastTitleRoot.active=!1),this.mCampTitleArr[0].parent.active=!0,this.mLastTitleRoot=this.mCampTitleArr[0].parent;var t=m.default.Ins.GetHeroCampArr();m.default.Ins.ExcludeHeroArr(t,m.default.Ins.mHeroInfo.heroTeam);for(var e=0,o=t.length;e<o;++e)t[e].sort(this._SortInCamp);this._CommonPlace(this.mCampTitleArr,t)},e.prototype._SortInCamp=function(t,e){var o=m.default.Ins.GetHeroSI(t),n=m.default.Ins.GetHeroSI(e);if(o.heroQuality!==n.heroQuality)return-(o.heroQuality-n.heroQuality);if(o.starLv!==n.starLv)return-(o.starLv-n.starLv);var r=p.default.Ins.m_DB.heroCardDB[t],i=p.default.Ins.m_DB.heroCardDB[e];return r.sortOrder-i.sortOrder},e.prototype._PlaceStars=function(){null!==this.mLastTitleRoot&&(this.mLastTitleRoot.active=!1),this.mStarTitleArr[0].parent.active=!0,this.mLastTitleRoot=this.mStarTitleArr[0].parent;var t=m.default.Ins.GetHeroStarArr();m.default.Ins.ExcludeHeroArr(t,m.default.Ins.mHeroInfo.heroTeam);for(var e=0,o=t.length;e<o;++e)t[e].sort(this._SortInStars);this._CommonPlace(this.mStarTitleArr,t)},e.prototype._SortInStars=function(t,e){var o=m.default.Ins.GetHeroSI(t),n=m.default.Ins.GetHeroSI(e);if(o.heroQuality!==n.heroQuality)return-(o.heroQuality-n.heroQuality);var r=p.default.Ins.m_DB.heroCardDB[t],i=p.default.Ins.m_DB.heroCardDB[e];return r.sortOrder-i.sortOrder},e.prototype._PlaceQuality=function(){null!==this.mLastTitleRoot&&(this.mLastTitleRoot.active=!1),this.mQualityTitleArr[0].parent.active=!0,this.mLastTitleRoot=this.mQualityTitleArr[0].parent;var t=m.default.Ins.GetHeroQualityArr();m.default.Ins.ExcludeHeroArr(t,m.default.Ins.mHeroInfo.heroTeam);for(var e=0,o=t.length;e<o;++e)t[e].sort(this._SortInQuality);this._CommonPlace(this.mQualityTitleArr,t)},e.prototype._SortInQuality=function(t,e){var o=m.default.Ins.GetHeroSI(t),n=m.default.Ins.GetHeroSI(e);if(o.starLv!==n.starLv)return-(o.starLv-n.starLv);var r=p.default.Ins.m_DB.heroCardDB[t],i=p.default.Ins.m_DB.heroCardDB[e];return r.sortOrder-i.sortOrder},e.prototype._PlaceCounter=function(){null!==this.mLastTitleRoot&&(this.mLastTitleRoot.active=!1),this.mCounterTitleArr[0].parent.active=!0,this.mLastTitleRoot=this.mCounterTitleArr[0].parent;var t=m.default.Ins.GetHeroCounterArr();m.default.Ins.ExcludeHeroArr(t,m.default.Ins.mHeroInfo.heroTeam);for(var e=0,o=t.length;e<o;++e)t[e].sort(this._SortInCamp);this._CommonPlace(this.mCounterTitleArr,t)},e.prototype._PlaceProfession=function(){null!==this.mLastTitleRoot&&(this.mLastTitleRoot.active=!1),this.mProfessionTitleArr[0].parent.active=!0,this.mLastTitleRoot=this.mProfessionTitleArr[0].parent;var t=m.default.Ins.GetHeroProfessionArr();m.default.Ins.ExcludeHeroArr(t,m.default.Ins.mHeroInfo.heroTeam);for(var e=0,o=t.length;e<o;++e)t[e].sort(this._SortInCamp);this._CommonPlace(this.mProfessionTitleArr,t)},e.prototype._CommonPlace=function(t,e){for(var o=this,n=0,r=t.length;n<r;++n)t[n].opacity=0;var i=0,a=0,s=0;for(n=0,r=e.length;n<r;++n){var l=e[n];if(s+=l.length,l.length>0){0===i&&(a=-this._OriCampTitleY),t[n].opacity=255,t[n].y=a,a-=this._IconOffsetTilteY;for(var m=function(t){var e=u.mItemMaps.get(l[t]);e&&(e.node.parent!==u.mIdleRoot&&(e.node.parent=u.mIdleRoot,e.node.scale=1),e.node.x=u._IconOriX+t%u._ColumnCount*u._IconWidth,e.node.y=a-Math.floor(t/u._ColumnCount)*u._IconHeight,e.SetCallback(function(){o._ClickIdleIcon(e)}))},u=this,p=0,c=l.length;p<c;++p)m(p);a-=Math.floor((l.length-1)/this._ColumnCount)*this._IconHeight,a-=this._TitleOffsetIconY,i++}}this.mIdleRoot.height=Math.abs(a),this.mEmptyHint.opacity=0===s?255:0},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(f.BCType.ToggleGroup_HeroTeam,this._OnMsg_ClickToggle,this),this.mHasSubscribed||(this.mHasSubscribed=!0,c.default.Subscribe(f.BCType.HeroAdjustTeamWin_AddPos,this._OnMsg_AddPos,this),c.default.Subscribe(f.BCType.HeroAdjustTeamWin_PutHeroOnTeam,this._OnMsg_PutHeroOnTeam,this),c.default.Subscribe(f.BCType.HeroAdjustTeamWin_PutHeroOffTeam,this._OnMsg_PutHeroOffTeam,this),c.default.Subscribe(f.BCType.OnUpgradeHeroMedalLv,this._OnMsg_OnUpgradeMedalLv,this),c.default.Subscribe(f.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),c.default.Subscribe(f.BCType.OnUpgradeHeroQuality,this._OnMsg_UpgradeQuality,this),c.default.Subscribe(f.BCType.Skin_Equip,this._OnMsg_EquipSkin,this))},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(f.BCType.ToggleGroup_HeroTeam,this._OnMsg_ClickToggle,this)},e.prototype._ClickTeamIcon=function(t){m.default.Ins.GetTeamEmptyPosCount()!==m.default.Ins.mHeroInfo.heroTeam.length-1?u.default.Ins.Open(f.WinType.RecycleMedalWin,function(e){e.SetData(t.mHeroSI.id)}):u.default.Ins.ShowTips("\u81f3\u5c11\u8981\u6709\u4e00\u4f4d\u6b66\u5c06\u5728\u9635\u4e0a")},e.prototype._ClickIdleIcon=function(t){m.default.Ins.PutHeroOnTeam(t.mHeroSI.id)},e.prototype._OnMsg_ClickToggle=function(t,e){switch(void 0===e&&(e=!1),e||d.default.PlayBtnSound(),t){case 0:this._PlaceQuality();break;case 1:this._PlaceStars();break;case 2:this._PlaceCamp();break;case 3:this._PlaceCounter();break;case 4:this._PlaceProfession()}this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._OnMsg_AddPos=function(){this._PlaceTeamHeros(),this.mExtendCostLbl.string=m.default.Ins.GetExtendPosCost()+""},e.prototype._OnMsg_PutHeroOnTeam=function(){this._PlaceTeamHeros(),this._RefreshIdlePos()},e.prototype._RefreshIdlePos=function(){switch(this.mToggleGroup.CurToggleIdx){case 0:this._PlaceQuality();break;case 1:this._PlaceStars();break;case 2:this._PlaceCamp()}},e.prototype._OnMsg_PutHeroOffTeam=function(t){this._PlaceTeamHeros(),this._RefreshIdlePos(),this.mItemMaps.get(t).UpdateOnPutoff()},e.prototype._OnMsg_OnUpgradeMedalLv=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateOnUpgradeMedalLv()},e.prototype._OnMsg_OnUpgradeStarLv=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateOnUpgradeStarLv()},e.prototype._OnMsg_UpgradeQuality=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateOnUpgradeQuality()},e.prototype._OnMsg_ShowHeroWin=function(){this.Invoke_Back()},e.prototype._OnMsg_EquipSkin=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateOnChangeSkin()},e.prototype.Invoke_Back=function(){d.default.PlayBtnSound(),u.default.Ins.Close(f.WinType.HeroAdjustTeamWin),u.default.Ins.Open(f.WinType.HeroWin,null,!0)},e.prototype.Invoke_AddPos=function(){d.default.PlayBtnSound(),m.default.Ins.mHeroInfo.heroTeam.length<m.default.HERO_MAX_NUM&&u.default.Ins.Open(f.WinType.AddPosWin,function(t){t.SetData()})},i([g(cc.Node)],e.prototype,"mTeamRoot",void 0),i([g(cc.Node)],e.prototype,"mIdleRoot",void 0),i([g(l.default)],e.prototype,"mToggleGroup",void 0),i([g(cc.Node)],e.prototype,"mTemplate",void 0),i([g(cc.Node)],e.prototype,"mHeroIconCacheRoot",void 0),i([g(cc.Node)],e.prototype,"mEmptyHeroTemplate",void 0),i([g(cc.Node)],e.prototype,"mAddPlaceBtn",void 0),i([g([cc.Node])],e.prototype,"mCampTitleArr",void 0),i([g([cc.Node])],e.prototype,"mStarTitleArr",void 0),i([g([cc.Node])],e.prototype,"mQualityTitleArr",void 0),i([g([cc.Node])],e.prototype,"mCounterTitleArr",void 0),i([g([cc.Node])],e.prototype,"mProfessionTitleArr",void 0),i([g(cc.Node)],e.prototype,"mEmptyHint",void 0),i([g(cc.Label)],e.prototype,"mExtendCostLbl",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/TeamHeroIcon":"TeamHeroIcon","./WinBase":"WinBase"}],HeroAttrPanel:[function(t,e,o){"use strict";cc._RF.push(e,"8dd85zZYbJLFq5jaiENyh4Z","HeroAttrPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/DataMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMask=null,e.mAtk=null,e.mDef=null,e.mHP=null,e.mDodge=null,e.mResist=null,e.mCrit=null,e.mCritDmg=null,e.mAtkDist=null,e.mAtkSpd=null,e.mMoveSpd=null,e.mVertigo=null,e.mCurHeroID=0,e}return r(e,t),e.prototype._Event_Click=function(){this.node.active=!1},e.prototype.Open=function(t){if(this.node.active=!0,this.mMask.once(cc.Node.EventType.TOUCH_END,this._Event_Click,this),this.mCurHeroID!==t){this.mCurHeroID=t;var e=a.default.Ins.m_DB.entityDB[t];this.mAtk.string=e.attack,this.mDef.string=e.defend,this.mHP.string=e.hp,this.mDodge.string=e.dodge+"%",this.mResist.string=e.resist+"%",this.mCrit.string=e.crit+"%",this.mCritDmg.string=100*(e.critDmgAdd+1)+"%",this.mAtkDist.string=e.attackDist,this.mAtkSpd.string=e.atkSpeed,this.mMoveSpd.string=e.moveSpeed,this.mVertigo.string=e.vertigo+"%"}},i([m(cc.Node)],e.prototype,"mMask",void 0),i([m(cc.Label)],e.prototype,"mAtk",void 0),i([m(cc.Label)],e.prototype,"mDef",void 0),i([m(cc.Label)],e.prototype,"mHP",void 0),i([m(cc.Label)],e.prototype,"mDodge",void 0),i([m(cc.Label)],e.prototype,"mResist",void 0),i([m(cc.Label)],e.prototype,"mCrit",void 0),i([m(cc.Label)],e.prototype,"mCritDmg",void 0),i([m(cc.Label)],e.prototype,"mAtkDist",void 0),i([m(cc.Label)],e.prototype,"mAtkSpd",void 0),i([m(cc.Label)],e.prototype,"mMoveSpd",void 0),i([m(cc.Label)],e.prototype,"mVertigo",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr"}],HeroDetailQualityPanel:[function(t,e,o){"use strict";cc._RF.push(e,"ae0a38lYK9G85Y3Sb+M541+","HeroDetailQualityPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SkillDetailPanel"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCurQualitySp=null,e.mNextQualitySp=null,e.mArrowNode=null,e.mAddNumLbl=null,e.mFragmentNumLbl=null,e.mAwakenStoneNumLbl=null,e.mFragmentPB=null,e.mAwakenPB=null,e.mAwakeBtnNode=null,e.mSkillDetailPanel=null,e.mAwakeSkillSp=null,e.mHeroID=0,e.mHeroSI=null,e.mHeroData=null,e.mOwnerWin=null,e.mCurQuality=d.HeroQuality.R,e}return r(e,t),e.prototype.OnFirstOpen=function(){this.mAwakeSkillSp.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_SkillTouchStart,this),this.mAwakeSkillSp.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_SkillTouchEnd,this),this.mAwakeSkillSp.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_SkillTouchCancel,this)},e.prototype.SetData=function(t,e){this.mOwnerWin=e,this.mHeroID!==t&&(this.mHeroID=t,this.mHeroSI=s.default.Ins.GetHeroSI(t),this.mHeroData=p.default.Ins.m_DB.heroCardDB[t]),this.mCurQuality=this.mHeroData.baseQuality,null!==this.mHeroSI&&(this.mCurQuality=this.mHeroSI.heroQuality),this._UpdateByQuality(this.mCurQuality),u.default.Ins.LoadHeroSkillSp(t,9,this.mAwakeSkillSp)},e.prototype._UpdateByQuality=function(t){if(t===d.HeroQuality.SP)this.mCurQualitySp.node.x=0,this.mArrowNode.opacity=0,this.mNextQualitySp.node.opacity=0,this.mCurQualitySp.spriteFrame=this.mOwnerWin.mQuality2SFArr[t],this.mFragmentPB.node.active=!1,this.mAwakenPB.node.active=!1,this.mAwakeBtnNode.active=!1,this.mAddNumLbl.string="+"+(100*(s.default.Ins.mQualityFactorArr[t-1]-1)).toFixed(0)+"%";else{this.mAddNumLbl.string="+"+(100*(s.default.Ins.mQualityFactorArr[t]-1)).toFixed(0)+"%",this.mCurQualitySp.node.x=-84,this.mArrowNode.opacity=255,this.mNextQualitySp.node.opacity=255,this.mCurQualitySp.spriteFrame=this.mOwnerWin.mQuality2SFArr[t],this.mNextQualitySp.spriteFrame=this.mOwnerWin.mQuality2SFArr[t+1],this.mFragmentPB.node.active=!0,this.mAwakenPB.node.active=!0,this.mAwakeBtnNode.active=!0;var e=m.default.Ins.GetItemNum(this.mHeroID),o=s.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,t,s.default.MAX_STAR_LV);this.mFragmentNumLbl.string=e+"/"+o,this.mFragmentPB.progress=e/o;var n=m.default.Ins.GetItemNum(d.ItemType.Awake),r=s.default.Ins.mAwakeNeedArr[t];this.mAwakenStoneNumLbl.string=n+"/"+r,this.mAwakenPB.progress=n/r}},e.prototype.Subscribe=function(){},e.prototype.Remove=function(){},e.prototype._OnNodeEvent_SkillTouchStart=function(){this.mSkillDetailPanel.SetData(this.mHeroID,9),this.mSkillDetailPanel.node.active=!0},e.prototype._OnNodeEvent_SkillTouchEnd=function(){this.mSkillDetailPanel.node.active=!1},e.prototype._OnNodeEvent_SkillTouchCancel=function(){this.mSkillDetailPanel.node.active=!1},e.prototype.Invoke_Awaken=function(){if(c.default.PlayBtnSound(),this.mCurQuality!==d.HeroQuality.SP){var t=m.default.Ins.GetItemNum(this.mHeroID),e=s.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,this.mCurQuality,s.default.MAX_STAR_LV),o=m.default.Ins.GetItemNum(d.ItemType.Awake),n=s.default.Ins.mAwakeNeedArr[this.mCurQuality];if(t<e)l.default.Ins.ShowTips("\u788e\u7247\u4e0d\u8db3~");else if(o<n)l.default.Ins.ShowTips("\u89c9\u9192\u77f3\u4e0d\u8db3~");else{var r=s.default.Ins.GetHeroAtk(this.mHeroID).ToString(2),i=s.default.Ins.GetHeroDef(this.mHeroID).ToString(2),a=s.default.Ins.GetHeroHP(this.mHeroID).ToString(2);m.default.Ins.UpdateItem(this.mHeroID,-e),m.default.Ins.UpdateItem(d.ItemType.Awake,-n),s.default.Ins.UpgradeQuality(this.mHeroID),this.SetData(this.mHeroID,this.mOwnerWin);var u=this;l.default.Ins.Open(d.WinType.QualitySuccessWin,function(t){t.SetData(u.mHeroID,r,i,a)})}}else l.default.Ins.ShowTips("\u5f53\u524d\u5df2\u7ecf\u6700\u9ad8\u54c1\u8d28")},i([y(cc.Sprite)],e.prototype,"mCurQualitySp",void 0),i([y(cc.Sprite)],e.prototype,"mNextQualitySp",void 0),i([y(cc.Node)],e.prototype,"mArrowNode",void 0),i([y(cc.Label)],e.prototype,"mAddNumLbl",void 0),i([y(cc.Label)],e.prototype,"mFragmentNumLbl",void 0),i([y(cc.Label)],e.prototype,"mAwakenStoneNumLbl",void 0),i([y(cc.ProgressBar)],e.prototype,"mFragmentPB",void 0),i([y(cc.ProgressBar)],e.prototype,"mAwakenPB",void 0),i([y(cc.Node)],e.prototype,"mAwakeBtnNode",void 0),i([y(a.default)],e.prototype,"mSkillDetailPanel",void 0),i([y(cc.Sprite)],e.prototype,"mAwakeSkillSp",void 0),i([h],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","./SkillDetailPanel":"SkillDetailPanel"}],HeroDetailSkinItem:[function(t,e,o){"use strict";cc._RF.push(e,"51107x0IMpImaFwomdy3aMX","HeroDetailSkinItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySkin"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkinSp=null,e.mTagSp=null,e.mSkinStateLbl=null,e.mEquipBtnNode=null,e.mCurSkinID=0,e.mCurSkinData=null,e.mSkinPanelWin=null,e.mIsEmpty=!1,e.mHeroID=0,e}return r(e,t),e.prototype.SetData=function(t,e,o){if(void 0===o&&(o=!1),this.mSkinPanelWin=e,this.mIsEmpty=o,this.mCurSkinID!==t.id){this.mCurSkinID=t.id,this.mCurSkinData=t,this.mHeroID=t.entityID,this.mTagSp.spriteFrame=e.mTagSFArr[this.mCurSkinData.quality];var n=this;this.mCurSkinData.fromType===a.SkinFromType.Default?m.default.Ins.LoadTexture("texture/hero/"+n.mCurSkinData.sprite,function(t){if(null!==n.mSkinSp){n.mSkinSp.spriteFrame=t;var e=n.mCurSkinData.offset;c.default.ResetSpriteSize(n.mSkinSp,n.mSkinSp.spriteFrame,e[2]),n.mSkinSp.node.position=cc.v3(e[0],e[1],0)}},null):m.default.Ins.LoadSpriteFrame(this.mCurSkinData.atlas,this.mCurSkinData.sprite,this.mSkinSp,function(t){if(null!==n.mSkinSp){n.mSkinSp.spriteFrame=t;var e=n.mCurSkinData.offset;c.default.ResetSpriteSize(n.mSkinSp,n.mSkinSp.spriteFrame,e[2]),n.mSkinSp.node.position=cc.v3(e[0],e[1],0)}})}},e.prototype.UpdateState=function(){this.mIsEmpty||(s.default.Ins.GetHeroSI(this.mHeroID)?a.default.Ins.CheckHasSkin(this.mCurSkinID,!0)?a.default.Ins.GetHeroCurSkinData(this.mHeroID).id===this.mCurSkinID?(this.mEquipBtnNode.active=!1,this.mSkinStateLbl.string="\u7a7f\u6234\u4e2d"):(this.mSkinStateLbl.string="",this.mEquipBtnNode.active=!0):(this.mEquipBtnNode.active=!1,this.mSkinStateLbl.string=a.default.Ins.GetSkinFromDesc(this.mCurSkinData.fromType)):(this.mEquipBtnNode.active=!1,this.mSkinStateLbl.string="\u8bf7\u5148\u83b7\u5f97\u6b66\u5c06"))},e.prototype.Invoke_Click=function(){if(u.default.PlayBtnSound(),this.mIsEmpty)l.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u671f\u5f85\u65b0\u7684\u76ae\u80a4\u54df~");else{var t=this;l.default.Ins.Open(p.WinType.SkinPreviewWin,function(e){e.SetData(t.mCurSkinID)})}},e.prototype.Invoke_Equip=function(){u.default.PlayBtnSound(),s.default.Ins.GetHeroSI(this.mHeroID)?a.default.Ins.CheckHasSkin(this.mCurSkinID,!0)?a.default.Ins.GetHeroCurSkinData(this.mHeroID).id!==this.mCurSkinID?s.default.Ins.EquipSkin(this.mCurSkinID):console.error("\u5f53\u524d\u6574\u7a7f\u6234\u8be5\u76ae\u80a4\uff0c\u8bf7\u68c0\u67e5\u903b\u8f91"):console.error("\u672a\u62e5\u6709\u8be5\u76ae\u80a4\uff0c\u8bf7\u68c0\u67e5\u903b\u8f91"):console.error("\u672a\u62e5\u6709\u8be5\u6b66\u5c06\uff0c\u8bf7\u68c0\u67e5\u903b\u8f91")},i([h(cc.Sprite)],e.prototype,"mSkinSp",void 0),i([h(cc.Sprite)],e.prototype,"mTagSp",void 0),i([h(cc.Label)],e.prototype,"mSkinStateLbl",void 0),i([h(cc.Node)],e.prototype,"mEquipBtnNode",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxySkin":"ProxySkin"}],HeroDetailSkinPanel:[function(t,e,o){"use strict";cc._RF.push(e,"a3c50pEUSJNp7phP05bi9Ix","HeroDetailSkinPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./HeroDetailSkinItem"),s=t("../../Proxy/ProxySkin"),l=t("../../Manager/BCMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mEmptySkin=null,e.mContentRoot=null,e.mTagSFArr=[],e.mOpenTimes=0,e.mCurHeroID=0,e.mWin=null,e.mCellWidth=0,e.mItemArr=[],e}return r(e,t),e.prototype.Open=function(){0===this.mOpenTimes&&this._OnFirstOpen(),this.mOpenTimes++,this._OnOpen()},e.prototype._OnOpen=function(){this.node.active=!0},e.prototype._OnFirstOpen=function(){this.mCellWidth=this.mTemplate.node.width,this.mItemArr.push(this.mTemplate)},e.prototype.Close=function(){this.node.active=!1},e.prototype.SetData=function(t,e){if(this.mWin=e,this.mCurHeroID!==t){this.mCurHeroID=t;var o=s.default.Ins.GetSkinsByHero(t);if(this.mItemArr.length<o.length)for(var n=o.length-this.mItemArr.length,r=0;r<n;++r){var i=cc.instantiate(this.mTemplate.node);i.parent=this.mContentRoot,this.mItemArr.push(i.getComponent(a.default))}r=0;for(var l=this.mItemArr.length;r<l;++r)this.mItemArr[r].node.active=!1;if(this.mEmptySkin.node.active=!1,1===o.length)this.mItemArr[0].node.active=!0,this.mItemArr[0].SetData(o[0],this),this.mItemArr[0].node.position=cc.v3(.5*this.mCellWidth,0,0),this.mEmptySkin.node.active=!0,this.mEmptySkin.node.position=cc.v3(.5*this.mCellWidth+this.mCellWidth,0,0),this.mEmptySkin.SetData(o[0],this,!0);else if(2===o.length)for(r=0,l=o.length;r<l;++r)this.mItemArr[r].node.active=!0,this.mItemArr[r].SetData(o[r],this),this.mItemArr[r].node.position=cc.v3(.5*this.mCellWidth+r*this.mCellWidth,0,0);else for(r=0,l=o.length;r<l;++r)this.mItemArr[r].node.active=!0,this.mItemArr[r].SetData(o[r],this),this.mItemArr[r].node.position=cc.v3(.5*this.mCellWidth+r*this.mCellWidth,0,0)}for(r=0,l=this.mItemArr.length;r<l;++r)this.mItemArr[r].UpdateState()},e.prototype.Subscribe=function(){l.default.Subscribe(m.BCType.Skin_Equip,this._OnMsg_EquipSkin,this)},e.prototype.Remove=function(){l.default.Remove(m.BCType.Skin_Equip,this._OnMsg_EquipSkin,this)},e.prototype._OnMsg_EquipSkin=function(){for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateState()},i([c(a.default)],e.prototype,"mTemplate",void 0),i([c(a.default)],e.prototype,"mEmptySkin",void 0),i([c(cc.Node)],e.prototype,"mContentRoot",void 0),i([c([cc.SpriteFrame])],e.prototype,"mTagSFArr",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxySkin":"ProxySkin","./HeroDetailSkinItem":"HeroDetailSkinItem"}],HeroDetailStarPanel:[function(t,e,o){"use strict";cc._RF.push(e,"522decyUltHWYScvX7w0+zy","HeroDetailStarPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SkillDetailPanel"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/AudioMgr"),d=t("../../MainGame"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCurStarSp=null,e.mNextStarSp=null,e.mArrowNode=null,e.mSkillSpArr=[],e.mSkillTypeSpArr=[],e.mUnlockLblArr=[],e.mFragmentPB=null,e.mFragmentNumLbl=null,e.mSkillDetailPanel=null,e.mUpgradeBtnNode=null,e.mStarHintLbl=null,e.mQualityNode=null,e.mInstructionNode=null,e.mHeroID=0,e.mHeroSI=null,e.mHeroData=null,e.mCurStar=1,e.mCurQuality=f.HeroQuality.R,e.mOwnerWin=null,e}return r(e,t),e.prototype.OnFirstOpen=function(){for(var t=0,e=this.mSkillSpArr.length;t<e;++t)this.mSkillSpArr[t].node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_SkillTouchStart,this),this.mSkillSpArr[t].node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_SkillTouchEnd,this),this.mSkillSpArr[t].node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_SkillTouchCancel,this);this.mInstructionNode.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_QualityTouchStart,this),this.mInstructionNode.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_QualityTouchEnd,this),this.mInstructionNode.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_QualityTouchCancel,this)},e.prototype.SetData=function(t,e){if(this.mOwnerWin=e,this.mHeroID!==t){this.mHeroID=t,this.mHeroSI=s.default.Ins.GetHeroSI(t),this.mHeroData=p.default.Ins.m_DB.heroCardDB[this.mHeroID];for(var o=1;o<=s.default.MAX_STAR_LV;++o)u.default.Ins.LoadHeroSkillSp(t,o,this.mSkillSpArr[o-1])}var n=1;null!==this.mHeroSI&&(n=this.mHeroSI.starLv),this.mCurStar=n,n===s.default.MAX_STAR_LV||null===this.mHeroSI?(this.mCurStarSp.spriteFrame=this.mOwnerWin.mStarSFArr[n-1],this.mCurStarSp.node.x=0,this.mNextStarSp.node.opacity=0,this.mArrowNode.opacity=0,this.mFragmentPB.node.active=!1,this.mUpgradeBtnNode.active=!1,this.mStarHintLbl.node.opacity=255,n===s.default.MAX_STAR_LV?this.mStarHintLbl.string="\u5df2\u6ee1\u661f\uff0c\u6b66\u5c06\u53ef\u89c9\u9192":this.mStarHintLbl.string="\u8bf7\u5148\u524d\u5f80\u6b66\u5c06\u5546\u5e97\u83b7\u53d6\u8be5\u6b66\u5c06"):(this.mCurStarSp.node.x=-97,this.mNextStarSp.node.opacity=255,this.mArrowNode.opacity=255,this.mCurStarSp.spriteFrame=this.mOwnerWin.mStarSFArr[n-1],this.mNextStarSp.spriteFrame=this.mOwnerWin.mStarSFArr[n],this.mFragmentPB.node.active=!0,this.mUpgradeBtnNode.active=!0,this.mStarHintLbl.node.opacity=0);var r=n;null===this.mHeroSI&&(r=s.default.MAX_STAR_LV),o=0;for(var i=this.mSkillSpArr.length;o<i;++o)r>o?(this.mSkillSpArr[o].setMaterial(0,d.default.mDefaultMat),this.mSkillTypeSpArr[o].setMaterial(0,d.default.mDefaultMat),o>0&&(this.mUnlockLblArr[o-1].node.opacity=0)):(this.mSkillSpArr[o].setMaterial(0,d.default.mGrayMat),this.mSkillTypeSpArr[o].setMaterial(0,d.default.mGrayMat),this.mUnlockLblArr[o-1].node.opacity=255);var a=m.default.Ins.GetItemNum(this.mHeroID),l=this.mHeroData.baseQuality;null!==this.mHeroSI&&(l=this.mHeroSI.heroQuality),this.mCurQuality=l;var c=s.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,l,n);this.mFragmentPB.progress=a/c,this.mFragmentNumLbl.string=a+"/"+c},e.prototype._OnNodeEvent_SkillTouchStart=function(t){if(t.currentTarget){var e=Number(t.currentTarget.name);this.mSkillDetailPanel.SetData(this.mHeroID,e),this.mSkillDetailPanel.node.active=!0}},e.prototype._OnNodeEvent_SkillTouchEnd=function(){this.mSkillDetailPanel.node.active=!1},e.prototype._OnNodeEvent_SkillTouchCancel=function(){this.mSkillDetailPanel.node.active=!1},e.prototype._OnNodeEvent_QualityTouchStart=function(){this.mQualityNode.active=!0},e.prototype._OnNodeEvent_QualityTouchEnd=function(){this.mQualityNode.active=!1},e.prototype._OnNodeEvent_QualityTouchCancel=function(){this.mQualityNode.active=!1},e.prototype.Invoke_UpgradeStar=function(){c.default.PlayBtnSound();var t=m.default.Ins.GetItemNum(this.mHeroID),e=s.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,this.mCurQuality,this.mCurStar);if(t<e)l.default.Ins.ShowTips("\u788e\u7247\u6570\u91cf\u4e0d\u8db3~");else{var o=s.default.Ins.GetHeroAtk(this.mHeroID).ToString(2),n=s.default.Ins.GetHeroDef(this.mHeroID).ToString(2),r=s.default.Ins.GetHeroHP(this.mHeroID).ToString(2);m.default.Ins.UpdateItem(this.mHeroID,-e),s.default.Ins.UpgradeStarLv(this.mHeroID),this.SetData(this.mHeroID,this.mOwnerWin);var i=this;l.default.Ins.Open(f.WinType.StarSuccessWin,function(t){t.SetData(i.mHeroID,o,n,r)})}},i([g(cc.Sprite)],e.prototype,"mCurStarSp",void 0),i([g(cc.Sprite)],e.prototype,"mNextStarSp",void 0),i([g(cc.Node)],e.prototype,"mArrowNode",void 0),i([g([cc.Sprite])],e.prototype,"mSkillSpArr",void 0),i([g([cc.Sprite])],e.prototype,"mSkillTypeSpArr",void 0),i([g([cc.Label])],e.prototype,"mUnlockLblArr",void 0),i([g(cc.ProgressBar)],e.prototype,"mFragmentPB",void 0),i([g(cc.Label)],e.prototype,"mFragmentNumLbl",void 0),i([g(a.default)],e.prototype,"mSkillDetailPanel",void 0),i([g(cc.Node)],e.prototype,"mUpgradeBtnNode",void 0),i([g(cc.Label)],e.prototype,"mStarHintLbl",void 0),i([g(cc.Node)],e.prototype,"mQualityNode",void 0),i([g(cc.Node)],e.prototype,"mInstructionNode",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","./SkillDetailPanel":"SkillDetailPanel"}],HeroDetailTrainPanel:[function(t,e,o){"use strict";cc._RF.push(e,"58e6eL9ZXpCgpu+nJSpVjp+","HeroDetailTrainPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/BCMgr"),s=t("../../Manager/UserMgr"),l=t("../../Manager/AudioMgr"),m=t("../../MainGame"),u=t("../../Manager/WinMgr"),p=t("../../Proxy/ProxyHero"),c=t("../../Proxy/ProxyLargeNum"),d=t("./HeroAttrPanel"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMedalLvLbl=null,e.mAtkLbl=null,e.mDefLbl=null,e.mHpLbl=null,e.mOwnMedalNumLbl=null,e.mCost1Lbl=null,e.mCost10Lbl=null,e.mCost100Lbl=null,e.mBtn1Sp=null,e.mBtn10Sp=null,e.mBtn100Sp=null,e.mFastBtnRoot=null,e.mBtn1Node=null,e.mMedalBgNode=null,e.mMedalNumBgNode=null,e.mHintLbl=null,e.mAttrPanel=null,e.mCurHeroID=0,e.mHeroSI=null,e.mOwnerWin=null,e.mLastClickBtnFrame=0,e.mIsFastBtnOn=!1,e.mPersistDuration=2.5,e.mTiming=e.mPersistDuration,e}return r(e,t),e.prototype.Subscribe=function(){a.default.Subscribe(f.BCType.Common_UpdateItem,this._OnMsg_UpdateMedalNumUI,this),a.default.Subscribe(f.BCType.OnUpgradeHeroMedalLv,this._OnMsg_OnUpgradeHeroMedal,this),a.default.Subscribe(f.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),a.default.Subscribe(f.BCType.OnUpgradeHeroQuality,this._OnMsg_OnUpgradeQuality,this)},e.prototype.Remove=function(){a.default.Remove(f.BCType.Common_UpdateItem,this._OnMsg_UpdateMedalNumUI,this),a.default.Remove(f.BCType.OnUpgradeHeroMedalLv,this._OnMsg_OnUpgradeHeroMedal,this),a.default.Remove(f.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),a.default.Remove(f.BCType.OnUpgradeHeroQuality,this._OnMsg_OnUpgradeQuality,this)},e.prototype.SetData=function(t,e){this.mOwnerWin=e,this.mCurHeroID!==t&&(this.mCurHeroID=t,this.mHeroSI=p.default.Ins.GetHeroSI(t)),this.HideFastBtn(),this._UpdateUI(),this._UpdateMedalBtnUI()},e.prototype._UpdateUI=function(){this._UpdateAttribute(),this.mOwnMedalNumLbl.string=c.default.FormatNumber(Math.floor(s.default.Ins.GetItemNum(f.ItemType.Medal)),1),null!==this.mHeroSI&&(this.mCost1Lbl.string=c.default.FormatNumber(Math.floor(p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,1)),1))},e.prototype._UpdateAttribute=function(){null!==this.mHeroSI?this.mMedalLvLbl.string="+"+this.mHeroSI.medalLv:this.mMedalLvLbl.string="+0",this._UpdateADH()},e.prototype._UpdateADH=function(){this.mAtkLbl.string=p.default.Ins.GetHeroAtk(this.mCurHeroID).ToString(),this.mDefLbl.string=p.default.Ins.GetHeroDef(this.mCurHeroID).ToString(),this.mHpLbl.string=p.default.Ins.GetHeroHP(this.mCurHeroID).ToString()},e.prototype._UpdateMedalBtnUI=function(){var t=p.default.Ins.GetHeroSI(this.mCurHeroID),e=p.default.Ins.CheckHeroInTeam(this.mCurHeroID);null===t?(this.mBtn1Node.active=!1,this.mMedalBgNode.opacity=0,this.mMedalNumBgNode.opacity=0,this.mHintLbl.node.opacity=255,this.mHintLbl.string="\u8bf7\u5148\u524d\u5f80\u6b66\u5c06\u5546\u5e97\u83b7\u5f97\u8be5\u6b66\u5c06"):e?(this.mBtn1Node.active=!0,this.mMedalBgNode.opacity=255,this.mMedalNumBgNode.opacity=255,this.mHintLbl.node.opacity=0):(this.mBtn1Node.active=!1,this.mMedalBgNode.opacity=0,this.mMedalNumBgNode.opacity=0,this.mHintLbl.node.opacity=255,this.mHintLbl.string="\u4e0a\u9635\u6b66\u5c06\u540e\u624d\u80fd\u57f9\u517b")},e.prototype._UpdateUIAfterInvokeUpgrade=function(){null!==this.mHeroSI&&(this.mCost1Lbl.string=c.default.FormatNumber(p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,1),1)),this._UpdateFastCostUI()},e.prototype.update=function(t){this.mIsFastBtnOn&&(this.mTiming-=t,this.mTiming<=0&&this.HideFastBtn())},e.prototype._OnMsg_UpdateMedalNumUI=function(t){if(t===f.ItemType.Medal){var e=s.default.Ins.GetItemNum(f.ItemType.Medal);this.mOwnMedalNumLbl.string=c.default.FormatNumber(e),this._UpdateFastIsEnoughUI()}},e.prototype._OnMsg_OnUpgradeHeroMedal=function(){this._UpdateAttribute()},e.prototype._OnMsg_OnUpgradeStarLv=function(){this._UpdateADH()},e.prototype._OnMsg_OnUpgradeQuality=function(){this._UpdateADH()},e.prototype._CheckFastBtn=function(){m.default.mFrameCount-this.mLastClickBtnFrame<=60&&this.ShowFastBtn(),this.mIsFastBtnOn&&this._UpdateFastBtn(),this.mLastClickBtnFrame=m.default.mFrameCount},e.prototype._UpdateFastBtn=function(){this.mTiming=this.mPersistDuration},e.prototype.ShowFastBtn=function(){this.mIsFastBtnOn||(this.mIsFastBtnOn=!0,this.mFastBtnRoot.active=!0,this.mTiming=this.mPersistDuration,this._UpdateFastCostUI(),this._UpdateFastIsEnoughUI())},e.prototype._UpdateFastCostUI=function(){null!==this.mHeroSI&&this.mIsFastBtnOn&&(this.mCost10Lbl.string=c.default.FormatNumber(p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,10),1),this.mCost100Lbl.string=c.default.FormatNumber(p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,100),1))},e.prototype._UpdateMedalIsEnough=function(){null!==this.mHeroSI&&(s.default.Ins.GetItemNum(f.ItemType.Medal)>=p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,1)?this.mBtn1Sp.setMaterial(0,m.default.mDefaultMat):this.mBtn1Sp.setMaterial(0,m.default.mGrayMat)),this._UpdateFastIsEnoughUI()},e.prototype._UpdateFastIsEnoughUI=function(){if(this.mIsFastBtnOn){var t=s.default.Ins.GetItemNum(f.ItemType.Medal);t>=p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,10)?this.mBtn10Sp.setMaterial(0,m.default.mDefaultMat):this.mBtn10Sp.setMaterial(0,m.default.mGrayMat),t>=p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,100)?this.mBtn100Sp.setMaterial(0,m.default.mDefaultMat):this.mBtn100Sp.setMaterial(0,m.default.mGrayMat)}},e.prototype.HideFastBtn=function(){this.mIsFastBtnOn=!1,this.mFastBtnRoot.active=!1},e.prototype.Press_ShowFastBtn=function(){this.ShowFastBtn()},e.prototype._CommonUpgrade=function(t,e){void 0===e&&(e=!1);var o=s.default.Ins.GetItemNum(f.ItemType.Medal),n=p.default.Ins.GetCostMedal(this.mHeroSI.medalLv,t);o<=n?e&&u.default.Ins.ShowTips("\u52cb\u7ae0\u6570\u91cf\u4e0d\u8db3~"):(l.default.PlaySFX(f.AudioName.UI_MedalUpgrade,!0),this._CheckFastBtn(),p.default.Ins.UpgradeMedalLv(this.mCurHeroID,t),s.default.Ins.UpdateItem(f.ItemType.Medal,-n),s.default.Ins.Save(),this._UpdateUIAfterInvokeUpgrade(),this.mOwnerWin.PlayUpgradeAnim())},e.prototype.Invoke_Upgrade1=function(){l.default.PlayBtnSound(),this._CommonUpgrade(1,!0)},e.prototype.Invoke_Upgrade10=function(){l.default.PlayBtnSound(),this._CommonUpgrade(10)},e.prototype.Invoke_Upgrade100=function(){l.default.PlayBtnSound(),this._CommonUpgrade(100)},e.prototype.Invoke_AttrDetail=function(){l.default.PlayBtnSound(),this.mAttrPanel.Open(this.mCurHeroID)},e.prototype.Invoke_Skin=function(){l.default.PlayBtnSound(),u.default.Ins.ShowTips("\u656c\u8bf7\u671f\u5f85")},i([g(cc.Label)],e.prototype,"mMedalLvLbl",void 0),i([g(cc.Label)],e.prototype,"mAtkLbl",void 0),i([g(cc.Label)],e.prototype,"mDefLbl",void 0),i([g(cc.Label)],e.prototype,"mHpLbl",void 0),i([g(cc.Label)],e.prototype,"mOwnMedalNumLbl",void 0),i([g(cc.Label)],e.prototype,"mCost1Lbl",void 0),i([g(cc.Label)],e.prototype,"mCost10Lbl",void 0),i([g(cc.Label)],e.prototype,"mCost100Lbl",void 0),i([g(cc.Sprite)],e.prototype,"mBtn1Sp",void 0),i([g(cc.Sprite)],e.prototype,"mBtn10Sp",void 0),i([g(cc.Sprite)],e.prototype,"mBtn100Sp",void 0),i([g(cc.Node)],e.prototype,"mFastBtnRoot",void 0),i([g(cc.Node)],e.prototype,"mBtn1Node",void 0),i([g(cc.Node)],e.prototype,"mMedalBgNode",void 0),i([g(cc.Node)],e.prototype,"mMedalNumBgNode",void 0),i([g(cc.Label)],e.prototype,"mHintLbl",void 0),i([g(d.default)],e.prototype,"mAttrPanel",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./HeroAttrPanel":"HeroAttrPanel"}],HeroDetailWin:[function(t,e,o){"use strict";cc._RF.push(e,"225cdRpymhBIrTxfX1W4HN4","HeroDetailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/RedPointNormal"),l=t("../Comp/QuickSelectPanel"),m=t("../Comp/MyToggleGroup"),u=t("../Comp/HeroDetailTrainPanel"),p=t("../Comp/HeroDetailStarPanel"),c=t("../Comp/HeroDetailSkinPanel"),d=t("../Comp/HeroDetailQualityPanel"),f=t("../../Proxy/ProxySkin"),h=t("../../Proxy/ProxyMainTask2"),y=t("../../Proxy/ProxyHero"),g=t("../../Manager/WinMgr"),I=t("../../Manager/ResMgr"),S=t("../../Manager/DataMgr"),_=t("../../Manager/BCMgr"),v=t("../../Manager/AudioMgr"),C=t("../../Common/EnumsDefine"),M=cc._decorator,P=M.ccclass,T=M.property,D=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySFArr=[],e.mQuality2SFArr=[],e.mCampSFArr=[],e.mStarSFArr=[],e.mCounterSFArr=[],e.mProfessionSFArr=[],e.mQualitySp=null,e.mCampSp=null,e.mStarSp=null,e.mCounterSp=null,e.mProfessionSp=null,e.mHeroSk=null,e.mUpgradeSk=null,e.mNameLbl=null,e.mRareTag=null,e.mCounterPanelNode=null,e.mProfessionPanelNode=null,e.mProfessionNameLbl=null,e.mProfessionDescLbl=null,e.mGoldRewardNumLbl=null,e.mBubbleNode=null,e.mDialogLbl=null,e.mToggleGroup=null,e.mQuickPanel=null,e.mTrainPanel=null,e.mStarPanel=null,e.mQualityPanel=null,e.mSkinPanel=null,e.mMedalPoint=null,e.mStarPoint=null,e.mAwakePoint=null,e.mHeroID=0,e.mHeroData=null,e.mEntityData=null,e.mProfessionData=null,e.mHeroSI=null,e.mCurCounterType=C.CounterType.Rock,e.mCurProfessionType=C.ProfessionType.Archer,e.mFromWinType=C.WinType.HeroWin,e.mCurQuality=C.HeroQuality.R,e.mCurStarLv=1,e.mBubbleTween=null,e.mCloseCallback=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mQuickPanel.OnFirstOpen(),this.mToggleGroup.Init(),this.mGoldRewardNumLbl.string="x"+y.default.Ins.mNewHeroGoldNum,this.mCounterSp.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_CounterTouchStart,this),this.mCounterSp.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_CounterTouchEnd,this),this.mCounterSp.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_CounterTouchCancel,this),this.mProfessionSp.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_ProfTouchStart,this),this.mProfessionSp.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_ProfTouchEnd,this),this.mProfessionSp.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_ProfTouchCancel,this),this.mStarPanel.OnFirstOpen(),this.mQualityPanel.OnFirstOpen()},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mQuickPanel.OnOpen()},e.prototype._OnClose=function(){t.prototype._OnClose.call(this),this._HandleHideBanner()},e.prototype._HandleShowBanner=function(){this.mFromWinType!==C.WinType.HeroWin&&this._ShowBanner()},e.prototype._HandleHideBanner=function(){this.mFromWinType!==C.WinType.HeroWin&&this._HideBanner()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),_.default.Subscribe(C.BCType.ToggleGroup_HeroDetail,this._OnMsg_ClickToggle,this),_.default.Subscribe(C.BCType.HeroDetailWin_ClickQuickIcon,this._OnMsg_ClickQuickIcon,this),_.default.Subscribe(C.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),_.default.Subscribe(C.BCType.OnUpgradeHeroQuality,this._OnMsg_OnUpgradeQuality,this),_.default.Subscribe(C.BCType.Skin_Equip,this._OnMsg_EquipSkin,this),this.mQuickPanel.Subscribe(),this.mTrainPanel.Subscribe(),this.mQualityPanel.Subscribe(),this.mSkinPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),_.default.Remove(C.BCType.ToggleGroup_HeroDetail,this._OnMsg_ClickToggle,this),_.default.Remove(C.BCType.HeroDetailWin_ClickQuickIcon,this._OnMsg_ClickQuickIcon,this),_.default.Remove(C.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),_.default.Remove(C.BCType.Skin_Equip,this._OnMsg_EquipSkin,this),this.mQuickPanel.Remove(),this.mTrainPanel.Remove(),this.mQualityPanel.Remove(),this.mSkinPanel.Remove()},e.prototype._UpdateToggleLockState=function(){var t=!1;null!==this.mHeroSI&&this.mHeroSI.starLv===y.default.MAX_STAR_LV?t=!0:2===this.mToggleGroup.CurToggleIdx&&this._OnMsg_ClickToggle(0,!0),this.mToggleGroup.mToggleArr[2].UpdateUnlockState(t)},e.prototype.SetCloseCallback=function(t){this.mCloseCallback=t},e.prototype.SetData=function(t,e){void 0===e&&(e=C.WinType.HeroWin),this.mFromWinType=e,this.mFromWinType===C.WinType.HeroWin?this.mQuickPanel.node.active=!0:this.mQuickPanel.node.active=!1;var o=this;if(this.mHeroID!==t){this.mHeroSI=y.default.Ins.GetHeroSI(t),this.mHeroData=S.default.Ins.m_DB.heroCardDB[t],this.mHeroID=t,this.mEntityData=S.default.Ins.m_DB.entityDB[t],this.mProfessionData=S.default.Ins.m_DB.professionDB[this.mEntityData.profession],this.mHeroSk.node.scale=this.mHeroData.scale;var n=f.default.Ins.GetHeroCurSkinData(this.mHeroID);I.default.Ins.LoadSpine("spine/hero/"+n.model,function(t){null!==o.mHeroSk&&(o.mHeroSk.skeletonData=t,o.mHeroSk.setAnimation(0,"daiji",!0))}),this.mCurQuality=this.mHeroData.baseQuality,null!==this.mHeroSI&&(this.mCurQuality=this.mHeroSI.heroQuality),this.mQualitySp.spriteFrame=this.mQualitySFArr[this.mCurQuality],this.mCampSp.spriteFrame=this.mCampSFArr[this.mHeroData.camp],null!==this.mHeroSI&&(this.mCurStarLv=this.mHeroSI.starLv),this.mStarSp.spriteFrame=this.mStarSFArr[this.mCurStarLv-1],this.mNameLbl.string=this.mHeroData.name,this.mRareTag.opacity=1===this.mHeroData.rare?255:0,this.mCurCounterType=this.mHeroData.counter,this.mCounterSp.spriteFrame=this.mCounterSFArr[this.mCurCounterType],this.mCurProfessionType=this.mEntityData.profession,this.mProfessionSp.spriteFrame=this.mProfessionSFArr[this.mCurProfessionType],this.mProfessionNameLbl.string=this.mProfessionData.name,this.mProfessionDescLbl.string=this.mProfessionData.desc,this.mDialogLbl.string=this.mHeroData.dialog,this.mMedalPoint.UpdatePointName("Main.Hero."+t+".Medal"),this.mStarPoint.UpdatePointName("Main.Hero.Pack."+t+".Star"),this.mAwakePoint.UpdatePointName("Main.Hero.Pack."+t+".Awake")}this.mBubbleNode.opacity=0,this.mBubbleNode.scale=0,null!==this.mBubbleTween&&this.mBubbleTween.stop(),this.mBubbleTween=cc.tween(this.mBubbleNode).delay(1.5).call(function(){o.mBubbleNode.opacity=255}).to(.15,{scale:1}).delay(5).to(.1,{scale:0}).start();var r=h.default.Ins.mCurTaskData;null!==r&&r.taskType===h.MainTaskType.HeroMedalLv&&(this.mToggleGroup.CurToggleIdx=0),-1!==this.mToggleGroup.CurToggleIdx?this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!0):this._OnMsg_ClickToggle(0,!0),this._UpdateToggleLockState(),this._HandleShowBanner()},e.prototype.PlayUpgradeAnim=function(){if(null===this.mUpgradeSk.skeletonData){var t=this;I.default.Ins.LoadSpine("spine/jueseshengji",function(e){t.mUpgradeSk.skeletonData=e,t.mUpgradeSk.setAnimation(0,"animation",!1)})}else this.mUpgradeSk.setAnimation(0,"animation",!1)},e.prototype._OnMsg_ClickToggle=function(t,e){void 0===e&&(e=!1),e||v.default.PlayBtnSound();var o=!0;switch(t){case 2:(o=null!==this.mHeroSI&&this.mHeroSI.starLv===y.default.MAX_STAR_LV)||g.default.Ins.ShowTips("\u6b66\u5c06\u6ee1\u661f\u540e\u89e3\u9501\u89c9\u9192~")}if(o)switch(t){case 0:this.mStarPanel.node.active=!1,this.mQualityPanel.node.active=!1,this.mSkinPanel.Close(),this.mTrainPanel.node.active=!0,this.mTrainPanel.SetData(this.mHeroID,this);break;case 1:this.mTrainPanel.node.active=!1,this.mQualityPanel.node.active=!1,this.mSkinPanel.Close(),this.mStarPanel.node.active=!0,this.mStarPanel.SetData(this.mHeroID,this);break;case 2:this.mTrainPanel.node.active=!1,this.mStarPanel.node.active=!1,this.mSkinPanel.Close(),this.mQualityPanel.node.active=!0,this.mQualityPanel.SetData(this.mHeroID,this);break;case 3:this.mTrainPanel.node.active=!1,this.mStarPanel.node.active=!1,this.mQualityPanel.node.active=!1,this.mSkinPanel.Open(),this.mSkinPanel.SetData(this.mHeroID,this)}o&&this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._OnMsg_ClickQuickIcon=function(t){this.SetData(t)},e.prototype._OnMsg_OnUpgradeStarLv=function(){this.mCurStarLv=this.mHeroSI.starLv,this.mStarSp.spriteFrame=this.mStarSFArr[this.mCurStarLv-1],this.mCurStarLv===y.default.MAX_STAR_LV&&this._UpdateToggleLockState()},e.prototype._OnMsg_OnUpgradeQuality=function(){this.mCurQuality=y.default.Ins.GetHeroSI(this.mHeroID).heroQuality,this.mQualitySp.spriteFrame=this.mQualitySFArr[this.mCurQuality]},e.prototype._OnMsg_EquipSkin=function(){var t=this,e=f.default.Ins.GetHeroCurSkinData(this.mHeroID);I.default.Ins.LoadSpine("spine/hero/"+e.model,function(e){null!==t.mHeroSk&&(t.mHeroSk.skeletonData=e,t.mHeroSk.setAnimation(0,"daiji",!0))})},e.prototype._OnNodeEvent_CounterTouchStart=function(){this.mCounterPanelNode.active=!0},e.prototype._OnNodeEvent_CounterTouchEnd=function(){this.mCounterPanelNode.active=!1},e.prototype._OnNodeEvent_CounterTouchCancel=function(){this.mCounterPanelNode.active=!1},e.prototype._OnNodeEvent_ProfTouchStart=function(){this.mProfessionPanelNode.active=!0},e.prototype._OnNodeEvent_ProfTouchEnd=function(){this.mProfessionPanelNode.active=!1},e.prototype._OnNodeEvent_ProfTouchCancel=function(){this.mProfessionPanelNode.active=!1},e.prototype.Invoke_Back=function(){v.default.PlayBtnSound(),this.CloseWin(),null!==this.mCloseCallback&&(this.mCloseCallback(),this.mCloseCallback=null)},i([T([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([T([cc.SpriteFrame])],e.prototype,"mQuality2SFArr",void 0),i([T([cc.SpriteFrame])],e.prototype,"mCampSFArr",void 0),i([T([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([T([cc.SpriteFrame])],e.prototype,"mCounterSFArr",void 0),i([T([cc.SpriteFrame])],e.prototype,"mProfessionSFArr",void 0),i([T(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([T(cc.Sprite)],e.prototype,"mCampSp",void 0),i([T(cc.Sprite)],e.prototype,"mStarSp",void 0),i([T(cc.Sprite)],e.prototype,"mCounterSp",void 0),i([T(cc.Sprite)],e.prototype,"mProfessionSp",void 0),i([T(sp.Skeleton)],e.prototype,"mHeroSk",void 0),i([T(sp.Skeleton)],e.prototype,"mUpgradeSk",void 0),i([T(cc.Label)],e.prototype,"mNameLbl",void 0),i([T(cc.Node)],e.prototype,"mRareTag",void 0),i([T(cc.Node)],e.prototype,"mCounterPanelNode",void 0),i([T(cc.Node)],e.prototype,"mProfessionPanelNode",void 0),i([T(cc.Label)],e.prototype,"mProfessionNameLbl",void 0),i([T(cc.Label)],e.prototype,"mProfessionDescLbl",void 0),i([T(cc.Label)],e.prototype,"mGoldRewardNumLbl",void 0),i([T(cc.Node)],e.prototype,"mBubbleNode",void 0),i([T(cc.Label)],e.prototype,"mDialogLbl",void 0),i([T(m.default)],e.prototype,"mToggleGroup",void 0),i([T(l.default)],e.prototype,"mQuickPanel",void 0),i([T(u.default)],e.prototype,"mTrainPanel",void 0),i([T(p.default)],e.prototype,"mStarPanel",void 0),i([T(d.default)],e.prototype,"mQualityPanel",void 0),i([T(c.default)],e.prototype,"mSkinPanel",void 0),i([T(s.default)],e.prototype,"mMedalPoint",void 0),i([T(s.default)],e.prototype,"mStarPoint",void 0),i([T(s.default)],e.prototype,"mAwakePoint",void 0),i([P],e)}(a.default);o.default=D,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../../Proxy/ProxySkin":"ProxySkin","../Comp/HeroDetailQualityPanel":"HeroDetailQualityPanel","../Comp/HeroDetailSkinPanel":"HeroDetailSkinPanel","../Comp/HeroDetailStarPanel":"HeroDetailStarPanel","../Comp/HeroDetailTrainPanel":"HeroDetailTrainPanel","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/QuickSelectPanel":"QuickSelectPanel","../Comp/RedPointNormal":"RedPointNormal","./WinBase":"WinBase"}],HeroDmgItem:[function(t,e,o){"use strict";cc._RF.push(e,"2e613zIGK1MtIUrZ+IKNZVn","HeroDmgItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyHero"),s=t("../../Manager/ResMgr"),l=t("../../Manager/ImtBossDmgMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHeroIcon=null,e.mHeroQualitySp=null,e.mSPTag=null,e.mMedalLvLbl=null,e.mDmgLbl=null,e.mProgressBar=null,e.mHeroID=0,e.mHeroSI=null,e}return r(e,t),e.prototype.SetData=function(t){this.mHeroID!==t&&(this.mHeroID=t,this.mHeroSI=a.default.Ins.GetHeroSI(t),s.default.Ins.LoadItemSprite(t,this.mHeroIcon)),null!==this.mHeroSI&&(this.mMedalLvLbl.string="+"+this.mHeroSI.medalLv,this._UpdateQualityUI())},e.prototype._UpdateQualityUI=function(){s.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mHeroQualitySp),this.mHeroSI.heroQuality===m.HeroQuality.SP?this.mSPTag.opacity=255:this.mSPTag.opacity=0},e.prototype.ResetDmgUI=function(){this.mDmgLbl.string="0",this.mProgressBar.progress=0},e.prototype.UpdateDmgUI=function(){var t=l.default.Ins.mHeroDmgMap.get(this.mHeroID);t&&(this.mDmgLbl.string=t.ToString(2),this.mProgressBar.progress=t.GetHPPercent(l.default.Ins.mInitialTotalValue))},i([c(cc.Sprite)],e.prototype,"mHeroIcon",void 0),i([c(cc.Sprite)],e.prototype,"mHeroQualitySp",void 0),i([c(cc.Node)],e.prototype,"mSPTag",void 0),i([c(cc.Label)],e.prototype,"mMedalLvLbl",void 0),i([c(cc.Label)],e.prototype,"mDmgLbl",void 0),i([c(cc.ProgressBar)],e.prototype,"mProgressBar",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/ImtBossDmgMgr":"ImtBossDmgMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero"}],HeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"e89ebf3GW9PYLBnhPm5WxNq","HeroItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./RedPointNormal"),s=t("./MainTaskGuideFinger"),l=t("../../Proxy/ProxyMainTask2"),m=t("../../Proxy/ProxyHero"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/MainTaskGuideMgr"),f=t("../../Manager/DataMgr"),h=t("../../Manager/BCMgr"),y=t("../../Manager/AudioMgr"),g=t("../../MainGame"),I=t("../../Common/EnumsDefine"),S=cc._decorator,_=S.ccclass,v=S.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mStarSFArr=[],e.mStarSp=null,e.mQualitySk=null,e.mQualitySp2=null,e.mQualitySp=null,e.mCampSp=null,e.mHeroSp=null,e.mGoldLvLbl=null,e.mMedalLvLbl=null,e.mNameLbl=null,e.mAtkLbl=null,e.mDefLbl=null,e.mHPLbl=null,e.mFastUpgradeBtnNode=null,e.mCost1Lbl=null,e.mCost10Lbl=null,e.mCost100Lbl=null,e.mCostMaxLbl=null,e.mCost1BtnSp=null,e.mCost10BtnSp=null,e.mCost100BtnSp=null,e.mCostMaxBtnSp=null,e.mCounterSp=null,e.mUpgradeSk=null,e.mUpgrade1BtnNode=null,e.mHeroBtnNode=null,e.mGuideFinger=null,e.mDetailGuideFinger=null,e.mRedPoint=null,e.mHeroSI=null,e.mHeroID=0,e.mOwnerWin=null,e.mItemData=null,e.mHeroData=null,e.mEntityData=null,e.mIsFastBtnOn=!1,e.mPersistDuration=2,e.mTiming=e.mPersistDuration,e.mHeroItemID=1,e.mLastClickBtnFrame=0,e}return r(e,t),e.prototype.update=function(t){this.mIsFastBtnOn&&(this.mTiming-=t,this.mTiming<=0&&this.HideFastBtn())},e.prototype.Init=function(t){this.mOwnerWin=t},e.prototype.SetHeroItemID=function(t){this.mHeroItemID=t,this.mGuideFinger.UpdatePointName(d.MainTaskGuideType.HeroItem+t),this.mDetailGuideFinger.UpdatePointName(d.MainTaskGuideType.HeroItemDetail+t)},e.prototype.SetData=function(t,e){this.mHeroID!==t&&(this.mRedPoint.UpdatePointName("Main.Hero."+t),this.mItemData=f.default.Ins.m_DB.itemDB[t],this.mHeroData=f.default.Ins.m_DB.heroCardDB[t],this.mEntityData=f.default.Ins.m_DB.entityDB[t],this.mHeroID=t,this.mHeroSI=m.default.Ins.GetHeroSI(t),this.mCounterSp.spriteFrame=e.mCounterSFArr[this.mHeroData.counter],c.default.Ins.LoadCampSprite(this.mHeroData.camp,this.mCampSp),this.mNameLbl.string=this.mHeroData.name),c.default.Ins.LoadHeroSkinItemSprite(t,this.mHeroSp),this.mUpgradeSk.node.opacity=0,this._UpdateStarUI(this.mHeroSI.starLv),this._UpdateQualityUI(),this._UpdateAttribute(),this.UpdateUIIfGoldIsEnough(!1)},e.prototype._UpdateStarUI=function(t){this.mStarSp.spriteFrame=this.mStarSFArr[t-1]},e.prototype._UpdateQualityUI=function(){if(c.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mQualitySp),this.mHeroSI.heroQuality===I.HeroQuality.SP){if(this.mQualitySp2.node.opacity=255,null===this.mQualitySp2.spriteFrame){c.default.Ins.LoadSpriteFrame("AutoAtlas/Heros/Heros","pinzhi_sp_neikuang",this.mQualitySp2,null);var t=this;c.default.Ins.LoadSpine("spine/wushuang",function(e){t&&t.mQualitySk&&(t.mQualitySk.skeletonData=e,t.mQualitySk.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),t.mQualitySk.setAnimation(0,"animation",!0))})}}else this.mQualitySp2.node.opacity=0},e.prototype.UpdateADH=function(){this.mAtkLbl.string=m.default.Ins.GetHeroAtk(this.mHeroID).ToString(),this.mDefLbl.string=m.default.Ins.GetHeroDef(this.mHeroID).ToString(),this.mHPLbl.string=m.default.Ins.GetHeroHP(this.mHeroID).ToString()},e.prototype._UpdateAttribute=function(){this.mGoldLvLbl.string="Lv."+this.mHeroSI.goldLv,this.mMedalLvLbl.string=0===this.mHeroSI.medalLv?"":"+"+this.mHeroSI.medalLv,this.mCost1Lbl.string=m.default.Ins.GetCostGold(this.mHeroID).ToString(1),this.UpdateADH()},e.prototype.UpdateOnUpgradeMedal=function(){this.mMedalLvLbl.string=0===this.mHeroSI.medalLv?"":"+"+this.mHeroSI.medalLv,this.UpdateADH()},e.prototype.UpdateOnUpgradeStar=function(){this._UpdateStarUI(this.mHeroSI.starLv),this.UpdateADH()},e.prototype.UpdateOnUpgradeQuality=function(){this.UpdateADH(),this._UpdateQualityUI()},e.prototype.UpdateOnUpgradeGoldLv=function(){this._UpdateAttribute(),this._UpdateFastCostUI(),this.mUpgradeSk.node.opacity=255,this.mUpgradeSk.setAnimation(0,"animation",!1)},e.prototype.UpdateOnBackCity=function(){this._UpdateAttribute()},e.prototype.UpdateRedPoint=function(){m.default.Ins.CheckRedPointMedal(this.mHeroID)},e.prototype.UpdateUIIfGoldIsEnough=function(t){var e=m.default.Ins.GetCostGold(this.mHeroID,1);p.default.Ins.IsCoinEnough(e)?this.mCost1BtnSp.spriteFrame=this.mOwnerWin.mBtnSFArr[0]:this.mCost1BtnSp.spriteFrame=this.mOwnerWin.mBtnSFArr[1],this._UpdateFastIsEnoughUI(),t&&(this.mCost1Lbl.string=e.ToString(1))},e.prototype._UpdateFastIsEnoughUI=function(){if(this.mIsFastBtnOn){var t=m.default.Ins.GetCostGold(this.mHeroID,10);p.default.Ins.IsCoinEnough(t)?this.mCost10BtnSp.setMaterial(0,g.default.mDefaultMat):this.mCost10BtnSp.setMaterial(0,g.default.mGrayMat);var e=m.default.Ins.GetCostGold(this.mHeroID,100);p.default.Ins.IsCoinEnough(e)?this.mCost100BtnSp.setMaterial(0,g.default.mDefaultMat):this.mCost100BtnSp.setMaterial(0,g.default.mGrayMat);var o=m.default.Ins.GetCostGold(this.mHeroID,-1);p.default.Ins.IsCoinEnough(o)&&!o.IsZero()?this.mCostMaxBtnSp.setMaterial(0,g.default.mDefaultMat):this.mCostMaxBtnSp.setMaterial(0,g.default.mGrayMat)}},e.prototype.UpdateOnChangeSkin=function(){c.default.Ins.LoadHeroSkinItemSprite(this.mHeroID,this.mHeroSp)},e.prototype._CheckFastBtn=function(){g.default.mFrameCount-this.mLastClickBtnFrame<=60&&this.ShowFastBtn(),this.mIsFastBtnOn&&this._UpdateFastBtn(),this.mLastClickBtnFrame=g.default.mFrameCount},e.prototype.ShowFastBtn=function(){this.mIsFastBtnOn||(this.mIsFastBtnOn=!0,this.mTiming=this.mPersistDuration,this.mFastUpgradeBtnNode.active=!0,this._UpdateFastCostUI(),this._UpdateFastIsEnoughUI())},e.prototype._UpdateFastBtn=function(){this.mTiming=this.mPersistDuration},e.prototype._UpdateFastCostUI=function(){this.mIsFastBtnOn&&(this.mCost10Lbl.string=m.default.Ins.GetCostGold(this.mHeroID,10).ToString(1),this.mCost100Lbl.string=m.default.Ins.GetCostGold(this.mHeroID,100).ToString(1),this.mCostMaxLbl.string=m.default.Ins.GetCostGold(this.mHeroID,-1).ToString(1))},e.prototype.HideFastBtn=function(){this.mIsFastBtnOn=!1,this.mFastUpgradeBtnNode.active=!1},e.prototype.Invoke_Upgrade1=function(){y.default.PlayBtnSound();var t=m.default.Ins.GetCostGold(this.mHeroID,1);if(p.default.Ins.IsCoinEnough(t))y.default.PlaySFX(I.AudioName.UI_CoinUpgrade,!0),m.default.Ins.UpgradeGoldLv(this.mHeroID),p.default.Ins.MinusCoin(t),this._CheckFastBtn(),h.default.Dispatch(I.BCType.Common_ChangeCoin),this.UpdateOnUpgradeGoldLv();else{var e=l.default.Ins.mCurTaskData;null!==e&&e.taskType===l.MainTaskType.HeroLv&&e.Id<20&&u.default.Ins.ShowTips("\u94f6\u5e01\u4e0d\u8db3\uff0c\u53ef\u524d\u5f80\u6253\u5de5\u754c\u9762\u9886\u53d6\u54e6~")}},e.prototype.Invoke_Upgrade10=function(){y.default.PlayBtnSound(),this._UpdateFastBtn();var t=m.default.Ins.GetCostGold(this.mHeroID,10);p.default.Ins.IsCoinEnough(t)&&(y.default.PlaySFX(I.AudioName.UI_CoinUpgrade,!0),m.default.Ins.UpgradeGoldLv(this.mHeroID,10),p.default.Ins.MinusCoin(t),h.default.Dispatch(I.BCType.Common_ChangeCoin),this.UpdateOnUpgradeGoldLv())},e.prototype.Invoke_Upgrade100=function(){y.default.PlayBtnSound(),this._UpdateFastBtn();var t=m.default.Ins.GetCostGold(this.mHeroID,100);p.default.Ins.IsCoinEnough(t)&&(y.default.PlaySFX(I.AudioName.UI_CoinUpgrade,!0),m.default.Ins.UpgradeGoldLv(this.mHeroID,100),h.default.Dispatch(I.BCType.Common_ChangeCoin),p.default.Ins.MinusCoin(t),this.UpdateOnUpgradeGoldLv())},e.prototype.Invoke_UpgradeMax=function(){y.default.PlayBtnSound(),this._UpdateFastBtn();var t=m.default.Ins.GetCostGold(this.mHeroID,-1);if(p.default.Ins.IsCoinEnough(t)&&!t.IsZero()){y.default.PlaySFX(I.AudioName.UI_CoinUpgrade,!0);var e=m.default.Ins.GetMaxCanUpradeLv(this.mHeroID,p.default.Ins.mCoin);m.default.Ins.UpgradeGoldLv(this.mHeroID,e),p.default.Ins.MinusCoin(t),h.default.Dispatch(I.BCType.Common_ChangeCoin),this.UpdateOnUpgradeGoldLv()}},e.prototype.Invoke_ClickHero=function(){var t=this;y.default.PlayBtnSound(),u.default.Ins.Open(I.WinType.HeroDetailWin,function(e){e.SetData(t.mHeroID)})},i([v([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([v(cc.Sprite)],e.prototype,"mStarSp",void 0),i([v(sp.Skeleton)],e.prototype,"mQualitySk",void 0),i([v(cc.Sprite)],e.prototype,"mQualitySp2",void 0),i([v(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([v(cc.Sprite)],e.prototype,"mCampSp",void 0),i([v(cc.Sprite)],e.prototype,"mHeroSp",void 0),i([v(cc.Label)],e.prototype,"mGoldLvLbl",void 0),i([v(cc.Label)],e.prototype,"mMedalLvLbl",void 0),i([v(cc.Label)],e.prototype,"mNameLbl",void 0),i([v(cc.Label)],e.prototype,"mAtkLbl",void 0),i([v(cc.Label)],e.prototype,"mDefLbl",void 0),i([v(cc.Label)],e.prototype,"mHPLbl",void 0),i([v(cc.Node)],e.prototype,"mFastUpgradeBtnNode",void 0),i([v(cc.Label)],e.prototype,"mCost1Lbl",void 0),i([v(cc.Label)],e.prototype,"mCost10Lbl",void 0),i([v(cc.Label)],e.prototype,"mCost100Lbl",void 0),i([v(cc.Label)],e.prototype,"mCostMaxLbl",void 0),i([v(cc.Sprite)],e.prototype,"mCost1BtnSp",void 0),i([v(cc.Sprite)],e.prototype,"mCost10BtnSp",void 0),i([v(cc.Sprite)],e.prototype,"mCost100BtnSp",void 0),i([v(cc.Sprite)],e.prototype,"mCostMaxBtnSp",void 0),i([v(cc.Sprite)],e.prototype,"mCounterSp",void 0),i([v(sp.Skeleton)],e.prototype,"mUpgradeSk",void 0),i([v(cc.Node)],e.prototype,"mUpgrade1BtnNode",void 0),i([v(cc.Node)],e.prototype,"mHeroBtnNode",void 0),i([v(s.default)],e.prototype,"mGuideFinger",void 0),i([v(s.default)],e.prototype,"mDetailGuideFinger",void 0),i([v(a.default)],e.prototype,"mRedPoint",void 0),i([_],e)}(cc.Component);o.default=C,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/MainTaskGuideMgr":"MainTaskGuideMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyMainTask2":"ProxyMainTask2","./MainTaskGuideFinger":"MainTaskGuideFinger","./RedPointNormal":"RedPointNormal"}],HeroMapWin:[function(t,e,o){"use strict";cc._RF.push(e,"60a31c1zLNKo5dKSuT0t2S1","HeroMapWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/MapItem"),l=t("../../Proxy/ProxyHeroMap"),m=t("../../Manager/UserMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBestLevelLbl=null,e.mTitleLbl=null,e.mTemplate=null,e.mLeftBtnNode=null,e.mRightBtnNode=null,e.mSV=null,e.mDefaultSF=null,e.mActiveSF=null,e.mLockSF=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mCurTabID=1,e.mMapItemArr=[],e.mOriPosY=-106,e.mCellHeight=190,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mTemplate.node.active=!1,this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&c.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mBestLevelLbl.string=m.default.Ins.ClientInfo.bestLevel+"",this.AutoSetTabID(),this.UpdateByTabID(this.mCurTabID)},e.prototype.AutoSetTabID=function(){var t=l.default.Ins.mMapInfo.toGetArr;if(0!==t.length){var e=t[0],o=l.default.Ins.GetTabIDByHeroID(e);-1!==o&&(this.mCurTabID=o)}else{var n=l.default.Ins.GetCachedCurMapID();this.mCurTabID=-1!==n?u.default.Ins.m_DB.heroMapDB[n].tab:l.default.Ins.mDataMap.size}},e.prototype.UpdateByTabID=function(t){1===t?(this.mLeftBtnNode.active=!1,this.mRightBtnNode.active=!0):t===l.default.Ins.mDataMap.size?(this.mRightBtnNode.active=!1,this.mLeftBtnNode.active=!0):(this.mRightBtnNode.active=!0,this.mLeftBtnNode.active=!0),this.mTitleLbl.string="\u7b2c"+t+"\u7ae0";var e=l.default.Ins.mDataMap.get(t);if(e){this.mSV.content.height=this.mCellHeight*e.length,this.mSV.scrollToTop();for(var o=0,n=this.mMapItemArr.length;o<n;++o)this.mMapItemArr[o].node.active=!1;for(o=0,n=e.length;o<n;++o){if(o>=this.mMapItemArr.length){var r=cc.instantiate(this.mTemplate.node);r.parent=this.mSV.content,this.mMapItemArr.push(r.getComponent(s.default))}var i=this.mMapItemArr[o];i.node.active=!0,i.node.x=0,i.node.y=this.mOriPosY-this.mCellHeight*o,i.SetData(e[o],this)}}},e.prototype.Invoke_LeftArrow=function(){p.default.PlayBtnSound(),this.mCurTabID--,this.mCurTabID<=0||this.UpdateByTabID(this.mCurTabID)},e.prototype.Invoke_RightArrow=function(){p.default.PlayBtnSound(),this.mCurTabID++,this.mCurTabID>l.default.Ins.mDataMap.size||this.UpdateByTabID(this.mCurTabID)},e.prototype.Invoke_Close=function(){p.default.PlayBtnSound(),this.CloseWin()},i([h(cc.Label)],e.prototype,"mBestLevelLbl",void 0),i([h(cc.Label)],e.prototype,"mTitleLbl",void 0),i([h(s.default)],e.prototype,"mTemplate",void 0),i([h(cc.Node)],e.prototype,"mLeftBtnNode",void 0),i([h(cc.Node)],e.prototype,"mRightBtnNode",void 0),i([h(cc.ScrollView)],e.prototype,"mSV",void 0),i([h(cc.SpriteFrame)],e.prototype,"mDefaultSF",void 0),i([h(cc.SpriteFrame)],e.prototype,"mActiveSF",void 0),i([h(cc.SpriteFrame)],e.prototype,"mLockSF",void 0),i([h(cc.Node)],e.prototype,"mCloseBtn",void 0),i([h(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyHeroMap":"ProxyHeroMap","../Comp/MapItem":"MapItem","./WinBase":"WinBase"}],HeroPictureWin:[function(t,e,o){"use strict";cc._RF.push(e,"39a73HUzEJAfYVKlJ7vnFKL","HeroPictureWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/PictureHeroIcon"),l=t("../Comp/MyToggleGroup"),m=t("../../Proxy/ProxyHero"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/DataMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mToggleGroup=null,e.mNoOwnTitle=null,e.mQualityTitleArr=[],e.mQuality1SFArr=[],e.mQuality2SFArr=[],e.mStarSFArr=[],e.mTemplate=null,e.mContentNode=null,e.mTitleLbl=null,e.mGraySFArr=[],e.mHasSubscribed=!1,e.mItemMaps=new Map,e.mCurMode=s.HeroPictureMode.Bag,e.mLastMode=s.HeroPictureMode.Bag,e.mBackCallback=null,e.mNeedRefresh=!1,e._OriTitleY=30,e._IconOffsetTilteY=82,e._TitleOffsetIconY=140,e._IconWidth=114,e._IconHeight=166,e._ColumnCount=6,e._IconOriX=-285,e._IconOriY=-70,e}return r(e,t),e.prototype.SetPreOpen=function(t){this.mCurMode=t,this.mCurMode===s.HeroPictureMode.Bag?this.mTitleLbl.string="\u6b66\u5c06\u5305\u88f9":this.mTitleLbl.string="\u5956\u52b1\u9884\u89c8"},e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init();for(var e=m.default.Ins.mCampHeroIDArr,o=0,n=e.length;o<n;++o)for(var r=e[o],i=0,a=r.length;i<a;++i){var l=cc.instantiate(this.mTemplate);l.active=!0;var u=l.getComponent(s.default);u.SetData(r[i],this),this.mItemMaps.set(r[i],u),l.parent=this.mContentNode}},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),(0===this._openedTimes||this.mLastMode!==this.mCurMode||this.mNeedRefresh)&&(this._OnMsg_ClickToggle(0,!0),this.mLastMode=this.mCurMode,this.mNeedRefresh=!1)},e.prototype.SetBackCallback=function(t){this.mBackCallback=t},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(h.BCType.ToggleGroup_HeroPicture,this._OnMsg_ClickToggle,this),this.mHasSubscribed||(this.mHasSubscribed=!0,d.default.Subscribe(h.BCType.GetNewHero,this._OnMsg_GetNewHero,this),d.default.Subscribe(h.BCType.UpdateHeroFragment,this._OnMsg_UpdateFragment,this),d.default.Subscribe(h.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),d.default.Subscribe(h.BCType.OnUpgradeHeroQuality,this._OnMsg_UpgradeQuality,this))},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(h.BCType.ToggleGroup_HeroPicture,this._OnMsg_ClickToggle,this)},e.prototype._PlaceAll_PreviewMode=function(){this.mQualityTitleArr[0].parent.opacity=255,this.mNoOwnTitle.opacity=0;var t=m.default.Ins.GroupByQuality(m.default.Ins.mAllHeroIDArr);this._CommonPlace_PreviewMode(this.mQualityTitleArr,t)},e.prototype._PlaceByCamp_PreviewMode=function(t){this.mQualityTitleArr[0].parent.opacity=255,this.mNoOwnTitle.opacity=0;var e=m.default.Ins.GroupByQuality(m.default.Ins.mCampHeroIDArr[t]);this._CommonPlace_PreviewMode(this.mQualityTitleArr,e)},e.prototype._CommonPlace_PreviewMode=function(t,e){for(var o=0,n=t.length;o<n;++o)t[o].opacity=0;this.mItemMaps.forEach(function(t){t.node.opacity=0});var r=0,i=0;for(o=0,n=e.length;o<n;++o)e[o].sort(this._SortInPreview);for(o=0,n=e.length;o<n;++o){var a=e[o];if(a.length>0){0===r&&(i=-this._OriTitleY),t[o].opacity=255,t[o].y=i,i-=this._IconOffsetTilteY;for(var l=function(t){var e=a[t],o=m.mItemMaps.get(e);o.node.opacity=255,o.node.x=m._IconOriX+t%m._ColumnCount*m._IconWidth,o.node.y=i-Math.floor(t/m._ColumnCount)*m._IconHeight,o.SetMode(s.HeroPictureMode.Lottery),o.SetCallback(function(){u.default.Ins.Open(h.WinType.HeroDetailWin,function(t){t.SetData(e,h.WinType.HeroPictureWin)})})},m=this,p=0,c=a.length;p<c;++p)l(p);i-=Math.floor((a.length-1)/this._ColumnCount)*this._IconHeight,i-=this._TitleOffsetIconY,r++}}this.mContentNode.height=Math.abs(i)},e.prototype._SortInPreview=function(t,e){var o=c.default.Ins.m_DB.heroCardDB[t],n=c.default.Ins.m_DB.heroCardDB[e];return o.sortOrder-n.sortOrder},e.prototype._PlaceAll_BagMode=function(){this.mQualityTitleArr[0].parent.opacity=0;var t=m.default.Ins.GetOwnHeroArr(),e=m.default.Ins.GetAllNoOwnHero();this._CommonPlace_BagMode(t,e)},e.prototype._PlaceByCamp_BagMode=function(t){this.mQualityTitleArr[0].parent.opacity=0,this.mItemMaps.forEach(function(t){t.node.opacity=0,t.node.x=1e4});var e=m.default.Ins.GetOwnHeroByCamp(t),o=m.default.Ins.GetNoOwnHeroByCamp(t);this._CommonPlace_BagMode(e,o)},e.prototype._CommonPlace_BagMode=function(t,e){this.mNoOwnTitle.parent.active=!0,this.mNoOwnTitle.opacity=0;var o=this._IconOriY;if(t.length>0){t.sort(this._SortInBag);for(var n=function(e){var n=t[e],i=r.mItemMaps.get(n);i.node.opacity=255,i.node.x=r._IconOriX+e%r._ColumnCount*r._IconWidth,i.node.y=o-Math.floor(e/r._ColumnCount)*r._IconHeight,i.SetMode(s.HeroPictureMode.Bag),i.SetCallback(function(){u.default.Ins.Open(h.WinType.HeroDetailWin,function(t){t.SetData(n,h.WinType.HeroPictureWin)})})},r=this,i=0,a=t.length;i<a;++i)n(i);o-=Math.ceil((t.length-.5)/this._ColumnCount)*this._IconHeight}else o=-this._OriTitleY;if(e.length>0){e.sort(this._SortInBag_NoOwn),this.mNoOwnTitle.opacity=255,this.mNoOwnTitle.y=o,o-=this._IconOffsetTilteY;var l=this,m=function(t){var n=e[t],r=p.mItemMaps.get(n);r.node.opacity=255,r.node.x=p._IconOriX+t%p._ColumnCount*p._IconWidth,r.node.y=o-Math.floor(t/p._ColumnCount)*p._IconHeight,r.SetMode(s.HeroPictureMode.Bag),r.SetCallback(function(){l._ClickNoOwnIcon(n)})},p=this;for(i=0,a=e.length;i<a;++i)m(i);o-=Math.ceil((e.length-.5)/this._ColumnCount)*this._IconHeight}this.mContentNode.height=Math.abs(o)},e.prototype._SortInBag=function(t,e){var o=m.default.Ins.GetHeroSI(t),n=m.default.Ins.GetHeroSI(e);if(o.heroQuality!==n.heroQuality)return-(o.heroQuality-n.heroQuality);if(o.starLv!==n.starLv)return-(o.starLv-n.starLv);var r=c.default.Ins.m_DB.heroCardDB[t],i=c.default.Ins.m_DB.heroCardDB[e];return r.sortOrder-i.sortOrder},e.prototype._SortInBag_NoOwn=function(t,e){var o=c.default.Ins.m_DB.heroCardDB[t],n=c.default.Ins.m_DB.heroCardDB[e];return o.baseQuality!==n.baseQuality?-(o.baseQuality-n.baseQuality):o.id-n.id},e.prototype._ClickNoOwnIcon=function(t){if(null===m.default.Ins.GetHeroSI(t)){var e=c.default.Ins.m_DB.heroCardDB[t].baseQuality,o=m.default.Ins.GetNeedFragment(e,e,0);if(!(p.default.Ins.GetItemNum(t)>=o))return void u.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u8bf7\u5148\u6839\u636e [\u795e\u5c06\u4e4b\u8def] \u89e3\u9501\u5e76\u83b7\u5f97\u8be5\u6b66\u5c06\u54e6~");p.default.Ins.UpdateItem(t,-o),m.default.Ins.GetHero([t]),u.default.Ins.Open(h.WinType.NewHeroShowWin,function(e){e.SetData(t)}),this.mItemMaps.get(t).SetData(t,this),m.default.Ins.CheckHeroStarAwake(t),this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!1)}},e.prototype._PlaceAll=function(){this.mCurMode===s.HeroPictureMode.Bag?this._PlaceAll_BagMode():this._PlaceAll_PreviewMode()},e.prototype._PlaceByCamp=function(t){this.mCurMode===s.HeroPictureMode.Bag?this._PlaceByCamp_BagMode(t):this._PlaceByCamp_PreviewMode(t)},e.prototype._OnMsg_ClickToggle=function(t,e){switch(void 0===e&&(e=!1),e||f.default.PlayBtnSound(),t){case 0:this._PlaceAll();break;case 1:this._PlaceByCamp(h.CampType.Wei);break;case 2:this._PlaceByCamp(h.CampType.Shu);break;case 3:this._PlaceByCamp(h.CampType.Wu);break;case 4:this._PlaceByCamp(h.CampType.Qun)}this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._OnMsg_GetNewHero=function(){this._OnMsg_ClickToggle(this.mToggleGroup.CurToggleIdx,!0)},e.prototype._OnMsg_UpdateFragment=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateFragment()},e.prototype._OnMsg_OnUpgradeStarLv=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateStar()},e.prototype._OnMsg_UpgradeQuality=function(t){var e=this.mItemMaps.get(t);e&&e.UpdateQuality()},e.prototype._OnMsg_ShowHeroWin=function(){this.Invoke_Back()},e.prototype.Invoke_Back=function(){f.default.PlayBtnSound(),u.default.Ins.Close(h.WinType.HeroPictureWin),null!==this.mBackCallback?this.mBackCallback():u.default.Ins.Open(h.WinType.HeroWin,null,!0),this.mBackCallback=null},i([I(l.default)],e.prototype,"mToggleGroup",void 0),i([I(cc.Node)],e.prototype,"mNoOwnTitle",void 0),i([I([cc.Node])],e.prototype,"mQualityTitleArr",void 0),i([I([cc.SpriteFrame])],e.prototype,"mQuality1SFArr",void 0),i([I([cc.SpriteFrame])],e.prototype,"mQuality2SFArr",void 0),i([I([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([I(cc.Node)],e.prototype,"mTemplate",void 0),i([I(cc.Node)],e.prototype,"mContentNode",void 0),i([I(cc.Label)],e.prototype,"mTitleLbl",void 0),i([I([cc.SpriteFrame])],e.prototype,"mGraySFArr",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/PictureHeroIcon":"PictureHeroIcon","./WinBase":"WinBase"}],HeroSpawnController:[function(t,e,o){"use strict";cc._RF.push(e,"39fd12qvnZLvrrQAiOplXCg","HeroSpawnController"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../UI/Win/BattleWin"),r=t("../../Proxy/ProxyHero"),i=t("../../Manager/PoolMgr"),a=t("../../Manager/DataMgr"),s=t("../../Manager/BCMgr"),l=t("../../Manager/AudioMgr"),m=t("../../MainGame"),u=t("../../Common/EnumsDefine"),p=t("../../Common/Common"),c=function(){function t(t){this.mCurTeam=null,this.mSpawnInterval=1,this.mTiming=0,this.mTotalSpawnCount=0,this.mCurSpawnCount=0,this.mIsSpawning=!1,this.mIsSpawnInterupt=!1,this.mOwnerFightMode=null,this.mOwnerFightMode=t}return t.prototype.StartSpawnHero=function(){this.mCurTeam=[];for(var t=0;t<r.default.Ins.mHeroInfo.heroTeam.length;++t){var e=r.default.Ins.mHeroInfo.heroTeam[t];0!==e&&this.mCurTeam.push(e)}p.default.GetRandArr(this.mCurTeam),this.mTiming=this.mSpawnInterval,this.mCurSpawnCount=0,this.mTotalSpawnCount=this.mCurTeam.length,this.mIsSpawning=!0,this.mIsSpawnInterupt=!1},t.prototype.OnUpdate=function(t){this.mIsSpawning&&(this.mTiming-=t,this.mTiming<=0&&(this.mTiming=this.mSpawnInterval,this._SpawnHero(this.mCurTeam[this.mCurSpawnCount]),this.mCurSpawnCount++,this.mCurSpawnCount>=this.mTotalSpawnCount&&(this.mIsSpawning=!1)))},t.prototype._SpawnHero=function(t,e){if(void 0===e&&(e=!1),this.mIsSpawning||e){var o=this,r=a.default.Ins.m_DB.heroCardDB[t],p=a.default.Ins.m_DB.entityDB[r.entityID];i.default.Ins.Borrow(i.default.HERO_PATH_ROOT+p.model,"Hero",function(e){if(o.mIsSpawnInterupt)i.default.Ins.Return(e);else{var r=e;r.Init(t,p,o.mOwnerFightMode),s.default.Dispatch(u.BCType.BattleWin_AddHero,r),o.mOwnerFightMode.AddHero(r),i.default.Ins.Borrow(i.default.EFX_PATH_ROOT+"spawnEfx","EfxBase",function(t){var e=t;e.node.parent=n.default.EfxRoot,r.node&&r.node.isValid&&(e.node.position=r.node.position)}),l.default.PlayFightSFX(u.AudioName.Fight_HeroShow,!0),null===m.default.mBattleCam.mCurFollower&&m.default.mBattleCam.SetFollower(r.node)}})}},t.prototype.StopSpawn=function(){this.mIsSpawning=!1,this.mIsSpawnInterupt=!0},t.prototype.PutHeroOff=function(t){var e=this.mCurTeam.indexOf(t);-1!==e&&this.mCurTeam.splice(e,1),this.mTotalSpawnCount--,this.mCurSpawnCount>=this.mTotalSpawnCount&&(this.mIsSpawning=!1)},t.prototype.PutHeroOn=function(t){this._SpawnHero(t,!0)},t}();o.default=c,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/PoolMgr":"PoolMgr","../../Proxy/ProxyHero":"ProxyHero","../../UI/Win/BattleWin":"BattleWin"}],HeroUnlockWin:[function(t,e,o){"use strict";cc._RF.push(e,"fc97ae9iIZCdKdJ/zbWF8Js","HeroUnlockWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxySkin"),l=t("../../Proxy/ProxyHeroMap"),m=t("../../Manager/ResMgr"),u=t("../../Manager/DataMgr"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHeroSp=null,e.mNameLbl=null,e}return r(e,t),e.prototype.SetData=function(t){var e=this,o=s.default.Ins.GetHeroDefaultSkin(t),n=u.default.Ins.m_DB.heroCardDB[t],r=u.default.Ins.m_DB.itemDB[t];if(o){this.mNameLbl.string=n.name,this.mNameLbl.node.color=l.default.Ins.GetNameColor(r.quality);var i=this;m.default.Ins.LoadTexture("texture/hero/"+o.sprite,function(t){if(null!==i.mHeroSp){i.mHeroSp.spriteFrame=t;var e=n.mapOffset;p.default.ResetSpriteSize(i.mHeroSp,i.mHeroSp.spriteFrame,e[2])}},null)}var a=cc.tween;this.mTweenAnimRoot.opacity=0,this.mTweenAnimRoot.position=cc.v3(0,200,0),a(this.mTweenAnimRoot).parallel(a().to(.3,{opacity:255}),a().to(.3,{position:cc.v3(0,280,0)})).delay(2.5).parallel(a().to(.3,{opacity:0}),a().to(.3,{position:cc.v3(0,200,0)})).call(function(){e.CloseWin()}).start()},i([f(cc.Sprite)],e.prototype,"mHeroSp",void 0),i([f(cc.Label)],e.prototype,"mNameLbl",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHeroMap":"ProxyHeroMap","../../Proxy/ProxySkin":"ProxySkin","./WinBase":"WinBase"}],HeroWin:[function(t,e,o){"use strict";cc._RF.push(e,"af6c4QRU29IEL5y9frXdH7v","HeroWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/PictureHeroIcon"),l=t("../Comp/HeroItem"),m=t("../Comp/HeroAddItem"),u=t("../../Proxy/ProxyMainTask2"),p=t("../../Proxy/ProxyHero"),c=t("../../Manager/WinMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mStarFullSf=null,e.mStarEmptySf=null,e.mCounterSFArr=[],e.mHeroItemTemplate=null,e.mHeroAddItemTemplate=null,e.mExtendPosItem=null,e.mContentNode=null,e.mExtendCostLbl=null,e.mSV=null,e.mBtnSFArr=[],e.mOriPosY=-70,e.mCellHeight=135,e.mHeroItemArr=[],e.mHeroAddItemArr=[],e.mHasSubscribed=!1,e.mCachedHeroItemArr=[],e.mCachedAddItemArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){var t=p.default.Ins.mHeroInfo.heroTeam;p.default.Ins.SortHeroTeam();for(var e=0,o=t.length;e<o;++e){var n=t[e];if(0===e)this.mHeroItemArr.push(this.mHeroItemTemplate.getComponent(l.default)),this.mHeroItemArr[e].Init(this),this.mHeroItemArr[e].SetData(n,this),this.mHeroItemArr[e].SetHeroItemID(e+1),this.mHeroItemArr[e].node.x=0,this.mHeroItemArr[e].node.y=this.mOriPosY;else if(0!==n){var r=cc.instantiate(this.mHeroItemTemplate),i=r.getComponent(l.default);this.mHeroItemArr.push(i),r.setParent(this.mContentNode),i.Init(this),i.SetData(n,this),i.SetHeroItemID(e+1),r.x=0,r.y=this.mOriPosY-this.mCellHeight*e}else{var a=cc.instantiate(this.mHeroAddItemTemplate);(i=a.getComponent(m.default)).SetData(this),this.mHeroAddItemArr.push(i),a.setParent(this.mContentNode),a.x=0,a.y=this.mOriPosY-this.mCellHeight*e}}var s=t.length;t.length<p.default.HERO_MAX_NUM?(s++,this.mExtendPosItem.setParent(this.mContentNode),this.mExtendPosItem.y=this.mOriPosY-t.length*this.mCellHeight):this.mExtendPosItem.active=!1,this.mContentNode.height=s*this.mCellHeight+10,this.mExtendCostLbl.string=p.default.Ins.GetExtendPosCost()+""},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._OnMsg_OnGoldChange(!0),this._OnMsg_MedalChange(),this._AutoScrollToItem()},e.prototype._AutoScrollToItem=function(){if(null!==u.default.Ins.mCurTaskData){var t=u.default.Ins.mCurTaskData.taskType;u.default.Ins.mMainTaskInfo.taskState===u.MainTaskState.Progress&&t===u.MainTaskType.ExtendHeroPos&&this.mSV.scrollToBottom()}},e.prototype._OnClose=function(){t.prototype._OnClose.call(this);for(var e=0,o=this.mHeroItemArr.length;e<o;++e)this.mHeroItemArr[e].HideFastBtn();c.default.Ins.Close(h.WinType.HeroAdjustTeamWin),c.default.Ins.Close(h.WinType.HeroPictureWin)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(h.BCType.Common_ChangeCoin,this._OnMsg_OnGoldChange,this),d.default.Subscribe(h.BCType.MainTask2_StartTask,this._OnMsg_StartTask,this),this.mHasSubscribed||(this.mHasSubscribed=!0,d.default.Subscribe(h.BCType.HeroAdjustTeamWin_AddPos,this._OnMsg_AddTeamPos,this),d.default.Subscribe(h.BCType.HeroAdjustTeamWin_PutHeroOffTeam,this._OnMsg_PutHeroOffTeam,this),d.default.Subscribe(h.BCType.HeroAdjustTeamWin_PutHeroOnTeam,this._OnMsg_PutHeroOnTeam,this),d.default.Subscribe(h.BCType.OnUpgradeHeroMedalLv,this._OnMsg_UpgradeHeroMedal,this),d.default.Subscribe(h.BCType.OnUpgradeHeroStarLv,this._OnMsg_UpgradeStarLv,this),d.default.Subscribe(h.BCType.OnUpgradeHeroQuality,this._OnMsg_UpgradeQuality,this),d.default.Subscribe(h.BCType.OnUpdateADH,this._OnMsg_UpdateADH,this),d.default.Subscribe(h.BCType.BackCity,this._OnMsg_BackCity,this),d.default.Subscribe(h.BCType.Skin_Equip,this._OnMsg_EquipSkin,this),d.default.Subscribe(h.BCType.HeroWin_ScrollToTop,this._OnMsg_ScrollToTop,this),d.default.Subscribe(h.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this))},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(h.BCType.Common_ChangeCoin,this._OnMsg_OnGoldChange,this),d.default.Remove(h.BCType.MainTask2_StartTask,this._OnMsg_StartTask,this)},e.prototype._OnMsg_AddTeamPos=function(){var t=p.default.Ins.mHeroInfo.heroTeam,e=cc.instantiate(this.mHeroAddItemTemplate),o=e.getComponent(m.default);o.SetData(this),this.mHeroAddItemArr.push(o),e.setParent(this.mContentNode),e.x=0,e.y=this.mOriPosY-this.mCellHeight*(t.length-1);var n=t.length;t.length<p.default.HERO_MAX_NUM?(n++,this.mExtendPosItem.setParent(this.mContentNode),this.mExtendPosItem.y=this.mOriPosY-t.length*this.mCellHeight):this.mExtendPosItem.active=!1,this.mExtendCostLbl.string=p.default.Ins.GetExtendPosCost()+"",this.mContentNode.height=n*this.mCellHeight+10},e.prototype._OnMsg_PutHeroOffTeam=function(t){for(var e=0;e<this.mHeroItemArr.length;++e)if(this.mHeroItemArr[e].mHeroSI.id===t){var o=this.mHeroItemArr.splice(e,1)[0];this.mCachedHeroItemArr.push(o),o.node.active=!1}if(0!==this.mCachedAddItemArr.length)(o=this.mCachedAddItemArr.pop()).node.active=!0,this.mHeroAddItemArr.push(o);else{var n=cc.instantiate(this.mHeroAddItemTemplate),r=n.getComponent(m.default);r.SetData(this),this.mHeroAddItemArr.push(r),n.setParent(this.mContentNode)}this._ResortHeroItem()},e.prototype._OnMsg_PutHeroOnTeam=function(t){var e=this.mHeroAddItemArr.pop();if(e.node.active=!1,this.mCachedAddItemArr.push(e),0!==this.mCachedHeroItemArr.length){var o=this.mCachedHeroItemArr.pop();o.node.active=!0,this.mHeroItemArr.push(o),o.SetData(t,this)}else{var n=cc.instantiate(this.mHeroItemTemplate),r=n.getComponent(l.default);this.mHeroItemArr.push(r),n.setParent(this.mContentNode),r.Init(this),r.SetData(t,this)}this._ResortHeroItem()},e.prototype._CompareHeroItem=function(t,e){var o=t.mHeroID,n=e.mHeroID;return p.default.Ins.CompareFunc(o,n)},e.prototype._ResortHeroItem=function(){this.mHeroItemArr.sort(this._CompareHeroItem);for(var t=0;t<this.mHeroItemArr.length;++t)this.mHeroItemArr[t].node.y=this.mOriPosY-this.mCellHeight*t,this.mHeroItemArr[t].SetHeroItemID(t+1);for(t=0;t<this.mHeroAddItemArr.length;++t)this.mHeroAddItemArr[t].node.y=this.mOriPosY-this.mCellHeight*(t+this.mHeroItemArr.length)},e.prototype._OnMsg_UpgradeHeroMedal=function(t){for(var e=0,o=this.mHeroItemArr.length;e<o;++e){var n=this.mHeroItemArr[e];n.mHeroID===t&&n.UpdateOnUpgradeMedal()}},e.prototype._OnMsg_UpgradeStarLv=function(t){for(var e=0,o=this.mHeroItemArr.length;e<o;++e){var n=this.mHeroItemArr[e];n.mHeroID===t&&n.UpdateOnUpgradeStar()}this._ResortHeroItem()},e.prototype._OnMsg_UpgradeQuality=function(t){for(var e=0,o=this.mHeroItemArr.length;e<o;++e){var n=this.mHeroItemArr[e];n.mHeroID===t&&n.UpdateOnUpgradeQuality()}this._ResortHeroItem()},e.prototype._OnMsg_OnGoldChange=function(t){void 0===t&&(t=!1);for(var e=0,o=this.mHeroItemArr.length;e<o;++e)this.mHeroItemArr[e].UpdateUIIfGoldIsEnough(t)},e.prototype._OnMsg_UpdateItem=function(t){t===h.ItemType.Medal&&this._OnMsg_MedalChange()},e.prototype._OnMsg_MedalChange=function(){for(var t=0,e=this.mHeroItemArr.length;t<e;++t)this.mHeroItemArr[t].UpdateRedPoint()},e.prototype._OnMsg_EquipSkin=function(t){for(var e=0,o=this.mHeroItemArr.length;e<o;++e){var n=this.mHeroItemArr[e];n.mHeroID===t&&n.UpdateOnChangeSkin()}},e.prototype._OnMsg_ScrollToTop=function(){this.mSV.scrollToTop()},e.prototype._OnMsg_BackCity=function(){for(var t=0,e=this.mHeroItemArr.length;t<e;++t)this.mHeroItemArr[t].UpdateOnBackCity()},e.prototype._OnMsg_UpdateADH=function(){for(var t=0,e=this.mHeroItemArr.length;t<e;++t)this.mHeroItemArr[t].UpdateADH()},e.prototype._OnMsg_StartTask=function(){var t=u.default.Ins.mCurTaskData;null!==t&&t.taskType===u.MainTaskType.ExtendHeroPos&&this.mSV.scrollToBottom()},e.prototype.Invoke_AdjustTeam=function(){f.default.PlayBtnSound();var t=this;c.default.Ins.Open(h.WinType.HeroAdjustTeamWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO},!0)},e.prototype.Invoke_HeroPicture=function(){f.default.PlayBtnSound();var t=this;c.default.Ins.Open(h.WinType.HeroPictureWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO},!0,function(t){t.SetPreOpen(s.HeroPictureMode.Bag)})},e.prototype.Invoke_ExtendHeroPos=function(){f.default.PlayBtnSound(),p.default.Ins.mHeroInfo.heroTeam.length<p.default.HERO_MAX_NUM&&c.default.Ins.Open(h.WinType.AddPosWin,function(t){t.SetData()})},i([I(cc.SpriteFrame)],e.prototype,"mStarFullSf",void 0),i([I(cc.SpriteFrame)],e.prototype,"mStarEmptySf",void 0),i([I([cc.SpriteFrame])],e.prototype,"mCounterSFArr",void 0),i([I(cc.Node)],e.prototype,"mHeroItemTemplate",void 0),i([I(cc.Node)],e.prototype,"mHeroAddItemTemplate",void 0),i([I(cc.Node)],e.prototype,"mExtendPosItem",void 0),i([I(cc.Node)],e.prototype,"mContentNode",void 0),i([I(cc.Label)],e.prototype,"mExtendCostLbl",void 0),i([I(cc.ScrollView)],e.prototype,"mSV",void 0),i([I([cc.SpriteFrame])],e.prototype,"mBtnSFArr",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../Comp/HeroAddItem":"HeroAddItem","../Comp/HeroItem":"HeroItem","../Comp/PictureHeroIcon":"PictureHeroIcon","./WinBase":"WinBase"}],Hero:[function(t,e,o){"use strict";cc._RF.push(e,"aca3fkkCMtJgLAHL04YSXZZ","Hero");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./Entity"),s=t("../AI/EntityState"),l=t("../../UI/Win/BattleWin"),m=t("../../Proxy/ProxySkin"),u=t("../../Proxy/ProxyLargeNum"),p=t("../../Proxy/ProxyHero"),c=t("../../Manager/ResMgr"),d=t("../../Manager/PoolMgr"),f=t("../../Manager/FightMgr"),h=t("../../Manager/DataMgr"),y=t("../../Manager/BCMgr"),g=t("../../Common/EnumsDefine"),I=t("../../Common/Common"),S=cc._decorator,_=S.ccclass,v=(S.property,function(t){function e(){var e=t.call(this)||this;return e.mHeroData=null,e.mHeroSI=null,e.mInitAnimName="zoulu",e.mCurModelName="",e.mReviveTiming=10,e}return r(e,t),e.prototype.OnSpawned=function(e){t.prototype.OnSpawned.call(this,e)},e.prototype.SetInitAnimName=function(t){this.mInitAnimName=t},e.prototype.Init=function(e,o,n){var r=this;t.prototype.Init.call(this,e,o,n);var i=m.default.Ins.GetHeroCurSkinData(this.mEntityID);if(i.model!==this.mCurModelName){var a=this;c.default.Ins.LoadSpine("spine/hero/"+i.model,function(t){null!==a.mSkeleton&&(a.mSkeleton.skeletonData=t,a.mSkeleton.setAnimation(0,a.mInitAnimName,!0),a.mMuzzleBone=r.mSkeleton.findBone("muzzle"),a.m_ShootTargetBone=r.mSkeleton.findBone("shootTarget"))}),this.mCurModelName=i.model}},e.prototype._InitOnce=function(e,o){this.mEntityType=g.EntityType.Hero,t.prototype._InitOnce.call(this,e,o),this.mHeroSI=p.default.Ins.GetHeroSI(e),this.mHeroData=h.default.Ins.m_DB.heroCardDB[e],this.mCurCamp=this.mHeroData.camp,this.mCounterType=this.mHeroData.counter},e.prototype.InitEntityAttr=function(){switch(t.prototype.InitEntityAttr.call(this),this.mOwnerFightMode.CurFightModeType){case g.FightModeType.Normal:case g.FightModeType.ImtBoss:var e=this.mOwnerFightMode.GetHeroHP(this.mEntityID);this.mEntityAttr.mMaxHP=e,this.mEntityAttr.mCurHP=new u.LargeNumber(e.mBaseValue,e.mExpoValue),this.mEntityAttr.mAttack=this.mOwnerFightMode.GetHeroAtk(this.mEntityID),this.mEntityAttr.mDefend=this.mOwnerFightMode.GetHeroDefend(this.mEntityID)}},e.prototype.UpdateEntityAttr=function(){switch(t.prototype.UpdateEntityAttr.call(this),this.mOwnerFightMode.CurFightModeType){case g.FightModeType.Normal:case g.FightModeType.ImtBoss:var e=this.mOwnerFightMode.GetHeroHP(this.mEntityID);this.mEntityAttr.mMaxHP=e,this.mEntityAttr.mAttack=this.mOwnerFightMode.GetHeroAtk(this.mEntityID),this.mEntityAttr.mDefend=this.mOwnerFightMode.GetHeroDefend(this.mEntityID),null!==this.mHPBar&&this.mHPBar.UpdateHP(this.GetCurHPPercent(),!0)}},e.prototype.EquipSkin=function(t){var e=this,o=h.default.Ins.m_DB.skinDB[t],n=this;c.default.Ins.LoadSpine("spine/hero/"+o.model,function(t){null!==n.mSkeleton&&(n.mSkeleton.skeletonData=t,n.ChangeState(s.EntityStateType.Idle),n.mMuzzleBone=e.mSkeleton.findBone("muzzle"),n.m_ShootTargetBone=e.mSkeleton.findBone("shootTarget"))})},e.prototype.AddPassiveSkill=function(){var t=p.default.Ins.GetHeroSI(this.mEntityID);if(null!==t){var e=this.mEntityData.passiveSkills[t.starLv-2];this.mPassiveCtrl.AddPassiveSkill(e)}},e.prototype._ReturnEntity=function(){t.prototype._ReturnEntity.call(this)},e.prototype._RemoveFromFight=function(){},e.prototype.GetTargetArr=function(){for(var t=[],e=f.default.mCurFightMode.mEnemyArr,o=0,n=e.length;o<n;++o)I.default.CanAttack(this.mWpCtrl.mWpType,e[o].mArmType)&&e[o].GetCurStateType()!==s.EntityStateType.Dead&&t.push(e[o]);return t},e.prototype.GetPartnerArr=function(){for(var t=[],e=f.default.mCurFightMode.mHeroArr,o=0,n=e.length;o<n;++o)e[o].GetCurStateType()!==s.EntityStateType.Dead&&t.push(e[o]);return t},e.prototype._Revive=function(){this._Reset(),y.default.Dispatch(g.BCType.BattleWin_AddHero,this),this.node.active=!0;var t=this;d.default.Ins.Borrow(d.default.EFX_PATH_ROOT+"spawnEfx","EfxBase",function(e){var o=e;o.node.parent=l.default.EfxRoot,t.node&&t.node.isValid&&(o.node.position=t.node.position)})},e.prototype.MoveState_OnEnter=function(){t.prototype.MoveState_OnEnter.call(this),this.SetLookDirection(g.LookDir.Right)},e.prototype.MoveState_OnUpdate=function(e){t.prototype.MoveState_OnUpdate.call(this,e)},e.prototype.MoveState_OnExit=function(){},e.prototype.DeadState_OnEnter=function(){t.prototype.DeadState_OnEnter.call(this),this.mReviveTiming=this.mHeroData.reviveTime},e.prototype.DeadState_OnUpdate=function(t){this.mReviveTiming-=t,this.mReviveTiming<=0&&this._Revive()},i([_],e)}(a.default));o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySkin":"ProxySkin","../../UI/Win/BattleWin":"BattleWin","../AI/EntityState":"EntityState","./Entity":"Entity"}],HitBackBehavior:[function(t,e,o){"use strict";cc._RF.push(e,"12166PYMR9J/qqoFeUHJgGs","HitBackBehavior"),Object.defineProperty(o,"__esModule",{value:!0}),o.HitBackStateType=void 0;var n,r=t("../AI/EntityState");(function(t){t[t.None=0]="None",t[t.HitBacking=1]="HitBacking",t[t.HitBackStop=2]="HitBackStop"})(n=o.HitBackStateType||(o.HitBackStateType={}));var i=function(){function t(t){this.mEntity=null,this.mHitBackDistance=100,this.mHitBackTime=0,this.mHitBackStandTime=0,this.mHitBackSpeed=0,this.mTimer=0,this.mEnable=!1,this.mTotalDistance=0,this.mHitDir=1,this.mHitbackState=n.HitBacking,this.mEntity=t}return t.prototype.SetHitParam=function(t){this.mHitBackDistance=t.hitBackDistance,this.mHitBackTime=t.hitBackTime,this.mHitBackStandTime=t.hitBackStandTime?t.hitBackStandTime:0,0!==this.mHitBackTime&&(this.mHitBackSpeed=this.mHitBackDistance/this.mHitBackTime)},t.prototype.SetSkillCompParam=function(t){this.mHitBackDistance=t[0],this.mHitBackTime=t[1],this.mHitBackStandTime=t[2],0!==this.mHitBackTime&&(this.mHitBackSpeed=this.mHitBackDistance/this.mHitBackTime)},t.prototype.CanTrigger=function(){return 0!==this.mHitBackDistance},t.prototype.Trigger=function(){this.CanTrigger()?(this.mTotalDistance=0,this.mHitbackState=n.HitBacking,this.mTimer=0,this.mEnable=!0,this.mHitDir=Math.sign(-this.mEntity.node.scaleX)):this.End()},t.prototype.OnUpdate=function(t){if(this.mEnable)if(this.mTimer+=t,this.mHitbackState===n.HitBacking)if(this.mTimer>=this.mHitBackTime&&(this.mHitbackState=n.HitBackStop),0===this.mHitBackTime)this.mEntity.node.x+=this.mHitBackDistance;else{var e=this.mHitBackSpeed*this.mHitDir*t;this.mTotalDistance+=e,this.mTotalDistance>=this.mHitBackDistance?(e=this.mTotalDistance-this.mHitBackDistance,this.mEntity.node.x+=e,this.mHitbackState=n.HitBackStop):this.mEntity.node.x+=e}else this.mTimer>=this.mHitBackTime+this.mHitBackStandTime&&this.End()},t.prototype.End=function(){this.mTimer=0,this.mEnable=!1,this.mTotalDistance=0,this.mHitbackState=n.HitBacking;var t=this.mEntity.GetCurStateType();t!==r.EntityStateType.Dead&&t!==r.EntityStateType.Frosted&&t!==r.EntityStateType.Vertigo&&this.mEntity.mStateMachine.ChangeState(r.EntityStateType.Move)},t}();o.default=i,cc._RF.pop()},{"../AI/EntityState":"EntityState"}],IState:[function(t,e,o){"use strict";cc._RF.push(e,"13f7aNq8TtH2ZDqITXjQyw/","IState"),Object.defineProperty(o,"__esModule",{value:!0});o.default=function(){},cc._RF.pop()},{}],ImmortalItem:[function(t,e,o){"use strict";cc._RF.push(e,"c980cnjtuNKYYRrJH4BrjvK","ImmortalItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollItem"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Proxy/ProxyImmortal"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/ResMgr"),c=t("../../Manager/DataMgr"),d=t("../../Manager/AudioMgr"),f=t("../../MainGame"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mFrame=null,e.mSPTag=null,e.mStar=null,e.mNameLbl=null,e.mLvLbl=null,e.mAttr1=null,e.mAttr2=null,e.mBtnBgSp=null,e.mCostLbl=null,e.mMatIcon=null,e.mBtnMaxRoot=null,e.mBtnNormalRoot=null,e.mUpgradeSk=null,e.mImmortalWin=null,e.mID=0,e.mItemData=null,e.mImtData=null,e}return r(e,t),e.prototype.Init=function(e,o){this.mImmortalWin=o,t.prototype.Init.call(this,e,o)},e.prototype.UpdateUI=function(){var t=l.default.Ins.mImmortalInfo.immortalArr[this.mIdx].id;this._SetData(t,this.mImmortalWin),this.mUpgradeSk.node.opacity=0},e.prototype._SetData=function(t,e){var o=l.default.Ins.GetImtSI(t);this.mID!==t&&(this.mID=t,this.mItemData=c.default.Ins.m_DB.itemDB[t],this.mImtData=c.default.Ins.m_DB.immortalDB[t],null!==o&&(p.default.Ins.LoadItemSprite(t,this.mIcon,null),p.default.Ins.LoadItemQualitySprite(this.mItemData.quality,this.mFrame,null),this.mSPTag.opacity=this.mItemData.quality===h.ItemQuality.SP?255:0,this.mStar.spriteFrame=e.mStarArr[this.mImtData.star-1],this.mNameLbl.string=this.mItemData.name,this._UpdateLvUI(o))),null!==o&&this.UpdateCostUI(o)},e.prototype._UpdateLvUI=function(t){this.mLvLbl.string="Lv."+t.lv,this.mAttr1.string=l.default.Ins.GetAttrDesc(this.mID,1),this.mAttr2.string=l.default.Ins.GetAttrDesc(this.mID,2)},e.prototype.UpdateCostUI=function(t){var e=this.mImtData.cost,o=e[0],n=o-h.ItemType.ImtForgeMat;this.mMatIcon.spriteFrame=this.mImmortalWin.mMatSFArr[n];var r=new s.LargeNumber(e[1],e[2]).ToNormalNum()*t.lv;this.mCostLbl.string=s.default.FormatNumber(r,0),this.mBtnBgSp.setMaterial(0,f.default.mDefaultMat),this.mBtnNormalRoot.opacity=0,this.mBtnMaxRoot.opacity=0,t.lv>=l.default.Ins.GetImtLimitLv(this.mImtData.star)?(this.mBtnBgSp.spriteFrame=this.mImmortalWin.mBtnMaxLvSF,this.mBtnMaxRoot.opacity=255):(this.mBtnBgSp.spriteFrame=this.mImmortalWin.mBtnNormalSF,u.default.Ins.GetItemNum(o)<r&&this.mBtnBgSp.setMaterial(0,f.default.mGrayMat),this.mBtnNormalRoot.opacity=255)},e.prototype.Invoke_ClickImmortal=function(){var t=this;m.default.Ins.Open(h.WinType.ImtDetailWin,function(e){e.SetData(t.mID)})},e.prototype.Invoke_UpgradeLv=function(){d.default.PlayBtnSound();var t=l.default.Ins.GetImtSI(this.mID),e=c.default.Ins.m_DB.immortalDB[this.mID],o=l.default.Ins.GetImtLimitLv(e.star);if(!(t.lv>=o)){var n=this.mImtData.cost,r=n[0],i=u.default.Ins.GetItemNum(r),a=new s.LargeNumber(n[1],n[2]).ToNormalNum()*t.lv;i<a?m.default.Ins.ShowTips("\u5347\u7ea7\u6750\u6599\u4e0d\u8db3\uff0c\u524d\u5f80\u6311\u6218-\u9ec4\u5929\u79d8\u5f84\u83b7\u53d6~"):(u.default.Ins.UpdateItem(r,-a),l.default.Ins.UpgradeImt(this.mID),this.UpdateCostUI(t),this._UpdateLvUI(t),this.mUpgradeSk.node.opacity=255,this.mUpgradeSk.setAnimation(0,"animation",!1))}},i([I(cc.Sprite)],e.prototype,"mIcon",void 0),i([I(cc.Sprite)],e.prototype,"mFrame",void 0),i([I(cc.Node)],e.prototype,"mSPTag",void 0),i([I(cc.Sprite)],e.prototype,"mStar",void 0),i([I(cc.Label)],e.prototype,"mNameLbl",void 0),i([I(cc.Label)],e.prototype,"mLvLbl",void 0),i([I(cc.Label)],e.prototype,"mAttr1",void 0),i([I(cc.Label)],e.prototype,"mAttr2",void 0),i([I(cc.Sprite)],e.prototype,"mBtnBgSp",void 0),i([I(cc.Label)],e.prototype,"mCostLbl",void 0),i([I(cc.Sprite)],e.prototype,"mMatIcon",void 0),i([I(cc.Node)],e.prototype,"mBtnMaxRoot",void 0),i([I(cc.Node)],e.prototype,"mBtnNormalRoot",void 0),i([I(sp.Skeleton)],e.prototype,"mUpgradeSk",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./LoopScrollItem":"LoopScrollItem"}],ImmortalLoopSV:[function(t,e,o){"use strict";cc._RF.push(e,"c1bb57gVIRHb4gXiw1/2vSn","ImmortalLoopSV");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollView"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./LoopScrollView":"LoopScrollView"}],ImmortalSkillBase:[function(t,e,o){"use strict";cc._RF.push(e,"1ee47wwlk1PfrYwWz4PhlrD","ImmortalSkillBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../Skill/SkillCtrl"),s=t("../Entity/WeaponController"),l=t("../Entity/EntityAttr"),m=t("../Entity/Entity"),u=t("../AI/EntityState"),p=t("../../Manager/PoolMgr"),c=t("../../Manager/FightMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/AudioMgr"),h=t("../../MainGame"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=(g.property,function(t){function e(){var e=t.call(this)||this;return e.mImtSkillData=null,e.mImtData=null,e.mEfxCurX=0,e.mEndCallback=null,e}return r(e,t),e.prototype.OnReturned=function(){this.node.active=!1},e.prototype.InitImtSkill=function(t,e,o,n,r){void 0===r&&(r=null),this.mCurSkillID=e,this.mOwnerFightMode=o,this.mImtSkillData=d.default.Ins.m_DB.imtSkillDB[e],this.mImtData=d.default.Ins.m_DB.immortalDB[e],this.mEndCallback=r;var i=JSON.stringify(d.default.Ins.m_DB.entityDB[t]),a=JSON.parse(i);a.normalSkillId=e,this._InitOnce(t,a),this._Reset()},e.prototype._InitOnce=function(t,e){var o=this;this.mInted||(this.mInted=!0,this.mEntityAttr=new l.default(this),this.mEntityID=t,this.mEntityData=e,this.mCurCamp=this.mImtData.camp,this.mArmType=0,this.mMoveSpeed=0,this.mAttackDist=0,this.mIsBoss=!1,setTimeout(function(){o.mMuzzleBone=o.mSkeleton.findBone("muzzle")},1),this.mSkeleton.setCompleteListener(this._OnAnimCompleted.bind(this)),this.mSkeleton.setEventListener(this._OnAnimEventListener.bind(this)),0!==this.mEntityData.normalSkillId&&(this.mSkillCtrl=new a.default(this),this.mSkillCtrl.InitImtSkillData(this.mImtSkillData),this.mSkillCtrl.InitOnce()),this.mWpCtrl=new s.default(this))},e.prototype._Reset=function(){this.mCurTargetEntity=null,null!==this.mSkillCtrl&&this.mSkillCtrl.Reset(),this.InitEntityAttr(),this.AfterInitRealAttr();var t=c.default.mCurFightMode.GetMaxHeroAtk();this.mEntityAttr.mAttack.SetValue(t),this.mStateMachine.ChangeState(u.EntityStateType.Attack)},e.prototype.SetATK=function(t){this.mEntityAttr.mAttack.SetValue(t)},e.prototype.PlaceImtSkill=function(t){var e=this.mImtSkillData.initParam;this.mEfxCurX=t+e[0],this.node.x=this.mEfxCurX,this.node.y=e[1],this.node.scale=e[2],h.default.mBattleCam.WaitToFollow(e[3])},e.prototype._OnAnimCompleted=function(){p.default.Ins.Return(this),null!==this.mEndCallback&&(this.mEndCallback(),this.mEndCallback=null)},e.prototype._OnAnimEventListener=function(t,e){if("onSkill"===e.data.name){var o=e.stringValue,n=y.default.Split2NumArr(o);if(2!==n.length)return void console.error("\u52a8\u753b\u4e8b\u4ef6\u53c2\u6570\u51fa\u9519:  "+o+"  \u6280\u80fdID: "+this.mCurSkillID);var r=this.mSkillCtrl.GetSkillCompCtrl(n[0]),i=n[1];null!==r&&r.TriggerByIdx(i)}else if("onAudio"===e.data.name){var a=e.stringValue;a&&f.default.PlayFightSFX(a)}},e.prototype.GetTargetArr=function(){for(var t=[],e=c.default.mCurFightMode.mEnemyArr,o=0,n=e.length;o<n;++o)y.default.CanAttack(this.mWpCtrl.mWpType,e[o].mArmType)&&e[o].GetCurStateType()!==u.EntityStateType.Dead&&t.push(e[o]);return t},e.prototype.Fire=function(t){this.mWpCtrl.FireByImtSkill(t)},e.prototype.BeAttack=function(t,e,o,n,r){void 0===r&&(r=!1)},i([I],e)}(m.default));o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../AI/EntityState":"EntityState","../Entity/Entity":"Entity","../Entity/EntityAttr":"EntityAttr","../Entity/WeaponController":"WeaponController","../Skill/SkillCtrl":"SkillCtrl"}],ImmortalSkillBtn:[function(t,e,o){"use strict";cc._RF.push(e,"35b803DyCVKq5q3IMaV5p/h","ImmortalSkillBtn");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyImtSkill"),s=t("../../Manager/ResMgr"),l=t("../../Manager/PoolMgr"),m=t("../../Manager/FightMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/BCMgr"),c=t("../../MainGame"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSkillIcon=null,e.mPb=null,e.mTimeLbl=null,e.mSkillID=0,e.mImtSkillData=null,e}return r(e,t),e.prototype.SetData=function(t){this.mSkillID!==t&&(this.mSkillID=t,this.mImtSkillData=u.default.Ins.m_DB.imtSkillDB[this.mSkillID],s.default.Ins.LoadImtSkillSp(t,this.mSkillIcon))},e.prototype.UpdateCD=function(){var t=a.default.Ins.GetSkillInfo(this.mSkillID);t&&(t.cdState===d.CDState.Ready?(this.mPb.node.opacity=0,this.mTimeLbl.string=""):(this.mPb.node.opacity=255,this.mTimeLbl.string=t.countDown+""))},e.prototype.Invoke_TriggerSkill=function(){if(a.default.Ins.mCanReleaseSkill){var t=a.default.Ins.GetSkillInfo(this.mSkillID);if(t&&t.cdState===d.CDState.Ready){a.default.Ins.TriggerSkill(this.mSkillID);var e=this;l.default.Ins.Borrow("prefab/skill/"+this.mImtSkillData.prefab,"ImmortalSkillBase",function(t){a.default.Ins.mCanReleaseSkill?(t.InitImtSkill(100001,e.mSkillID,m.default.mCurFightMode,null),p.default.Dispatch(d.BCType.BattleWin_AddSkillItem,t),t.PlaceImtSkill(c.default.mBattleCam.node.x),m.default.mCurFightMode.AddImtSkill(t)):l.default.Ins.Return(t)});var o=this.mImtSkillData.initParam[3];p.default.Dispatch(d.BCType.BattleWin_StartSkill,this.mSkillID,o)}}},i([y(cc.Sprite)],e.prototype,"mSkillIcon",void 0),i([y(cc.ProgressBar)],e.prototype,"mPb",void 0),i([y(cc.Label)],e.prototype,"mTimeLbl",void 0),i([h],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyImtSkill":"ProxyImtSkill"}],ImmortalWin:[function(t,e,o){"use strict";cc._RF.push(e,"904c1J/1QFDP6Zt/YzybMMP","ImmortalWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ImmortalLoopSV"),l=t("../../Proxy/ProxyImmortal"),m=t("../../Proxy/ProxyForge"),u=t("../../Manager/WinMgr"),p=t("../../Manager/PlatformMgr"),c=t("../../Manager/GuideMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMatSFArr=[],e.mStarArr=[],e.mBtnNormalSF=null,e.mBtnMaxLvSF=null,e.mImtTemplate=null,e.mContentNode=null,e.mLoopSV=null,e.mEmptyHintNode=null,e._isAdded=!1,e}return r(e,t),e.prototype._OnFirstOpen=function(){this.mLoopSV.Initialize(l.default.Ins.mImmortalInfo.immortalArr.length,this),0===l.default.Ins.mImmortalInfo.immortalArr.length?(this.mEmptyHintNode.opacity=255,this.mLoopSV.node.opacity=0):(this.mEmptyHintNode.opacity=0,this.mLoopSV.node.opacity=255),0===m.default.Ins.mForgeInfo.forgeTimes&&(c.default.TriggerGuide(50,!0),p.default.ReportEvent(h.BIPoint.Guide_FirstOpenImt),p.default.mCurPlf.ReportHuoShanEvent(h.HuoShanEventType.Imt_Open))},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mLoopSV.UpdateUI(),0===l.default.Ins.mImmortalInfo.immortalArr.length?(this.mEmptyHintNode.opacity=255,this.mLoopSV.node.opacity=0):(this.mEmptyHintNode.opacity=0,this.mLoopSV.node.opacity=255)},e.prototype._OnClose=function(){t.prototype._OnClose.call(this),u.default.Ins.Close(h.WinType.ForgeWin),u.default.Ins.Close(h.WinType.ImtPictureWin),u.default.Ins.Close(h.WinType.ImtSkillWin)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),this._isAdded||(this._isAdded=!0,d.default.Subscribe(h.BCType.ImtWin_GetNewImt,this._OnMsg_GetNewImt,this))},e.prototype._Remove=function(){t.prototype._Remove.call(this)},e.prototype._OnMsg_GetNewImt=function(){this.mLoopSV.node.opacity=255,this.mLoopSV.UpdateScrollRangeCount(l.default.Ins.mImmortalInfo.immortalArr.length,this),this.mLoopSV.UpdateUI()},e.prototype.Invoke_AdjustSkill=function(){var t=this;u.default.Ins.Open(h.WinType.ImtSkillWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO,d.default.Dispatch(h.BCType.MainWin_ChangeCoinType,h.CoinType.Common)},!0)},e.prototype.Invoke_Forge=function(){f.default.PlayBtnSound();var t=this;u.default.Ins.Open(h.WinType.ForgeWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO},!0)},e.prototype.Invoke_Instruction=function(){f.default.PlayBtnSound(),u.default.Ins.Open(h.WinType.ImtInsWin,function(){})},i([I([cc.SpriteFrame])],e.prototype,"mMatSFArr",void 0),i([I([cc.SpriteFrame])],e.prototype,"mStarArr",void 0),i([I(cc.SpriteFrame)],e.prototype,"mBtnNormalSF",void 0),i([I(cc.SpriteFrame)],e.prototype,"mBtnMaxLvSF",void 0),i([I(cc.Node)],e.prototype,"mImtTemplate",void 0),i([I(cc.Node)],e.prototype,"mContentNode",void 0),i([I(s.default)],e.prototype,"mLoopSV",void 0),i([I(cc.Node)],e.prototype,"mEmptyHintNode",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/GuideMgr":"GuideMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyImmortal":"ProxyImmortal","../Comp/ImmortalLoopSV":"ImmortalLoopSV","./WinBase":"WinBase"}],ImtBossDmgMgr:[function(t,e,o){"use strict";cc._RF.push(e,"0d35ewZXOhLtrABbPlnuqKX","ImtBossDmgMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./BCMgr"),r=t("../Proxy/ProxyLargeNum"),i=t("../Common/EnumsDefine"),a=function(){function t(){this.mInitialTotalValue=new r.LargeNumber(1,0),this.mHeroDmgMap=new Map}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.StartStat=function(t){this.mHeroDmgMap.clear(),this.mInitialTotalValue=t},t.prototype.StatHeroDmg=function(t,e){var o=this.mHeroDmgMap.get(t);o?o.AddSelf(e):(o=new r.LargeNumber(e.mBaseValue,e.mExpoValue),this.mHeroDmgMap.set(t,o)),-1===this.mInitialTotalValue.Compare(o)&&this.mInitialTotalValue.SetValue(o),n.default.Dispatch(i.BCType.ImtBoss_UpdateHeroDmg)},t.mIns=null,t}();o.default=a,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Proxy/ProxyLargeNum":"ProxyLargeNum","./BCMgr":"BCMgr"}],ImtBossFailWin:[function(t,e,o){"use strict";cc._RF.push(e,"6f4487ytfxCZJT+j4dlIXGM","ImtBossFailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/FightMgr"),l=t("../../Manager/AudioMgr"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Invoke_OK=function(){l.default.PlayBtnSound(),this.CloseWin(),s.default.mImtBossFightMode.BackToNormalMode()},i([u],e)}(a.default));o.default=p,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/FightMgr":"FightMgr","./WinBase":"WinBase"}],ImtBossFightWin:[function(t,e,o){"use strict";cc._RF.push(e,"3c0f3kaImtGf4YiMNah3fjU","ImtBossFightWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ImtSkillPanel"),l=t("../Comp/HeroDmgItem"),m=t("../../Proxy/ProxyImtBoss"),u=t("../../Proxy/ProxyHero"),p=t("../../Manager/WinMgr"),c=t("../../Manager/FightMgr"),d=t("../../Manager/BCMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mContentNode=null,e.mSV=null,e.mFightTimeLbl=null,e.mSkillPanel=null,e.mItemArr=[],e.mCellHeight=135,e.mOriPosY=-75,e.mCurTeamLength=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mSkillPanel.OnFirstOpen(),this.mItemArr.push(this.mTemplate)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mSkillPanel.OnOpen(),this._OnMsg_UpdateFightTime(m.default.Ins.mFightTime),this.mSV.scrollToTop();for(var e=this.mItemArr.length,o=0;o<e;++o)this.mItemArr[o].node.opacity=0;for(var n=[],r=u.default.Ins.mHeroInfo.heroTeam,i=(o=0,r.length);o<i;++o)0!==r[o]&&n.push(r[o]);for(this.mCurTeamLength=n.length,o=0,i=n.length;o<i;++o){var a=n[o];if(o>=e){var s=cc.instantiate(this.mTemplate.node);s.parent=this.mContentNode,s.x=0;var p=s.getComponent(l.default);p.SetData(a),this.mItemArr.push(p)}else this.mItemArr[o].node.opacity=255,this.mItemArr[o].SetData(a);this.mItemArr[o].node.y=this.mOriPosY-this.mCellHeight*o,this.mItemArr[o].ResetDmgUI()}this.mContentNode.height=n.length*this.mCellHeight+10},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(f.BCType.ImtBoss_UpdateFightTime,this._OnMsg_UpdateFightTime,this),d.default.Subscribe(f.BCType.ImtBoss_UpdateHeroDmg,this._OnMsg_UpdateHeroDmg,this),this.mSkillPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(f.BCType.ImtBoss_UpdateFightTime,this._OnMsg_UpdateFightTime,this),d.default.Subscribe(f.BCType.ImtBoss_UpdateHeroDmg,this._OnMsg_UpdateHeroDmg,this),this.mSkillPanel.Remove()},e.prototype._OnMsg_UpdateFightTime=function(t){this.mFightTimeLbl.string=h.default.FormatTimeWithSeconds(t)+" \u540e\u7ed3\u675f"},e.prototype._OnMsg_UpdateHeroDmg=function(){for(var t=0;t<this.mCurTeamLength;++t)this.mItemArr[t].UpdateDmgUI()},e.prototype.Invoke_Back=function(){p.default.Ins.Open(f.WinType.CommonDialogWin,function(t){t.SetData("\u662f\u5426\u786e\u8ba4\u9000\u51fa?",function(){c.default.mCurFightMode.BackToNormalMode()},null)})},i([I(l.default)],e.prototype,"mTemplate",void 0),i([I(cc.Node)],e.prototype,"mContentNode",void 0),i([I(cc.ScrollView)],e.prototype,"mSV",void 0),i([I(cc.Label)],e.prototype,"mFightTimeLbl",void 0),i([I(s.default)],e.prototype,"mSkillPanel",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/FightMgr":"FightMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../Comp/HeroDmgItem":"HeroDmgItem","../Comp/ImtSkillPanel":"ImtSkillPanel","./WinBase":"WinBase"}],ImtBossItem:[function(t,e,o){"use strict";cc._RF.push(e,"22d8aCJCcJPl56YZ0TMrQii","ImtBossItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MainTaskGuideFinger"),s=t("../../Proxy/ProxyImtBoss"),l=t("../../Manager/WinMgr"),m=t("../../Manager/MainTaskGuideMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNameLbl=null,e.mGuideFinger=null,e.mID=1,e.mOwnerWin=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mGuideFinger.UpdatePointName(m.MainTaskGuideType.ImtBossLevel+t),this.mID=t,this.mOwnerWin=e,this.mNameLbl.string=s.default.Ins.mBossNameArr[t-1]},e.prototype.Invoke_ChooseBoss=function(){var t=this;l.default.Ins.Open(u.WinType.ImtBossLevelWin,function(e){var o=e;o.SetData(t.mID),t.mOwnerWin.node.active=!1,o.node.parent=t.mOwnerWin.node.parent,o.node.position=cc.Vec3.ZERO})},i([d(cc.Label)],e.prototype,"mNameLbl",void 0),i([d(a.default)],e.prototype,"mGuideFinger",void 0),i([c],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/MainTaskGuideMgr":"MainTaskGuideMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImtBoss":"ProxyImtBoss","./MainTaskGuideFinger":"MainTaskGuideFinger"}],ImtBossLevelController:[function(t,e,o){"use strict";cc._RF.push(e,"65681D7IblJYa6jdhvnCxUH","ImtBossLevelController");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./EnemySpawnController"),a=t("../../Common/EnumsDefine"),s=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.InitData=function(t){var e=this.mOwerFightMode;this.mLimitDmgCampType=a.CampType.None,this.mCounterType=a.CounterType.None,this.mStartSpawn=!1,this.mSpawnerArr=[],this.mSpawnerArr.push(new i.default([e.mBossIDArr[t-1],1,0,0],this))},e}(t("./LevelController").default);o.default=s,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","./EnemySpawnController":"EnemySpawnController","./LevelController":"LevelController"}],ImtBossLevelIntroduceWin:[function(t,e,o){"use strict";cc._RF.push(e,"ebc9d6ijm9E9rbATk3B5gsz","ImtBossLevelIntroduceWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyImtBoss"),l=t("../../Manager/DataMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRecLvLbl=null,e.mNeedNumLbl=null,e.mNeedLvLbl=null,e.mNeedRoot=null,e.mLevelNameLbl=null,e}return r(e,t),e.prototype.SetData=function(t,e){var o=s.default.Ins.GetBossName(t);this.mLevelNameLbl.string=o+"-"+e;var n=l.default.Ins.m_DB.imtBossLevelDB[e];this.mRecLvLbl.string=n.recLv;var r=n.needLv;0===r.length?this.mNeedRoot.opacity=0:(this.mNeedRoot.opacity=255,this.mNeedNumLbl.string=r[0],this.mNeedLvLbl.string=r[1])},e.prototype.Invoke_Close=function(){this.CloseWin()},i([p(cc.Label)],e.prototype,"mRecLvLbl",void 0),i([p(cc.Label)],e.prototype,"mNeedNumLbl",void 0),i([p(cc.Label)],e.prototype,"mNeedLvLbl",void 0),i([p(cc.Node)],e.prototype,"mNeedRoot",void 0),i([p(cc.Label)],e.prototype,"mLevelNameLbl",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Proxy/ProxyImtBoss":"ProxyImtBoss","./WinBase":"WinBase"}],ImtBossLevelItem:[function(e,o,n){"use strict";cc._RF.push(o,"f9625Pff/tEm6pU8OiVgKvl","ImtBossLevelItem");var r,i=this&&this.__extends||(r=function(t,e){return(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),a=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(n,"__esModule",{value:!0});var s=e("./LoopScrollItem"),l=e("../../Proxy/ProxyLargeNum"),m=e("../../Proxy/ProxyImtBoss"),u=e("../../Proxy/ProxyHero"),p=e("../../Manager/WinMgr"),c=e("../../Manager/UserMgr"),d=e("../../Manager/FightMgr"),f=e("../../Manager/DataMgr"),h=e("../../Manager/AudioMgr"),y=e("../../MainGame"),g=e("../../Common/EnumsDefine"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t.mLevelNameLbl=null,t.mBgSp=null,t.mBossIcon=null,t.mMatItemIconArr=[],t.mNumLblArr=[],t.mChallengeBtnLbl=null,t.mChallengeBtnBg=null,t.mMopBtnBg=null,t.mOwnerWin=null,t.mBossID=0,t}return i(o,e),o.prototype.Init=function(e,o){this.mOwnerWin=o,t.prototype.Init.call(this,e,o)},o.prototype.UpdateUI=function(){var t=this.mIdx+1,e=f.default.Ins.m_DB.imtBossLevelDB[t];this.mLevelNameLbl.string=m.default.Ins.GetBossName(this.mBossID)+"-"+t;var o=m.default.Ins.GetMatNumByLevel(t);this.mNumLblArr[0].string="x"+l.default.FormatNumber(o,1);var n=m.default.Ins.GetMatAddRate();if(0!==n){var r=Math.floor(o*n);this.mNumLblArr[1].node.parent.opacity=255,this.mNumLblArr[1].string="x"+l.default.FormatNumber(r,1),this.mNumLblArr[2].node.parent.x=-8}else this.mNumLblArr[1].node.parent.opacity=0,this.mNumLblArr[2].node.parent.x=-75;var i=c.default.Ins.ClientInfo.imtBossLevel.passedLevelArr[this.mBossID-1],a=i>=t,s=e.needLv,p=!0;0!==s.length&&(p=u.default.Ins.CheckHeroMedalLv(s[0],s[1])),a?this.mNumLblArr[2].node.parent.opacity=0:(this.mNumLblArr[2].string="x"+e.goldNum,this.mNumLblArr[2].node.parent.opacity=255),this.mMopBtnBg.spriteFrame=a?this.mOwnerWin.mMopBtnSFArr[0]:this.mOwnerWin.mMopBtnSFArr[1],p?t-i>1?(this.mChallengeBtnBg.spriteFrame=this.mOwnerWin.mChallBtnSFArr[1],this.mChallengeBtnLbl.string="\u5148\u901a\u5173\u4e0a\u4e00\u5173"):(this.mChallengeBtnBg.spriteFrame=this.mOwnerWin.mChallBtnSFArr[0],this.mChallengeBtnLbl.string="\u6311\u6218"):(this.mChallengeBtnBg.spriteFrame=this.mOwnerWin.mChallBtnSFArr[1],this.mChallengeBtnLbl.string="\u9700\u8981\u66f4\u5f3a\u7684\u6b66\u5c06")},o.prototype.SetBossID=function(t){this.mBossID=t,this.mBossIcon.spriteFrame=this.mOwnerWin.mBossSFArr[t-1],this.mBgSp.spriteFrame=this.mOwnerWin.mBossBgSFArr[t-1],this.mLevelNameLbl.string=m.default.Ins.GetBossName(t)+"-"+(this.mIdx+1),this.mMatItemIconArr[0].spriteFrame=this.mOwnerWin.mMatSFArr[t-1],this.mMatItemIconArr[1].spriteFrame=this.mOwnerWin.mMatSFArr[t-1],this.UpdateUI()},o.prototype.Invoke_Detail=function(){h.default.PlayBtnSound();var t=this;p.default.Ins.Open(g.WinType.ImtBossLevelIntroduceWin,function(e){e.SetData(t.mBossID,t.mIdx+1)})},o.prototype.Invoke_Challenge=function(){h.default.PlayBtnSound();var t=this.mIdx+1,e=f.default.Ins.m_DB.imtBossLevelDB[t],o=c.default.Ins.ClientInfo.imtBossLevel.passedLevelArr[this.mBossID-1],n=e.needLv,r=!0;if(0!==n.length&&(r=u.default.Ins.CheckHeroMedalLv(n[0],n[1])),r)if(t-o>1)p.default.Ins.ShowTips("\u8bf7\u4e3b\u516c\u5148\u5b8c\u6210\u524d\u9762\u5173\u5361~");else if(c.default.Ins.ClientInfo.imtBossLevel.challengeTimes<=0)p.default.Ins.Open(g.WinType.FreeRewardWin,function(t){var e=t,o=m.default.Ins.GetMaxChallengeTimes(),n=Math.min(m.default.Ins.mFreeChallengeTimes,o);e.SetFreeChallengeTimes("\u6b23\u8d4f\u4e00\u6bb5\u89c6\u9891\uff0c\u83b7\u5f97\u6311\u6218\u6b21\u6570",n,null,function(t){m.default.Ins.RecoverChallengeTimes(n),p.default.Ins.Open(g.WinType.GetRewardsWin,function(e){var o=e;t?o.SetDataWithADCoin(g.ItemType.ChallengeTimes,""+n):o.SetDataSingle(g.ItemType.ChallengeTimes,""+n)})})});else{y.default.mGlobalMask.active=!0;var i=this;p.default.Ins.ShowTransitionClose(function(){d.default.Ins.ChangeFightMode(g.FightModeType.ImtBoss,{bossID:i.mBossID,levelID:i.mIdx+1}),p.default.Ins.Close(g.WinType.MainWin),p.default.Ins.Open(g.WinType.ImtBossFightWin,function(){p.default.Ins.ShowTransitionOpen()})},function(){y.default.mGlobalMask.active=!1})}else{var a=this;p.default.Ins.Open(g.WinType.ImtBossLevelIntroduceWin,function(t){t.SetData(a.mBossID,a.mIdx+1)})}},o.prototype.Invoke_Mop=function(){h.default.PlayBtnSound();var t=this.mIdx+1;if(c.default.Ins.ClientInfo.imtBossLevel.passedLevelArr[this.mBossID-1]<t)p.default.Ins.ShowTips("\u901a\u8fc7\u8be5\u5173\u5361\u4ee5\u540e\u624d\u53ef\u4ee5\u8fdb\u884c\u626b\u8361\u54e6~");else if(c.default.Ins.ClientInfo.imtBossLevel.challengeTimes<=0)p.default.Ins.Open(g.WinType.FreeRewardWin,function(t){var e=t,o=m.default.Ins.GetMaxChallengeTimes(),n=Math.min(m.default.Ins.mFreeChallengeTimes,o);e.SetFreeChallengeTimes("\u6b23\u8d4f\u4e00\u6bb5\u89c6\u9891\uff0c\u83b7\u5f97\u6311\u6218\u6b21\u6570",n,null,function(t){m.default.Ins.RecoverChallengeTimes(n),p.default.Ins.Open(g.WinType.GetRewardsWin,function(e){var o=e;t?o.SetDataWithADCoin(g.ItemType.ChallengeTimes,""+n):o.SetDataSingle(g.ItemType.ChallengeTimes,""+n)})})});else if(c.default.Ins.GetItemNum(g.ItemType.MopTicket)<=0)p.default.Ins.Open(g.WinType.FreeRewardWin,function(t){t.SetData("\u89c2\u770b\u4e00\u6bb5\u89c6\u9891\uff0c\u83b7\u5f97\u626b\u8361\u5238",g.ItemType.MopTicket,m.default.Ins.mFreeMopTicketNum,null,function(){})});else{var e=this,o=m.default.Ins.Mop(this.mBossID,t);p.default.Ins.Open(g.WinType.MopResultWin,function(n){n.SetData(e.mBossID,t,o)})}},a([_(cc.Label)],o.prototype,"mLevelNameLbl",void 0),a([_(cc.Sprite)],o.prototype,"mBgSp",void 0),a([_(cc.Sprite)],o.prototype,"mBossIcon",void 0),a([_([cc.Sprite])],o.prototype,"mMatItemIconArr",void 0),a([_([cc.Label])],o.prototype,"mNumLblArr",void 0),a([_(cc.Label)],o.prototype,"mChallengeBtnLbl",void 0),a([_(cc.Sprite)],o.prototype,"mChallengeBtnBg",void 0),a([_(cc.Sprite)],o.prototype,"mMopBtnBg",void 0),a([S],o)}(s.default);n.default=v,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./LoopScrollItem":"LoopScrollItem"}],ImtBossLevelWin:[function(t,e,o){"use strict";cc._RF.push(e,"b2f0bceYiVL1oWgwQFJgF6p","ImtBossLevelWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ImtBossLoopSV"),l=t("../../Proxy/ProxyImtBoss"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBossSFArr=[],e.mBossBgSFArr=[],e.mMatSFArr=[],e.mChallBtnSFArr=[],e.mMopBtnSFArr=[],e.mLoopSV=null,e.mChallengeNumLbl=null,e.mTimeLbl=null,e.mMopNumLbl=null,e.mImtBossSI=null,e.mID=1,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mImtBossSI=u.default.Ins.ClientInfo.imtBossLevel,this.mLoopSV.Initialize(l.default.Ins.GetLevelCount(),this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._UpdateChallengeTimesUI(),this.mMopNumLbl.string=""+u.default.Ins.GetItemNum(d.ItemType.MopTicket)},e.prototype._UpdateChallengeTimesUI=function(){var t=l.default.Ins.GetMaxChallengeTimes(),e=this.mImtBossSI.challengeTimes;this.mChallengeNumLbl.string=e+"/"+t,this.mTimeLbl.string=e>=t?"":"\uff08"+f.default.FormatTimeBySeconds(this.mImtBossSI.leftTime)+"\uff09",this.mTimeLbl.node.x=t>=10?75:50},e.prototype.SetData=function(t){this.mID=t,this.mLoopSV.SetBossID(t)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),p.default.Subscribe(d.BCType.ImtBoss_UpdateChallengeTimes,this._OnMsg_UpdateChallengeTime,this),p.default.Subscribe(d.BCType.ImtBoSS_UpdateRecoverTime,this._OnMsg_UpdateRecoverTime,this),p.default.Subscribe(d.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this),p.default.Subscribe(d.BCType.ImtBoss_UpdateLevelItem,this._OnMsg_UpdateLevelItem,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),p.default.Remove(d.BCType.ImtBoss_UpdateChallengeTimes,this._OnMsg_UpdateChallengeTime,this),p.default.Remove(d.BCType.ImtBoSS_UpdateRecoverTime,this._OnMsg_UpdateRecoverTime,this),p.default.Remove(d.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this),p.default.Remove(d.BCType.ImtBoss_UpdateLevelItem,this._OnMsg_UpdateLevelItem,this)},e.prototype._OnMsg_UpdateChallengeTime=function(){this._UpdateChallengeTimesUI()},e.prototype._OnMsg_UpdateRecoverTime=function(){this.mTimeLbl.string="\uff08"+f.default.FormatTimeBySeconds(this.mImtBossSI.leftTime)+"\uff09"},e.prototype._OnMsg_UpdateItem=function(t){t===d.ItemType.MopTicket&&(this.mMopNumLbl.string=""+u.default.Ins.GetItemNum(d.ItemType.MopTicket))},e.prototype._OnMsg_UpdateLevelItem=function(){this.SetData(this.mID),this._UpdateChallengeTimesUI()},e.prototype.Invoke_Back=function(){c.default.PlayBtnSound(),this.CloseWin(),m.default.Ins.Open(d.WinType.ImtBossWin,null,!0)},i([g([cc.SpriteFrame])],e.prototype,"mBossSFArr",void 0),i([g([cc.SpriteFrame])],e.prototype,"mBossBgSFArr",void 0),i([g([cc.SpriteFrame])],e.prototype,"mMatSFArr",void 0),i([g([cc.SpriteFrame])],e.prototype,"mChallBtnSFArr",void 0),i([g([cc.SpriteFrame])],e.prototype,"mMopBtnSFArr",void 0),i([g(s.default)],e.prototype,"mLoopSV",void 0),i([g(cc.Label)],e.prototype,"mChallengeNumLbl",void 0),i([g(cc.Label)],e.prototype,"mTimeLbl",void 0),i([g(cc.Label)],e.prototype,"mMopNumLbl",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../Comp/ImtBossLoopSV":"ImtBossLoopSV","./WinBase":"WinBase"}],ImtBossLoopSV:[function(t,e,o){"use strict";cc._RF.push(e,"bd827evKIpBW6G5TwyJKcHE","ImtBossLoopSV");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollView"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.SetBossID=function(t){for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].SetBossID(t)},i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./LoopScrollView":"LoopScrollView"}],ImtBossVictoryWin:[function(t,e,o){"use strict";cc._RF.push(e,"2d18e4Hi/tDsanGZ+xVbpmK","ImtBossVictoryWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyLargeNum"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemRoot=null,e.mItemTemplate=null,e.mVictorySk=null,e.mCurBossID=1,e.mCurLevelID=1,e.mCloseCallback=null,e.mCellWidth=120,e.mItemArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=0;e<=3;++e)if(0===e)this.mItemArr.push(this.mItemTemplate);else{var o=cc.instantiate(this.mItemTemplate.node);o.parent=this.mItemRoot;var n=o.getComponent(s.default);this.mItemArr.push(n)}},e.prototype.SetData=function(t,e,o,n){this.mCloseCallback=t,this.mCurBossID=e,this.mCurLevelID=o,this.mVictorySk.node.opacity=255,this.mVictorySk.setAnimation(0,"animation",!1);for(var r=0,i=this.mItemArr.length;r<i;++r)this.mItemArr[r].node.opacity=0;for(r=0,i=n.length;r<i;++r){this.mItemArr[r].node.opacity=255;var a=n[r][0],s=n[r][1].toFixed(0);u.ItemType.ImtForgeMat<=a&&a<=u.ItemType.ImtForgeMat+3&&(s=l.default.FormatNumber(n[r][1],2)),this.mItemArr[r].SetData(a,s),this.mItemArr[r].node.position=cc.v3(this.mCellWidth*r-.5*this.mCellWidth*(i-1),0,0)}},e.prototype.Invoke_Close=function(){m.default.PlayBtnSound(),this.mCloseCallback(),this.CloseWin()},i([d(cc.Node)],e.prototype,"mItemRoot",void 0),i([d(s.default)],e.prototype,"mItemTemplate",void 0),i([d(sp.Skeleton)],e.prototype,"mVictorySk",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],ImtBossWin:[function(t,e,o){"use strict";cc._RF.push(e,"43ae3Q7LB1Dw7vIybYTWyKb","ImtBossWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ImtBossItem"),l=t("../../Proxy/ProxyImtBoss"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMatSFArr=[],e.mItemArr=[],e.mChallengeNumLbl=null,e.mTimeLbl=null,e.mMopNumLbl=null,e.mImtBossSI=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mImtBossSI=u.default.Ins.ClientInfo.imtBossLevel;for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].SetData(e+1,this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._UpdateChallengeTimesUI(),this.mMopNumLbl.string=""+u.default.Ins.GetItemNum(d.ItemType.MopTicket)},e.prototype._UpdateChallengeTimesUI=function(){var t=l.default.Ins.GetMaxChallengeTimes(),e=this.mImtBossSI.challengeTimes;this.mChallengeNumLbl.string=e+"/"+t,this.mTimeLbl.string=e>=t?"":"\uff08"+f.default.FormatTimeBySeconds(this.mImtBossSI.leftTime)+"\uff09",this.mTimeLbl.node.x=t>=10?75:50},e.prototype._OnClose=function(){t.prototype._OnClose.call(this),m.default.Ins.Close(d.WinType.ImtBossLevelWin)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),p.default.Subscribe(d.BCType.ImtBoss_UpdateChallengeTimes,this._OnMsg_UpdateChallengeTime,this),p.default.Subscribe(d.BCType.ImtBoSS_UpdateRecoverTime,this._OnMsg_UpdateRecoverTime,this),p.default.Subscribe(d.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),p.default.Remove(d.BCType.ImtBoss_UpdateChallengeTimes,this._OnMsg_UpdateChallengeTime,this),p.default.Remove(d.BCType.ImtBoSS_UpdateRecoverTime,this._OnMsg_UpdateRecoverTime,this),p.default.Remove(d.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this)},e.prototype._OnMsg_UpdateChallengeTime=function(){this._UpdateChallengeTimesUI()},e.prototype._OnMsg_UpdateRecoverTime=function(){this.mTimeLbl.string="\uff08"+f.default.FormatTimeBySeconds(this.mImtBossSI.leftTime)+"\uff09"},e.prototype._OnMsg_UpdateItem=function(t){t===d.ItemType.MopTicket&&(this.mMopNumLbl.string=""+u.default.Ins.GetItemNum(d.ItemType.MopTicket))},e.prototype.Invoke_Back=function(){c.default.PlayBtnSound(),this.CloseWin(),m.default.Ins.Open(d.WinType.ChallengeWin,null,!0),p.default.Dispatch(d.BCType.MainWin_ChangeCoinType,d.CoinType.Common)},i([g([cc.SpriteFrame])],e.prototype,"mMatSFArr",void 0),i([g([s.default])],e.prototype,"mItemArr",void 0),i([g(cc.Label)],e.prototype,"mChallengeNumLbl",void 0),i([g(cc.Label)],e.prototype,"mTimeLbl",void 0),i([g(cc.Label)],e.prototype,"mMopNumLbl",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../Comp/ImtBossItem":"ImtBossItem","./WinBase":"WinBase"}],ImtDetailWin:[function(t,e,o){"use strict";cc._RF.push(e,"dfb6eQ0zEtJMrqigFuB4IFD","ImtDetailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyLargeNum"),m=t("../../Proxy/ProxyImmortal"),u=t("../../Manager/UserMgr"),p=t("../../Manager/ResMgr"),c=t("../../Manager/DataMgr"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mImtNameLbl=null,e.mStarSFArr=[],e.mStarSp=null,e.mImtSp=null,e.mLvLbl=null,e.mSkillRoot=null,e.mSkillIcon=null,e.mSkillNameLbl=null,e.mSkillDescLbl=null,e.mAttr1Lbl=null,e.mAttr1AddLbl=null,e.mAttr2Lbl=null,e.mAttr2AddLbl=null,e.mItem=null,e.mMatInsItem=null,e.mItemNumLbl=null,e.mInsPanelNode=null,e.mDescLbl=null,e.mCurImtID=0,e.mImtData=null,e.mItemDB=null,e.mImtSI=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mInsPanelNode.opacity=0,this.mItem.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_ItemTouchStart,this),this.mItem.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_ItemTouchEnd,this),this.mItem.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_ItemTouchCancel,this)},e.prototype.SetData=function(t){this.mImtSI=m.default.Ins.GetImtSI(t),this.mImtData=c.default.Ins.m_DB.immortalDB[t];var e=0;null!==this.mImtSI&&(e=this.mImtSI.lv);var o=m.default.Ins.GetImtLimitLv(this.mImtData.star);this.mLvLbl.string="Lv. "+e+"/"+o,this.mAttr1Lbl.string=m.default.Ins.GetAttrDesc(t,1),this.mAttr1AddLbl.string=e<o?m.default.Ins.GetAttrAddDesc(t,1):"",0===this.mImtData.attr2.length?this.mAttr2Lbl.node.opacity=0:(this.mAttr2Lbl.node.opacity=255,this.mAttr2Lbl.string=m.default.Ins.GetAttrDesc(t,2),this.mAttr2AddLbl.string=e<o?m.default.Ins.GetAttrAddDesc(t,2):"");var n=this.mImtData.cost;this.mItem.SetData(n[0],"");var r=u.default.Ins.GetItemNum(n[0]),i=new l.LargeNumber(n[1],n[2]).ToNormalNum()*e;if(this.mItemNumLbl.string=l.default.FormatNumber(r,0)+"/"+l.default.FormatNumber(i,0),this.mCurImtID!==t){if(this.mCurImtID=t,this.mItemDB=c.default.Ins.m_DB.itemDB[t],this.mImtNameLbl.string=this.mItemDB.name,this.mStarSp.spriteFrame=this.mStarSFArr[this.mImtData.star-1],p.default.Ins.LoadItemSprite(t,this.mImtSp,null),0!==this.mImtData.skill){this.mSkillRoot.active=!0,p.default.Ins.LoadImtSkillSp(t,this.mSkillIcon,null);var a=c.default.Ins.m_DB.imtSkillDB[this.mImtData.skill];this.mSkillNameLbl.string=a.name,this.mSkillDescLbl.string=a.desc}else this.mSkillRoot.active=!1;var s=c.default.Ins.m_DB.itemDB[n[0]];this.mMatInsItem.SetData(n[0],""),this.mDescLbl.string=s.introduct}},e.prototype._OnNodeEvent_ItemTouchStart=function(){this.mInsPanelNode.opacity=255},e.prototype._OnNodeEvent_ItemTouchEnd=function(){this.mInsPanelNode.opacity=0},e.prototype._OnNodeEvent_ItemTouchCancel=function(){this.mInsPanelNode.opacity=0},e.prototype.Inovke_Close=function(){this.CloseWin()},i([h(cc.Label)],e.prototype,"mImtNameLbl",void 0),i([h([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([h(cc.Sprite)],e.prototype,"mStarSp",void 0),i([h(cc.Sprite)],e.prototype,"mImtSp",void 0),i([h(cc.Label)],e.prototype,"mLvLbl",void 0),i([h(cc.Node)],e.prototype,"mSkillRoot",void 0),i([h(cc.Sprite)],e.prototype,"mSkillIcon",void 0),i([h(cc.Label)],e.prototype,"mSkillNameLbl",void 0),i([h(cc.Label)],e.prototype,"mSkillDescLbl",void 0),i([h(cc.Label)],e.prototype,"mAttr1Lbl",void 0),i([h(cc.Label)],e.prototype,"mAttr1AddLbl",void 0),i([h(cc.Label)],e.prototype,"mAttr2Lbl",void 0),i([h(cc.Label)],e.prototype,"mAttr2AddLbl",void 0),i([h(s.default)],e.prototype,"mItem",void 0),i([h(s.default)],e.prototype,"mMatInsItem",void 0),i([h(cc.Label)],e.prototype,"mItemNumLbl",void 0),i([h(cc.Node)],e.prototype,"mInsPanelNode",void 0),i([h(cc.Label)],e.prototype,"mDescLbl",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],ImtInsWin:[function(t,e,o){"use strict";cc._RF.push(e,"4c26bYKNmxNI4nRXJJzZPIC","ImtInsWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/FuncMgr"),l=t("../../Manager/AudioMgr"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mUnlockLbl=null,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),s.default.IsUnlock(s.FuncType.Immortal)&&(this.mUnlockLbl.node.opacity=0)},e.prototype.Invoke_Close=function(){l.default.PlayBtnSound(),this.CloseWin()},i([u],e)}(a.default));o.default=p,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/FuncMgr":"FuncMgr","./WinBase":"WinBase"}],ImtPictureIcon:[function(t,e,o){"use strict";cc._RF.push(e,"af49cjEVAJBfJE+1pu4bfHs","ImtPictureIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyImmortal"),s=t("../../Manager/WinMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/DataMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mImtSp=null,e.mSpTag=null,e.mSkillTag=null,e.mMaskNode=null,e.mID=0,e.mItemData=null,e.mImtData=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mID=t,this.mItemData=m.default.Ins.m_DB.itemDB[t],this.mImtData=m.default.Ins.m_DB.immortalDB[t],this.mQualitySp.spriteFrame=e.mQualitySFArr[this.mItemData.quality+1],l.default.Ins.LoadItemSprite(t,this.mImtSp,null),this.mSpTag.node.opacity=0,this.mItemData.quality===p.ItemQuality.SP&&(this.mSpTag.node.opacity=255),0!==this.mImtData.skill?this.mSkillTag.opacity=255:this.mSkillTag.opacity=0},e.prototype.UpdateState=function(){null===a.default.Ins.GetImtSI(this.mID)?this.mMaskNode.opacity=200:this.mMaskNode.opacity=0},e.prototype.Invoke_ShowDetail=function(){u.default.PlayBtnSound();var t=this;s.default.Ins.Open(p.WinType.ImtDetailWin,function(e){e.SetData(t.mID)})},i([f(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([f(cc.Sprite)],e.prototype,"mImtSp",void 0),i([f(cc.Sprite)],e.prototype,"mSpTag",void 0),i([f(cc.Node)],e.prototype,"mSkillTag",void 0),i([f(cc.Node)],e.prototype,"mMaskNode",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImmortal":"ProxyImmortal"}],ImtPictureWin:[function(t,e,o){"use strict";cc._RF.push(e,"374029+B8lG6pVxQTmYaQf8","ImtPictureWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ImtPictureIcon"),l=t("../../Proxy/ProxyImmortal"),m=t("../../Proxy/ProxyForge"),u=t("../../Manager/WinMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySFArr=[],e.mTemplate=null,e.mContentNode=null,e.mStarNodeArr=[],e.mItemArr=[],e._OriTitleY=30,e._IconOffsetTilteY=80,e._TitleOffsetIconY=118,e._IconWidth=115,e._IconHeight=140,e._ColumnCount=6,e._IconOriX=-285,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=0,o=0,n=l.default.Ins.MAX_STAR,r=l.default.Ins.GetImtStarArr(),i=0,a=r.length;i<a;++i)r[i].sort(this._CompareFunc);for(i=0,a=r.length;i<a;++i){for(var u=[],p=0,c=r[i].length;p<c;++p)if(0===i&&0===p)u.push(this.mTemplate),this.mTemplate.SetData(r[i][p],this);else{var d=cc.instantiate(this.mTemplate.node);d.parent=this.mContentNode;var f=d.getComponent(s.default);f.SetData(r[i][p],this),u.push(f)}this.mItemArr.push(u),u.length,0===e&&(o=-this._OriTitleY),this.mStarNodeArr[n-i-1].y=o,o-=this._IconOffsetTilteY;for(var h=0,y=u.length;h<y;++h)u[h].node.x=this._IconOriX+h%this._ColumnCount*this._IconWidth,u[h].node.y=o-Math.floor(h/this._ColumnCount)*this._IconHeight;o-=Math.floor((u.length-1)/this._ColumnCount)*this._IconHeight,o-=this._TitleOffsetIconY,e++}this.mContentNode.height=Math.abs(o),m.default.Ins.mForgeInfo.hasShownPicture||m.default.Ins.FirstShowPicture()},e.prototype._CompareFunc=function(t,e){var o=p.default.Ins.m_DB.immortalDB[t],n=p.default.Ins.m_DB.immortalDB[e];return o.order!==n.order?o.order-n.order:t-e},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);for(var e=0,o=this.mItemArr.length;e<o;++e)for(var n=this.mItemArr[e],r=0,i=n.length;r<i;++r)n[r].UpdateState()},e.prototype.Invoke_Back=function(){c.default.PlayBtnSound(),this.CloseWin(),u.default.Ins.Open(d.WinType.ForgeWin,null,!0)},i([y([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([y(s.default)],e.prototype,"mTemplate",void 0),i([y(cc.Node)],e.prototype,"mContentNode",void 0),i([y([cc.Node])],e.prototype,"mStarNodeArr",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyImmortal":"ProxyImmortal","../Comp/ImtPictureIcon":"ImtPictureIcon","./WinBase":"WinBase"}],ImtRefineFailWin:[function(t,e,o){"use strict";cc._RF.push(e,"247b7tiioRDJYdTJCsAQkg/","ImtRefineFailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Proxy/ProxyImmortal"),m=t("../../Manager/ResMgr"),u=t("../../Manager/DataMgr"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTitleSk=null,e.mImtSp=null,e.mMatIcon=null,e.mMatNumLbl=null,e.mNameLbl=null,e.mStarSp=null,e.mStarSFArr=[],e}return r(e,t),e.prototype.SetData=function(t){this.mTitleSk.setAnimation(0,"animation",!1),m.default.Ins.LoadItemSprite(t,this.mImtSp,null);var e=l.default.Ins.GetConvertMat(t);m.default.Ins.LoadItemSprite(e[0],this.mMatIcon,null),this.mMatNumLbl.string="x"+s.default.FormatNumber(e[1],0);var o=u.default.Ins.m_DB.itemDB[t],n=u.default.Ins.m_DB.immortalDB[t];this.mNameLbl.string=o.name,this.mStarSp.spriteFrame=this.mStarSFArr[n.star-1]},e.prototype.Invoke_Close=function(){this.CloseWin()},i([d(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([d(cc.Sprite)],e.prototype,"mImtSp",void 0),i([d(cc.Sprite)],e.prototype,"mMatIcon",void 0),i([d(cc.Label)],e.prototype,"mMatNumLbl",void 0),i([d(cc.Label)],e.prototype,"mNameLbl",void 0),i([d(cc.Sprite)],e.prototype,"mStarSp",void 0),i([d([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./WinBase":"WinBase"}],ImtSkillPanel:[function(t,e,o){"use strict";cc._RF.push(e,"0aa70ikAmBJ2L9sPQ14Ku0i","ImtSkillPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ImmortalSkillBtn"),s=t("../../Proxy/ProxyImtSkill"),l=t("../../Manager/BCMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mItemRoot=null,e.mItemMap=new Map,e.mCellWidth=68,e}return r(e,t),e.prototype.OnFirstOpen=function(){this.mItemMap.set(0,this.mTemplate),this.UpdateSkillBtn()},e.prototype.OnOpen=function(){this.UpdateSkillBtn(),this.mItemMap.forEach(function(t){t.UpdateCD()})},e.prototype.Subscribe=function(){l.default.Subscribe(m.BCType.ImtSkill_UpdateCD,this._OnMsg_UpdateCD,this),l.default.Subscribe(m.BCType.ImtSkill_UpdateSkill,this._OnMsg_UpdateSkill,this)},e.prototype.Remove=function(){l.default.Remove(m.BCType.ImtSkill_UpdateCD,this._OnMsg_UpdateCD,this),l.default.Remove(m.BCType.ImtSkill_UpdateSkill,this._OnMsg_UpdateSkill,this)},e.prototype.UpdateSkillBtn=function(){this.mItemMap.forEach(function(t){t.node.active=!1});for(var t=s.default.Ins.GetCurSkillIDArr(),e=[],o=0,n=t.length;o<n;++o)0!==t[o]&&e.push(t[o]);for(o=0,n=e.length;o<n;++o){var r=e[o],i=this.mItemMap.get(r);if(!i){var l=cc.instantiate(this.mTemplate.node);l.parent=this.mItemRoot;var m=l.getComponent(a.default);m.SetData(t[o]),this.mItemMap.set(r,m),i=m}i.UpdateCD(),i.node.active=!0,i.node.position=cc.v3(this.mCellWidth*o-.5*this.mCellWidth*(n-1),0,0)}},e.prototype._OnMsg_UpdateCD=function(t){var e=this.mItemMap.get(t.skillID);e&&e.UpdateCD()},e.prototype._OnMsg_UpdateSkill=function(){this.UpdateSkillBtn()},i([c(a.default)],e.prototype,"mTemplate",void 0),i([c(cc.Node)],e.prototype,"mItemRoot",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxyImtSkill":"ProxyImtSkill","./ImmortalSkillBtn":"ImmortalSkillBtn"}],ImtSkillWin:[function(t,e,o){"use strict";cc._RF.push(e,"1fd360idtpLbbic8C43euGR","ImtSkillWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/TeamSkillIcon"),l=t("../Comp/TeamActiveSkillIcon"),m=t("../../Proxy/ProxyImtSkill"),u=t("../../Proxy/ProxyImmortal"),p=t("../../Manager/WinMgr"),c=t("../../Manager/DataMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTeamRoot=null,e.mContentRoot=null,e.mTemplate=null,e.mActiveTemplate=null,e.mAddPlaceBtn=null,e.mEmptyHint=null,e.mExtendCostLbl=null,e.mOwnSkillIconMap=new Map,e.mActiveSkillIconArr=new Array,e.mSkillIDArr=[],e.mNeedUpdateSkill=!1,e._OriPosX=-285,e.mColumnNum=6,e.mCellWidth=115,e.mCellHeight=100,e.mIdleOriPosY=-60,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mNeedUpdateSkill=!0,this._PlaceIdleSkills(),this._PlaceActiveSkills()},e.prototype._OnClose=function(){t.prototype._OnClose.call(this),this.mNeedUpdateSkill&&(m.default.Ins.UpdateSkill(),this.mNeedUpdateSkill=!1)},e.prototype._Compare_SkillID=function(t,e){return-(t-e)},e.prototype._PlaceActiveSkills=function(){for(var t=u.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e){if(e>=this.mActiveSkillIconArr.length){var n=cc.instantiate(this.mActiveTemplate.node);n.parent=this.mTeamRoot;var r=n.getComponent(l.default);r.SetData(t[e]),this.mActiveSkillIconArr.push(r)}else this.mActiveSkillIconArr[e].SetData(t[e]);var i=this._OriPosX+e*this.mCellWidth;this.mActiveSkillIconArr[e].node.position=cc.v3(i,0,0)}this.mActiveSkillIconArr.length===m.default.Ins.MAX_SKILL_COUNT?this.mAddPlaceBtn.active=!1:(this.mAddPlaceBtn.active=!0,this.mAddPlaceBtn.x=this._OriPosX+this.mCellWidth*this.mActiveSkillIconArr.length,this.mExtendCostLbl.string=""+m.default.Ins.GetExtendPosCost())},e.prototype._PlaceIdleSkills=function(){this.mSkillIDArr=[];for(var t=u.default.Ins.mImmortalInfo.immortalArr,e=null,o=0,n=t.length;o<n;++o)0!==(e=c.default.Ins.m_DB.immortalDB[t[o].id]).skill&&this.mSkillIDArr.push(e.skill);for(0===this.mSkillIDArr.length?this.mEmptyHint.opacity=255:this.mEmptyHint.opacity=0,o=0,n=this.mSkillIDArr.length;o<n;++o){var r=this.mSkillIDArr[o],i=this.mOwnSkillIconMap.get(r);if(i)i.SetData(this.mSkillIDArr[o]);else{var a=cc.instantiate(this.mTemplate.node);a.parent=this.mContentRoot;var l=a.getComponent(s.default);l.SetData(this.mSkillIDArr[o]),this.mOwnSkillIconMap.set(r,l)}}this.mContentRoot.height=Math.ceil(this.mSkillIDArr.length/this.mColumnNum)*this.mCellHeight+10,this.mSkillIDArr.sort(this._Compare_SkillID),this._CommonPlaceArr(this.mSkillIDArr,this.mColumnNum,this.mCellWidth,this.mCellHeight)},e.prototype._CommonPlaceArr=function(t,e,o,n){for(var r=0,i=t.length;r<i;++r){var a=this.mOwnSkillIconMap.get(t[r]),s=.5*-(e-1)*o+r%this.mColumnNum*o,l=this.mIdleOriPosY-Math.floor(r/e)*n;a.node.position=cc.v3(s,l,0)}},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(h.BCType.ImtSkill_UpdateSkillTeam,this._OnMsg_UpdateSkillTeam,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(h.BCType.ImtSkill_UpdateSkillTeam,this._OnMsg_UpdateSkillTeam,this)},e.prototype._OnMsg_UpdateSkillTeam=function(t){this._PlaceActiveSkills(),t&&this.mOwnSkillIconMap.get(t).UpdateState()},e.prototype.Invoke_Back=function(){f.default.PlayBtnSound(),this.CloseWin(),p.default.Ins.Open(h.WinType.ImmortalWin,null,!0),d.default.Dispatch(h.BCType.MainWin_ChangeCoinType,h.CoinType.ForgeMat)},e.prototype.Invoke_AddPos=function(){f.default.PlayBtnSound(),u.default.Ins.mImmortalInfo.curSkillArr.length<m.default.Ins.MAX_SKILL_COUNT&&p.default.Ins.Open(h.WinType.AddSkillPosWin,function(t){t.SetData()})},i([I(cc.Node)],e.prototype,"mTeamRoot",void 0),i([I(cc.Node)],e.prototype,"mContentRoot",void 0),i([I(s.default)],e.prototype,"mTemplate",void 0),i([I(l.default)],e.prototype,"mActiveTemplate",void 0),i([I(cc.Node)],e.prototype,"mAddPlaceBtn",void 0),i([I(cc.Node)],e.prototype,"mEmptyHint",void 0),i([I(cc.Label)],e.prototype,"mExtendCostLbl",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyImtSkill":"ProxyImtSkill","../Comp/TeamActiveSkillIcon":"TeamActiveSkillIcon","../Comp/TeamSkillIcon":"TeamSkillIcon","./WinBase":"WinBase"}],ImtSpeedLine:[function(t,e,o){"use strict";cc._RF.push(e,"03773syYzxPP5C7TF2ntGHq","ImtSpeedLine");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=t("../../Manager/PoolMgr"),l=t("../../Manager/DataMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSk=null,e.mImtSkillSp=null,e.mImtSkillNameLbl=null,e.mCurSkillID=0,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,this.mSk.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.active=!0},e.prototype.OnReturned=function(){this.node.active=!1},e.prototype.Init=function(t){if(this.mCurSkillID!==t){var e=l.default.Ins.m_DB.imtSkillDB[t];a.default.Ins.LoadItemSprite(t,this.mImtSkillSp,null),this.mImtSkillNameLbl.string=e.name}this.mSk.setAnimation(0,"animation",!1)},e.prototype._OnAnimCompleted=function(){s.default.Ins.Return(this)},i([p(sp.Skeleton)],e.prototype,"mSk",void 0),i([p(cc.Sprite)],e.prototype,"mImtSkillSp",void 0),i([p(cc.Label)],e.prototype,"mImtSkillNameLbl",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr"}],InitGame:[function(t,e,o){"use strict";cc._RF.push(e,"3de42XxpqtKzacBp802sYDy","InitGame");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./UI/Win/PreloadWin"),s=t("./Manager/WinMgr"),l=t("./Manager/SaveMgr"),m=t("./Manager/PlatformMgr"),u=t("./Manager/DataMgr"),p=t("./Manager/AudioMgr"),c=t("./Common/EnumsDefine"),d=t("./Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.preloadWin=null,e}var o;return r(e,t),o=e,e.prototype.start=function(){d.default.ScreenWidth=cc.winSize.width,d.default.ScreenHeight=cc.winSize.height;var t=d.default.ScreenHeight/d.default.ScreenWidth,e=d.default.DESIGN_HEIGHT/d.default.DESIGN_WIDTH;d.default.RealAspect=t,d.default.RealAspect<=1.6&&(cc.view.setDesignResolutionSize(720,1280,cc.ResolutionPolicy.FIXED_HEIGHT),d.default.MainScene="MainGamePad"),t-e>.1&&(d.default.TOP_SAFE_OFFSET=-60),p.default.Init(),u.default.Ins.Initialize(),m.default.Init(),d.default.Init(),cc.director.preloadScene(d.default.MainScene,null,function(){o.HasMainSceneLoaded=!0}),this._HandlePrivacy(),this.preloadWin.Init()},e.prototype._HandlePrivacy=function(){m.default.mCurPlf.NeedShowPrivacy()?l.default.Get(l.default.PRIVACY_FLAG)?o.HasPrivacyOK=!0:s.default.Ins.Open(c.WinType.PrivacyWin,null):o.HasPrivacyOK=!0},e.HasDataLoaded=!1,e.HasMainSceneLoaded=!1,e.HasPrivacyOK=!1,i([y(a.default)],e.prototype,"preloadWin",void 0),o=i([h],e)}(cc.Component);o.default=g,cc._RF.pop()},{"./Common/Common":"Common","./Common/EnumsDefine":"EnumsDefine","./Manager/AudioMgr":"AudioMgr","./Manager/DataMgr":"DataMgr","./Manager/PlatformMgr":"PlatformMgr","./Manager/SaveMgr":"SaveMgr","./Manager/WinMgr":"WinMgr","./UI/Win/PreloadWin":"PreloadWin"}],ItemDetailPanel:[function(t,e,o){"use strict";cc._RF.push(e,"9ec2fcyJhhHE4SB5v9SDIuG","ItemDetailPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Manager/DataMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mDescLbl=null,e.mItem=null,e.mCurItemID=0,e}return r(e,t),e.prototype.SetData=function(t){if(this.mCurItemID!==t){this.mCurItemID=t;var e=s.default.Ins.m_DB.itemDB[t];this.mItem.SetData(t,""),this.mDescLbl.string=e.introduct}},e.prototype.SetPosition=function(t){this.node.position=t},i([u(cc.Label)],e.prototype,"mDescLbl",void 0),i([u(a.default)],e.prototype,"mItem",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","./SimpleItem":"SimpleItem"}],ItemHintWin:[function(t,e,o){"use strict";cc._RF.push(e,"9dbe8rGqydCkIdJObHz8anR","ItemHintWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Manager/UserMgr"),m=t("../../Manager/DataMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mNumLbl=null,e.mHintLbl=null,e.mDescLbl=null,e.mItemData=null,e.mEnableClose=!1,e}return r(e,t),e.prototype.SetData=function(t){this.mItemData=m.default.Ins.m_DB.itemDB[t],this.mItem.SetData(t,""),this.mNumLbl.string=l.default.Ins.GetItemNum(t)+"",this.mHintLbl.string=this.mItemData.name+"\u4e0d\u8db3",this.mDescLbl.string=this.mItemData.introduct},e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mEnableClose=!1,this.scheduleOnce(function(){e.mEnableClose=!0},.5),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnEvent_ClickMask=function(){this.mEnableClose&&(this.CloseWin(),this.mMask.targetOff(cc.Node.EventType.TOUCH_END))},i([c(s.default)],e.prototype,"mItem",void 0),i([c(cc.Label)],e.prototype,"mNumLbl",void 0),i([c(cc.Label)],e.prototype,"mHintLbl",void 0),i([c(cc.Label)],e.prototype,"mDescLbl",void 0),i([p],e)}(a.default);o.default=d,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],JellyTween:[function(t,e,o){"use strict";cc._RF.push(e,"9426erIf3hE/4ohEaQBZuu6","JellyTween");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.frequency=4,e.decay=2,e.pressScale=.2,e.totalTime=1,e.interval=1,e.playOnLoad=!1,e.originalScale=1,e.tween=null,e}return r(e,t),e.prototype.start=function(){this.originalScale=this.node.scale,this.playOnLoad&&this.play()},e.prototype.play=function(t){var e=this,o=null!=t&&t>0?t:1e9,n=.2*this.totalTime,r=.15*this.totalTime,i=.65*this.totalTime,a=this.pressScale/r;this.tween=cc.tween(this.node).repeat(o,cc.tween().to(n,{scaleX:this.originalScale+this.pressScale,scaleY:this.originalScale-this.pressScale},{easing:"sineOut"}).to(r,{scaleX:this.originalScale,scaleY:this.originalScale}).to(i,{scaleX:{value:this.originalScale,progress:function(t,o,n,r){return o-e.getDifference(a,r)}},scaleY:{value:this.originalScale,progress:function(t,o,n,r){return o+e.getDifference(a,r)}}}).delay(this.interval)).start()},e.prototype.stop=function(){this.tween&&this.tween.stop(),this.node.setScale(this.originalScale)},e.prototype.getDifference=function(t,e){var o=this.frequency*Math.PI*2;return t*(Math.sin(e*o)/Math.exp(this.decay*e)/o)},i([l({tooltip:"!1"})],e.prototype,"frequency",void 0),i([l({tooltip:"!1"})],e.prototype,"decay",void 0),i([l({tooltip:"!1"})],e.prototype,"pressScale",void 0),i([l({tooltip:"!1"})],e.prototype,"totalTime",void 0),i([l({tooltip:"!1"})],e.prototype,"interval",void 0),i([l({tooltip:"!1"})],e.prototype,"playOnLoad",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],LevelController:[function(t,e,o){"use strict";cc._RF.push(e,"c4154iA29ZGmYxizlU98639","LevelController"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EnemySpawnController"),r=t("../../Manager/DataMgr"),i=t("../../Common/EnumsDefine"),a=function(){function t(t){this.mOwerFightMode=null,this.mIsBossLevel=!1,this.mLimitDmgCampType=i.CampType.None,this.mCounterType=i.CounterType.None,this.mSpawnerArr=[],this.mStartSpawn=!1,this.mOwerFightMode=t}return t.prototype.Init=function(t){if(0!==t)if(this.mCurLevelData=r.default.Ins.GetLevelDataByID(t),null!==this.mCurLevelData){var e=this.mOwerFightMode;this.mLimitDmgCampType=e.GetLimitDmgCampType(t),this.mCounterType=e.GetCounterType(),this.mStartSpawn=!1,this.mSpawnerArr=[];for(var o=this.mCurLevelData.monster,i=0,a=o.length;i<a;++i)this.mSpawnerArr.push(new n.default(o[i],this));if(this.mIsBossLevel=e.IsBossLevel(),this.mIsBossLevel){var s=e.GetBossID();this.mSpawnerArr.push(new n.default([s,1,0,0],this))}else if(e.IsEliteLevel()){var l=e.GetEliteID();this.mSpawnerArr.push(new n.default([l,1,0,0],this))}}else console.error("\u4e0d\u5b58\u5728\u5173\u5361ID\u4e3a"+t+"\u7684\u914d\u7f6e")},t.prototype.StartSpawn=function(){this.mStartSpawn=!0},t.prototype.OnUpdate=function(t){if(this.mStartSpawn)for(var e=0,o=this.mSpawnerArr.length;e<o;++e)this.mSpawnerArr[e].OnUpdate(t)},t.prototype.Stop=function(){for(var t=0,e=this.mSpawnerArr.length;t<e;++t)this.mSpawnerArr[t].Stop()},t}();o.default=a,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/DataMgr":"DataMgr","./EnemySpawnController":"EnemySpawnController"}],LevelItem:[function(t,e,o){"use strict";cc._RF.push(e,"31f26TQVL1B6Zuj6+lxQBS5","LevelItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/FightMgr"),s=t("../../Manager/DataMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNumLbl=null,e.mTypeSp=null,e.mLevelPanel=null,e.mShowNum=-100,e}return r(e,t),e.prototype.Init=function(t){this.mLevelPanel=t},e.prototype.SetData=function(t){this.mShowNum!==t&&(t<=0||t>s.default.Ins.mMaxLevelID?this.node.active=!1:(this.node.active=!0,this.mShowNum=t,this.mNumLbl.string=t+"",this._SetTypeSF()))},e.prototype._SetTypeSF=function(){this.mShowNum%a.default.mBossLevelInterval==0?this.mTypeSp.spriteFrame=this.mLevelPanel.mTypeSFArr[2]:this.mShowNum%a.default.mEliteLevelInterval==0?this.mTypeSp.spriteFrame=this.mLevelPanel.mTypeSFArr[1]:this.mTypeSp.spriteFrame=this.mLevelPanel.mTypeSFArr[0]},i([u(cc.Label)],e.prototype,"mNumLbl",void 0),i([u(cc.Sprite)],e.prototype,"mTypeSp",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/FightMgr":"FightMgr"}],LevelPanel:[function(t,e,o){"use strict";cc._RF.push(e,"e4315r+qtFNE63R+N4oETEX","LevelPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LevelItem"),s=t("../../Manager/UserMgr"),l=t("../../Manager/FightMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTypeSFArr=[],e.mLevelItem=null,e.mItemArr=[],e.mCurShowLevel=-10,e.mT1=.2,e}return r(e,t),e.prototype.Init=function(){for(var t=0;t<5;++t){if(0===t)this.mItemArr.push(this.mLevelItem);else{var e=cc.instantiate(this.mLevelItem.node),o=e.getComponent(a.default);e.parent=this.mLevelItem.node.parent,this.mItemArr.push(o)}this.mItemArr[t].Init(this)}},e.prototype._PlayTween=function(t,e,o,n,r){void 0===r&&(r=null);var i=cc.tween;i(t).parallel(i().to(this.mT1,{position:e}),i().to(this.mT1,{scale:o}),i().to(this.mT1,{opacity:n})).call(function(){null!==r&&r()}).start()},e.prototype.UpdateUI=function(){var t=this,e=s.default.Ins.ClientInfo.curLevel;if(e!==this.mCurShowLevel){var o=this.mItemArr[0],n=this.mItemArr[1],r=this.mItemArr[2],i=this.mItemArr[3],a=this.mItemArr[4];e>this.mCurShowLevel&&e-this.mCurShowLevel==1?((0,cc.tween)(o.node).to(this.mT1,{position:cc.v3(-200,0,0)}).start(),this._PlayTween(n.node,cc.v3(-135,0,0),.8,220),this._PlayTween(r.node,cc.v3(-70,0,0),.9,235),i.node.x=70,i.node.opacity=0,i.node.scale=0,i.SetData(e),this._PlayTween(i.node,cc.v3(0,0,0),1,255,function(){var e=t.mItemArr.shift();t.mItemArr.splice(-1,0,e)}),a.SetData(this._GetNextTargetLevel(e))):e<this.mCurShowLevel&&e-this.mCurShowLevel==-1?(this._PlayTween(r.node,cc.v3(70,0,0),0,0),this._PlayTween(n.node,cc.v3(0,0,0),1,255),this._PlayTween(o.node,cc.v3(-70,0,0),.9,235),i.node.x=-200,i.node.opacity=0,i.node.scale=0,i.SetData(e-2),this._PlayTween(i.node,cc.v3(-135,0,0),.8,220,function(){var e=t.mItemArr.splice(3,1);t.mItemArr.unshift(e[0])}),a.SetData(this._GetNextTargetLevel(e))):(o.SetData(e-2),n.SetData(e-1),r.SetData(e),i.SetData(-1),a.SetData(this._GetNextTargetLevel(e)),o.node.x=-135,o.node.scale=.8,o.node.opacity=220,n.node.x=-70,n.node.scale=.9,n.node.opacity=235,r.node.x=0,r.node.scale=1,r.node.opacity=255,i.node.x=70,i.node.scale=.9,i.node.opacity=235,a.node.x=135,a.node.scale=.8,a.node.opacity=220),this.mCurShowLevel=e}},e.prototype._GetNextTargetLevel=function(t){return(Math.floor(t/l.default.mEliteLevelInterval)+1)*l.default.mEliteLevelInterval},i([p([cc.SpriteFrame])],e.prototype,"mTypeSFArr",void 0),i([p(a.default)],e.prototype,"mLevelItem",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Manager/FightMgr":"FightMgr","../../Manager/UserMgr":"UserMgr","./LevelItem":"LevelItem"}],LevelRewardItem:[function(t,e,o){"use strict";cc._RF.push(e,"9d2c1wHUGZKxaApnHxGAO1J","LevelRewardItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollItem"),s=t("../../Proxy/ProxyLevelReward"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLevelBgNode=null,e.mLevelIDLbl=null,e.mLevelLockMask=null,e.mLeftGoldLbl=null,e.mLeftGotNode=null,e.mLeftCanGetNode=null,e.mRightGoldLbl=null,e.mRightGotNode=null,e.mRightLockNode=null,e.mRightCanGetNode=null,e.mLevelID=0,e.mCurBestLevel=0,e.mLevelRewardWin=null,e}return r(e,t),e.prototype.Init=function(e,o){this.mLevelRewardWin=o,t.prototype.Init.call(this,e,o)},e.prototype._InitOnce=function(){this.mLeftGoldLbl.string="x"+s.default.Ins.mNormalGoldNum,this.mRightGoldLbl.string="x"+s.default.Ins.mLuxuryGoldNum},e.prototype.UpdateUI=function(){var t=m.default.Ins.ClientInfo.levelReward;this.mCurBestLevel=this.mLevelRewardWin.mCurShowBestLevel,this.mLevelID=(this.mIdx+1)*s.default.Ins.mLevelInternal,this.mLevelIDLbl.string=""+this.mLevelID;var e=!1;this.mCurBestLevel<this.mLevelID?(this.mLevelLockMask.opacity=255,this.mLevelBgNode.opacity=0):(this.mLevelLockMask.opacity=0,this.mLevelBgNode.opacity=255,e=!0),this.mLeftCanGetNode.opacity=0,t.normalID<this.mLevelID?(this.mLeftGotNode.opacity=0,e&&t.normalID+s.default.Ins.mLevelInternal===this.mLevelID&&(this.mLeftCanGetNode.opacity=255)):this.mLeftGotNode.opacity=255,this.mRightCanGetNode.opacity=0,0===t.luxuryState?this.mRightLockNode.opacity=255:this.mRightLockNode.opacity=0,t.luxuryID<this.mLevelID?(this.mRightGotNode.opacity=0,e&&1===t.luxuryState&&t.luxuryID+s.default.Ins.mLevelInternal===this.mLevelID&&(this.mRightCanGetNode.opacity=255)):this.mRightGotNode.opacity=255},e.prototype.Invoke_ClickLeftGold=function(){if(u.default.PlayBtnSound(),this.mCurBestLevel<this.mLevelID)l.default.Ins.ShowTips("\u901a\u8fc7\u7b2c"+this.mLevelID+"\u5173\u5373\u53ef\u9886\u53d6");else{var t=m.default.Ins.ClientInfo.levelReward;t.normalID>=this.mLevelID||(t.normalID+s.default.Ins.mLevelInternal===this.mLevelID?(s.default.Ins.GetNormalReward(this.mLevelID),l.default.Ins.Open(p.WinType.GetRewardsWin,function(t){t.SetDataSingle(p.ItemType.Gold,""+s.default.Ins.mNormalGoldNum)})):l.default.Ins.ShowTips("\u8bf7\u5148\u9886\u53d6\u524d\u9762\u7684\u5956\u52b1\uff0c\u907f\u514d\u9057\u6f0f\u54e6~"))}},e.prototype.Invoke_ClickRightGold=function(){u.default.PlayBtnSound();var t=m.default.Ins.ClientInfo.levelReward;0!==t.luxuryState?t.luxuryID>=this.mLevelID||(t.luxuryID+s.default.Ins.mLevelInternal===this.mLevelID?(s.default.Ins.GetLuxuryReward(this.mLevelID),l.default.Ins.Open(p.WinType.GetRewardsWin,function(t){t.SetDataSingle(p.ItemType.Gold,""+s.default.Ins.mLuxuryGoldNum)})):l.default.Ins.ShowTips("\u8bf7\u5148\u9886\u53d6\u524d\u9762\u7684\u5956\u52b1\uff0c\u907f\u514d\u9057\u6f0f\u54e6~")):l.default.Ins.ShowTips("\u89e3\u9501\u4ee5\u540e\u5373\u53ef\u9886\u53d6\uff0c\u8bf7\u5148\u524d\u5f80\u89e3\u9501\u3002")},i([f(cc.Node)],e.prototype,"mLevelBgNode",void 0),i([f(cc.Label)],e.prototype,"mLevelIDLbl",void 0),i([f(cc.Node)],e.prototype,"mLevelLockMask",void 0),i([f(cc.Label)],e.prototype,"mLeftGoldLbl",void 0),i([f(cc.Node)],e.prototype,"mLeftGotNode",void 0),i([f(cc.Node)],e.prototype,"mLeftCanGetNode",void 0),i([f(cc.Label)],e.prototype,"mRightGoldLbl",void 0),i([f(cc.Node)],e.prototype,"mRightGotNode",void 0),i([f(cc.Node)],e.prototype,"mRightLockNode",void 0),i([f(cc.Node)],e.prototype,"mRightCanGetNode",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLevelReward":"ProxyLevelReward","./LoopScrollItem":"LoopScrollItem"}],LevelRewardLoopSV:[function(t,e,o){"use strict";cc._RF.push(e,"13216kUeQtM3JBStv6KUnRv","LevelRewardLoopSV");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollView"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./LoopScrollView":"LoopScrollView"}],LevelRewardWin:[function(t,e,o){"use strict";cc._RF.push(e,"72478WjrZRCWLgwuDC363Qh","LevelRewardWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/LevelRewardLoopSV"),l=t("../../Proxy/ProxyLevelReward"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=t.call(this)||this;e.mLoopSV=null,e.mCurLevelLbl=null,e.mAccGoldLbl=null,e.mUnlockRoot=null,e.mADCoinLbl=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mCurShowBestLevel=0;var o=e;return o.mLoopSV=null,o.mCurLevelLbl=null,o.mAccGoldLbl=null,o.mUnlockRoot=null,o.mADCoinLbl=null,o.mCloseBtn=null,o.mCloseBtnRoot=null,o.mCurShowBestLevel=0,o}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mLoopSV.Initialize(p.default.Ins.mMaxLevelID/l.default.Ins.mLevelInternal,this),this.mADCoinLbl.string=l.default.Ins.mNeedADCoinNum+"",this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&h.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mCurShowBestLevel=u.default.Ins.ClientInfo.bestLevel-1,this.mLoopSV.UpdateUI(),this.mUnlockRoot.active=0===u.default.Ins.ClientInfo.levelReward.luxuryState,this.mCurLevelLbl.string="\u901a\u5173\u5bf9\u5e94\u5173\u5361\u53ef\u9886\u53d6\uff08\u6700\u9ad8"+this.mCurShowBestLevel+"\uff09",this.mAccGoldLbl.string=l.default.Ins.GetLuxuryCanGetGoldNum()+"",d.default.PlaySFX(f.AudioName.UI_TanKuang,!0)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(f.BCType.LevelReward_GetRewards,this._OnMsg_GetLevelRewards,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(f.BCType.LevelReward_GetRewards,this._OnMsg_GetLevelRewards,this)},e.prototype._OnMsg_GetLevelRewards=function(){this.mLoopSV.UpdateUI()},e.prototype.Invoke_Close=function(){d.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_UnlockLuxuryReward=function(){if(d.default.PlayBtnSound(),1!==u.default.Ins.ClientInfo.levelReward.luxuryState)if(u.default.Ins.GetItemNum(f.ItemType.ADCoin)<l.default.Ins.mNeedADCoinNum)m.default.Ins.Open(f.WinType.ItemHintWin,function(t){t.SetData(f.ItemType.ADCoin)});else{var t=l.default.Ins.UnlockLuxuryReward();0!==t?m.default.Ins.Open(f.WinType.GetRewardsWin,function(e){e.SetDataSingle(f.ItemType.Gold,""+t)}):m.default.Ins.Open(f.WinType.UnlockLevelLuxuryWin,null),this.mUnlockRoot.active=!1,this.mLoopSV.UpdateUI()}},i([I(s.default)],e.prototype,"mLoopSV",void 0),i([I(cc.Label)],e.prototype,"mCurLevelLbl",void 0),i([I(cc.Label)],e.prototype,"mAccGoldLbl",void 0),i([I(cc.Node)],e.prototype,"mUnlockRoot",void 0),i([I(cc.Label)],e.prototype,"mADCoinLbl",void 0),i([I(cc.Node)],e.prototype,"mCloseBtn",void 0),i([I(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLevelReward":"ProxyLevelReward","../Comp/LevelRewardLoopSV":"LevelRewardLoopSV","./WinBase":"WinBase"}],LongPress:[function(t,e,o){"use strict";cc._RF.push(e,"e7bbenuFotLo6Rv351Fd2Fq","LongPress");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTriggerTime=.5,e.mEvents=[],e}return r(e,t),e.prototype.onEnable=function(){this.node.on(cc.Node.EventType.TOUCH_START,this._OnTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._OnTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnTouchCancel,this)},e.prototype.onDisable=function(){this.node.off(cc.Node.EventType.TOUCH_START,this._OnTouchStart,this),this.node.off(cc.Node.EventType.TOUCH_END,this._OnTouchEnd,this),this.node.off(cc.Node.EventType.TOUCH_CANCEL,this._OnTouchCancel,this)},e.prototype._OnTouchStart=function(){this.scheduleOnce(this._HandlePressEvent.bind(this),this.mTriggerTime)},e.prototype._OnTouchEnd=function(){this.unscheduleAllCallbacks()},e.prototype._OnTouchCancel=function(){this.unscheduleAllCallbacks()},e.prototype._HandlePressEvent=function(){this._Trigger()},e.prototype._Trigger=function(){cc.Component.EventHandler.emitEvents(this.mEvents,this)},i([l(cc.Float)],e.prototype,"mTriggerTime",void 0),i([l(cc.Component.EventHandler)],e.prototype,"mEvents",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],LoopScrollItem:[function(t,e,o){"use strict";cc._RF.push(e,"cdff3ZRljhJl4xiz3jt2wjy","LoopScrollItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.Init=function(t){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];this.mIdx=t,this._InitOnce(),this.UpdateUI()},e.prototype._InitOnce=function(){},e.prototype.OnItemChange=function(t){this.mIdx=t,this.UpdateUI()},e.prototype.UpdateUI=function(){},i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],LoopScrollView:[function(t,e,o){"use strict";cc._RF.push(e,"6e65behT71LzaBq07NY8IZ7","LoopScrollView");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollItem"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mScrollView=null,e.mTemplate=null,e.mInitCount=0,e.mSpacing=0,e.mBufferZone=0,e.mItemArr=[],e.mContentNode=null,e.mTotalCount=0,e.mTotalHeight=0,e.mUpdateTimer=0,e.mUpdateInterval=.12,e.mLastContentPosY=0,e}return r(e,t),e.prototype.update=function(t){if(this.mUpdateTimer+=t,!(this.mUpdateTimer<this.mUpdateInterval)){this.mUpdateTimer=0;for(var e=this.mItemArr,o=this.mBufferZone,n=this.mScrollView.content.y<this.mLastContentPosY,r=(this.mTemplate.node.height+this.mSpacing)*e.length,i=0;i<e.length;++i){var a=this.GetPositionInView(e[i].node);if(n){if(a.y<-o&&e[i].node.y+r<0){e[i].node.y=e[i].node.y+r;var s=e[i].mIdx-e.length;e[i].OnItemChange(s)}}else a.y>o&&e[i].node.y-r>-this.mContentNode.height&&(e[i].node.y=e[i].node.y-r,s=e[i].mIdx+e.length,e[i].OnItemChange(s))}this.mLastContentPosY=this.mScrollView.content.y}},e.prototype.Initialize=function(t,e){void 0===e&&(e=null),0===this.mBufferZone&&(this.mBufferZone=.5*this.mScrollView.node.height+.5*this.mTemplate.node.height+10),this.mTotalCount=t,this.mLastContentPosY=0,this.mContentNode=this.mScrollView.content,this.mTotalHeight=this.mTotalCount*(this.mTemplate.node.height+this.mSpacing)+this.mSpacing,this.mContentNode.height=this.mTotalHeight;for(var o=Math.min(t,this.mInitCount),n=0;n<o;++n){var r=null;(r=0===n?this.mTemplate.node:cc.instantiate(this.mTemplate.node)).active=!0,r.parent=this.mContentNode,r.setPosition(0,-r.height*(.5+n)-this.mSpacing*(n+1));var i=r.getComponent(a.default);this.mItemArr.push(i)}for(n=0;n<o;++n)(i=this.mItemArr[n]).Init(n,e)},e.prototype.UpdateScrollRangeCount=function(t,e){this.mTotalHeight=t*(this.mTemplate.node.height+this.mSpacing)+this.mSpacing,this.mContentNode.height=this.mTotalHeight;var o=this.mItemArr.length,n=Math.min(t,this.mInitCount);if(o<n)for(var r=n-o,i=0;i<r;++i){var s=null,l=i+o;(s=0===this.mItemArr.length?this.mTemplate.node:cc.instantiate(this.mTemplate.node)).active=!0,s.parent=this.mContentNode,s.setPosition(0,-s.height*(.5+l)-this.mSpacing*(l+1));var m=s.getComponent(a.default);m.Init(l,e),this.mItemArr.push(m)}},e.prototype.ScrollToID=function(t,e){void 0===e&&(e=0);var o=(this.mTemplate.node.height+this.mSpacing)*(t-1)/(this.mTotalHeight-this.mScrollView.node.height);this.mScrollView.scrollTo(cc.v2(0,1-o),e)},e.prototype.GetPositionInView=function(t){var e=t.parent.convertToWorldSpaceAR(t.position);return this.mScrollView.node.convertToNodeSpaceAR(e)},e.prototype.UpdateUI=function(){for(var t=0;t<this.mItemArr.length;++t)this.mItemArr[t].UpdateUI()},i([m(cc.ScrollView)],e.prototype,"mScrollView",void 0),i([m(a.default)],e.prototype,"mTemplate",void 0),i([m(cc.Integer)],e.prototype,"mInitCount",void 0),i([m(cc.Float)],e.prototype,"mSpacing",void 0),i([m(cc.Float)],e.prototype,"mBufferZone",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"./LoopScrollItem":"LoopScrollItem"}],LotteryBox:[function(t,e,o){"use strict";cc._RF.push(e,"0bf245oEzdCNbmSr+RBVMth","LotteryBox");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyLottery"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/PoolMgr"),c=t("../../Manager/PlotMgr"),d=t("../../Manager/PlatformMgr"),f=t("../../Manager/GuideMgr"),h=t("../../Manager/DataMgr"),y=t("../../Manager/AudioMgr"),g=t("../../Common/EnumsDefine"),I=t("../../Common/Common"),S=cc._decorator,_=S.ccclass,v=S.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSk=null,e.mBgEfx=null,e.mHeroRoot=null,e.mHeroSk=null,e.mQualitySp=null,e.mHintNode=null,e.mFragmentLbl=null,e.mNameLbl=null,e.mRepeatHeroRoot=null,e.mCurFragNumLbl=null,e.mPb=null,e.mStarInfoRoot=null,e.mSkillIcon=null,e.mSkillNameLbl=null,e.mSkillDescLbl=null,e.mStarUnlockLbl=null,e.mHeroID=0,e.mOwnerWin=null,e.mQualityArr=["r","sr","ssr"],e.mCurQuality=g.HeroQuality.R,e.mOpened=!1,e.mIsNew=!1,e.mIsSingle=!0,e.mTargetFragNum=0,e.mLastFragNum=0,e.mCurFragNum=0,e.mRepeatTween=null,e.mStarCount=!1,e.mCountingTime=1,e.mTiming=0,e}return r(e,t),e.prototype.Reset=function(){this.mHeroRoot.active=!1,this.mOpened=!1,this.mSk.setAnimation(0,"jingtai",!1),this.mBgEfx.node.opacity=0,this.mPb.node.active=!1,this.mStarCount=!1,this.mRepeatHeroRoot.opacity=0},e.prototype.SetData=function(t,e,o,n){void 0===n&&(n=!0),this.mHeroID=t,this.mIsNew=e,this.mOwnerWin=o,this.mIsSingle=n;var r=h.default.Ins.m_DB.heroCardDB[t],i=this,l=s.default.Ins.GetHeroSI(t),p=a.default.Ins.mFragmentNumArr[r.baseQuality];if(this.mTargetFragNum=s.default.Ins.GetNeedFragment(r.baseQuality,l.heroQuality,l.starLv),this.mCurFragNum=m.default.Ins.GetItemNum(t),this.mLastFragNum=this.mCurFragNum-p,null!==this.mHeroSk){this.mHeroSk.node.scale=r.scale,this.mHeroSk.skeletonData=null;var c=h.default.Ins.m_DB.entityDB[t];u.default.Ins.LoadSpine("spine/hero/"+c.model,function(t){i.mHeroSk&&(i.mHeroSk.skeletonData=t,i.mHeroSk.setAnimation(0,"daiji",!0))})}if(this.mQualitySp.spriteFrame=o.mQualitySFArr[r.baseQuality],this.mCurQuality=r.baseQuality,this.mNameLbl.string=r.name,this.mIsNew?this.mHintNode.opacity=0:(this.mHintNode.opacity=255,this.mFragmentLbl.string="x"+p),!e){var d=this;u.default.Ins.LoadSpine("spine/beijngguang",function(t){d.mBgEfx.skeletonData=t})}this.mSk.setEventListener(this._OnAnimEventListener.bind(this))},e.prototype._OnAnimEventListener=function(t,e){var o=this.mCurQuality,n=this;if("appear_1"===e.data.name){var r=this.node.position,i=cc.v3(r.x,r.y+.5*(this.node.scale-1)*this.node.height,0),a=this.node.parent.convertToWorldSpaceAR(i);p.default.Ins.Borrow(p.default.EFX_PATH_ROOT+"boxEfx"+this.mCurQuality,"UIEfxBase",function(t){t.node.parent=n.mOwnerWin.mEfxRoot,t.node.position=n.mOwnerWin.mEfxRoot.convertToNodeSpaceAR(a),t.node.scale=1}),o===g.HeroQuality.R?y.default.PlaySFX(g.AudioName.UI_R,!0):o===g.HeroQuality.SR?y.default.PlaySFX(g.AudioName.UI_SR,!0):o===g.HeroQuality.SSR&&y.default.PlaySFX(g.AudioName.UI_SSR,!0)}else{var s=e.data.name;("appear_r"===s&&o===g.HeroQuality.R||"appear_sr"===s&&o===g.HeroQuality.SR||"appear_ssr"===s&&o===g.HeroQuality.SSR)&&(n.mIsNew?l.default.Ins.Open(g.WinType.NewHeroShowWin,function(t){var e=t,o=null;1===m.default.Ins.ClientInfo.lottery.totalTimes?(o=function(){c.default.Ins.TriggerPlot(7,function(){f.default.TriggerGuide(10,!0)},!0)},u.default.Ins.LoadPrefab("prefab/win/SecondDayWin",null,null),d.default.mCurPlf.HideBanner()):I.default.RealAspect<=2&&d.default.mCurPlf.HideBanner(),e.SetData(n.mHeroID,o,g.WinType.LotteryOpenWin)},!1,function(){n.mOwnerWin.Back()}):(this.mOwnerWin.OnBoxOpened(),this.mHeroRoot.active=!0,this.mHeroRoot.opacity=0,this.mHeroSk&&this.mHeroSk.setAnimation(0,"daiji",!0),cc.tween(this.mHeroRoot).to(.2,{opacity:255}).start(),this.mBgEfx.node.opacity=255,this.mBgEfx.setAnimation(0,this.mQualityArr[o],!0),this._RepeatHeroAnim()))}},e.prototype._RepeatHeroAnim=function(){var t=this;null!==this.mRepeatTween&&this.mRepeatTween.stop();var e=this;this._SetStarInfo(),this.mRepeatTween=cc.tween(this.mRepeatHeroRoot).delay(.5).to(.3,{opacity:255}).call(function(){e.mPb.node.active=!0,e.mOwnerWin.mUpAnim.stop(),e.mOwnerWin.mBottomAnim.stop(),e.mOwnerWin.mUpAnim.node.scale=0,e.mOwnerWin.mBottomAnim.node.scale=0,e.mOwnerWin.mDoubleBtnRoot.active=!0,t.scheduleOnce(function(){e.mOwnerWin.mUpAnim.play("btnAppear",0)},1.2),t.scheduleOnce(function(){e.mOwnerWin.mBottomAnim.play("btnAppear",0)},1.7),e.mTiming=0,e.mStarCount=!0,e._ShowStarInfo()}).start()},e.prototype._SetStarInfo=function(){var t=s.default.Ins.GetHeroSI(this.mHeroID);if(t.starLv<s.default.MAX_STAR_LV){var e=t.starLv+1,o=s.default.Ins.GetHeroSkillData(this.mHeroID,e);o&&(u.default.Ins.LoadHeroSkillSp(this.mHeroID,e,this.mSkillIcon),this.mSkillNameLbl.string=o.name,this.mSkillDescLbl.string=o.desc),this.mStarUnlockLbl.string="\uff08"+e+"\u661f\u89e3\u9501\uff09"}else this.mStarInfoRoot.opacity=0},e.prototype._ShowStarInfo=function(){s.default.Ins.GetHeroSI(this.mHeroID).starLv<s.default.MAX_STAR_LV&&(this.mStarInfoRoot.opacity=255)},e.prototype.update=function(t){if(this.mStarCount)if(this.mTiming+=t,this.mTiming>=this.mCountingTime)this.mStarCount=!1,this.mPb.progress=this.mCurFragNum/this.mTargetFragNum,this.mCurFragNumLbl.string=this.mCurFragNum+"/"+this.mTargetFragNum;else{var e=Math.floor(this.mLastFragNum+this.mTiming/this.mCountingTime*(this.mCurFragNum-this.mLastFragNum));this.mPb.progress=e/this.mTargetFragNum,this.mCurFragNumLbl.string=e+"/"+this.mTargetFragNum}},e.prototype.Invoke_Open=function(){this.mOpened||(y.default.PlayBtnSound(),this.mOpened=!0,this.mSk.setAnimation(0,this.mQualityArr[this.mCurQuality]+"_doudong",!1))},i([v(sp.Skeleton)],e.prototype,"mSk",void 0),i([v(sp.Skeleton)],e.prototype,"mBgEfx",void 0),i([v(cc.Node)],e.prototype,"mHeroRoot",void 0),i([v(sp.Skeleton)],e.prototype,"mHeroSk",void 0),i([v(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([v(cc.Node)],e.prototype,"mHintNode",void 0),i([v(cc.Label)],e.prototype,"mFragmentLbl",void 0),i([v(cc.Label)],e.prototype,"mNameLbl",void 0),i([v(cc.Node)],e.prototype,"mRepeatHeroRoot",void 0),i([v(cc.Label)],e.prototype,"mCurFragNumLbl",void 0),i([v(cc.ProgressBar)],e.prototype,"mPb",void 0),i([v(cc.Node)],e.prototype,"mStarInfoRoot",void 0),i([v(cc.Sprite)],e.prototype,"mSkillIcon",void 0),i([v(cc.Label)],e.prototype,"mSkillNameLbl",void 0),i([v(cc.Label)],e.prototype,"mSkillDescLbl",void 0),i([v(cc.Label)],e.prototype,"mStarUnlockLbl",void 0),i([_],e)}(cc.Component);o.default=C,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/GuideMgr":"GuideMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PlotMgr":"PlotMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery"}],LotteryCampInstructionWin:[function(t,e,o){"use strict";cc._RF.push(e,"79f50WN1qlHxYuZwRRBDkDR","LotteryCampInstructionWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/AudioMgr"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),s.default.PlaySFX(l.AudioName.UI_TanKuang,!0)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},i([u],e)}(a.default));o.default=p,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","./WinBase":"WinBase"}],LotteryInstructionWin:[function(t,e,o){"use strict";cc._RF.push(e,"579764QhLpKUo4Z9zGcJZ+F","LotteryInstructionWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/AudioMgr"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),s.default.PlaySFX(l.AudioName.UI_TanKuang,!0)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},i([u],e)}(a.default));o.default=p,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","./WinBase":"WinBase"}],LotteryOpenWin:[function(t,e,o){"use strict";cc._RF.push(e,"ef5d57QhoJOqr22xNYq19ce","LotteryOpenWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/LotteryBox"),l=t("../../Proxy/ProxyLottery"),m=t("../../Proxy/ProxyHero"),u=t("../../Proxy/ProxyCrystal"),p=t("../../Platform/PlatformBase"),c=t("../../Manager/WinMgr"),d=t("../../Manager/UserMgr"),f=t("../../Manager/DataMgr"),h=t("../../Manager/BCMgr"),y=t("../../Manager/AudioMgr"),g=t("../../Common/EnumsDefine"),I=t("../../Common/Common"),S=cc._decorator,_=S.ccclass,v=S.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOneAnim=null,e.mTenAnim=null,e.mOnceIcon=null,e.mOncePriceLbl=null,e.mTensIcon=null,e.mTenPriceLbl=null,e.mTenRootArr=[],e.mLuckyBox=null,e.mCampBox=null,e.mBackNode=null,e.mQualitySFArr=[],e.mEfxRoot=null,e.mDoubleBtnRoot=null,e.mUpAnim=null,e.mBottomAnim=null,e.mCurLotteryType=g.LotteryType.Lucky,e.mHeroIDsArr=null,e.mHeroStateArr=null,e.mLuckyBoxArr=null,e.mCampBoxArr=null,e.mCurTimes=1,e.mCurOpenedCount=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mLuckyBoxArr=[],this.mLuckyBoxArr.push(this.mLuckyBox),this.mCampBoxArr=[],this.mCampBoxArr.push(this.mCampBox)},e.prototype.SetData=function(t,e,o){this.mCurLotteryType=t,this.mHeroIDsArr=e,this.mHeroStateArr=o,this.mCurTimes=e.length,this.mCurOpenedCount=0,this.mBackNode.active=!1,this.mDoubleBtnRoot.active=!1,this._Prepare(t,this.mCurTimes)},e.prototype._PrepareOne=function(t){var e=t[0];e.node.parent=this.mOneAnim.node,e.node.position=cc.Vec3.ZERO,e.node.scale=1.5,e.node.active||(e.node.active=!0),e.Reset(),e.SetData(this.mHeroIDsArr[0],1===this.mHeroStateArr[0],this),this.mOneAnim.node.active=!0,this.mOneAnim.play()},e.prototype._PrepareTen=function(t,e){if(1===t.length)for(var o=0;o<10;++o)if(0!==o){var n=cc.instantiate(e.node);n.parent=this.mTenRootArr[o],n.scale=1.2,n.position=cc.Vec3.ZERO,t.push(n.getComponent(s.default))}for(t[0].node.parent=this.mTenRootArr[0],t[0].node.position=cc.Vec3.ZERO,t[0].node.scale=1.2,o=0;o<10;++o)t[o].node.active||(t[o].node.active=!0),t[o].Reset(),t[o].SetData(this.mHeroIDsArr[o],1===this.mHeroStateArr[o],this);this.mTenAnim.play()},e.prototype._Prepare=function(t,e){t===g.LotteryType.Lucky?1===e?this._PrepareOne(this.mLuckyBoxArr,this.mLuckyBox):this._PrepareTen(this.mLuckyBoxArr,this.mLuckyBox):1===e?this._PrepareOne(this.mCampBoxArr,this.mCampBox):this._PrepareTen(this.mCampBoxArr,this.mCampBox)},e.prototype.OnBoxOpened=function(){this.mCurOpenedCount++,this.mCurOpenedCount>=this.mCurTimes&&this._AllOpenCompleted()},e.prototype._AllOpenCompleted=function(){this._UpdateBtn()},e.prototype.Invoke_Back=function(){y.default.PlayBtnSound(),this.CloseWin(),this._HideAllBox()},e.prototype._HideAllBox=function(){if(null!==this.mLuckyBoxArr)for(var t=0,e=this.mLuckyBoxArr.length;t<e;++t)this.mLuckyBoxArr[t].node.active&&(this.mLuckyBoxArr[t].node.active=!1);if(null!==this.mCampBoxArr)for(t=0,e=this.mCampBoxArr.length;t<e;++t)this.mCampBoxArr[t].node.active&&(this.mCampBoxArr[t].node.active=!1)},e.prototype._UpdateBtn=function(){},e.prototype.Invoke_OnceMore=function(){if(y.default.PlayBtnSound(),this.mCurLotteryType===g.LotteryType.Lucky){if(d.default.Ins.GetItemNum(g.ItemType.Crystal)<u.default.Ins.mTargetNum)return;d.default.Ins.UpdateItem(g.ItemType.Crystal,-u.default.Ins.mTargetNum);var t=l.default.Ins.LuckyLottery(1),e=m.default.Ins.GetHero(t);this.SetData(this.mCurLotteryType,t,e)}else{if(d.default.Ins.GetItemNum(g.ItemType.CampTicket)<1)return void console.log("\u9635\u8425\u62bd\u5956\u5238\u4e0d\u591f \u5f39\u7a97todo\u3002\u3002\u3002");d.default.Ins.UpdateItem(g.ItemType.CampTicket,-1),t=l.default.Ins.CampLottery(1),e=m.default.Ins.GetHero(t),this.SetData(this.mCurLotteryType,t,e)}},e.prototype.Invoke_TenMore=function(){if(y.default.PlayBtnSound(),this.mCurLotteryType===g.LotteryType.Lucky){if(d.default.Ins.GetItemNum(g.ItemType.LuckyTicket)<10)return;d.default.Ins.UpdateItem(g.ItemType.LuckyTicket,-10);var t=l.default.Ins.LuckyLottery(10),e=m.default.Ins.GetHero(t);this.SetData(this.mCurLotteryType,t,e)}else{if(d.default.Ins.GetItemNum(g.ItemType.CampTicket)<10)return void console.log("\u9635\u8425\u62bd\u5956\u5238\u4e0d\u591f \u5f39\u7a97todo\u3002\u3002\u3002");d.default.Ins.UpdateItem(g.ItemType.CampTicket,-10),t=l.default.Ins.CampLottery(10),e=m.default.Ins.GetHero(t),this.SetData(this.mCurLotteryType,t,e)}},e.prototype.Invoke_GetFragment=function(){y.default.PlayBtnSound();var t=this.mHeroIDsArr[0],e=f.default.Ins.m_DB.heroCardDB[t],o=l.default.Ins.mFragmentNumArr[e.baseQuality];c.default.Ins.Open(g.WinType.GetRewardsWin,function(e){e.SetDataSingle(t,o+"")},!1,function(){}),this.Back()},e.prototype.Invoke_DoubleFragment=function(){y.default.PlayBtnSound(),I.default.WatchADForRewards(this._FragADCallback.bind(this),p.ADUnitID.CommonVideo,g.ADPoint.DoubleHeroFragment)},e.prototype._FragADCallback=function(t){t&&d.default.Ins.GetADExtraRewards();var e=this.mHeroIDsArr[0],o=f.default.Ins.m_DB.heroCardDB[e],n=l.default.Ins.mFragmentNumArr[o.baseQuality];d.default.Ins.UpdateItem(e,n),h.default.Dispatch(g.BCType.UpdateHeroFragment,e),c.default.Ins.Open(g.WinType.GetRewardsWin,function(o){var r=o;t?r.SetDataWithADCoin(e,2*n+""):r.SetDataSingle(e,2*n+"")},!1,function(){}),d.default.Ins.Save(),m.default.Ins.CheckHeroStarAwake(e),this.Back()},e.prototype.Back=function(){this.CloseWin(),this._HideAllBox()},i([v(cc.Animation)],e.prototype,"mOneAnim",void 0),i([v(cc.Animation)],e.prototype,"mTenAnim",void 0),i([v(cc.Sprite)],e.prototype,"mOnceIcon",void 0),i([v(cc.Label)],e.prototype,"mOncePriceLbl",void 0),i([v(cc.Sprite)],e.prototype,"mTensIcon",void 0),i([v(cc.Label)],e.prototype,"mTenPriceLbl",void 0),i([v([cc.Node])],e.prototype,"mTenRootArr",void 0),i([v(s.default)],e.prototype,"mLuckyBox",void 0),i([v(s.default)],e.prototype,"mCampBox",void 0),i([v(cc.Node)],e.prototype,"mBackNode",void 0),i([v([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([v(cc.Node)],e.prototype,"mEfxRoot",void 0),i([v(cc.Node)],e.prototype,"mDoubleBtnRoot",void 0),i([v(cc.Animation)],e.prototype,"mUpAnim",void 0),i([v(cc.Animation)],e.prototype,"mBottomAnim",void 0),i([_],e)}(a.default);o.default=C,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery","../Comp/LotteryBox":"LotteryBox","./WinBase":"WinBase"}],LotteryScoreRewardWin:[function(t,e,o){"use strict";cc._RF.push(e,"4e079QYdT9Iqr53W2glFrhv","LotteryScoreRewardWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/WinMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/DataMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemSp=null,e.mQualitySp=null,e.mItemNameLbl=null,e}return r(e,t),e.prototype.SetData=function(t){var e=m.default.Ins.m_DB.itemDB[t];l.default.Ins.LoadItemSprite(t,this.mItemSp,null),l.default.Ins.LoadItemQualitySprite(e.quality,this.mQualitySp,null),this.mItemNameLbl.string=e.name,this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),u.default.PlaySFX(p.AudioName.UI_TanKuang,!0)},e.prototype.Invoke_GotoVIP=function(){u.default.PlayBtnSound(),s.default.Ins.Open(p.WinType.VipWin,null),this.CloseWin()},i([f(cc.Sprite)],e.prototype,"mItemSp",void 0),i([f(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([f(cc.Label)],e.prototype,"mItemNameLbl",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","./WinBase":"WinBase"}],LotteryWin:[function(t,e,o){"use strict";cc._RF.push(e,"0ac7bkXK9xA04a9B4qaZ5PX","LotteryWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/PictureHeroIcon"),l=t("../Comp/LuckyLottery"),m=t("../Comp/CampLottery"),u=t("../../Proxy/ProxyLottery"),p=t("../../Proxy/ProxyHero"),c=t("../../Manager/WinMgr"),d=t("../../Manager/UserMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLuckyLottery=null,e.mCampLottery=null,e.RewardPB=null,e.mProgressLbl=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&g.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._UpdateUI(),this.mLuckyLottery.OnOpen(),this.mCampLottery.OnOpen()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),f.default.Subscribe(y.BCType.Lottery_GetHero,this._OnMsg_OnLottery,this),this.mLuckyLottery.Subscribe(),this.mCampLottery.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),f.default.Remove(y.BCType.Lottery_GetHero,this._OnMsg_OnLottery,this),this.mLuckyLottery.Remove(),this.mCampLottery.Remove()},e.prototype._UpdateUI=function(){var t=d.default.Ins.ClientInfo.lottery;this.mProgressLbl.string=t.score+"/"+u.default.Ins.mLotteryBoxScore,this.RewardPB.progress=t.score/u.default.Ins.mLotteryBoxScore},e.prototype._OnMsg_OnLottery=function(){var t=d.default.Ins.ClientInfo.lottery;this.mProgressLbl.string=t.score+"/"+u.default.Ins.mLotteryBoxScore,this.RewardPB.progress=t.score/u.default.Ins.mLotteryBoxScore},e.prototype.Invoke_Back=function(){h.default.PlayBtnSound(),this.CloseWin(),d.default.Ins.ClientInfo.hasOpenedSecondDayWin||c.default.Ins.Open(y.WinType.SecondDayWin,null)},e.prototype.Invoke_Preview=function(){h.default.PlayBtnSound();var t=this;c.default.Ins.Open(y.WinType.HeroPictureWin,function(e){t.node.active=!1,e.node.parent=t.node.parent,e.node.position=cc.Vec3.ZERO,e.SetBackCallback(function(){t.node.active=!0})},!0,function(t){t.SetPreOpen(s.HeroPictureMode.Lottery)})},e.prototype.Invoke_BoxRewards=function(){if(h.default.PlayBtnSound(),d.default.Ins.ClientInfo.lottery.score<u.default.Ins.mLotteryBoxScore)c.default.Ins.Open(y.WinType.LotteryScoreRewardWin,function(t){t.SetData(u.default.Ins.mLotteryScoreRewardID)});else if(d.default.Ins.ClientInfo.vip.lv<2)c.default.Ins.ShowTips("VIP2\u81ea\u52a8\u89e3\u9501\u8be5\u798f\u5229\u54e6~");else{var t=u.default.Ins.LotteryAllByQuality(y.HeroQuality.SSR);u.default.Ins.GetLotteryScoreRewards(),1===p.default.Ins.GetHero([t])[0]?c.default.Ins.Open(y.WinType.NewHeroShowWin,function(e){e.SetData(t)}):c.default.Ins.Open(y.WinType.RepeatHeroWin,function(e){e.SetData(t)}),this._UpdateUI()}},i([_(l.default)],e.prototype,"mLuckyLottery",void 0),i([_(m.default)],e.prototype,"mCampLottery",void 0),i([_(cc.ProgressBar)],e.prototype,"RewardPB",void 0),i([_(cc.Label)],e.prototype,"mProgressLbl",void 0),i([_(cc.Node)],e.prototype,"mCloseBtn",void 0),i([_(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([S],e)}(a.default);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery","../Comp/CampLottery":"CampLottery","../Comp/LuckyLottery":"LuckyLottery","../Comp/PictureHeroIcon":"PictureHeroIcon","./WinBase":"WinBase"}],LuckyImtWin:[function(t,e,o){"use strict";cc._RF.push(e,"17bc1gAXQNApbTGO73V60gP","LuckyImtWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyVIP"),l=t("../../Proxy/ProxySmith"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Proxy/ProxyImmortal"),p=t("../../Proxy/ProxyForge"),c=t("../../Platform/PlatformBase"),d=t("../../Manager/WinMgr"),f=t("../../Manager/UserMgr"),h=t("../../Manager/ResMgr"),y=t("../../Manager/FloatItemMgr"),g=t("../../Manager/DataMgr"),I=t("../../Manager/AudioMgr"),S=t("../../Common/SwitchConfig"),_=t("../../Common/EnumsDefine"),v=t("../../Common/Common"),C=cc._decorator,M=C.ccclass,P=C.property,T=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mStarSFArr=[],e.mTagSFArr=[],e.mLhsTagSp=null,e.mLhsImtSp=null,e.mLhsStarSp=null,e.mRhsTagSp=null,e.mRhsStarSp=null,e.mRateHintLbl=null,e.mRefineSk=null,e.mHideRoot=null,e.mCancelBtnNode=null,e.mTitleSk=null,e.mUpAnim=null,e.mBottomAnim=null,e.mNextStar=1,e.mLhsID=0,e.mLhsOriPos=cc.Vec3.ZERO,e.mTargetPos=cc.Vec3.ZERO,e.mIsAD=!1,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mLhsOriPos=this.mLhsImtSp.node.position,this.mTargetPos=this.mRefineSk.node.position,this.mRefineSk.setCompleteListener(this._OnCompleteEvent.bind(this))},e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mTitleSk.setAnimation(0,"xingyunlaixi",!1),this.mUpAnim.node.scale=0,this.mBottomAnim.node.scale=0,this.scheduleOnce(function(){e.mUpAnim.play("btnAppear",0)},.3),this.scheduleOnce(function(){e.mBottomAnim.play("btnAppear",0)},1)},e.prototype.SetData=function(t){this.mLhsID=t;var e=g.default.Ins.m_DB.immortalDB[t].star;this.mLhsTagSp.spriteFrame=this.mTagSFArr[e-1],this.mLhsStarSp.spriteFrame=this.mStarSFArr[e-1],h.default.Ins.LoadItemSprite(t,this.mLhsImtSp,null),this.mLhsImtSp.node.position=this.mLhsOriPos,this.mHideRoot.active=!0,this.mCancelBtnNode.active=!0,this.mRefineSk.node.active=!1;var o=e+1;if(o>u.default.Ins.MAX_STAR&&(o=u.default.Ins.MAX_STAR),this.mNextStar=o,this.mRhsTagSp.spriteFrame=this.mTagSFArr[o-1],this.mRhsStarSp.spriteFrame=this.mStarSFArr[o-1],0===p.default.Ins.mForgeInfo.refineCount)this.mRateHintLbl.string="\u9996\u6b21\u5fc5\u5b9a\u6210\u529f";else{var n=p.default.Ins.GetLuckyRefineRate();this.mRateHintLbl.string=n+"\u6982\u7387\u6210\u529f"}},e.prototype.Invoke_GiveUp=function(){I.default.PlayBtnSound(),this.CloseWin();var t=u.default.Ins.GetImt(this.mLhsID),e=!1;if(!t&&(e=l.default.Ins.CheckDoubleImt())){var o=u.default.Ins.GetConvertMat(this.mLhsID);f.default.Ins.UpdateItem(o[0],o[1]),y.default.Ins.ShowItem(o[0],m.default.FormatNumber(o[1],1))}var n=this;d.default.Ins.Open(_.WinType.GetImtWin,function(o){o.SetData(n.mLhsID,t,e)})},e.prototype.Invoke_ChangeImt=function(){I.default.PlayBtnSound(),v.default.WatchADForRewards(this._ADCallback.bind(this),c.ADUnitID.CommonVideo,_.ADPoint.LuckyImtRefine)},e.prototype._ADCallback=function(t){var e=this;this.mIsAD=t,this.mHideRoot.active=!1,this.mCancelBtnNode.active=!1;var o=this.mTargetPos.add(cc.v3(0,50,0));cc.tween(this.mLhsImtSp.node).to(.3,{position:o}).call(function(){e.mRefineSk.node.active=!0,e.mRefineSk.setAnimation(0,"animation",!1)}).start(),t&&f.default.Ins.GetADExtraRewards()},e.prototype._OnCompleteEvent=function(){if(p.default.Ins.LuckyRefine()){var t=p.default.Ins.GetLuckyImtByStar(this.mNextStar),e=u.default.Ins.GetImt(t),o=!1;if(!e&&(o=l.default.Ins.CheckDoubleImt())){var n=u.default.Ins.GetConvertMat(t);f.default.Ins.UpdateItem(n[0],n[1]),y.default.Ins.ShowItem(n[0],m.default.FormatNumber(n[1],1))}d.default.Ins.Open(_.WinType.GetImtWin,function(n){n.SetData(t,e,o)})}else{var r=this;n=u.default.Ins.GetConvertMat(this.mLhsID),f.default.Ins.UpdateItem(n[0],n[1]),y.default.Ins.ShowItem(n[0],m.default.FormatNumber(n[1],1)),d.default.Ins.Open(_.WinType.ImtRefineFailWin,function(t){t.SetData(r.mLhsID)})}this.CloseWin(),this.mIsAD&&((!S.default.mNeedLimitADCoin||f.default.Ins.ClientInfo.todayADCoinFromAD<=S.default.mADCoinLimitNum)&&y.default.Ins.ShowItem(_.ItemType.ADCoin,"1"),y.default.Ins.ShowItem(_.ItemType.VIPExp,s.default.Ins.mOnceADExp+""))},i([P([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([P([cc.SpriteFrame])],e.prototype,"mTagSFArr",void 0),i([P(cc.Sprite)],e.prototype,"mLhsTagSp",void 0),i([P(cc.Sprite)],e.prototype,"mLhsImtSp",void 0),i([P(cc.Sprite)],e.prototype,"mLhsStarSp",void 0),i([P(cc.Sprite)],e.prototype,"mRhsTagSp",void 0),i([P(cc.Sprite)],e.prototype,"mRhsStarSp",void 0),i([P(cc.Label)],e.prototype,"mRateHintLbl",void 0),i([P(sp.Skeleton)],e.prototype,"mRefineSk",void 0),i([P(cc.Node)],e.prototype,"mHideRoot",void 0),i([P(cc.Node)],e.prototype,"mCancelBtnNode",void 0),i([P(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([P(cc.Animation)],e.prototype,"mUpAnim",void 0),i([P(cc.Animation)],e.prototype,"mBottomAnim",void 0),i([M],e)}(a.default);o.default=T,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/FloatItemMgr":"FloatItemMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySmith":"ProxySmith","../../Proxy/ProxyVIP":"ProxyVIP","./WinBase":"WinBase"}],LuckyLottery:[function(t,e,o){"use strict";cc._RF.push(e,"1f4f0nha3ZLCIuoF0q8TM4U","LuckyLottery");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyLottery"),s=t("../../Proxy/ProxyHero"),l=t("../../Proxy/ProxyCrystal"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/ResMgr"),c=t("../../Manager/RedPointMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSk=null,e.mPb=null,e.mNumLbl=null,e.mFullSk=null,e.mTimesLbl=null,e.mTiming=2,e.mEnable=!0,e.mLastCrystalNum=0,e}return r(e,t),e.prototype.update=function(t){this.mEnable&&(this.mTiming-=t,this.mTiming<=0&&(this.mTiming=y.default.GetRandValueBetween(5,8),this._PlayAnim()))},e.prototype._PlayAnim=function(){this.mSk.setAnimation(0,"daiji_"+y.default.GetRandIntValueBetween(1,4,!0),!1)},e.prototype.OnOpen=function(){this._UpdateCostUI(),this.mLastCrystalNum=u.default.Ins.mCrystal,this.mLastCrystalNum>=l.default.Ins.mTargetNum?this._SetFullAnimState(!0):this._SetFullAnimState(!1),this.mTimesLbl.string=c.default.GetRedPointNode(c.RedPointType.MainLotteryBox_Crystal).mPointNum+""},e.prototype.Subscribe=function(){d.default.Subscribe(h.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this),d.default.Subscribe(h.BCType.Lottery_GetHero,this._OnMsg_OnLotteryCompleted,this),d.default.Subscribe(h.BCType.Lottery_UpdateCrystalState,this._OnMsg_UpdateState,this),d.default.Subscribe(c.RedPointType.MainLotteryBox_Crystal,this._OnMsg_UpdateCrystalDrawTimes,this)},e.prototype.Remove=function(){d.default.Remove(h.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this),d.default.Remove(h.BCType.Lottery_GetHero,this._OnMsg_OnLotteryCompleted,this),d.default.Remove(h.BCType.Lottery_UpdateCrystalState,this._OnMsg_UpdateState,this),d.default.Remove(c.RedPointType.MainLotteryBox_Crystal,this._OnMsg_UpdateCrystalDrawTimes,this)},e.prototype._SetFullAnimState=function(t){if(null===this.mFullSk.skeletonData){var e=this;t&&p.default.Ins.LoadSpine("spine/manghejindu",function(t){e.mFullSk.skeletonData=t,e.mFullSk.setAnimation(0,"animation",!0)})}else this.mFullSk.node.active=t},e.prototype._UpdateCostUI=function(){var t=u.default.Ins.mCrystal;this.mNumLbl.string=Math.round(t)+"",this.mPb.progress=t/l.default.Ins.mTargetNum,this.mLastCrystalNum<l.default.Ins.mTargetNum&&t>=l.default.Ins.mTargetNum?this._SetFullAnimState(!0):this.mLastCrystalNum>=l.default.Ins.mTargetNum&&t<l.default.Ins.mTargetNum&&this._SetFullAnimState(!1),this.mLastCrystalNum=t},e.prototype._OnMsg_UpdateItem=function(t){t===h.ItemType.Crystal&&this._UpdateCostUI()},e.prototype._OnMsg_UpdateCrystalDrawTimes=function(){this.mTimesLbl.string=c.default.GetRedPointNode(c.RedPointType.MainLotteryBox_Crystal).mPointNum+""},e.prototype._OnMsg_OnLotteryCompleted=function(){},e.prototype._OnMsg_UpdateState=function(){this.mLastCrystalNum=u.default.Ins.mCrystal,this.mLastCrystalNum>=l.default.Ins.mTargetNum?this._SetFullAnimState(!0):this._SetFullAnimState(!1),this.mTimesLbl.string=c.default.GetRedPointNode(c.RedPointType.MainLotteryBox_Crystal).mPointNum+""},e.prototype.Invoke_Instruction=function(){f.default.PlayBtnSound(),m.default.Ins.Open(h.WinType.LotteryInstructionWin,null)},e.prototype.Invoke_One=function(){if(f.default.PlayBtnSound(),u.default.Ins.mCrystal<l.default.Ins.mTargetNum)m.default.Ins.ShowTips("\u6c34\u6676\u77f3\u4e0d\u8db3\uff0c\u4e3b\u516c\u52a0\u6cb9\u63a8\u5173\u54e6\uff0c\u63a8\u5173\u53ef\u83b7\u5f97\u5927\u91cf\u6c34\u6676\u77f3\uff01");else{u.default.Ins.UpdateItem(h.ItemType.Crystal,-l.default.Ins.mTargetNum),u.default.Ins.SaveCrystal();var t=a.default.Ins.LuckyLottery(1),e=s.default.Ins.GetHero(t);m.default.Ins.Open(h.WinType.LotteryOpenWin,function(o){o.SetData(h.LotteryType.Lucky,t,e)}),this._UpdateCostUI()}},i([S(sp.Skeleton)],e.prototype,"mSk",void 0),i([S(cc.ProgressBar)],e.prototype,"mPb",void 0),i([S(cc.Label)],e.prototype,"mNumLbl",void 0),i([S(sp.Skeleton)],e.prototype,"mFullSk",void 0),i([S(cc.Label)],e.prototype,"mTimesLbl",void 0),i([I],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/RedPointMgr":"RedPointMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery"}],MainBackPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5ba3fgnnjNCnKPUE3Oh25gD","MainBackPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./OfflineLevelPanel"),s=t("./ItemDetailPanel"),l=t("./FuncHintPanel"),m=t("./CounterPanel"),u=t("../../Proxy/ProxyOffline"),p=t("../../Proxy/ProxyLevelReward"),c=t("../../Proxy/ProxyLargeNum"),d=t("../../Manager/WinMgr"),f=t("../../Manager/UserMgr"),h=t("../../Manager/PoolMgr"),y=t("../../Manager/BCMgr"),g=t("../../Manager/AudioMgr"),I=t("../../Common/EnumsDefine"),S=t("../../Common/Common"),_=cc._decorator,v=_.ccclass,C=_.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mGoldLbl=null,e.mCoinLbl=null,e.mMedalLbl=null,e.mAdCoinLbl=null,e.mSkinFragLbl=null,e.mSkinFragIcon=null,e.blinBlinEfx=null,e.mCoinNode=null,e.mTargetLevelLbl=null,e.mLevelGoldLbl=null,e.mOfflineLevelLbl=null,e.mOfflineLevelPanel=null,e.mCounterPanel=null,e.mFunHintPanel=null,e.mCoinRoot1=null,e.mCoinRoot2=null,e.mFC1Lbl=null,e.mFC2Lbl=null,e.mFC3Lbl=null,e.mFC4Lbl=null,e.mXinDeLbl=null,e.mGoldNode=null,e.mMedalNode=null,e.mADCoinNode=null,e.mFC1Node=null,e.mFC2Node=null,e.mFC3Node=null,e.mFC4Node=null,e.mXinDeNode=null,e.mItemDetailPanel=null,e.mTargetCoinPos=null,e.mCurHighestReachableLevel=0,e.mIsAdded=!1,e}return r(e,t),e.prototype.OnFirstOpen=function(){var t=this;this.mGoldLbl.string=""+f.default.Ins.GetItemNum(I.ItemType.Gold),this.mCoinLbl.string=""+f.default.Ins.mCoin.ToString(),this.mMedalLbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.Medal),1),this.mAdCoinLbl.string=""+f.default.Ins.GetItemNum(I.ItemType.ADCoin),this.mSkinFragLbl.string=""+f.default.Ins.GetItemNum(I.ItemType.SkinFrag),this.mCoinRoot2.active=!1,this.mFC1Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat),1),this.mFC2Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+1),1),this.mFC3Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+2),1),this.mFC4Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+3),1),this.mXinDeLbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ForgeExp),1),this.scheduleOnce(function(){var e=t.mCoinNode.parent.convertToWorldSpaceAR(t.mCoinNode.position);t.mTargetCoinPos=d.default.Ins.TopRoot.convertToNodeSpaceAR(e)},0),this._UpdateTargetLevel(),this.mLevelGoldLbl.string="x"+p.default.Ins.GetLevelRewardNum(),this.mCurHighestReachableLevel=u.default.Ins.GetHighestReachLevelByAllHero(),this.mOfflineLevelLbl.string=this.mCurHighestReachableLevel+"",this.mOfflineLevelPanel.node.active=!1,this.mCounterPanel.node.active=!1,this.mFunHintPanel.SetData(f.default.Ins.ClientInfo.bestLevel),this._RegisterItemHint(this.mGoldNode,I.ItemType.Gold),this._RegisterItemHint(this.mMedalNode,I.ItemType.Medal),this._RegisterItemHint(this.mADCoinNode,I.ItemType.ADCoin),this._RegisterItemHint(this.mCoinNode,I.ItemType.Coin),this._RegisterItemHint(this.mSkinFragIcon,I.ItemType.SkinFrag),this._RegisterItemHint(this.mFC1Node,I.ItemType.ImtForgeMat),this._RegisterItemHint(this.mFC2Node,I.ItemType.ImtForgeMat+1),this._RegisterItemHint(this.mFC3Node,I.ItemType.ImtForgeMat+2),this._RegisterItemHint(this.mFC4Node,I.ItemType.ImtForgeMat+3),this._RegisterItemHint(this.mXinDeNode,I.ItemType.ForgeExp)},e.prototype.ResetCoinPos=function(){var t=this.mCoinNode.parent.convertToWorldSpaceAR(this.mCoinNode.position);this.mTargetCoinPos=d.default.Ins.TopRoot.convertToNodeSpaceAR(t)},e.prototype._RegisterItemHint=function(t,e){var o=this;t.on(cc.Node.EventType.TOUCH_START,function(t){o._TouchStartEvent(t,e)},this),t.on(cc.Node.EventType.TOUCH_END,this._TouchEnd,this),t.on(cc.Node.EventType.TOUCH_CANCEL,this._TouchCancel,this)},e.prototype._TouchStartEvent=function(t,e){this._OnMsg_OnItemTouchStart(e,t.getLocation())},e.prototype._TouchEnd=function(){this._OnMsg_OnItemTouchEnd()},e.prototype._TouchCancel=function(){this._OnMsg_OnItemTouchCancel()},e.prototype.Subscribe=function(){this.mIsAdded||(this.mIsAdded=!0,y.default.Subscribe(I.BCType.Common_ChangeCoin,this._OnMsg_UpdateCoinUI,this),y.default.Subscribe(I.BCType.Common_UpdateItem,this._OnMsg_UpdateGoldUI,this),y.default.Subscribe(I.BCType.MainWin_FlyCoin,this._OnMsg_FlyToCoin,this)),y.default.Subscribe(I.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this),y.default.Subscribe(I.BCType.LevelReward_UnlockLuxury,this._OnMsg_UnlockLevelLuxury,this),y.default.Subscribe(I.BCType.Offline_UpdateHighestLevelID,this._OnMsg_UpdateHighestLevel,this),y.default.Subscribe(I.BCType.MainWin_ChangeCoinType,this._OnMsg_ChangeCoinType,this)},e.prototype.Remove=function(){y.default.Remove(I.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this),y.default.Remove(I.BCType.LevelReward_UnlockLuxury,this._OnMsg_UnlockLevelLuxury,this),y.default.Remove(I.BCType.Offline_UpdateHighestLevelID,this._OnMsg_UpdateHighestLevel,this),y.default.Remove(I.BCType.MainWin_ChangeCoinType,this._OnMsg_ChangeCoinType,this)},e.prototype._UpdateTargetLevel=function(){this.mTargetLevelLbl.string="\u76ee\u6807\uff1a\u901a\u8fc7\u7b2c"+p.default.Ins.GetTargetLevelID()+"\u5173"},e.prototype._OnMsg_UpdateCoinUI=function(){this.mCoinLbl.string=f.default.Ins.mCoin.ToString()},e.prototype._OnMsg_UpdateGoldUI=function(t){switch(t){case I.ItemType.Gold:this.mGoldLbl.string=f.default.Ins.GetItemNum(I.ItemType.Gold)+"";break;case I.ItemType.Medal:this.mMedalLbl.string=c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.Medal),1);break;case I.ItemType.ADCoin:this.mAdCoinLbl.string=f.default.Ins.GetItemNum(I.ItemType.ADCoin)+"";break;case I.ItemType.SkinFrag:this.mSkinFragLbl.string=""+f.default.Ins.GetItemNum(I.ItemType.SkinFrag);break;case I.ItemType.ImtForgeMat:this.mFC1Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat),1);break;case I.ItemType.ImtForgeMat+1:this.mFC2Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+1),1);break;case I.ItemType.ImtForgeMat+2:this.mFC3Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+2),1);break;case I.ItemType.ImtForgeMat+3:this.mFC4Lbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ImtForgeMat+3),1);break;case I.ItemType.ForgeExp:this.mXinDeLbl.string=""+c.default.FormatNumber(f.default.Ins.GetItemNum(I.ItemType.ForgeExp),1)}},e.prototype._OnMsg_FlyToCoin=function(t){var e=this,o=cc.tween,n=t.node.position,r=Math.abs(e.mTargetCoinPos.x-n.x),i=e.mTargetCoinPos.y-n.y,a=.5*(e.mTargetCoinPos.x+n.x)+.5*r*S.default.GetRandValueBetween(-3,3),s=.5*(a+e.mTargetCoinPos.x),l=n.y+.4*i,m=n.y+1.1*i,u=cc.v2(a,l),p=cc.v2(s,m);o(t.node).parallel(o().bezierTo(.3,u,p,cc.v2(e.mTargetCoinPos)),o().to(.3,{scale:1})).call(function(){null===t.mCoinNum||t.mIsObselete||(f.default.Ins.AddCoin(t.mCoinNum),h.default.Ins.Borrow(h.default.FLOAT_NUM,"FloatNum",function(o){var n=o;n.node.setParent(e.mCoinNode),n.node.position=cc.v3(50,40),null!==t&&null!==t.mCoinNum?n.SetData(t.mCoinNum.ToString(1)):n.SetData(""),n.Trigger()})),e.blinBlinEfx.setAnimation(0,"animation",!1),g.default.PlaySFX(I.AudioName.UI_FlyCoin,!0),h.default.Ins.Return(t)}).start()},e.prototype._OnMsg_PassBestLevel=function(){this._UpdateTargetLevel(),this.mFunHintPanel.SetData(f.default.Ins.ClientInfo.bestLevel)},e.prototype._OnMsg_UnlockLevelLuxury=function(){this.mLevelGoldLbl.string="x"+p.default.Ins.GetLevelRewardNum()},e.prototype._OnMsg_UpdateHighestLevel=function(t){this.mCurHighestReachableLevel=t,this.mOfflineLevelLbl.string=""+t},e.prototype._OnMsg_ChangeCoinType=function(t){switch(t){case I.CoinType.Common:this.mCoinRoot1.active=!0,this.mCoinRoot2.active=!1,this.mSkinFragLbl.node.opacity=0,this.mSkinFragIcon.active=!1;break;case I.CoinType.Shop:this.mCoinRoot1.active=!0,this.mCoinRoot2.active=!1,this.mSkinFragLbl.node.opacity=255,this.mSkinFragIcon.active=!0;break;case I.CoinType.ForgeMat:this.mCoinRoot1.active=!1,this.mCoinRoot2.active=!0}},e.prototype._OnMsg_OnItemTouchStart=function(t,e){this.mItemDetailPanel.SetData(t),this.mItemDetailPanel.node.opacity=255;var o=this.mItemDetailPanel.node.parent.convertToNodeSpaceAR(e);this.mItemDetailPanel.node.position=o.add(cc.v3(0,100,0));var n=.5*this.mItemDetailPanel.node.width,r=.5*-S.default.DESIGN_WIDTH+n,i=.5*S.default.DESIGN_WIDTH-n;this.mItemDetailPanel.node.x=S.default.Clamp(this.mItemDetailPanel.node.x,r,i)},e.prototype._OnMsg_OnItemTouchEnd=function(){this.mItemDetailPanel.node.opacity=0},e.prototype._OnMsg_OnItemTouchCancel=function(){this.mItemDetailPanel.node.opacity=0},e.prototype.Invoke_OpenLevelRewardWin=function(){g.default.PlayBtnSound(),d.default.Ins.Open(I.WinType.LevelRewardWin,null)},e.prototype.Invoke_OpenOfflineDetailPanel=function(){g.default.PlayBtnSound(),this.mOfflineLevelPanel.Open(this.mCurHighestReachableLevel)},e.prototype.Invoke_CounterDetail=function(){g.default.PlayBtnSound(),this.mCounterPanel.Open()},i([C(cc.Label)],e.prototype,"mGoldLbl",void 0),i([C(cc.Label)],e.prototype,"mCoinLbl",void 0),i([C(cc.Label)],e.prototype,"mMedalLbl",void 0),i([C(cc.Label)],e.prototype,"mAdCoinLbl",void 0),i([C(cc.Label)],e.prototype,"mSkinFragLbl",void 0),i([C(cc.Node)],e.prototype,"mSkinFragIcon",void 0),i([C(sp.Skeleton)],e.prototype,"blinBlinEfx",void 0),i([C(cc.Node)],e.prototype,"mCoinNode",void 0),i([C(cc.Label)],e.prototype,"mTargetLevelLbl",void 0),i([C(cc.Label)],e.prototype,"mLevelGoldLbl",void 0),i([C(cc.Label)],e.prototype,"mOfflineLevelLbl",void 0),i([C(a.default)],e.prototype,"mOfflineLevelPanel",void 0),i([C(m.default)],e.prototype,"mCounterPanel",void 0),i([C(l.default)],e.prototype,"mFunHintPanel",void 0),i([C(cc.Node)],e.prototype,"mCoinRoot1",void 0),i([C(cc.Node)],e.prototype,"mCoinRoot2",void 0),i([C(cc.Label)],e.prototype,"mFC1Lbl",void 0),i([C(cc.Label)],e.prototype,"mFC2Lbl",void 0),i([C(cc.Label)],e.prototype,"mFC3Lbl",void 0),i([C(cc.Label)],e.prototype,"mFC4Lbl",void 0),i([C(cc.Label)],e.prototype,"mXinDeLbl",void 0),i([C(cc.Node)],e.prototype,"mGoldNode",void 0),i([C(cc.Node)],e.prototype,"mMedalNode",void 0),i([C(cc.Node)],e.prototype,"mADCoinNode",void 0),i([C(cc.Node)],e.prototype,"mFC1Node",void 0),i([C(cc.Node)],e.prototype,"mFC2Node",void 0),i([C(cc.Node)],e.prototype,"mFC3Node",void 0),i([C(cc.Node)],e.prototype,"mFC4Node",void 0),i([C(cc.Node)],e.prototype,"mXinDeNode",void 0),i([C(s.default)],e.prototype,"mItemDetailPanel",void 0),i([v],e)}(cc.Component);o.default=M,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyLevelReward":"ProxyLevelReward","../../Proxy/ProxyOffline":"ProxyOffline","./CounterPanel":"CounterPanel","./FuncHintPanel":"FuncHintPanel","./ItemDetailPanel":"ItemDetailPanel","./OfflineLevelPanel":"OfflineLevelPanel"}],MainGame:[function(t,e,o){"use strict";cc._RF.push(e,"db389MoXRRPBrLeFRZbzm+R","MainGame");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./UI/Comp/MyToggleGroup"),s=t("./Proxy/ProxyWork"),l=t("./Proxy/ProxySpeed"),m=t("./Manager/UserMgr"),u=t("./Manager/TimeMgr"),p=t("./Manager/ShakeMgr"),c=t("./Manager/GuideMgr"),d=t("./Manager/GuideListener"),f=t("./Manager/FuncMgr"),h=t("./Manager/FloatItemMgr"),y=t("./Manager/FightMgr"),g=t("./Common/Common"),I=t("./Battle/BattleCamera"),S=cc._decorator,_=S.ccclass,v=S.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBattleCam=null,e.grayMat=null,e.defaultMat=null,e.mCounterSFArr=[],e.mCampSFArr=[],e.mBattleFloatArr=[],e.mBuffIconArr=[],e.mStarSFArr=[],e.mGlobalInputMask=null,e}var o;return r(e,t),o=e,e.prototype.onLoad=function(){g.default.ScreenWidth=cc.winSize.width,g.default.ScreenHeight=cc.winSize.height,o.mGrayMat=this.grayMat,o.mDefaultMat=this.defaultMat,o.mCounterSFArr=this.mCounterSFArr,o.mCampSFArr=this.mCampSFArr,o.mBattleFloatArr=this.mBattleFloatArr,o.mBuffIconArr=this.mBuffIconArr,o.mStarSFArr=this.mStarSFArr,o.mGlobalMask=this.mGlobalInputMask,f.default.Init(),a.default.StaticInit(),d.default.Init(),h.default.Ins.Init(),o.mBattleCam=this.mBattleCam},e.prototype.update=function(t){o.mFrameCount++,m.default.Ins.OnUpdate(),u.default.OnUpdate(t),y.default.Ins.OnUpdate(t*l.default.Ins.mSpeedFactor),p.default.OnUpdate(t*l.default.Ins.mSpeedFactor),h.default.Ins.OnUpdate(t),this.mBattleCam.OnUpdate(t),s.default.Ins.UpdateForWorking(t),c.default.OnUpdate(t)},e.mFrameCount=0,e.mBattleCam=null,e.mGrayMat=null,e.mDefaultMat=null,e.mCounterSFArr=[],e.mCampSFArr=[],e.mBattleFloatArr=[],e.mBuffIconArr=[],e.mStarSFArr=[],e.mGlobalMask=null,i([v(I.default)],e.prototype,"mBattleCam",void 0),i([v(cc.Material)],e.prototype,"grayMat",void 0),i([v(cc.Material)],e.prototype,"defaultMat",void 0),i([v([cc.SpriteFrame])],e.prototype,"mCounterSFArr",void 0),i([v([cc.SpriteFrame])],e.prototype,"mCampSFArr",void 0),i([v([cc.SpriteFrame])],e.prototype,"mBattleFloatArr",void 0),i([v([cc.SpriteFrame])],e.prototype,"mBuffIconArr",void 0),i([v([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([v(cc.Node)],e.prototype,"mGlobalInputMask",void 0),o=i([_],e)}(cc.Component);o.default=C,cc._RF.pop()},{"./Battle/BattleCamera":"BattleCamera","./Common/Common":"Common","./Manager/FightMgr":"FightMgr","./Manager/FloatItemMgr":"FloatItemMgr","./Manager/FuncMgr":"FuncMgr","./Manager/GuideListener":"GuideListener","./Manager/GuideMgr":"GuideMgr","./Manager/ShakeMgr":"ShakeMgr","./Manager/TimeMgr":"TimeMgr","./Manager/UserMgr":"UserMgr","./Proxy/ProxySpeed":"ProxySpeed","./Proxy/ProxyWork":"ProxyWork","./UI/Comp/MyToggleGroup":"MyToggleGroup"}],MainLotteryBox:[function(t,e,o){"use strict";cc._RF.push(e,"61bdaJTRoJN1pMlqXwp8SET","MainLotteryBox");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyCrystal"),s=t("../../Manager/WinMgr"),l=t("../../Manager/UserMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/RedPointMgr"),p=t("../../Manager/PoolMgr"),c=t("../../Manager/FuncMgr"),d=t("../../Manager/BCMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCrystalNumLbl=null,e.mCrystalIconNode=null,e.mPb=null,e.mFullSk=null,e.mTotalTimesLbl=null,e.mLockRoot=null,e.mTargetPos=cc.Vec3.ZERO,e.mLastCrystalNum=0,e.mIsAdded=!1,e.mLastCanDrawTimes=0,e.mIconTween=null,e}return r(e,t),e.prototype.OnFirstOpen=function(){var t=this;this.mLastCrystalNum=l.default.Ins.mCrystal,this.mCrystalNumLbl.string=Math.round(this.mLastCrystalNum)+"",this.mPb.progress=this.mLastCrystalNum/a.default.Ins.mTargetNum,this.scheduleOnce(function(){var e=t.mCrystalIconNode.parent.convertToWorldSpaceAR(t.mCrystalIconNode.position);t.mTargetPos=s.default.Ins.TopRoot.convertToNodeSpaceAR(e)},0),this.mLastCrystalNum>=a.default.Ins.mTargetNum&&this._SetFullAnimState(!0),this.mTotalTimesLbl.string=u.default.GetRedPointNode(u.RedPointType.MainLotteryBox).mPointNum+"",this.mLockRoot.active=!c.default.IsUnlock(c.FuncType.LotteryBox,!1)},e.prototype.Subscribe=function(){this.mIsAdded||(this.mIsAdded=!0,d.default.Subscribe(f.BCType.MainWin_FlyCrystal,this._OnMsg_GetFlyCrystal,this),d.default.Subscribe(f.BCType.Common_UpdateItem,this._OnMsg_UpdateItem,this),d.default.Subscribe(f.BCType.Lottery_UpdateCrystalState,this._OnMsg_UpdateState,this),d.default.Subscribe(f.BCType.Lottery_OnDrawCrystal,this._OnMsg_UpdateRedPointNum,this))},e.prototype.Remove=function(){},e.prototype.UpdateLockState=function(){this.mLockRoot.active=!c.default.IsUnlock(c.FuncType.LotteryBox,!1)},e.prototype._SetFullAnimState=function(t){if(null===this.mFullSk.skeletonData){var e=this;t&&m.default.Ins.LoadSpine("spine/manghejindu",function(t){e.mFullSk.skeletonData=t,e.mFullSk.setAnimation(0,"animation",!0)})}else this.mFullSk.node.active=t},e.prototype._OnMsg_UpdateItem=function(t){if(t===f.ItemType.Crystal){var e=l.default.Ins.mCrystal;this.mCrystalNumLbl.string=Math.round(e)+"",this.mPb.progress=e/a.default.Ins.mTargetNum,this.mLastCrystalNum<a.default.Ins.mTargetNum&&e>=a.default.Ins.mTargetNum?this._SetFullAnimState(!0):this.mLastCrystalNum>=a.default.Ins.mTargetNum&&e<a.default.Ins.mTargetNum&&this._SetFullAnimState(!1);var o=a.default.Ins.GetCanLotteryTimes();o!==this.mLastCanDrawTimes&&(u.default.SetInvokeData(u.RedPointType.MainLotteryBox_Crystal,o),this.mTotalTimesLbl.string=u.default.GetRedPointNode(u.RedPointType.MainLotteryBox).mPointNum+"",this.mLastCanDrawTimes=o),this.mLastCrystalNum=e}else t===f.ItemType.CampTicket&&(u.default.SetInvokeData(u.RedPointType.MainLotteryBox_Ticket,l.default.Ins.GetItemNum(f.ItemType.CampTicket)),this.mTotalTimesLbl.string=u.default.GetRedPointNode(u.RedPointType.MainLotteryBox).mPointNum+"")},e.prototype._OnMsg_GetFlyCrystal=function(t){var e=this,o=cc.tween,n=t.node.position,r=Math.abs(e.mTargetPos.x-n.x),i=e.mTargetPos.y-n.y,a=.5*(e.mTargetPos.x+n.x)+.5*r*h.default.GetRandValueBetween(-5,-3),s=.5*(a+e.mTargetPos.x),m=n.y+.4*i,u=n.y+1.1*i,c=cc.v2(a,m),d=cc.v2(s,u);o(t.node).parallel(o().bezierTo(.5,c,d,cc.v2(e.mTargetPos)),o().to(.4,{scale:1})).call(function(){null!==t.mCrystalNum&&(l.default.Ins.UpdateItem(f.ItemType.Crystal,t.mCrystalNum),null!==t.mCallback&&t.mCallback(),e.mCrystalIconNode.scale=1,null!==e.mIconTween&&e.mIconTween.stop(),e.mIconTween=o(e.mCrystalIconNode).to(.15,{scale:1.5}).to(.05,{scale:1}).start()),p.default.Ins.Return(t)}).start()},e.prototype._OnMsg_UpdateState=function(){var t=l.default.Ins.mCrystal;t>=a.default.Ins.mTargetNum?this._SetFullAnimState(!0):t<a.default.Ins.mTargetNum&&this._SetFullAnimState(!1),this.mPb.progress=t/a.default.Ins.mTargetNum},e.prototype._OnMsg_UpdateRedPointNum=function(){this.mTotalTimesLbl.string=u.default.GetRedPointNode(u.RedPointType.MainLotteryBox).mPointNum+""},i([I(cc.Label)],e.prototype,"mCrystalNumLbl",void 0),i([I(cc.Node)],e.prototype,"mCrystalIconNode",void 0),i([I(cc.ProgressBar)],e.prototype,"mPb",void 0),i([I(sp.Skeleton)],e.prototype,"mFullSk",void 0),i([I(cc.Label)],e.prototype,"mTotalTimesLbl",void 0),i([I(cc.Node)],e.prototype,"mLockRoot",void 0),i([g],e)}(cc.Component);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/RedPointMgr":"RedPointMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyCrystal":"ProxyCrystal"}],MainSidePanel:[function(t,e,o){"use strict";cc._RF.push(e,"e2facpQ5oBM4IUkvyetBW9P","MainSidePanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMaskNode=null,e.mMoveRoot=null,e.mMoreBtnNode=null,e.mMoveState=4,e}return r(e,t),e.prototype.Init=function(){this.mMaskNode.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask,this),this.node.active=!1},e.prototype._OnEvent_ClickMask=function(){this.Hide()},e.prototype.Show=function(){var t=this;t.node.active=!0,this.mMoveState=1,cc.tween(this.mMoreBtnNode).to(.15,{position:cc.v3(108,0,0)}).start(),cc.tween(this.mMoveRoot).to(.15,{position:cc.v3(108,0,0)}).call(function(){t.mMaskNode.active=!0,t.mMoveState=2}).start()},e.prototype.Hide=function(){var t=this;this.mMaskNode.active=!1,t.mMoveState=3,cc.tween(this.mMoreBtnNode).to(.15,{position:cc.v3(0,0,0)}).start(),cc.tween(this.mMoveRoot).to(.15,{position:cc.v3(0,0,0)}).call(function(){t.node.active=!1,t.mMoveState=4}).start()},i([l(cc.Node)],e.prototype,"mMaskNode",void 0),i([l(cc.Node)],e.prototype,"mMoveRoot",void 0),i([l(cc.Node)],e.prototype,"mMoreBtnNode",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],MainTaskFingerData:[function(t,e,o){"use strict";cc._RF.push(e,"d9ebbQ7xFZHR7SeEYJTAmQy","MainTaskFingerData"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./MainTaskGuideMgr"),r=t("./BCMgr"),i=function(){function t(){this.mNodeName="",this.mNodeFullName="",this.mPointNum=0,this.mParentNode=null,this.mNumChangeFunc=null,this.mChildNodeMap=new Map}return t.prototype.SetRedPointNum=function(t){this.mChildNodeMap.size>0?console.error("\u53ea\u80fd\u8bbe\u7f6e\u53f6\u5b50\u8282\u70b9"):(this.mPointNum=t,this.NotifyPointNumChange(),null!==this.mParentNode&&this.mParentNode.ChangeParentRPNum())},t.prototype.NotifyPointNumChange=function(){r.default.Dispatch(n.default.BCMsgTag+this.mNodeFullName,this)},t.prototype.ChangeParentRPNum=function(){var t=0;this.mChildNodeMap.forEach(function(e){t+=e.mPointNum}),t!==this.mPointNum&&(this.mPointNum=t,this.NotifyPointNumChange()),null!==this.mParentNode&&this.mParentNode.ChangeParentRPNum()},t}();o.default=i,cc._RF.pop()},{"./BCMgr":"BCMgr","./MainTaskGuideMgr":"MainTaskGuideMgr"}],MainTaskGuideFinger:[function(t,e,o){"use strict";cc._RF.push(e,"ad02dXbwWVJ64P5/P2LZjLc","MainTaskGuideFinger");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=t("../../Manager/RedPointMgr"),l=t("../../Manager/MainTaskGuideMgr"),m=t("../../Manager/BCMgr"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPointType="",e.mGuideFinger=null,e}return r(e,t),e.prototype.onEnable=function(){this.mPointType&&(m.default.Subscribe(l.default.BCMsgTag+this.mPointType,this._OnMsg_UpdateRedPoint,this),s.default.mInited&&this._OnMsg_UpdateRedPoint(l.default.GetRedPointNode(this.mPointType)))},e.prototype.onDisable=function(){this.mPointType&&m.default.Remove(l.default.BCMsgTag+this.mPointType,this._OnMsg_UpdateRedPoint,this)},e.prototype.UpdatePointName=function(t){this.mPointType&&m.default.Remove(l.default.BCMsgTag+this.mPointType,this._OnMsg_UpdateRedPoint,this),this.mPointType=t,this._OnMsg_UpdateRedPoint(l.default.GetRedPointNode(this.mPointType)),m.default.Subscribe(l.default.BCMsgTag+t,this._OnMsg_UpdateRedPoint,this)},e.prototype._OnMsg_UpdateRedPoint=function(t){if(this.mGuideFinger){var e=!!t&&0!==t.mPointNum;if(e){var o=this;null===this.mGuideFinger.skeletonData&&a.default.Ins.LoadSpine("spine/skeleton",function(t){o.mGuideFinger.skeletonData=t,o.mGuideFinger.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),o.mGuideFinger.setAnimation(0,"animation",!0)})}this.mGuideFinger.node.active=e}else console.error("\u4e3b\u7ebf\u4efb\u52a1\u5f15\u5bfc\u4e3a\u7a7a: "+this.mPointType)},i([c(cc.String)],e.prototype,"mPointType",void 0),i([c(sp.Skeleton)],e.prototype,"mGuideFinger",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Manager/BCMgr":"BCMgr","../../Manager/MainTaskGuideMgr":"MainTaskGuideMgr","../../Manager/RedPointMgr":"RedPointMgr","../../Manager/ResMgr":"ResMgr"}],MainTaskGuideMgr:[function(t,e,o){"use strict";cc._RF.push(e,"bea6aTaD0VDvZdnOzUGQe3M","MainTaskGuideMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.MainTaskGuideType=void 0;var n,r=t("./MainTaskFingerData"),i=t("../Proxy/ProxyWork"),a=t("../Proxy/ProxyImtBoss"),s=t("../Proxy/ProxyHero");(function(t){t.Main="Main",t.Main_More="Main.More",t.Work="Main.Work",t.WorkItem="Main.Work.Item",t.WorkItemActive="Main.Work.Active",t.Hero="Main.Hero",t.HeroItem="Main.Hero.Item",t.HeroItemDetail="Main.Hero.Detail",t.HeroItemDetailStrength="Main.Hero.Strength",t.HeroPosExtend="Main.Hero.Extend",t.ForgeImt="Main.Imt",t.BackCity="Main.Back",t.ImtBossLevel="Main.Cha.Boss.Level",t.SmithTrain="Main.Imt.Forge.Smith.Train.Btn",t.Lottery_Crystal="Main.Box.C",t.CrystalItem="Main.CI",t.ImtSkillIocn="Main.Skill"})(n=o.MainTaskGuideType||(o.MainTaskGuideType={}));var l=function(){function t(){}return t.Init=function(){for(var t in this.mInited=!0,n)this.mGuideTreeArr.push(n[t]);for(var e=0,o=i.default.MAX_WORK_ID;e<o;++e)this.mGuideTreeArr.push(n.WorkItem+(e+1));for(this.mGuideTreeArr.push(n.WorkItemActive+"1"),this.mGuideTreeArr.push(n.WorkItemActive+"2"),e=0,o=s.default.Ins.mHeroInfo.heroTeam.length;e<o;++e)this.mGuideTreeArr.push(n.HeroItem+(e+1)),this.mGuideTreeArr.push(n.HeroItemDetail+(e+1));for(e=0,o=a.default.Ins.mBossNameArr.length;e<o;++e)this.mGuideTreeArr.push(n.ImtBossLevel+(e+1));this._InitGuideTree()},t._InitGuideTree=function(){this.mRootNode=new r.default,this.mRootNode.mNodeName=n.Main;for(var t=0,e=this.mGuideTreeArr.length;t<e;++t){var o=this.mRootNode,i=this.mGuideTreeArr[t],a=i.split(".");if(a[0]==this.mRootNode.mNodeName){var s=a[0];if(a.length>1)for(var l=1,m=a.length;l<m;++l){var u=a[l],p=o.mChildNodeMap.get(u);s=s+"."+u,p||(p=new r.default,o.mChildNodeMap.set(u,p),p.mNodeFullName=s,p.mNodeName=u),p.mParentNode=o,o=p}}else console.error("\u6839\u8282\u70b9\u8bbe\u7f6e\u9519\u8bef\uff1a"+i)}},t.SetInvokeData=function(t,e){var o=t.split(".");if(1!==o.length)for(var n=this.mRootNode,r=1,i=o.length;r<i;++r){var a=o[r];if(!n.mChildNodeMap.has(a))return void console.error("\u8282\u70b9\u6811\u4e2d\u4e0d\u5305\u542b\u8be5\u5b50\u8282\u70b9\uff1a"+a);if(void 0===(n=n.mChildNodeMap.get(a)))return void console.error("\u7a7a\u8282\u70b9, \u540d\u5b57\u4e3a\uff1a"+a);r===o.length-1&&n.SetRedPointNum(e)}else console.error("\u89e6\u53d1\u9519\u8bef\uff1a"+t)},t.GetRedPointNode=function(t){var e=t.split("."),o=this.mRootNode;if(1===e.length)return o;for(var n=1,r=e.length;n<r;++n){if(!o)return console.error("\u67e5\u627e\u8282\u70b9\u4e3a\u7a7a========="+t),null;o=o.mChildNodeMap.get(e[n])}return o},t.BCMsgTag="Task_",t.mInited=!1,t.mRootNode=null,t.mGuideTreeArr=[],t}();o.default=l,cc._RF.pop()},{"../Proxy/ProxyHero":"ProxyHero","../Proxy/ProxyImtBoss":"ProxyImtBoss","../Proxy/ProxyWork":"ProxyWork","./MainTaskFingerData":"MainTaskFingerData"}],MainTaskPanel:[function(t,e,o){"use strict";cc._RF.push(e,"3d52afF0bJC74VIkO3NyQoT","MainTaskPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyMainTask2"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Manager/WinMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/SwitchConfig"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTaskDescLbl=null,e.mIcon=null,e.mItemNumLbl=null,e.mCompleteNode=null,e.mCompleteSk=null,e.mEfxSk=null,e}return r(e,t),e.prototype.OnFirstOpen=function(){a.default.Ins.mMainTaskInfo.taskState!==a.MainTaskState.Got&&0!==a.default.Ins.mMainTaskInfo.curTaskID&&(this.node.active=!0,a.default.Ins.RestartTask()),a.default.Ins.mCurTaskData?(this.node.active=!0,this.SetData(a.default.Ins.mMainTaskInfo.curTaskID)):this.node.active=!1,!d.default.mGuideOpen&&d.default.mClearInfo?(this.node.active=!0,a.default.Ins.StartMainTask(),this._OnMsg_UpdateTaskData(),this._OnMsg_UpdateTaskState()):(this._OnMsg_UpdateTaskData(),this._OnMsg_UpdateTaskState())},e.prototype.Subscribe=function(){p.default.Subscribe(f.BCType.MainTask2_StartTask,this._OnMsg_UpdateTaskData,this),p.default.Subscribe(f.BCType.MainTask2_UpdateState,this._OnMsg_UpdateTaskState,this)},e.prototype.Remove=function(){p.default.Remove(f.BCType.MainTask2_StartTask,this._OnMsg_UpdateTaskData,this),p.default.Remove(f.BCType.MainTask2_UpdateState,this._OnMsg_UpdateTaskState,this)},e.prototype.SetData=function(t){var e=u.default.Ins.m_DB.mainTask2DB[t];this.mTaskDescLbl.string=e.desc;var o=e.rewards,n=o[0];if(m.default.Ins.LoadItemSprite(n,this.mIcon,null),n===f.ItemType.Coin){var r=new s.LargeNumber(o[1],o[2]);this.mItemNumLbl.string="x"+r.ToString(1)}else this.mItemNumLbl.string="x"+o[1];this.UpdateState()},e.prototype.UpdateState=function(){a.default.Ins.mMainTaskInfo.taskState===a.MainTaskState.Complete?(this.mCompleteNode.active=!0,this.mEfxSk.node.active=!0):(this.mCompleteNode.active=!1,this.mEfxSk.node.active=!1)},e.prototype._GoToTaskPlace=function(){},e.prototype._OnMsg_UpdateTaskData=function(){a.default.Ins.mCurTaskData?this.SetData(a.default.Ins.mMainTaskInfo.curTaskID):this.node.active=!1},e.prototype._OnMsg_UpdateTaskState=function(){this.UpdateState()},e.prototype.Invoke_OpenRewardsWin=function(){c.default.PlayBtnSound(),a.default.Ins.mMainTaskInfo.taskState===a.MainTaskState.Complete?l.default.Ins.Open(f.WinType.MainTaskWin,function(t){t.SetData(a.default.Ins.mMainTaskInfo.curTaskID)}):this._GoToTaskPlace()},i([g(cc.Label)],e.prototype,"mTaskDescLbl",void 0),i([g(cc.Sprite)],e.prototype,"mIcon",void 0),i([g(cc.Label)],e.prototype,"mItemNumLbl",void 0),i([g(cc.Node)],e.prototype,"mCompleteNode",void 0),i([g(sp.Skeleton)],e.prototype,"mCompleteSk",void 0),i([g(sp.Skeleton)],e.prototype,"mEfxSk",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyMainTask2":"ProxyMainTask2"}],MainTaskWin:[function(t,e,o){"use strict";cc._RF.push(e,"49d57rctXdAF6wrsJT/5dsm","MainTaskWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyMainTask2"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Manager/UserMgr"),p=t("../../Manager/PlotMgr"),c=t("../../Manager/PlatformMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mDescLbl=null,e.mBgSp=null,e.mCurTaskID=0,e.mCurData=null,e}return r(e,t),e.prototype.SetData=function(t){this.mCurTaskID=t,this.mCurData=d.default.Ins.m_DB.mainTask2DB[t];var e,o=this.mCurData.rewards;e=o[0]===h.ItemType.Coin?new m.LargeNumber(o[1],o[2]).ToString(1):o[1],this.mItem.SetData(o[0],e),this.mDescLbl.string=this.mCurData.rewardsDesc},e.prototype.Invoke_GetRewards=function(){f.default.PlayBtnSound();var t=this.mCurData.rewards,e=t[0];if(e===h.ItemType.Coin){var o=new m.LargeNumber(t[1],t[2]);u.default.Ins.AddCoin(o)}else u.default.Ins.UpdateItem(e,t[1]),e===h.ItemType.Crystal&&u.default.Ins.SaveCrystal();u.default.Ins.Save(),l.default.Ins.StartNextTask(),this.CloseWin(),null!==l.default.Ins.mMainTaskInfo&&c.default.ReportEvent(h.BIPoint.MainTask_End,{id:l.default.Ins.mMainTaskInfo.curTaskID}),null!==l.default.Ins.mMainTaskInfo&&4===l.default.Ins.mMainTaskInfo.curTaskID&&p.default.Ins.TriggerPlot(6)},e.prototype.Invoke_Close=function(){f.default.PlayBtnSound(),this.CloseWin()},i([I(s.default)],e.prototype,"mItem",void 0),i([I(cc.Label)],e.prototype,"mDescLbl",void 0),i([I(cc.Sprite)],e.prototype,"mBgSp",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PlotMgr":"PlotMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],MainWin:[function(t,e,o){"use strict";cc._RF.push(e,"b7eb826GRJHWoM4xtfv4tXm","MainWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/UnlockFuncPanel"),l=t("../Comp/MyToggleGroup"),m=t("../Comp/MainTaskPanel"),u=t("../Comp/MainSidePanel"),p=t("../Comp/MainLotteryBox"),c=t("../Comp/MainBackPanel"),d=t("../Comp/LevelPanel"),f=t("../Comp/ImtSkillPanel"),h=t("../Comp/FightItemUI"),y=t("../../Proxy/ProxyVIP"),g=t("../../Proxy/ProxySpeed"),I=t("../../Proxy/ProxyShop"),S=t("../../Proxy/ProxySevenDays"),_=t("../../Proxy/ProxyMainTask2"),v=t("../../Proxy/ProxyLevelReward"),C=t("../../Proxy/ProxyImtSkill"),M=t("../../Proxy/ProxyExplore"),P=t("../../Proxy/ProxyBackCity"),T=t("../../Proxy/ProxyAct"),D=t("../../Manager/WinMgr"),A=t("../../Manager/UserMgr"),O=t("../../Manager/ResMgr"),k=t("../../Manager/PoolMgr"),B=t("../../Manager/PlotMgr"),b=t("../../Manager/PlatformMgr"),R=t("../../Manager/FuncMgr"),L=t("../../Manager/BCMgr"),F=t("../../Manager/AudioMgr"),x=t("../../MainGame"),N=t("../../Common/SwitchConfig"),G=t("../../Common/GameRunningData"),w=t("../../Common/EnumsDefine"),H=t("../../Common/Common"),E=t("../../Proxy/ProxyCrystal"),W=cc._decorator,U=W.ccclass,j=W.property,V=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTopRoot=null,e.mCurLevelLbl=null,e.mTransitionNode1=null,e.mToggleGroup=null,e.mPanelRoot=null,e.mMoveDownRoot=null,e.mBackPanel=null,e.mBackContentNode=null,e.mMedalSpeedLbl=null,e.mLeftMedalLevelLbl=null,e.mBackBtnNode=null,e.mMainTaskPanel=null,e.mMainTaskNode=null,e.mMainTaskDescLbl=null,e.mMainTaskCompleteNode=null,e.mSevenDayBtn=null,e.mSevenDayBtnSp=null,e.mSevenDayUnlockLbl=null,e.mSecondDayBtnNode=null,e.mMoreBtnNode=null,e.mFingerSk=null,e.mSkillPanel=null,e.mImtSpeedLineRoot=null,e.mImtSpeedLineRoot2=null,e.mVIPSp=null,e.mVIPSFArr=[],e.mVIPBtn=null,e.mVIPGiftBtn=null,e.mGuideSkillBtnNode=null,e.mOfficeBtnNode=null,e.mOfficeBtnBg=null,e.mOfficeLbl=null,e.mDailyTaskBtnNode=null,e.mDailyTaskBg=null,e.mDailyTaskLbl=null,e.mLevelPanel=null,e.mUnlockPanel=null,e.mMainBox=null,e.mFightItemUI=null,e.mSidePanel=null,e.mMapBtnNode=null,e.mLastSevenDayBtnState=-2,e.mLastOfficeBtnState=-2,e.mLastDailyTaskBtnState=-2,e.mLastLotteryBoxBtnState=-2,e.mLastSecondDayBtnState=0,e.mLastMoreBtnState=0,e.mLastVIPBtnState=-1,e.mLastExploreFuncState=-2,e.mIsAdded=!1,e.mLastActState=!0,e.mLastShopState=!0,e.mCurOpenedWin=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mTopRoot.y=H.default.TOP_SAFE_OFFSET,this.mToggleGroup.Init(),this.mBackPanel.OnFirstOpen(),this.mSkillPanel.OnFirstOpen(),this.mMainTaskPanel.OnFirstOpen(),this.mMainBox.OnFirstOpen(),this.mFightItemUI.OnFirstOpen(),this.mGuideSkillBtnNode.active=!1,this.mLevelPanel.Init(),this.mSidePanel.Init(),this.mUnlockPanel.SetData(A.default.Ins.ClientInfo.bestLevel),this.mVIPSp.spriteFrame=this.mVIPSFArr[A.default.Ins.ClientInfo.vip.lv],setTimeout(function(){g.default.Ins.InitGameSpeedItemTime(),E.default.Ins.InitMultipleItemTime()},0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mSkillPanel.OnOpen(),!A.default.Ins.ClientInfo.passedGuideLevel&&N.default.mGuideOpen?(this.mLevelPanel.node.active=!1,this.mUnlockPanel.node.active=!1,this.mBackBtnNode.active=!1):(this.mLevelPanel.UpdateUI(),this.mLevelPanel.node.active=!0,this.mUnlockPanel.node.active=!0,this.mUnlockPanel.SetData(A.default.Ins.ClientInfo.bestLevel),this.mBackBtnNode.active=!0),this._RefreshSevenDayBtn(!1),this._RefreshOfficeBtn(!1),this._RefreshDailyTaskBtn(!1),this._RefreshVIPBtn(!1),this._RefreshLotteryBoxBtn(!1),this._RefreshSecondDayBtn(!1),this._RefreshMoreBtn(!1),this._RefreshExplore(!1),this._UpdateToggleLockState(),this._OnMsg_ChangeLevel()},e.prototype.HideMainWin=function(){this.mBackPanel.node.x=2e3,this.mToggleGroup.node.x=2e3},e.prototype.ShowMainWin=function(){this.mBackPanel.node.x=0,this.mBackPanel.ResetCoinPos(),this.mToggleGroup.node.x=0,this.mLevelPanel.node.active=!0,this.mUnlockPanel.node.active=!0},e.prototype._RefreshSevenDayBtn=function(t){var e=R.default.GetFuncState(R.FuncType.SevenDays),o=e[0];if(this.mLastSevenDayBtnState!==o){if(-1===o)this.mSevenDayBtn.active=!1;else if(0===o)this.mSevenDayBtn.active=!0,this.mSevenDayBtnSp.setMaterial(0,x.default.mGrayMat),this.mSevenDayUnlockLbl.string=e[1]+"\u5173\u5f00\u542f";else{var n=S.default.Ins.CheckAllRewardsGot();this.mSevenDayBtn.active=!n,this.mSevenDayBtnSp.setMaterial(0,x.default.mDefaultMat),this.mSevenDayUnlockLbl.string="",t&&(D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.SevenDays)}),b.default.ReportEvent(w.BIPoint.Guide_Unlock_7Day))}this.mLastSevenDayBtnState=o}},e.prototype._RefreshOfficeBtn=function(t){var e=R.default.GetFuncState(R.FuncType.Office),o=e[0];this.mLastOfficeBtnState!==o&&(-1===o?this.mOfficeBtnNode.active=!1:0===o?(this.mOfficeBtnNode.active=!0,this.mOfficeBtnBg.setMaterial(0,x.default.mGrayMat),this.mOfficeLbl.string=e[1]+"\u5173\u5f00\u542f"):(this.mOfficeBtnBg.setMaterial(0,x.default.mDefaultMat),this.mOfficeLbl.string="",t&&(D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.Office)}),b.default.ReportEvent(w.BIPoint.Guide_Unlock_Office),O.default.Ins.LoadPrefab("prefab/win/OfficeWin",null,null))),this.mLastOfficeBtnState=o)},e.prototype._RefreshDailyTaskBtn=function(t){var e=R.default.GetFuncState(R.FuncType.DailyTask),o=e[0];this.mLastDailyTaskBtnState!==o&&(-1===o?this.mDailyTaskBtnNode.active=!1:0===o?(this.mDailyTaskBtnNode.active=!0,this.mDailyTaskBg.setMaterial(0,x.default.mGrayMat),this.mDailyTaskLbl.string=e[1]+"\u5173\u5f00\u542f"):(this.mDailyTaskBg.setMaterial(0,x.default.mDefaultMat),this.mDailyTaskLbl.string="",this.mDailyTaskBtnNode.active=!0,t&&D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.DailyTask)})),this.mLastDailyTaskBtnState=o)},e.prototype._RefreshLotteryBoxBtn=function(t){var e=R.default.GetFuncState(R.FuncType.LotteryBox)[0];this.mLastLotteryBoxBtnState!==e&&(-1===e?(this.mMainBox.node.active=!1,this.mMapBtnNode.active=!1):0===e?(this.mMainBox.node.active=!0,this.mMapBtnNode.active=!0):(this.mMainBox.node.active=!0,this.mMapBtnNode.active=!0,t&&(D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.LotteryBox)}),this.mMainBox.UpdateLockState(),this.mFightItemUI.OnUnlock(),O.default.Ins.LoadPrefab("prefab/win/LotteryWin",null,null))),this.mLastLotteryBoxBtnState=e)},e.prototype._RefreshSecondDayBtn=function(){if(1!==this.mLastSecondDayBtnState){var t=R.default.GetFuncState(R.FuncType.SecondDayGift)[0];-1===t?this.mSecondDayBtnNode.active=!1:A.default.Ins.ClientInfo.hasGotSecondDayGift?this.mSecondDayBtnNode.active=!1:this.mSecondDayBtnNode.active=!0,this.mLastLotteryBoxBtnState=t}},e.prototype._RefreshMoreBtn=function(){if(1!==this.mLastMoreBtnState){var t=R.default.GetFuncState(R.FuncType.MoreBtn)[0];this.mMoreBtnNode.active=-1!==t,this.mLastMoreBtnState=t}},e.prototype._RefreshVIPBtn=function(t){var e=y.default.Ins.NeedShowBtn();-1!==this.mLastVIPBtnState&&e===(1===this.mLastVIPBtnState)||(this.mVIPBtn.active=e,this.mVIPGiftBtn.active=e&&0===A.default.Ins.ClientInfo.vip.vipGiftState),0===this.mLastVIPBtnState&&e&&(this.mVIPBtn.active=e,this.mVIPGiftBtn.active=e&&0===A.default.Ins.ClientInfo.vip.vipGiftState,t&&(D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.VIP)}),O.default.Ins.LoadPrefab("prefab/win/VIPGiftWin",null,null))),this.mLastVIPBtnState=e?1:0},e.prototype._RefreshExplore=function(t){var e=R.default.GetFuncState(R.FuncType.Explore)[0];this.mLastExploreFuncState!==e&&(-1===e||0===e||t&&(D.default.Ins.Open(w.WinType.FuncUnlockWin,function(t){t.SetData(R.FuncType.Explore)}),M.default.Ins.CheckRedPointNum()),this.mLastExploreFuncState=e)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),this.mIsAdded||(this.mIsAdded=!0,L.default.Subscribe(w.BCType.MainWin_Transition1,this._OnMsg_Transition1,this),this.mMainTaskPanel.Subscribe()),L.default.Subscribe(w.BCType.ToggleGroup_MainWin,this._OnMsg_ClickToggle,this),L.default.Subscribe(w.BCType.Fight_PassBestLevel,this._UpdateToggleLockState,this),L.default.Subscribe(w.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this),L.default.Subscribe(w.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this),L.default.Subscribe(w.BCType.MainWin_PlotToFight,this._OnMsg_PlotToFight,this),L.default.Subscribe(w.BCType.MainWin_SetShowState,this._OnMsg_SetShowState,this),L.default.Subscribe(w.BCType.BattleWin_StartSkill,this._OnMsg_StartSkill,this),L.default.Subscribe(w.BCType.Activity_UpdateBackUI,this._OnMsg_UpdateBackUI,this),L.default.Subscribe(w.BCType.VIP_OnUpgraded,this._OnMsg_OnVIPUpgraded,this),L.default.Subscribe(w.BCType.MainWin_ShowGuideSkillBtn,this._OnMsg_ShowGuideSkillBtn,this),L.default.Subscribe(w.BCType.VIP_BuyGift,this._OnMsg_BuyVIPGift,this),L.default.Subscribe(w.BCType.MainWin_GetSecondDayGift,this._OnMsg_GetSecondDayGift,this),L.default.Subscribe(w.BCType.BackCity,this._OnMsg_BackCity,this),this.mMainBox.Subscribe(),this.mBackPanel.Subscribe(),this.mSkillPanel.Subscribe(),this.mFightItemUI.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),L.default.Remove(w.BCType.ToggleGroup_MainWin,this._OnMsg_ClickToggle,this),L.default.Remove(w.BCType.Fight_PassBestLevel,this._UpdateToggleLockState,this),L.default.Remove(w.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this),L.default.Remove(w.BCType.Fight_ChangeLevel,this._OnMsg_ChangeLevel,this),L.default.Remove(w.BCType.MainWin_PlotToFight,this._OnMsg_PlotToFight,this),L.default.Remove(w.BCType.MainWin_SetShowState,this._OnMsg_SetShowState,this),L.default.Remove(w.BCType.BattleWin_StartSkill,this._OnMsg_StartSkill,this),L.default.Remove(w.BCType.Activity_UpdateBackUI,this._OnMsg_UpdateBackUI,this),L.default.Remove(w.BCType.VIP_OnUpgraded,this._OnMsg_OnVIPUpgraded,this),L.default.Remove(w.BCType.MainWin_ShowGuideSkillBtn,this._OnMsg_ShowGuideSkillBtn,this),L.default.Remove(w.BCType.VIP_BuyGift,this._OnMsg_BuyVIPGift,this),L.default.Remove(w.BCType.MainWin_GetSecondDayGift,this._OnMsg_GetSecondDayGift,this),L.default.Remove(w.BCType.BackCity,this._OnMsg_BackCity,this),this.mMainBox.Remove(),this.mBackPanel.Remove(),this.mSkillPanel.Remove(),this.mFightItemUI.Remove()},e.prototype._UpdateToggleLockState=function(){var t=R.default.GetFuncState(R.FuncType.Hero);this.mToggleGroup.mToggleArr[0].UpdateToggleUnlockState(t);var e=R.default.GetFuncState(R.FuncType.Work);this.mToggleGroup.mToggleArr[1].UpdateToggleUnlockState(e);var o=R.default.GetFuncState(R.FuncType.Immortal);this.mToggleGroup.mToggleArr[2].UpdateToggleUnlockState(o);var n=R.default.GetFuncState(R.FuncType.Challenge);this.mToggleGroup.mToggleArr[3].UpdateToggleUnlockState(n);var r=R.default.GetFuncState(R.FuncType.Shop),i=1===r[0];!this.mLastShopState&&i&&(this._ShowUnlockHint(R.FuncType.Shop),I.default.Ins.CheckShopRedNum(),b.default.ReportEvent(w.BIPoint.Guide_Unlock_Shop)),this.mToggleGroup.mToggleArr[4].UpdateToggleUnlockState(r),this.mLastShopState=i;var a=R.default.GetFuncState(R.FuncType.Activity),s=1===a[0];!this.mLastActState&&s&&(this._ShowUnlockHint(R.FuncType.Activity),T.default.Ins.CheckRedPoint(),b.default.ReportEvent(w.BIPoint.Guide_Unlock_Activity)),this.mToggleGroup.mToggleArr[5].UpdateToggleUnlockState(a),this.mLastActState=s},e.prototype._ShowUnlockHint=function(t){D.default.Ins.Open(w.WinType.FuncUnlockWin,function(e){e.SetData(t)})},e.prototype._OnMsg_Transition1=function(t){var e=this;this.mTransitionNode1.opacity=0;var o=this;C.default.Ins.PauseImtSkill(),cc.tween(this.mTransitionNode1).to(.3,{opacity:255}).call(function(){o.mTransitionNode1.opacity=0,t(),e.mLevelPanel.UpdateUI(),C.default.Ins.ResumeImtSkill()}).start()},e.prototype._OnMsg_ChangeLevel=function(){this.mMedalSpeedLbl.string=P.default.Ins.GetCurLevelGetMedalSpeed()+"";var t=A.default.Ins.ClientInfo.curLevel,e=1;t%P.default.Ins.mMedalRewardLevelUnit!=0&&(e=P.default.Ins.mMedalRewardLevelUnit-t%P.default.Ins.mMedalRewardLevelUnit+1),this.mLeftMedalLevelLbl.string=e+""},e.prototype._OnMsg_PlotToFight=function(){this.mBackBtnNode.active=!0,this.ShowMainWin(),this._OnMsg_ClickToggle(1,!0),this.mMainTaskPanel.node.active=!0,_.default.Ins.StartMainTask()},e.prototype._OnMsg_OpenHeroWin=function(){G.default.Ins.mMainWinPanelState===G.MainPanelState.Up&&0===this.mToggleGroup.CurToggleIdx||this._OnMsg_ClickToggle(0,!0)},e.prototype._OnMsg_PassBestLevel=function(){this._RefreshSevenDayBtn(!0),this._RefreshOfficeBtn(!0),this._RefreshDailyTaskBtn(!0),this._RefreshVIPBtn(!0),this._RefreshLotteryBoxBtn(!0),this._RefreshSecondDayBtn(!0),this._RefreshMoreBtn(!0),this._RefreshExplore(!0),v.default.Ins.CheckRedPointNum(),this.mUnlockPanel.SetData(A.default.Ins.ClientInfo.bestLevel)},e.prototype._OnMsg_SetShowState=function(t){switch(t){case 0:this.node.opacity=0;break;case 1:this.node.opacity=255}},e.prototype._OnMsg_StartSkill=function(t,e,o){void 0===o&&(o=!1);var n="",r=null;o?(r=this.mImtSpeedLineRoot2,n="prefab/ui/suduxian2"):(n="prefab/ui/suduxian",r=this.mImtSpeedLineRoot),k.default.Ins.Borrow(n,"ImtSpeedLine",function(e){var o=e;e.node.parent=r,e.node.position=cc.Vec3.ZERO,o.Init(t)})},e.prototype._OnMsg_UpdateBackUI=function(t){this.node.opacity=t?255:0},e.prototype._OnMsg_OnVIPUpgraded=function(){this.mVIPSp.spriteFrame=this.mVIPSFArr[A.default.Ins.ClientInfo.vip.lv]},e.prototype._OnMsg_ShowGuideSkillBtn=function(){this.mGuideSkillBtnNode.active=!0},e.prototype._OnMsg_BuyVIPGift=function(){this.mVIPGiftBtn.active=!1},e.prototype._OnMsg_GetSecondDayGift=function(){this.mSecondDayBtnNode.active=!A.default.Ins.ClientInfo.hasGotSecondDayGift},e.prototype._OnMsg_BackCity=function(){var t=R.default.GetFuncState(R.FuncType.Immortal);this.mToggleGroup.mToggleArr[2].UpdateToggleUnlockState(t);var e=R.default.GetFuncState(R.FuncType.Challenge);this.mToggleGroup.mToggleArr[3].UpdateToggleUnlockState(e)},e.prototype._OnMsg_ClickToggle=function(t,e){void 0===e&&(e=!1),e||F.default.PlayBtnSound();var o=!0;switch(t){case 0:o=R.default.IsUnlock(R.FuncType.Hero,!0);break;case 1:o=R.default.IsUnlock(R.FuncType.Work,!0);break;case 2:o=R.default.IsUnlock(R.FuncType.Immortal,!1);break;case 3:o=R.default.IsUnlock(R.FuncType.Challenge,!0);break;case 4:o=R.default.IsUnlock(R.FuncType.Shop,!0);break;case 5:o=R.default.IsUnlock(R.FuncType.Activity,!0)}5!==t&&(this.mToggleGroup.CurToggleIdx<0&&o?this._MoveUp():this.mToggleGroup.CurToggleIdx===t&&this._MoveDown());var n=!1;this.mToggleGroup.CurToggleIdx!==t&&o&&(n=!0,null!==this.mCurOpenedWin&&5!==t&&D.default.Ins.Close(this.mCurOpenedWin.mWinType)),o||2===t&&(A.default.Ins.ClientInfo.bestLevel<3?D.default.Ins.ShowTips("\u8bf7\u5148\u5b8c\u6210\u6559\u5b66\uff0c\u7b2c3\u5173\u5f00\u542f\u5c55\u793a~"):D.default.Ins.Open(w.WinType.ImtInsWin,null));var r=this;if(n)switch(t){case 0:o&&(D.default.Ins.Open(w.WinType.HeroWin,function(t){r.mCurOpenedWin=t,t.node.parent!==r.mPanelRoot&&(t.node.parent=r.mPanelRoot,t.node.position=cc.Vec3.ZERO)},!0),L.default.Dispatch(w.BCType.MainWin_ChangeCoinType,w.CoinType.Common));break;case 1:o&&(D.default.Ins.Open(w.WinType.WorkWin,function(t){r.mCurOpenedWin=t,t.node.parent!==r.mPanelRoot&&(t.node.parent=r.mPanelRoot,t.node.position=cc.Vec3.ZERO)},!0),L.default.Dispatch(w.BCType.MainWin_ChangeCoinType,w.CoinType.Common));break;case 2:o&&(D.default.Ins.Open(w.WinType.ImmortalWin,function(t){r.mCurOpenedWin=t,t.node.parent!==r.mPanelRoot&&(t.node.parent=r.mPanelRoot,t.node.position=cc.Vec3.ZERO)},!0),L.default.Dispatch(w.BCType.MainWin_ChangeCoinType,w.CoinType.ForgeMat));break;case 3:o&&D.default.Ins.Open(w.WinType.ChallengeWin,function(t){r.mCurOpenedWin=t,t.node.parent!==r.mPanelRoot&&(t.node.parent=r.mPanelRoot,t.node.position=cc.Vec3.ZERO)},!0),L.default.Dispatch(w.BCType.MainWin_ChangeCoinType,w.CoinType.Common);break;case 4:o&&D.default.Ins.Open(w.WinType.ShopWin,function(t){r.mCurOpenedWin=t,t.node.parent!==r.mPanelRoot&&(t.node.parent=r.mPanelRoot,t.node.position=cc.Vec3.ZERO)},!0),L.default.Dispatch(w.BCType.MainWin_ChangeCoinType,w.CoinType.Shop);break;case 5:o&&D.default.Ins.Open(w.WinType.CommonActivity,function(){L.default.Dispatch(w.BCType.Activity_UpdateBackUI,!1)})}o&&5!==t&&this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._MoveDown=function(){var t=this;this.mBackContentNode.active=!0,cc.tween(this.mMoveDownRoot).to(.1,{position:cc.v3(0,-800,0)}).call(function(){t.mToggleGroup.CurToggleIdx=-1,t.mToggleGroup.UpdateToggleBtnState(-1),t.mMoveDownRoot.active=!1,null!==t.mCurOpenedWin&&D.default.Ins.Close(t.mCurOpenedWin.mWinType)}).start(),G.default.Ins.mMainWinPanelState=G.MainPanelState.Down},e.prototype._MoveUp=function(){var t=this;this.mMoveDownRoot.active=!0,cc.tween(this.mMoveDownRoot).to(.1,{position:cc.v3(0,41,0)}).call(function(){t.mBackContentNode.active=!1}).start(),G.default.Ins.mMainWinPanelState=G.MainPanelState.Up},e.prototype.Invoke_MoveDown=function(){F.default.PlayBtnSound(),this._MoveDown(),this.mToggleGroup.UpdateToggleBtnState(-1)},e.prototype.Invoke_BackCity=function(){F.default.PlayBtnSound();var t=A.default.Ins.ClientInfo;R.default.IsUnlock(R.FuncType.BackCity)&&!t.hasShownBackCityInstructionWin?D.default.Ins.Open(w.WinType.BackCityInstructionWin,null):D.default.Ins.Open(w.WinType.BackCityWin,null)},e.prototype.Invoke_OpenDailyTask=function(){F.default.PlayBtnSound();var t=R.default.GetFuncState(R.FuncType.DailyTask);0!==t[0]?D.default.Ins.Open(w.WinType.DailyTaskWin,null):D.default.Ins.ShowTips("\u7b2c"+t[1]+"\u5173\u5c31\u89e3\u9501\u55bd~~\u4e3b\u516c\u52a0\u6cb9\uff01")},e.prototype.Invoke_OpenSevenDays=function(){F.default.PlayBtnSound();var t=R.default.GetFuncState(R.FuncType.SevenDays);0!==t[0]?(D.default.Ins.Open(w.WinType.SevenDaysWin,null),this.mSidePanel.Hide()):D.default.Ins.ShowTips("\u7b2c"+t[1]+"\u5173\u5c31\u89e3\u9501\u55bd~~\u4e3b\u516c\u52a0\u6cb9\uff01")},e.prototype.Invoke_OpenVIP=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.VipWin,null)},e.prototype.Invoke_OpenOffice=function(){F.default.PlayBtnSound();var t=R.default.GetFuncState(R.FuncType.Office);0!==t[0]?(D.default.Ins.Open(w.WinType.OfficeWin,null),this.mSidePanel.Hide()):D.default.Ins.ShowTips("\u7b2c"+t[1]+"\u5173\u5c31\u89e3\u9501\u55bd~~\u4e3b\u516c\u52a0\u6cb9\uff01")},e.prototype.Invoke_TriggerGuideSkill=function(){F.default.PlayBtnSound(),this.mGuideSkillBtnNode.active=!1,B.default.Ins.TriggerImtSkill()},e.prototype.Invoke_OpenVIPGift=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.VIPGiftWin,null)},e.prototype.Invoke_OpenLotteryWin=function(){F.default.PlayBtnSound(),R.default.IsUnlock(R.FuncType.LotteryBox,!0)&&D.default.Ins.Open(w.WinType.LotteryWin,null)},e.prototype.Invoke_More=function(){F.default.PlayBtnSound(),4===this.mSidePanel.mMoveState?this.mSidePanel.Show():2===this.mSidePanel.mMoveState&&this.mSidePanel.Hide()},e.prototype.Invoke_SecondDayWin=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.SecondDayWin,null)},e.prototype.Invoke_OpenHeroMap=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.HeroMapWin,null)},e.prototype.Invoke_OpenSetting=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.SetWin,null)},e.prototype.Invoke_OpenServiceWin=function(){F.default.PlayBtnSound(),D.default.Ins.Open(w.WinType.ServiceWin,null)},i([j(cc.Node)],e.prototype,"mTopRoot",void 0),i([j(cc.Label)],e.prototype,"mCurLevelLbl",void 0),i([j(cc.Node)],e.prototype,"mTransitionNode1",void 0),i([j(l.default)],e.prototype,"mToggleGroup",void 0),i([j(cc.Node)],e.prototype,"mPanelRoot",void 0),i([j(cc.Node)],e.prototype,"mMoveDownRoot",void 0),i([j(c.default)],e.prototype,"mBackPanel",void 0),i([j(cc.Node)],e.prototype,"mBackContentNode",void 0),i([j(cc.Label)],e.prototype,"mMedalSpeedLbl",void 0),i([j(cc.Label)],e.prototype,"mLeftMedalLevelLbl",void 0),i([j(cc.Node)],e.prototype,"mBackBtnNode",void 0),i([j(m.default)],e.prototype,"mMainTaskPanel",void 0),i([j(cc.Node)],e.prototype,"mMainTaskNode",void 0),i([j(cc.Label)],e.prototype,"mMainTaskDescLbl",void 0),i([j(cc.Node)],e.prototype,"mMainTaskCompleteNode",void 0),i([j(cc.Node)],e.prototype,"mSevenDayBtn",void 0),i([j(cc.Sprite)],e.prototype,"mSevenDayBtnSp",void 0),i([j(cc.Label)],e.prototype,"mSevenDayUnlockLbl",void 0),i([j(cc.Node)],e.prototype,"mSecondDayBtnNode",void 0),i([j(cc.Node)],e.prototype,"mMoreBtnNode",void 0),i([j(sp.Skeleton)],e.prototype,"mFingerSk",void 0),i([j(f.default)],e.prototype,"mSkillPanel",void 0),i([j(cc.Node)],e.prototype,"mImtSpeedLineRoot",void 0),i([j(cc.Node)],e.prototype,"mImtSpeedLineRoot2",void 0),i([j(cc.Sprite)],e.prototype,"mVIPSp",void 0),i([j([cc.SpriteFrame])],e.prototype,"mVIPSFArr",void 0),i([j(cc.Node)],e.prototype,"mVIPBtn",void 0),i([j(cc.Node)],e.prototype,"mVIPGiftBtn",void 0),i([j(cc.Node)],e.prototype,"mGuideSkillBtnNode",void 0),i([j(cc.Node)],e.prototype,"mOfficeBtnNode",void 0),i([j(cc.Sprite)],e.prototype,"mOfficeBtnBg",void 0),i([j(cc.Label)],e.prototype,"mOfficeLbl",void 0),i([j(cc.Node)],e.prototype,"mDailyTaskBtnNode",void 0),i([j(cc.Sprite)],e.prototype,"mDailyTaskBg",void 0),i([j(cc.Label)],e.prototype,"mDailyTaskLbl",void 0),i([j(d.default)],e.prototype,"mLevelPanel",void 0),i([j(s.default)],e.prototype,"mUnlockPanel",void 0),i([j(p.default)],e.prototype,"mMainBox",void 0),i([j(h.default)],e.prototype,"mFightItemUI",void 0),i([j(u.default)],e.prototype,"mSidePanel",void 0),i([j(cc.Node)],e.prototype,"mMapBtnNode",void 0),i([U],e)}(a.default);o.default=V,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/GameRunningData":"GameRunningData","../../Common/SwitchConfig":"SwitchConfig","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/FuncMgr":"FuncMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PlotMgr":"PlotMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyAct":"ProxyAct","../../Proxy/ProxyBackCity":"ProxyBackCity","../../Proxy/ProxyCrystal":"ProxyCrystal","../../Proxy/ProxyExplore":"ProxyExplore","../../Proxy/ProxyImtSkill":"ProxyImtSkill","../../Proxy/ProxyLevelReward":"ProxyLevelReward","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../../Proxy/ProxySevenDays":"ProxySevenDays","../../Proxy/ProxyShop":"ProxyShop","../../Proxy/ProxySpeed":"ProxySpeed","../../Proxy/ProxyVIP":"ProxyVIP","../Comp/FightItemUI":"FightItemUI","../Comp/ImtSkillPanel":"ImtSkillPanel","../Comp/LevelPanel":"LevelPanel","../Comp/MainBackPanel":"MainBackPanel","../Comp/MainLotteryBox":"MainLotteryBox","../Comp/MainSidePanel":"MainSidePanel","../Comp/MainTaskPanel":"MainTaskPanel","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/UnlockFuncPanel":"UnlockFuncPanel","./WinBase":"WinBase"}],MapHeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"ca8dd8wmstDT5biQY9ziGQ/","MapHeroItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySkin"),s=t("../../Proxy/ProxyHeroMap"),l=t("../../Manager/WinMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/AudioMgr"),c=t("../../MainGame"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mHeroSp=null,e.mNameLbl=null,e.mStateLbl=null,e.mGoldRoot=null,e.mHeroID=0,e.mHeroData=null,e.mIsVisible=!0,e}return r(e,t),e.prototype.SetVisibleState=function(t){this.mIsVisible=t,this.node.opacity=t?255:0},e.prototype.SetData=function(t){var e=a.default.Ins.GetHeroDefaultSkin(t),o=u.default.Ins.m_DB.heroCardDB[t],n=u.default.Ins.m_DB.itemDB[t];if(this.mHeroID=t,this.mHeroData=o,this.mNameLbl.string=o.name,e){this.mNameLbl.node.color=s.default.Ins.GetNameColor(n.quality);var r=this;m.default.Ins.LoadTexture("texture/hero/"+e.sprite,function(t){if(null!==r.mHeroSp){r.mHeroSp.spriteFrame=t;var e=o.mapOffset;f.default.ResetSpriteSize(r.mHeroSp,r.mHeroSp.spriteFrame,e[2]),r.mHeroSp.node.position=cc.v3(e[0],e[1],0)}},null)}},e.prototype.UpdateState=function(){var t=s.default.Ins.GetHeroState(this.mHeroID);if(this.mHeroData)switch(this.mStateLbl.node.color=s.default.Ins.GetColorByHeroState(t),t){case s.MapHeroState.Lock:this.mStateLbl.string=this.mHeroData.unlockLevel+"\u5173\u89e3\u9501",this.mHeroSp.node.color=cc.Color.BLACK;break;case s.MapHeroState.NotGot:this.mHeroSp.node.color=cc.Color.WHITE,this.mHeroSp.setMaterial(0,c.default.mGrayMat),this.mStateLbl.string="\u672a\u83b7\u5f97";break;case s.MapHeroState.HasGot:this.mHeroSp.node.color=cc.Color.WHITE,this.mHeroSp.setMaterial(0,c.default.mDefaultMat),this.mStateLbl.string="\u5df2\u83b7\u5f97"}var e=s.default.Ins.GetGoldNumByID(this.mHeroID);this.mGoldRoot.active=0!==e},e.prototype.Invoke_ClickHero=function(){var t=this;if(this.mIsVisible){p.default.PlayBtnSound();var e=!1;switch(s.default.Ins.GetHeroState(this.mHeroID)){case s.MapHeroState.Lock:l.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u8bf7\u5148\u89e3\u9501\u8be5\u6b66\u5c06\u54e6~");break;case s.MapHeroState.NotGot:e=!0;break;case s.MapHeroState.HasGot:var o=s.default.Ins.GetGoldNumByID(this.mHeroID);0!==o?(s.default.Ins.GetHeroReward(this.mHeroID,o),this.mGoldRoot.active=!1):e=!0}e&&l.default.Ins.Open(d.WinType.HeroDetailWin,function(e){e.SetData(t.mHeroID,d.WinType.HeroMapWin)})}},i([g(cc.Sprite)],e.prototype,"mHeroSp",void 0),i([g(cc.Label)],e.prototype,"mNameLbl",void 0),i([g(cc.Label)],e.prototype,"mStateLbl",void 0),i([g(cc.Node)],e.prototype,"mGoldRoot",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHeroMap":"ProxyHeroMap","../../Proxy/ProxySkin":"ProxySkin"}],MapItem:[function(t,e,o){"use strict";cc._RF.push(e,"0b5697a+6xGp4gLUGGsMgu8","MapItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MapHeroItem"),s=t("./LoopScrollItem"),l=t("../../Manager/UserMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBgSp=null,e.mLevelLbl=null,e.mTagNode=null,e.mTemplate=null,e.mHeroMapWin=null,e.mCurDataID=0,e.mHeroItemArr=[],e.mCellWidth=180,e.mInited=!1,e}return r(e,t),e.prototype.SetData=function(t,e){void 0===e&&(e=null),this.mInited||(this.mHeroItemArr.push(this.mTemplate),this.mInited=!0),this.mHeroMapWin=e,this.mTagNode.opacity=0;var o=t.levelArr,n=o[0],r=o[1],i=l.default.Ins.ClientInfo.bestLevel;if(this.mLevelLbl.string=n+"~"+r,i<n?this.mBgSp.spriteFrame=this.mHeroMapWin.mLockSF:n<=i&&i<=r?(this.mBgSp.spriteFrame=this.mHeroMapWin.mActiveSF,this.mTagNode.opacity=255):this.mBgSp.spriteFrame=this.mHeroMapWin.mDefaultSF,this.mCurDataID!==t.Id){for(var s=t.heroArr,m=0,u=this.mHeroItemArr.length;m<u;++m)this.mHeroItemArr[m].SetVisibleState(!1);var p=s.length-1;for(m=0,u=s.length;m<u;++m){if(m>=this.mHeroItemArr.length){var c=cc.instantiate(this.mTemplate.node);c.parent=this.mTemplate.node.parent;var d=c.getComponent(a.default);this.mHeroItemArr.push(d)}this.mHeroItemArr[m].SetData(s[m]),this.mHeroItemArr[m].SetVisibleState(!0),this.mHeroItemArr[m].node.x=this.mCellWidth*m-p/2*this.mCellWidth}}for(this.mCurDataID=t.Id,m=0,u=t.heroArr.length;m<u;++m)this.mHeroItemArr[m].UpdateState()},i([p(cc.Sprite)],e.prototype,"mBgSp",void 0),i([p(cc.Label)],e.prototype,"mLevelLbl",void 0),i([p(cc.Node)],e.prototype,"mTagNode",void 0),i([p(a.default)],e.prototype,"mTemplate",void 0),i([u],e)}(s.default);o.default=c,cc._RF.pop()},{"../../Manager/UserMgr":"UserMgr","./LoopScrollItem":"LoopScrollItem","./MapHeroItem":"MapHeroItem"}],MedalDetailPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5d7b9oPYKVD24/7UBWpub4P","MedalDetailPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMask=null,e}return r(e,t),e.prototype.Open=function(){this.node.active=!0,this.mMask.once(cc.Node.EventType.TOUCH_END,this._Click,this)},e.prototype._Click=function(){this.node.active=!1},i([l(cc.Node)],e.prototype,"mMask",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],MopResultWin:[function(t,e,o){"use strict";cc._RF.push(e,"e7bd1u58/ZEAZuMOCgZfLBS","MopResultWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyLargeNum"),m=t("../../Proxy/ProxyImtBoss"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTopRoot=null,e.mFC1Lbl=null,e.mFC2Lbl=null,e.mFC3Lbl=null,e.mFC4Lbl=null,e.mItemRoot=null,e.mItemTemplate=null,e.mChallengeTimesLbl=null,e.mMopNumLbl=null,e.mCurBossID=1,e.mCurLevelID=1,e.mCellWidth=120,e.mItemArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mTopRoot.y=h.default.TOP_SAFE_OFFSET;for(var e=0;e<=3;++e)if(0===e)this.mItemArr.push(this.mItemTemplate);else{var o=cc.instantiate(this.mItemTemplate.node);o.parent=this.mItemRoot;var n=o.getComponent(s.default);this.mItemArr.push(n)}},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mFC1Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat),1),this.mFC2Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+1),1),this.mFC3Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+2),1),this.mFC4Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+3),1)},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(f.BCType.Common_UpdateItem,this._OnMsg_UpdateMatUI,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(f.BCType.Common_UpdateItem,this._OnMsg_UpdateMatUI,this)},e.prototype.SetData=function(t,e,o){this.mCurBossID=t,this.mCurLevelID=e;for(var n=0,r=this.mItemArr.length;n<r;++n)this.mItemArr[n].node.opacity=0;for(n=0,r=o.length;n<r;++n){this.mItemArr[n].node.opacity=255;var i=o[n][0],a=o[n][1].toFixed(0);f.ItemType.ImtForgeMat<=i&&i<=f.ItemType.ImtForgeMat+3&&(a=l.default.FormatNumber(o[n][1],2)),this.mItemArr[n].SetData(i,a),this.mItemArr[n].node.position=cc.v3(this.mCellWidth*n-.5*this.mCellWidth*(r-1),0,0)}for(this._UpdateNumLbl(),n=0,r=o.length;n<r;++n)this.mItemArr[n].node.scale=0,cc.tween(this.mItemArr[n].node).delay(.1*n+.05).to(.08,{scale:1}).start()},e.prototype._UpdateNumLbl=function(){this.mChallengeTimesLbl.string=p.default.Ins.ClientInfo.imtBossLevel.challengeTimes+"/1",this.mMopNumLbl.string=p.default.Ins.GetItemNum(f.ItemType.MopTicket)+"/1"},e.prototype._OnMsg_UpdateMatUI=function(t){switch(t){case f.ItemType.ImtForgeMat:this.mFC1Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat),1);break;case f.ItemType.ImtForgeMat+1:this.mFC2Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+1),1);break;case f.ItemType.ImtForgeMat+2:this.mFC3Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+2),1);break;case f.ItemType.ImtForgeMat+3:this.mFC4Lbl.string=""+l.default.FormatNumber(p.default.Ins.GetItemNum(f.ItemType.ImtForgeMat+3),1)}},e.prototype.Invoke_Close=function(){d.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_Mop=function(){if(p.default.Ins.ClientInfo.imtBossLevel.challengeTimes<=0)u.default.Ins.Open(f.WinType.FreeRewardWin,function(t){var e=t,o=m.default.Ins.GetMaxChallengeTimes(),n=Math.min(m.default.Ins.mFreeChallengeTimes,o);e.SetFreeChallengeTimes("\u6b23\u8d4f\u4e00\u6bb5\u89c6\u9891\uff0c\u83b7\u5f97\u6311\u6218\u6b21\u6570",n,null,function(t){m.default.Ins.RecoverChallengeTimes(n),u.default.Ins.Open(f.WinType.GetRewardsWin,function(e){var o=e;t?o.SetDataWithADCoin(f.ItemType.ChallengeTimes,""+n):o.SetDataSingle(f.ItemType.ChallengeTimes,""+n)})})});else if(p.default.Ins.GetItemNum(f.ItemType.MopTicket)<=0)u.default.Ins.Open(f.WinType.FreeRewardWin,function(t){t.SetData("\u89c2\u770b\u4e00\u6bb5\u89c6\u9891\uff0c\u83b7\u5f97\u626b\u8361\u5238",f.ItemType.MopTicket,m.default.Ins.mFreeMopTicketNum,null,null)});else{var t=m.default.Ins.Mop(this.mCurBossID,this.mCurLevelID);this.SetData(this.mCurBossID,this.mCurLevelID,t)}},i([I(cc.Node)],e.prototype,"mTopRoot",void 0),i([I(cc.Label)],e.prototype,"mFC1Lbl",void 0),i([I(cc.Label)],e.prototype,"mFC2Lbl",void 0),i([I(cc.Label)],e.prototype,"mFC3Lbl",void 0),i([I(cc.Label)],e.prototype,"mFC4Lbl",void 0),i([I(cc.Node)],e.prototype,"mItemRoot",void 0),i([I(s.default)],e.prototype,"mItemTemplate",void 0),i([I(cc.Label)],e.prototype,"mChallengeTimesLbl",void 0),i([I(cc.Label)],e.prototype,"mMopNumLbl",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImtBoss":"ProxyImtBoss","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],MyToggleGroup:[function(t,e,o){"use strict";cc._RF.push(e,"cfb2d39Fw1NXrmZ1uLsE6nr","MyToggleGroup");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MyToggle"),s=t("../../Common/EnumsDefine"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mToggleType=0,e.mToggleArr=[],e.mCurToggleIdx=-1,e}var o;return r(e,t),o=e,Object.defineProperty(e.prototype,"CurToggleIdx",{get:function(){return this.mCurToggleIdx},set:function(t){this.mCurToggleIdx=t},enumerable:!1,configurable:!0}),e.StaticInit=function(){o.ToggleType2BCMsgType=new Map,o.ToggleType2BCMsgType.set(s.ToggleGroupType.MainWin,s.BCType.ToggleGroup_MainWin),o.ToggleType2BCMsgType.set(s.ToggleGroupType.AdjustTeamWin,s.BCType.ToggleGroup_HeroTeam),o.ToggleType2BCMsgType.set(s.ToggleGroupType.HeroPicture,s.BCType.ToggleGroup_HeroPicture),o.ToggleType2BCMsgType.set(s.ToggleGroupType.HeroDetail,s.BCType.ToggleGroup_HeroDetail),o.ToggleType2BCMsgType.set(s.ToggleGroupType.SmithWin,s.BCType.ToggleGroup_SmithWin),o.ToggleType2BCMsgType.set(s.ToggleGroupType.Activity,s.BCType.ToggleGroup_Activity),o.ToggleType2BCMsgType.set(s.ToggleGroupType.AllSPAct,s.BCType.ToggleGroup_AllSPAct),o.ToggleType2BCMsgType.set(s.ToggleGroupType.AllSPActHero,s.BCType.ToggleGroup_AllSPHero),o.ToggleType2BCMsgType.set(s.ToggleGroupType.AllSPActImt,s.BCType.ToggleGroup_AllSPImt),o.ToggleType2BCMsgType.set(s.ToggleGroupType.Shop,s.BCType.ToggleGroup_Shop)},e.GetBCMsg=function(t){return o.ToggleType2BCMsgType.get(t)},e.prototype.Init=function(){var t=this;this.mToggleArr.forEach(function(e){e.Init(t.mToggleType)})},e.prototype.UpdateUnlockState=function(){},e.prototype.UpdateToggleBtnState=function(t){this.mCurToggleIdx=t,this.mToggleArr.forEach(function(e,o){o===t?e.OnActived():e.OnDeactived()})},e.ToggleType2BCMsgType=null,i([u(cc.Integer)],e.prototype,"mToggleType",void 0),i([u([a.default])],e.prototype,"mToggleArr",void 0),o=i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","./MyToggle":"MyToggle"}],MyToggle:[function(t,e,o){"use strict";cc._RF.push(e,"86aacImR/RJ3o2xqoxCQ7hc","MyToggle");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MyToggleGroup"),s=t("../../Manager/BCMgr"),l=t("../../MainGame"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ToggleIdx=0,e.m_DeactivedNode=null,e.m_ActivedNode=null,e.m_UnlockNode=null,e.mIcon=null,e.mDeactiveSp=null,e.m_ToggleGroupType=0,e.m_IsActived=!1,e.mCurUnlockState=!0,e}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this._OnClickToggle,this)},e.prototype.onDestroy=function(){this.node.off(cc.Node.EventType.TOUCH_END,this._OnClickToggle,this)},e.prototype._OnClickToggle=function(){s.default.Dispatch(a.default.GetBCMsg(this.m_ToggleGroupType),this.m_ToggleIdx)},e.prototype.UpdateToggleUnlockState=function(t){var e=t[0];-1===e?(this.node.active=!1,this.m_UnlockNode&&(this.m_UnlockNode.active=!1)):0===e?(this.node.active=!0,this.UpdateUnlockState(!1)):(this.node.active=!0,this.UpdateUnlockState(!0))},e.prototype.UpdateUnlockState=function(t){this.mCurUnlockState!==t&&(this.m_UnlockNode&&(this.m_UnlockNode.active=!t),null!==this.mIcon&&(t?this.mIcon.setMaterial(0,l.default.mDefaultMat):this.mIcon.setMaterial(0,l.default.mGrayMat)),null!==this.mDeactiveSp&&(t?this.mDeactiveSp.setMaterial(0,l.default.mDefaultMat):this.mDeactiveSp.setMaterial(0,l.default.mGrayMat)),this.mCurUnlockState=t)},e.prototype.Init=function(t){this.m_ToggleGroupType=t},e.prototype.OnActived=function(){this.m_IsActived||(null!==this.m_DeactivedNode&&(this.m_DeactivedNode.opacity=0),this.m_ActivedNode.opacity=255),this.m_IsActived=!0},e.prototype.OnDeactived=function(){this.m_IsActived&&(null!==this.m_DeactivedNode&&(this.m_DeactivedNode.opacity=255),this.m_ActivedNode.opacity=0),this.m_IsActived=!1},i([p(cc.Integer)],e.prototype,"m_ToggleIdx",void 0),i([p(cc.Node)],e.prototype,"m_DeactivedNode",void 0),i([p(cc.Node)],e.prototype,"m_ActivedNode",void 0),i([p(cc.Node)],e.prototype,"m_UnlockNode",void 0),i([p(cc.Sprite)],e.prototype,"mIcon",void 0),i([p(cc.Sprite)],e.prototype,"mDeactiveSp",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../MainGame":"MainGame","../../Manager/BCMgr":"BCMgr","./MyToggleGroup":"MyToggleGroup"}],NewHeroShowWin:[function(t,e,o){"use strict";cc._RF.push(e,"6271cJa2ORH8I6qHEEZchsB","NewHeroShowWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyHero"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySFArr=[],e.mQualitySp=null,e.mNameLbl=null,e.mDescLbl=null,e.mBubbleNode=null,e.mHeroSk=null,e.mEfxSk=null,e.mAppearEfx=null,e.mItem=null,e.mAnim=null,e.mBubbleTween=null,e.mOpenedCallback=null,e.mFromWinType=y.WinType.None,e.mMultiple=5,e}return r(e,t),e.prototype._OnOpen=function(){if(t.prototype._OnOpen.call(this),null!==this.mOpenedCallback&&this.mOpenedCallback(),this.mAppearEfx.node.active=!1,null===this.mAppearEfx.skeletonData){var e=this;c.default.Ins.LoadSpine("spine/ruchang",function(t){e.mAppearEfx.skeletonData=t})}},e.prototype.SetPreOpenData=function(t){this.mOpenedCallback=t},e.prototype.SetData=function(t,e,o){void 0===e&&(e=null),void 0===o&&(o=y.WinType.None),this.mFromWinType=o,this._closeCallback=e;var n=this,r=d.default.Ins.m_DB.entityDB[t],i=d.default.Ins.m_DB.heroCardDB[t],a=d.default.Ins.m_DB.itemDB[t];this.mHeroSk.node.scale=i.scale,c.default.Ins.LoadSpine("spine/hero/"+r.model,function(t){null!==n.mHeroSk&&(n.mHeroSk.skeletonData=t,n.mHeroSk.setAnimation(0,"daiji",!0))}),this.mNameLbl.string=i.name,this.mQualitySp.spriteFrame=this.mQualitySFArr[a.quality],a.quality===y.HeroQuality.SSR&&c.default.Ins.LoadSpine("spine/guangquan",function(t){n&&n.mEfxSk&&n.mEfxSk.node.isValid&&(n.mEfxSk.skeletonData=t,n.mEfxSk.setAnimation(0,"animation",!0))}),this.mDescLbl.string=i.dialog,this.mBubbleNode.opacity=0,this.mBubbleNode.scale=0,null!==this.mBubbleTween&&this.mBubbleTween.stop(),this.mBubbleTween=cc.tween(this.mBubbleNode).delay(.5).call(function(){n.mBubbleNode.opacity=255}).to(.15,{scale:1}).start(),this.mItem.SetData(y.ItemType.Gold,l.default.Ins.mNewHeroGoldNum+""),this.mAnim.play()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),f.default.Subscribe(y.BCType.NewHeroShow_AppearEfx,this._OnMsg_ShowAppearEfx,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),f.default.Remove(y.BCType.NewHeroShow_AppearEfx,this._OnMsg_ShowAppearEfx,this)},e.prototype._OnMsg_ShowAppearEfx=function(){this.mAppearEfx.node.active=!0,this.mAppearEfx.setAnimation(0,"animation",!1)},e.prototype.Invoke_GetGold=function(){h.default.PlayBtnSound(),p.default.Ins.UpdateItem(y.ItemType.Gold,l.default.Ins.mNewHeroGoldNum),p.default.Ins.Save(),null===this._closeCallback&&u.default.Ins.Open(y.WinType.GetRewardsWin,function(t){t.SetDataSingle(y.ItemType.Gold,l.default.Ins.mNewHeroGoldNum+"")}),this.CloseWin()},e.prototype.Invoke_DoubleGold=function(){h.default.PlayBtnSound(),g.default.WatchADForRewards(this._ADCallback.bind(this),m.ADUnitID.CommonVideoID_30,y.ADPoint.NewHeroGold)},e.prototype._ADCallback=function(t){var e=l.default.Ins.mNewHeroGoldNum*this.mMultiple;p.default.Ins.UpdateItem(y.ItemType.Gold,e),t&&p.default.Ins.GetADExtraRewards(),u.default.Ins.Open(y.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(y.ItemType.Gold,e+""):n.SetDataSingle(y.ItemType.Gold,e+"")},!1,function(){}),p.default.Ins.Save(),this.CloseWin()},i([_([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([_(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([_(cc.Label)],e.prototype,"mNameLbl",void 0),i([_(cc.Label)],e.prototype,"mDescLbl",void 0),i([_(cc.Node)],e.prototype,"mBubbleNode",void 0),i([_(sp.Skeleton)],e.prototype,"mHeroSk",void 0),i([_(sp.Skeleton)],e.prototype,"mEfxSk",void 0),i([_(sp.Skeleton)],e.prototype,"mAppearEfx",void 0),i([_(s.default)],e.prototype,"mItem",void 0),i([_(cc.Animation)],e.prototype,"mAnim",void 0),i([S],e)}(a.default);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyHero":"ProxyHero","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],OfficeLoopItem:[function(t,e,o){"use strict";cc._RF.push(e,"1a1d2RcFPpLn4SznzyNFQhe","OfficeLoopItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("./LoopScrollItem"),l=t("../../Proxy/ProxyOffice"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mNameLbl=null,e.mTargetLbl=null,e.mItem=null,e.mHasGotNode=null,e.mNotGotNode=null,e.mWin=null,e}return r(e,t),e.prototype.Init=function(t,e){this.mIdx=t,this.mWin=e,this.UpdateUI()},e.prototype.UpdateUI=function(){var t=l.default.Ins.mIDMap.get(this.mIdx+1);this.mIcon.spriteFrame=this.mWin.mIconSFArr[Number(t.icon)-1],this.mNameLbl.string=t.name,this.mTargetLbl.string="\u901a\u8fc7\u5173\u5361\uff1a"+t.level,this.mItem.SetData(t.rewards[0],t.rewards[1]);var e=l.default.Ins.mOfficeInfo;e.title>t.title||e.title===t.title&&e.step>=t.step?(this.mHasGotNode.opacity=255,this.mNotGotNode.opacity=0):(this.mHasGotNode.opacity=0,this.mNotGotNode.opacity=255)},i([p(cc.Sprite)],e.prototype,"mIcon",void 0),i([p(cc.Label)],e.prototype,"mNameLbl",void 0),i([p(cc.Label)],e.prototype,"mTargetLbl",void 0),i([p(a.default)],e.prototype,"mItem",void 0),i([p(cc.Node)],e.prototype,"mHasGotNode",void 0),i([p(cc.Node)],e.prototype,"mNotGotNode",void 0),i([u],e)}(s.default);o.default=c,cc._RF.pop()},{"../../Proxy/ProxyOffice":"ProxyOffice","./LoopScrollItem":"LoopScrollItem","./SimpleItem":"SimpleItem"}],OfficeLvNode:[function(t,e,o){"use strict";cc._RF.push(e,"8ec5bZHO+9OuZk2YHt90/Y8","OfficeLvNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLvSp=null,e.mStarActiveAnim=null,e.mCallback=null,e.mWin=null,e}return r(e,t),e.prototype.Init=function(t){this.mWin=t,this.mStarActiveAnim.setEventListener(this._OnAnimEvent.bind(this)),this.mStarActiveAnim.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype._OnAnimEvent=function(t,e){"chuxian"==e.data.name&&null!==this.mCallback&&(this.SetActive(!0),this.mCallback(),this.mCallback=null)},e.prototype._OnAnimCompleted=function(){this.mStarActiveAnim.node.active=!1},e.prototype.SetActive=function(t){this.mLvSp.spriteFrame=t?this.mWin.mFullSF:this.mWin.mEmptySF},e.prototype.PlayShowAnim=function(t){this.mStarActiveAnim.node.active=!0,this.mStarActiveAnim.setAnimation(0,"animation",!1),this.mCallback=t},i([l(cc.Sprite)],e.prototype,"mLvSp",void 0),i([l(sp.Skeleton)],e.prototype,"mStarActiveAnim",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],OfficePreviewWin:[function(t,e,o){"use strict";cc._RF.push(e,"af783/wVCFLM7twIYW2fyhH","OfficePreviewWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/LoopScrollView"),l=t("../../Proxy/ProxyOffice"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIconSFArr=[],e.mLoopSV=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mLoopSV.Initialize(l.default.Ins.mIDMap.size-1,this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask,this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},i([p([cc.SpriteFrame])],e.prototype,"mIconSFArr",void 0),i([p(s.default)],e.prototype,"mLoopSV",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Proxy/ProxyOffice":"ProxyOffice","../Comp/LoopScrollView":"LoopScrollView","./WinBase":"WinBase"}],OfficeUpgradeWin:[function(t,e,o){"use strict";cc._RF.push(e,"d1868NA0TdK85H+BUYCstwD","OfficeUpgradeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyOffice"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/SwitchConfig"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mNameLbl=null,e.mItem=null,e.mOriLblArr=[],e.mCurLblArr=[],e.mGoldLbl=null,e.mGetTypeSp=null,e.mAnim=null,e.mUpAnim=null,e.mBottomAnim=null,e.mGetType=h.GetRewardsType.AD,e.mCurData=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){var e=this;t.prototype._OnFirstOpen.call(this),this.mGetType=h.GetRewardsType.AD,f.default.mForceGetRewardsType!==h.GetRewardsType.Default&&(this.mGetType=f.default.mForceGetRewardsType),c.default.Ins.LoadGetTypeSp(this.mGetType,this.mGetTypeSp),this.mUpAnim.node.scale=0,this.mBottomAnim.node.scale=0,this.scheduleOnce(function(){e.mUpAnim.play("btnAppear",0)},2),this.scheduleOnce(function(){e.mBottomAnim.play("btnAppear",0)},2.5)},e.prototype.SetData=function(t,e){var o=l.default.Ins.mOfficeInfo,n=l.default.Ins.GetData(t,e),r=l.default.Ins.GetData(o.title,o.step);this.mCurData=r;var i=n.attr,a=r.attr;this.mNameLbl.string=r.name,c.default.Ins.LoadSpriteFrame(r.atlas,r.icon,this.mIcon,null);for(var s=0,m=this.mOriLblArr.length;s<m;++s)s!==m-1?(this.mOriLblArr[s].string="+"+i[s]+"%",this.mCurLblArr[s].string="+"+a[s]+"%"):(this.mOriLblArr[s].string=i[s]+"\u5143\u5b9d",this.mCurLblArr[s].string=a[s]+"\u5143\u5b9d");this.mGoldLbl.string="x"+r.shareRewards[1],this.mItem.SetData(r.rewards[0],r.rewards[1]),this.mAnim.play("officeUpgradeWin",0)},e.prototype.Invoke_Confirm=function(){d.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_GetRewards=function(){d.default.PlayBtnSound(),y.default.WatchADForRewards(this._Callback.bind(this),m.ADUnitID.CommonVideoID_15,h.ADPoint.OfficeShare,this.mGetType)},e.prototype._Callback=function(t){t&&p.default.Ins.GetADExtraRewards();var e=this.mCurData.shareRewards[1];p.default.Ins.UpdateItem(h.ItemType.Gold,e),u.default.Ins.Open(h.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(h.ItemType.Gold,e):n.SetDataSingle(h.ItemType.Gold,e)}),p.default.Ins.Save(),this.CloseWin()},i([S(cc.Sprite)],e.prototype,"mIcon",void 0),i([S(cc.Label)],e.prototype,"mNameLbl",void 0),i([S(s.default)],e.prototype,"mItem",void 0),i([S([cc.Label])],e.prototype,"mOriLblArr",void 0),i([S([cc.Label])],e.prototype,"mCurLblArr",void 0),i([S(cc.Label)],e.prototype,"mGoldLbl",void 0),i([S(cc.Sprite)],e.prototype,"mGetTypeSp",void 0),i([S(cc.Animation)],e.prototype,"mAnim",void 0),i([S(cc.Animation)],e.prototype,"mUpAnim",void 0),i([S(cc.Animation)],e.prototype,"mBottomAnim",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyOffice":"ProxyOffice","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],OfficeWin:[function(t,e,o){"use strict";cc._RF.push(e,"71ea3SQYUtITpsajtuCdkX6","OfficeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../Comp/OfficeLvNode"),m=t("../../Proxy/ProxyOffice"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mNameLbl=null,e.mPb=null,e.mPbLbl=null,e.mAttrLblArr=[],e.mItem=null,e.mStarRoot=null,e.mStarSpTemplate=null,e.mStarSFArr=[],e.mInsPanelNode=null,e.mInsPanelMask=null,e.mUpgradeHintNode=null,e.mDailyRewardsPanelNode=null,e.mEmptySF=null,e.mFullSF=null,e.mStepPanel=null,e.mEvolveSk=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mStarItemArr=[],e.mCurData=null,e.mStarCellWidth=30,e.mWaitUpgrading=!1,e.mOriTitle=0,e.mOriStep=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mInsPanelNode.active=!1,this.mDailyRewardsPanelNode.active=!1,this.mInsPanelMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickInsPanelMask,this),this._UpdateUI(),this.mEvolveSk.setEventListener(this._OnSpineAnimEvent.bind(this)),this.mEvolveSk.setCompleteListener(this._OnSpineAnimCompleted.bind(this)),this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&y.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnEvent_ClickInsPanelMask=function(){this.mInsPanelNode.active=!1},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mWaitUpgrading=!1,this.mStepPanel.active=!1,this._UpdateState()},e.prototype._UpdateUI=function(){var t=m.default.Ins.mOfficeInfo;this.mCurData=m.default.Ins.GetData(t.title,t.step),c.default.Ins.LoadSpriteFrame(this.mCurData.atlas,this.mCurData.icon,this.mIcon,null),this.mNameLbl.string=this.mCurData.name;for(var e=this.mCurData.attr,o=0,n=this.mAttrLblArr.length;o<n;++o)this.mAttrLblArr[o].string=o!==n-1?"+"+e[o]+"%":e[o]+"\u5143\u5b9d";var r=m.default.Ins.GetNextData(t.title,t.step);if(r){var i=r.rewards;this.mItem.SetData(i[0],i[1])}else this.mItem.node.active=!1;var a=m.default.Ins.GetStepCountByTitle(t.title),s=a-this.mStarItemArr.length;for(o=0;o<s;++o){var u=cc.instantiate(this.mStarSpTemplate.node);u.parent=this.mStarRoot;var p=u.getComponent(l.default);p.Init(this),this.mStarItemArr.push(p)}if(1===a)this.mStarRoot.opacity=0;else for(this.mStarRoot.opacity=255,o=0;o<a;++o)this.mStarItemArr[o].node.active=!0,o<t.step?this.mStarItemArr[o].mLvSp.spriteFrame=this.mStarSFArr[1]:this.mStarItemArr[o].mLvSp.spriteFrame=this.mStarSFArr[0],this.mStarItemArr[o].node.position=cc.v3(o*this.mStarCellWidth-.5*this.mStarCellWidth*(a-1),0,0)},e.prototype._UpdateState=function(){var t=p.default.Ins.ClientInfo,e=m.default.Ins.mOfficeInfo,o=m.default.Ins.GetNextData(e.title,e.step),n=this.mCurData;if(o&&(n=o),this.mPb.progress=(t.bestLevel-1)/n.level,this.mPbLbl.string="\u6700\u9ad8\u901a\u5173\uff1a"+(t.bestLevel-1)+"/"+n.level,0===e.dailyRewardState&&0!==this.mCurData.attr[m.OfficeAttrType.Gold-1]?this.mDailyRewardsPanelNode.active=!0:this.mDailyRewardsPanelNode.active=!1,o){var r=p.default.Ins.ClientInfo.bestLevel-1,i=o.level;this.mUpgradeHintNode.active=!(r<i)}else this.mUpgradeHintNode.active=!1},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(h.BCType.Office_Upgraded,this._OnMsg_UpgradeOffice,this),d.default.Subscribe(h.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(h.BCType.Office_Upgraded,this._OnMsg_UpgradeOffice,this),d.default.Remove(h.BCType.Fight_PassBestLevel,this._OnMsg_PassBestLevel,this)},e.prototype._OnSpineAnimCompleted=function(){this.mWaitUpgrading=!1,this.mEvolveSk.node.active=!1,this.mStepPanel.active=!1},e.prototype._OnSpineAnimEvent=function(t,e){var o=this;"appear"==e.data.name&&(m.default.Ins.UpgradeLv(),u.default.Ins.Open(h.WinType.OfficeUpgradeWin,function(t){t.SetData(o.mOriTitle,o.mOriStep)}))},e.prototype._OnMsg_UpgradeOffice=function(){this._UpdateUI(),this._UpdateState()},e.prototype._OnMsg_PassBestLevel=function(){var t=p.default.Ins.ClientInfo,e=m.default.Ins.mOfficeInfo,o=m.default.Ins.GetNextData(e.title,e.step),n=this.mCurData;if(o&&(n=o),this.mPb.progress=(t.bestLevel-1)/n.level,this.mPbLbl.string="\u6700\u9ad8\u901a\u5173\uff1a"+(t.bestLevel-1)+"/"+n.level,o){var r=p.default.Ins.ClientInfo.bestLevel-1,i=o.level;this.mUpgradeHintNode.active=!(r<i)}else this.mUpgradeHintNode.active=!1},e.prototype.Invoke_Preview=function(){f.default.PlayBtnSound(),u.default.Ins.Open(h.WinType.OfficePreviewWin,null)},e.prototype.Invoke_Ins=function(){f.default.PlayBtnSound(),this.mInsPanelNode.active=!0},e.prototype.Invoke_ClickIcon=function(){if(f.default.PlayBtnSound(),!this.mWaitUpgrading){var t=m.default.Ins.mOfficeInfo,e=m.default.Ins.GetNextData(t.title,t.step);if(e)if(p.default.Ins.ClientInfo.bestLevel-1<e.level)u.default.Ins.ShowTips("\u901a\u5173\u6307\u5b9a\u5173\u5361\u624d\u80fd\u8fdb\u9636\u5b98\u804c\u54e6~");else{var o=this,n=t.title,r=t.step,i=m.default.Ins.GetStepCountByTitle(n);this.mWaitUpgrading=!0,r===i?(this.mOriTitle=n,this.mOriStep=r,this.mStepPanel.active=!0,this.mEvolveSk.node.active=!0,this.mEvolveSk.setAnimation(0,"animation",!1)):this.mStarItemArr[r].PlayShowAnim(function(){o.mWaitUpgrading=!1,m.default.Ins.UpgradeLv(),u.default.Ins.Open(h.WinType.OfficeUpgradeWin,function(t){t.SetData(n,r)})})}else u.default.Ins.ShowTips("\u606d\u559c\u4e3b\u516c\uff0c\u5df2\u7ecf\u8fbe\u5230\u6700\u9ad8\u5b98\u804c\u5566\uff01")}},e.prototype.Invoke_Close=function(){f.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_GetDailyRewards=function(){f.default.PlayBtnSound(),m.default.Ins.GetDailyRewards(),this.mDailyRewardsPanelNode.active=!1},i([S(cc.Sprite)],e.prototype,"mIcon",void 0),i([S(cc.Label)],e.prototype,"mNameLbl",void 0),i([S(cc.ProgressBar)],e.prototype,"mPb",void 0),i([S(cc.Label)],e.prototype,"mPbLbl",void 0),i([S([cc.Label])],e.prototype,"mAttrLblArr",void 0),i([S(s.default)],e.prototype,"mItem",void 0),i([S(cc.Node)],e.prototype,"mStarRoot",void 0),i([S(cc.Sprite)],e.prototype,"mStarSpTemplate",void 0),i([S([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([S(cc.Node)],e.prototype,"mInsPanelNode",void 0),i([S(cc.Node)],e.prototype,"mInsPanelMask",void 0),i([S(cc.Node)],e.prototype,"mUpgradeHintNode",void 0),i([S(cc.Node)],e.prototype,"mDailyRewardsPanelNode",void 0),i([S(cc.SpriteFrame)],e.prototype,"mEmptySF",void 0),i([S(cc.SpriteFrame)],e.prototype,"mFullSF",void 0),i([S(cc.Node)],e.prototype,"mStepPanel",void 0),i([S(sp.Skeleton)],e.prototype,"mEvolveSk",void 0),i([S(cc.Node)],e.prototype,"mCloseBtn",void 0),i([S(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyOffice":"ProxyOffice","../Comp/OfficeLvNode":"OfficeLvNode","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],OfflineCoinWin:[function(t,e,o){"use strict";cc._RF.push(e,"e0fc4xWvntJ8aFcPfFtBYYj","OfflineCoinWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/AudioMgr"),l=t("../../Common/Common"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOfflineTimeLbl=null,e.mCoinRoot=null,e.mLevelRoot=null,e.mCoinNumLbl=null,e.mLevelNumLbl=null,e.mBtnNode=null,e.mCallback=null,e.mCoinNum=null,e}return r(e,t),e.prototype.SetData=function(t,e,o,n){this.mCallback=n,this.mCoinNum=t,this.mOfflineTimeLbl.string=l.default.FormatTimeBySeconds(Math.floor(o)),this.mCoinNumLbl.string=t.ToString(1),this.mLevelNumLbl.string=e+"",e<=0&&(this.mLevelRoot.opacity=0,this.mCoinRoot.x=0)},e.prototype.Invoke_OK=function(){s.default.PlayBtnSound(),null!==this.mCallback&&this.mCallback(),this.CloseWin();var t=this.mBtnNode.parent.convertToWorldSpaceAR(this.mBtnNode.position);l.default.GetFlyCoin(this.mCoinNum,cc.v2(t),10)},i([p(cc.Label)],e.prototype,"mOfflineTimeLbl",void 0),i([p(cc.Node)],e.prototype,"mCoinRoot",void 0),i([p(cc.Node)],e.prototype,"mLevelRoot",void 0),i([p(cc.Label)],e.prototype,"mCoinNumLbl",void 0),i([p(cc.Label)],e.prototype,"mLevelNumLbl",void 0),i([p(cc.Node)],e.prototype,"mBtnNode",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/AudioMgr":"AudioMgr","./WinBase":"WinBase"}],OfflineLevelPanel:[function(t,e,o){"use strict";cc._RF.push(e,"e9b4dBkgZ1MIIG0Ij25wNLA","OfflineLevelPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyOffline"),s=t("../../Manager/UserMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/DataMgr"),u=t("../../Common/Common"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLevelSpeedRT=null,e.mHighestLevelRT=null,e.mTipsRT=null,e.mMask=null,e}return r(e,t),e.prototype.Open=function(t){this.node.active=!0;var e=a.default.Ins.mOfflinePassLevelSpeed;this.mLevelSpeedRT.string="<color=ff0000>"+parseFloat(e.toFixed(1))+"</color>\u5173/\u5206\u949f\uff08<color=ff0000>"+parseFloat((60*e).toFixed(1))+"</color>\u5173/\u5c0f\u65f6\uff09";var o=s.default.Ins.ClientInfo,n=t-o.curLevel,r="";if(n>0){var i=Math.floor(n/a.default.Ins.mOfflinePassLevelSpeed);i>0&&(r="\uff08"+u.default.FormatTimeBySeconds(60*i)+"\u540e\u5230\u8fbe\uff09")}this.mHighestLevelRT.string="<color=ff0000>"+t+"</color>/"+o.bestLevel+r;var p="",c="";if(t>m.default.Ins.mNoLimitCampLevelNum){var d=a.default.Ins.GetNextLimitCamp(t);p="<img src='"+l.default.Ins.mCampSFArr[d]+"' height=30/>";var f=a.default.Ins.GetCanReachLevelByCamp(d);c="\uff0c\u9700\u8981\u7b49\u7ea7<color=ff0000>+"+(100*Math.ceil(t/100)-f+1)+"</color>\u3002"}this.mTipsRT.string="\u5347\u7ea7\u4f60\u6700\u5f3a\u7684"+p+"\u6b66\u5c06\u4ee5\u63d0\u9ad8\u79bb\u7ebf\u65f6\u7684\u6700\u9ad8\u5173\u5361"+c,this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_Click,this)},e.prototype._OnEvent_Click=function(){this.node.active=!1},i([d(cc.RichText)],e.prototype,"mLevelSpeedRT",void 0),i([d(cc.RichText)],e.prototype,"mHighestLevelRT",void 0),i([d(cc.RichText)],e.prototype,"mTipsRT",void 0),i([d(cc.Node)],e.prototype,"mMask",void 0),i([c],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyOffline":"ProxyOffline"}],OfflineMedalWin:[function(t,e,o){"use strict";cc._RF.push(e,"4c2092iKTZDg7IxWKU1QlQE","OfflineMedalWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyOffline"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Platform/PlatformBase"),p=t("../../Manager/WinMgr"),c=t("../../Manager/UserMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOfflineTimeLbl=null,e.mAddLbl=null,e.mLimitTimeLbl=null,e.mMedalItem=null,e.mAddNode=null,e.mTimeNode=null,e.mAddHintPanel=null,e.mTimeHintPanel=null,e.mAddRateRT=null,e.mTimeLimitRT=null,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);var e=l.default.Ins.mCurOfflineMedalMinTime,o=(e/60).toFixed(1)+"\u5c0f\u65f6";this.mLimitTimeLbl.string=o;var n=l.default.Ins.mOfflineTime,r=60*e;n>r&&(n=r),this.mOfflineTimeLbl.string=h.default.FormatTimeBySeconds(n),this.mAddLbl.string="+"+(100*(l.default.Ins.mOfflineMedalAddRate-1)).toFixed()+"%";var i=m.default.FormatNumber(l.default.Ins.mOfflineMedalNum,1);this.mMedalItem.SetData(f.ItemType.Medal,i),this.mAddRateRT.string="\u52cb\u7ae0\u5956\u52b1\u6570\u91cf\u63d0\u5347<color=ff0000>"+(100*(l.default.Ins.mOfflineMedalAddRate-1)).toFixed()+"%</color>\u3002<br/>\u63d0\u5347<color=ff0000>\u5b98\u804c</color>\u53ef\u4ee5\u63d0\u9ad8\u52a0\u6210",this.mTimeLimitRT.string="<color=ff0000>"+o+"\u540e</color>\u79bb\u7ebf\u6536\u76ca\u4f1a\u6682\u505c\u3002<br/>\u63d0\u5347<color=ff0000>\u5b98\u804c</color>\u53ef\u4ee5\u63d0\u9ad8\u4e0a\u9650",this.mAddNode.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_AddRateTouchStart,this),this.mAddNode.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_AddRateTouchEnd,this),this.mAddNode.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_AddRateTouchCancel,this),this.mTimeNode.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_TimeLimitTouchStart,this),this.mTimeNode.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_TimeLimitTouchEnd,this),this.mTimeNode.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_TimeLimitTouchCancel,this)},e.prototype._OnNodeEvent_AddRateTouchStart=function(){this.mAddHintPanel.opacity=255},e.prototype._OnNodeEvent_AddRateTouchEnd=function(){this.mAddHintPanel.opacity=0},e.prototype._OnNodeEvent_AddRateTouchCancel=function(){this.mAddHintPanel.opacity=0},e.prototype._OnNodeEvent_TimeLimitTouchStart=function(){this.mTimeHintPanel.opacity=255},e.prototype._OnNodeEvent_TimeLimitTouchEnd=function(){this.mTimeHintPanel.opacity=0},e.prototype._OnNodeEvent_TimeLimitTouchCancel=function(){this.mTimeHintPanel.opacity=0},e.prototype.Invoke_NormalGet=function(){d.default.PlayBtnSound(),this.CloseWin(),c.default.Ins.UpdateItem(f.ItemType.Medal,l.default.Ins.mOfflineMedalNum),p.default.Ins.Open(f.WinType.GetRewardsWin,function(t){t.SetDataSingle(f.ItemType.Medal,m.default.FormatNumber(l.default.Ins.mOfflineMedalNum,1))}),c.default.Ins.Save()},e.prototype.Invoke_ADGet=function(){d.default.PlayBtnSound(),h.default.WatchADForRewards(this._OnADGetRewards.bind(this),u.ADUnitID.CommonVideoID_15,f.ADPoint.OfflineDoubleMedal)},e.prototype._OnADGetRewards=function(t){var e=2*l.default.Ins.mOfflineMedalNum;c.default.Ins.UpdateItem(f.ItemType.Medal,e),t&&c.default.Ins.GetADExtraRewards(),p.default.Ins.Open(f.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(f.ItemType.Medal,m.default.FormatNumber(e,1)):n.SetDataSingle(f.ItemType.Medal,m.default.FormatNumber(e,1))}),c.default.Ins.Save(),this.CloseWin()},i([I(cc.Label)],e.prototype,"mOfflineTimeLbl",void 0),i([I(cc.Label)],e.prototype,"mAddLbl",void 0),i([I(cc.Label)],e.prototype,"mLimitTimeLbl",void 0),i([I(s.default)],e.prototype,"mMedalItem",void 0),i([I(cc.Node)],e.prototype,"mAddNode",void 0),i([I(cc.Node)],e.prototype,"mTimeNode",void 0),i([I(cc.Node)],e.prototype,"mAddHintPanel",void 0),i([I(cc.Node)],e.prototype,"mTimeHintPanel",void 0),i([I(cc.RichText)],e.prototype,"mAddRateRT",void 0),i([I(cc.RichText)],e.prototype,"mTimeLimitRT",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyOffline":"ProxyOffline","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],OnAnimEvent:[function(t,e,o){"use strict";cc._RF.push(e,"6eaa0o8awZHRYUhvFJK/QRZ","OnAnimEvent");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/BCMgr"),s=t("../../Manager/AudioMgr"),l=cc._decorator,m=l.ccclass,u=(l.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onAudio=function(t){s.default.PlaySFX(t,!0)},e.prototype.onEvent=function(t){a.default.Dispatch(t)},i([m],e)}(cc.Component));o.default=u,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr"}],PCPlatform:[function(t,e,o){"use strict";cc._RF.push(e,"c4742SbxYBH5KCaKB7iS1zX","PCPlatform");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Manager/SaveMgr"),a=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.NeedShowPrivacy=function(){return!0},e.prototype.Login=function(t){var e,o=cc.sys.localStorage.getItem("localplayerid"),n=0;o?(e=o,n=0):(e=Math.floor(1e4*Math.random())+"-"+(new Date).getTime(),cc.sys.localStorage.setItem("localplayerid",e),n=1);var r=(new Date).getTime(),a=i.default.Get(i.default.LOCAL_OFFLINE_TIME);a&&(r=a),t({ret:0,isNewUser:1===n,systemTime:(new Date).getTime(),lastLogoutTime:r/1e3})},e.prototype.WatchAd=function(t,e,o,n,r){void 0===r&&(r=null),o&&o(!0),r&&r()},e.prototype.Share=function(t){t&&t(!0)},e}(t("./PlatformBase").default);o.default=a,cc._RF.pop()},{"../Manager/SaveMgr":"SaveMgr","./PlatformBase":"PlatformBase"}],PassiveAddAttr:[function(t,e,o){"use strict";cc._RF.push(e,"cd711SGkz1JObDaGD4FMes9","PassiveAddAttr");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return t.call(this)||this}return r(e,t),e}(t("./PassiveEffectBase").default);o.default=i,cc._RF.pop()},{"./PassiveEffectBase":"PassiveEffectBase"}],PassiveCheckBase:[function(t,e,o){"use strict";cc._RF.push(e,"8bca2Ht1cJKkINVV+4jm7xC","PassiveCheckBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.mOwnerEntity=null,this.mPassiveSkill=null}return t.prototype.Init=function(t,e){this.mOwnerEntity=t,this.mPassiveSkill=e,this._InitOnce()},t.prototype._InitOnce=function(){},t.prototype.Check=function(){return!1},t.prototype.Reset=function(){},t}();o.default=n,cc._RF.pop()},{}],PassiveCheckTimes:[function(t,e,o){"use strict";cc._RF.push(e,"cb590wkj0lEfIEXG4wPqWm4","PassiveCheckTimes");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("../../../../Common/Common"),a=function(t){function e(){var e=t.call(this)||this;return e.mCurCheckTimes=0,e.mMinTimes=0,e.mMaxTimes=0,e}return r(e,t),e.prototype._InitOnce=function(){var t=this.mPassiveSkill.mData.checkParam;this.mMinTimes=Number(t[0]),this.mMaxTimes=Number(t[1]),this.mCurCheckTimes=i.default.GetRandIntValueBetween(this.mMinTimes,this.mMaxTimes,!0)},e.prototype.Check=function(){return this.mCurCheckTimes--,this.mCurCheckTimes<=0&&(this.mCurCheckTimes=i.default.GetRandIntValueBetween(this.mMinTimes,this.mMaxTimes,!0),!0)},e}(t("./PassiveCheckBase").default);o.default=a,cc._RF.pop()},{"../../../../Common/Common":"Common","./PassiveCheckBase":"PassiveCheckBase"}],PassiveEffectBase:[function(t,e,o){"use strict";cc._RF.push(e,"d39b9gzabxD572qcUOt1PgG","PassiveEffectBase"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.mOwnerEntity=null,this.mPassiveSkill=null}return t.prototype.Init=function(t,e){this.mOwnerEntity=t,this.mPassiveSkill=e},t.prototype.Trigger=function(){},t}();o.default=n,cc._RF.pop()},{}],PassiveSkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"ad375PIiMNDa5IZGdiqcuWP","PassiveSkillCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./PassiveSkill"),r=t("../../../Proxy/ProxyHero"),i=t("../../../Manager/DataMgr"),a=t("../../../Common/EnumsDefine"),s=function(){function t(t){this.mOwnerEntity=null,this.mOwnerEntity=t,this.InitOnce()}return t.prototype.InitOnce=function(){this.mPassiveMap=new Map;var t=this.mOwnerEntity.mEntityData.passiveSkills,e=null;this.mOwnerEntity.mEntityType===a.EntityType.Hero&&(e=r.default.Ins.GetHeroSI(this.mOwnerEntity.mEntityID));for(var o=0,n=t.length;o<n;++o){var i=t[o];0!==i&&(null!==e?e.starLv-1>o&&this.AddPassiveSkill(i):this.AddPassiveSkill(i))}},t.prototype.AddPassiveSkill=function(t){var e=i.default.Ins.m_DB.passiveDB[t];if(e){var o=this.mPassiveMap.get(e.checkTimeType);void 0===o&&(o=[],this.mPassiveMap.set(e.checkTimeType,o));var r=new n.default;r.InitOnce(this,e),null!==r&&o.push(r)}},t.prototype.Reset=function(){this.mPassiveMap.forEach(function(t){for(var e=0,o=t.length;e<o;++e)t[e].Reset()})},t.prototype.End=function(){this.mPassiveMap.forEach(function(t){for(var e=0,o=t.length;e<o;++e)t[e].End()})},t.prototype.CheckPassive=function(t){var e=this.mPassiveMap.get(t);if(e)for(var o=0,n=e.length;o<n;++o)e[o].Check()},t}();o.default=s,cc._RF.pop()},{"../../../Common/EnumsDefine":"EnumsDefine","../../../Manager/DataMgr":"DataMgr","../../../Proxy/ProxyHero":"ProxyHero","./PassiveSkill":"PassiveSkill"}],PassiveSkillFactory:[function(t,e,o){"use strict";cc._RF.push(e,"87af2tBkolNiq9TEfK4/DzG","PassiveSkillFactory"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./Effect/PassiveUseSkill"),r=t("./Effect/PassiveAddAttr"),i=t("./Check/PassiveCheckTimes"),a=t("../../../Common/EnumsDefine"),s=function(){function t(){}return t.CreatePassiveCheck=function(t){var e=null;switch(t){case a.PassiveCheckLogicType.Times:e=new i.default}return e},t.CreatePassiveEffect=function(t){var e=null;switch(t){case a.PassiveEffectType.UseSkill:e=new n.default;break;case a.PassiveEffectType.AddAttr:e=new r.default}return null===e&&console.error("\u4e0d\u5b58\u5728\u8fd9\u79cd\u68c0\u6d4b\u7c7b\u578b_Effect: "+t),e},t}();o.default=s,cc._RF.pop()},{"../../../Common/EnumsDefine":"EnumsDefine","./Check/PassiveCheckTimes":"PassiveCheckTimes","./Effect/PassiveAddAttr":"PassiveAddAttr","./Effect/PassiveUseSkill":"PassiveUseSkill"}],PassiveSkill:[function(t,e,o){"use strict";cc._RF.push(e,"9aa9ex+TYhEibraMHg+wwA1","PassiveSkill"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./PassiveSkillFactory"),r=function(){function t(){this.mData=null,this.mPassiveCtrl=null,this.mPassiveCheck=null,this.mPassiveEffect=null}return t.prototype.InitOnce=function(t,e){this.mData=e,this.mPassiveCtrl=t,this.mPassiveCheck=n.default.CreatePassiveCheck(e.checkLogicType),null!==this.mPassiveCheck&&this.mPassiveCheck.Init(t.mOwnerEntity,this),this.mPassiveEffect=n.default.CreatePassiveEffect(e.effectType),null!==this.mPassiveEffect&&this.mPassiveEffect.Init(t.mOwnerEntity,this)},t.prototype.Reset=function(){null!==this.mPassiveCheck&&this.mPassiveCheck.Reset()},t.prototype.Check=function(){var t=!1;return null!==this.mPassiveCheck&&(t=this.mPassiveCheck.Check()),t&&this.Trigger(),t},t.prototype.Trigger=function(){null!==this.mPassiveEffect&&this.mPassiveEffect.Trigger()},t.prototype.OnUpdate=function(){},t.prototype.End=function(){},t}();o.default=r,cc._RF.pop()},{"./PassiveSkillFactory":"PassiveSkillFactory"}],PassiveUseSkill:[function(t,e,o){"use strict";cc._RF.push(e,"4323fYvq+pMhotognir8DRt","PassiveUseSkill");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.Trigger=function(){t.prototype.Trigger.call(this),this.mOwnerEntity.mNextSkillID=Number(this.mPassiveSkill.mData.effectParam[0])},e}(t("./PassiveEffectBase").default);o.default=i,cc._RF.pop()},{"./PassiveEffectBase":"PassiveEffectBase"}],PictureHeroIcon:[function(t,e,o){"use strict";cc._RF.push(e,"5833dDPJ7FJ4ZbPTa1cIR2m","PictureHeroIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0}),o.HeroPictureMode=void 0;var a,s=t("./RedPointNormal"),l=t("../../Proxy/ProxyHero"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Common/EnumsDefine");(function(t){t[t.Bag=0]="Bag",t[t.Lottery=1]="Lottery"})(a=o.HeroPictureMode||(o.HeroPictureMode={}));var d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mQualitySp2=null,e.mSPTag=null,e.mIcon=null,e.mStarSp=null,e.mRareTag=null,e.mNewTag=null,e.mFightTag=null,e.mNameLbl=null,e.mFragmentLbl=null,e.mFragmentPB=null,e.mActiveHintNode=null,e.mHeroPoint=null,e.mOwnerWin=null,e.mHeroSI=null,e.mHeroData=null,e.mHeroID=0,e.mOwnState=!0,e.mCallback=null,e.mCurMode=a.Bag,e.mActiveColor=new cc.Color(255,255,255,255),e.mGrayColor=new cc.Color(88,88,88,255),e.mDefaultColor=new cc.Color(168,96,38,255),e.mColorArr=[new cc.Color(73,82,172,255),new cc.Color(147,54,200,255),new cc.Color(139,81,39,255),new cc.Color(183,54,151,255)],e}return r(e,t),e.prototype.SetData=function(t,e){this.mHeroID=t,this.mOwnerWin=e,this.mHeroData=p.default.Ins.m_DB.heroCardDB[t],this.mHeroSI=l.default.Ins.GetHeroSI(t);var o=this.mHeroData.baseQuality,n=0;null!==this.mHeroSI&&(o=this.mHeroSI.heroQuality,n=this.mHeroSI.starLv),u.default.Ins.LoadItemSprite(t,this.mIcon),0===n?this.mStarSp.node.opacity=0:(this.mStarSp.node.opacity=255,u.default.Ins.LoadHeroStarSprite(n,this.mStarSp)),this.mNameLbl.string=this.mHeroData.name,this.mRareTag.opacity=1===this.mHeroData.rare?255:0;var r=m.default.Ins.GetItemNum(t);if(l.default.Ins.IsMax(t))this.mFragmentLbl.string=""+r,this.mFragmentPB.progress=1;else{var i=l.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,o,n);this.mFragmentLbl.string=r+"/"+i,this.mFragmentPB.progress=r/i}this.node.on(cc.Node.EventType.TOUCH_END,this._OnClickIcon,this),this.Update(),this.mHeroPoint.UpdatePointName("Main.Hero.Pack."+t)},e.prototype.Update=function(t){if(void 0===t&&(t=!1),this.mFightTag.opacity=l.default.Ins.CheckHeroInTeam(this.mHeroID)?255:0,this.mHeroSI=l.default.Ins.GetHeroSI(this.mHeroID),null!==this.mHeroSI)this.mOwnState&&!t||(this.mOwnState=!0,this._SetDefault(),this.mActiveHintNode.opacity=0);else if(this.mOwnState||t){this.mOwnState=!1,this._SetGray();var e=this.mHeroData.baseQuality,o=l.default.Ins.GetNeedFragment(e,e,0);m.default.Ins.GetItemNum(this.mHeroID)>=o&&(this.mActiveHintNode.opacity=255)}},e.prototype._SetDefault=function(){this.mIcon.node.color=this.mActiveColor,this.mStarSp.node.color=this.mActiveColor},e.prototype._SetGray=function(){this.mIcon.node.color=this.mGrayColor,this.mStarSp.node.color=this.mGrayColor},e.prototype._SetQuality=function(t){if(t===a.Bag){var e=this.mHeroData.baseQuality;null!==this.mHeroSI?(e=this.mHeroSI.heroQuality,this.mQualitySp.spriteFrame=this.mOwnerWin.mQuality1SFArr[l.default.MAX_QUALITY-e],this.mQualitySp2.spriteFrame=this.mOwnerWin.mQuality2SFArr[l.default.MAX_QUALITY-e]):(this.mQualitySp.spriteFrame=this.mOwnerWin.mGraySFArr[0],this.mQualitySp2.spriteFrame=this.mOwnerWin.mGraySFArr[1]),this.mNameLbl.node.color=this._GetColorByQuality(e),this.mSPTag.opacity=e==c.HeroQuality.SP?255:0}else e=this.mHeroData.baseQuality,this.mQualitySp.spriteFrame=this.mOwnerWin.mQuality1SFArr[l.default.MAX_QUALITY-e],this.mQualitySp2.spriteFrame=this.mOwnerWin.mQuality2SFArr[l.default.MAX_QUALITY-e],this.mSPTag.opacity=0,this.mNameLbl.node.color=this._GetColorByQuality(e)},e.prototype.SetMode=function(t){this.mCurMode=t,this._SetQuality(t),t===a.Bag?(this.Update(!0),this.mFragmentPB.node.opacity=255,this.mStarSp.node.opacity=255):(this._SetDefault(),this.mFragmentPB.node.opacity=0,this.mFightTag.opacity=0,this.mStarSp.node.opacity=0,this.mActiveHintNode.opacity=0)},e.prototype.SetCallback=function(t){this.mCallback=t},e.prototype.UpdateFragment=function(){this.mHeroSI=l.default.Ins.GetHeroSI(this.mHeroID);var t=this.mHeroData.baseQuality,e=0;null!==this.mHeroSI&&(t=this.mHeroSI.heroQuality,e=this.mHeroSI.starLv);var o=m.default.Ins.GetItemNum(this.mHeroID);if(l.default.Ins.IsMax(this.mHeroID))this.mFragmentLbl.string=""+o,this.mFragmentPB.progress=1;else{var n=l.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,t,e);this.mFragmentLbl.string=o+"/"+n,this.mFragmentPB.progress=o/n}},e.prototype.UpdateQuality=function(){this._SetQuality(this.mCurMode),this.UpdateFragment()},e.prototype.UpdateStar=function(){var t=0;this.mHeroSI=l.default.Ins.GetHeroSI(this.mHeroID),null!==this.mHeroSI&&(t=this.mHeroSI.starLv),0===t?this.mStarSp.node.opacity=0:(this.mStarSp.node.opacity=255,u.default.Ins.LoadHeroStarSprite(t,this.mStarSp)),this.UpdateFragment()},e.prototype._GetColorByQuality=function(t){return this.mColorArr[t]},e.prototype._OnClickIcon=function(){null!==this.mCallback&&this.mCallback()},i([h(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([h(cc.Sprite)],e.prototype,"mQualitySp2",void 0),i([h(cc.Node)],e.prototype,"mSPTag",void 0),i([h(cc.Sprite)],e.prototype,"mIcon",void 0),i([h(cc.Sprite)],e.prototype,"mStarSp",void 0),i([h(cc.Node)],e.prototype,"mRareTag",void 0),i([h(cc.Node)],e.prototype,"mNewTag",void 0),i([h(cc.Node)],e.prototype,"mFightTag",void 0),i([h(cc.Label)],e.prototype,"mNameLbl",void 0),i([h(cc.Label)],e.prototype,"mFragmentLbl",void 0),i([h(cc.ProgressBar)],e.prototype,"mFragmentPB",void 0),i([h(cc.Node)],e.prototype,"mActiveHintNode",void 0),i([h(s.default)],e.prototype,"mHeroPoint",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyHero":"ProxyHero","./RedPointNormal":"RedPointNormal"}],PlatformBase:[function(t,e,o){"use strict";cc._RF.push(e,"2b87bYdx31HaJ2+VpvZw9kt","PlatformBase"),Object.defineProperty(o,"__esModule",{value:!0}),o.ADUnitID=void 0;var n=function(){function t(){}return t.CommonBannerID="b60fe3d01acf51",t.CommonVideoID_15="b60ed81507d6a5",t.CommonVideoID_30="b60ed81507d6a5",t.CommonVideoID_60="b60ed81507d6a5",t.CommonVideoID="b60ed81507d6a5",t.WorkCoin="1",t.CommonVideo="2",t.Interstitial_Level_ID="1",t.Interstitial_Func_ID="2",t}();o.ADUnitID=n;var r=function(){function t(){}return t.prototype.AutoInterstitialAD=function(){return!1},t.prototype.NeedShowPrivacy=function(){return!1},t.prototype.RequestGameServer=function(t){null!==t&&t()},t.prototype.Login=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.Register=function(){},t.prototype.ReportPay=function(){},t.prototype.Share=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.prototype.PreloadVideoAd=function(t,e){void 0===e&&(e=null)},t.prototype.ReportEvent=function(){},t.prototype.ReportLevel=function(){},t.prototype.ReportTrackingEvent=function(){},t.prototype.ReportHuoShanEvent=function(t,e){void 0===e&&(e=null)},t.prototype.WatchAd=function(t,e,o,n,r){void 0===r&&(r=null)},t.prototype.ShowInterstitial=function(){},t.prototype.ShowIOSInterAD=function(){},t.prototype.ShowIOSFullAD=function(){},t.prototype.ShowTemplateInter=function(t){void 0===t&&(t=!1)},t.prototype.HideTemplateInter=function(){},t.prototype.ShowBanner=function(){},t.prototype.HideBanner=function(){},t.prototype.RefreshBanner=function(){},t.prototype.AgreePrivacy=function(){},t.prototype.ExitPrivacy=function(){},t.prototype.ShowExitWin=function(){},t.prototype.AddQQGroup=function(){return!1},t}();o.default=r,cc._RF.pop()},{}],PlatformMgr:[function(t,e,o){"use strict";cc._RF.push(e,"ee14amk3XhH25mgN2xhu5gy","PlatformMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.PlfTP=void 0;var n,r=t("../Platform/XiaoMiPlatform"),i=t("../Platform/XiaoMiChannelPlatform"),a=t("../Platform/WeChatPlf"),s=t("../Platform/TwoThreeThreePlf"),l=t("../Platform/PCPlatform"),m=t("../Platform/iOSPlatform"),u=t("../Common/SwitchConfig");(function(t){t.Local="Local",t.WeChat="WeChat",t.QQ="QQ",t.XiaoMi="XiaoMi",t.XiaoMiChannel="XiaoMiChannel",t.TwoThreeThree="TwoThreeThree",t.iOS="iOS"})(n=o.PlfTP||(o.PlfTP={}));var p=function(){function t(){}return t.Init=function(){switch(u.default.mCurPlatformType){case n.Local:this.mCurPlf=new l.default;break;case n.WeChat:this.mCurPlf=new a.default;break;case n.XiaoMi:this.mCurPlf=new r.default;break;case n.XiaoMiChannel:this.mCurPlf=new i.default;break;case n.iOS:this.mCurPlf=new m.default;break;case n.TwoThreeThree:this.mCurPlf=new s.default}},t.ReportEvent=function(t,e){void 0===e&&(e=null),null!==this.mCurPlf&&this.mCurPlf.ReportEvent(t,e)},t.ShowBanner=function(){null!==this.mCurPlf&&this.mCurPlf.ShowBanner()},t.HideBanner=function(){null!==this.mCurPlf&&this.mCurPlf.HideBanner()},t.mCurPlf=null,t}();o.default=p,cc._RF.pop()},{"../Common/SwitchConfig":"SwitchConfig","../Platform/PCPlatform":"PCPlatform","../Platform/TwoThreeThreePlf":"TwoThreeThreePlf","../Platform/WeChatPlf":"WeChatPlf","../Platform/XiaoMiChannelPlatform":"XiaoMiChannelPlatform","../Platform/XiaoMiPlatform":"XiaoMiPlatform","../Platform/iOSPlatform":"iOSPlatform"}],PlotMgr:[function(t,e,o){"use strict";cc._RF.push(e,"37ebdH2TAJPA76xqJxDRNLT","PlotMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./WinMgr"),r=t("./UserMgr"),i=t("./ResMgr"),a=t("./PoolMgr"),s=t("./PlatformMgr"),l=t("./GuideMgr"),m=t("./FightMgr"),u=t("./DataMgr"),p=t("./BCMgr"),c=t("../Proxy/ProxyLargeNum"),d=t("../Proxy/ProxyImtSkill"),f=t("../Proxy/ProxyAllSP"),h=t("../MainGame"),y=t("../Common/SwitchConfig"),g=t("../Common/GameRunningData"),I=t("../Common/EnumsDefine"),S=t("../Battle/AI/EntityState"),_=function(){function t(){this.mIsPlotting=!1,this.mHero=null,this.mEnemy=null,this.mSmallEnemyArr=[]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsPlotting",{get:function(){return this.mIsPlotting},enumerable:!1,configurable:!0}),t.prototype.Subscribe=function(){p.default.Subscribe(I.BCType.Plot_End,this._OnMsg_PlotEnd,this),p.default.Subscribe(I.BCType.ProblemWin_OK,this._OnMsg_ProblemWinOK,this)},t.prototype._OnMsg_ProblemWinOK=function(){this._StartSpecialPlot()},t.prototype._OnMsg_PlotEnd=function(t){switch(t){case 1:m.default.mNormalFightMode.AddEnemy(this.mEnemy),m.default.mNormalFightMode.AddHero(this.mHero);for(var e=0,o=this.mSmallEnemyArr.length;e<o;++e)m.default.mNormalFightMode.AddEnemy(this.mSmallEnemyArr[e]),this.mSmallEnemyArr[e].ChangeState(S.EntityStateType.Move);var n=this;setTimeout(function(){n.TriggerNextPlot(),n.mHero.mEntityAttr.mDefend=new c.LargeNumber(1,2),s.default.ReportEvent(I.BIPoint.Guide_StartAskForHelp)},2500),i.default.Ins.LoadPrefab("prefab/win/WorkWin",null,null);break;case 2:p.default.Dispatch(I.BCType.MainWin_ShowGuideSkillBtn),l.default.TriggerGuide(-1,!0)}},t.prototype.TriggerPlot=function(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o=!1),!y.default.mGuideOpen&&!o)return!1;n.default.Ins.Open(I.WinType.PlotWin,function(n){n.TriggerPlot(t,e,o)})},t.prototype.TriggerNextPlot=function(t,e){void 0===t&&(t=null),void 0===e&&(e=!1);var o=r.default.Ins.ClientInfo.plotID;this.TriggerPlot(++o,t,e)},t.prototype._StartSpecialPlot=function(){var t=this;this.TriggerPlot(0,function(){g.default.Ins.mProblemWinOK=!0,t._Action_SmallEnemy(),t._Action_ZhangJiao()})},t.prototype._Action_SmallEnemy=function(){for(var t=function(t){var o=e.mSmallEnemyArr[t],n=e._GetSmallEnemyPos(t);cc.tween(o.node).delay(.5).to(1.2,{position:cc.v3(n[0],n[1],0)}).call(function(){o.mSkeleton.setAnimation(0,"daiji",!0)}).start()},e=this,o=0,n=this.mSmallEnemyArr.length;o<n;++o)t(o)},t.prototype._Action_ZhangJiao=function(){var t=this.mEnemy;if(null!==t){s.default.ReportEvent(I.BIPoint.Guide_ZhangJiaoShow);var e=this;cc.tween(t.node).delay(2.5).call(function(){p.default.Dispatch(I.BCType.BattleWin_AddEnemy,t),t.SetLookDirection(I.LookDir.Left),t.mSkeleton.timeScale=1,t.mSkeleton.setAnimation(0,"ruchang",!1),t.mSkeleton.addAnimation(0,"daiji",!0),t.node.position=cc.v3(70,100,0)}).delay(.6).call(function(){s.default.ReportEvent(I.BIPoint.Guide_ZhangJiaoSpeak),e.TriggerPlot(1)}).start()}},t.prototype._GetSmallEnemyPos=function(t){var e=200,o=190;return[e=e+t%4*15+80*Math.floor(t/4),o-=t%4*50]},t.prototype.TriggerSpecialPlot=function(){var t=this,e=u.default.Ins.m_DB.entityDB[3004];a.default.Ins.Borrow(a.default.HERO_PATH_ROOT+e.model,"Hero",function(o){var n=o;t.mHero=n,n.SetInitAnimName("daiji"),n.Init(3004,e,m.default.mNormalFightMode),n.mCanNotDie=!0,p.default.Dispatch(I.BCType.BattleWin_AddHero,n),n.node.position=cc.v3(-170,100,0)});var o=u.default.Ins.m_DB.entityDB[20001];a.default.Ins.Borrow(a.default.ENEMY_PATH_ROOT+o.model,"Enemy",function(e){var n=e;t.mEnemy=n,n.Init(20001,o,m.default.mNormalFightMode,I.CounterType.None),n.mEntityAttr.mMaxHP=new c.LargeNumber(1,2),n.mEntityAttr.mCurHP=new c.LargeNumber(1,2),n.mEntityAttr.mResist=100,n.mEntityAttr.mAttack.MultiplySelfSingle(.5),g.default.Ins.mProblemWinOK&&t._Action_ZhangJiao()});for(var n=u.default.Ins.m_DB.entityDB[5004],r=function(e){var o=i._GetSmallEnemyPos(e),r=o[0],s=o[1],l=e+1;a.default.Ins.Borrow(a.default.ENEMY_PATH_ROOT+n.model,"Enemy",function(e){var o=e;t.mSmallEnemyArr.push(o),o.Init(5004,n,m.default.mNormalFightMode,I.CounterType.None),p.default.Dispatch(I.BCType.BattleWin_AddEnemy,o),o.ChangeState(S.EntityStateType.Wait),o.mEntityAttr.mMaxHP=new c.LargeNumber(10,1).MultiplySingle(l/8),o.mEntityAttr.mCurHP=new c.LargeNumber(10,1).MultiplySingle(l/8),o.SetLookDirection(I.LookDir.Left),o.mSkeleton.setAnimation(0,"zoulu",!0),o.node.position=cc.v3(400,s,0),o.node.zIndex=-s,o.mSkeleton.timeScale=2,g.default.Ins.mProblemWinOK&&cc.tween(o.node).delay(.5).to(1.2,{position:cc.v3(r,s,0)}).call(function(){o.mSkeleton.setAnimation(0,"daiji",!0)}).start()})},i=this,s=0;s<8;++s)r(s)},t.prototype.TriggerImtSkill=function(){s.default.ReportEvent(I.BIPoint.Guide_ClickImtBtn),d.default.Ins.TriggerSkill(40006);var t=u.default.Ins.m_DB.imtSkillDB[40006],e=this;a.default.Ins.Borrow("prefab/skill/"+t.prefab,"ImmortalSkillBase",function(t){var o=t;setTimeout(function(){o.InitImtSkill(100001,40006,m.default.mCurFightMode,null,function(){e.mEnemy.ChangeState(S.EntityStateType.Wait),e.mHero.ChangeState(S.EntityStateType.Wait),s.default.ReportEvent(I.BIPoint.Guide_ImtSkillEnd),e.TriggerNextPlot(function(){e._TurnBackMoveOut(e.mEnemy),s.default.ReportEvent(I.BIPoint.Guide_ZhangJiaoBeginBack)})}),o.SetATK(new c.LargeNumber(5,1)),p.default.Dispatch(I.BCType.BattleWin_AddSkillItem,t),t.PlaceImtSkill(h.default.mBattleCam.node.x),m.default.mCurFightMode.AddImtSkill(t)},1e3)});var o=t.initParam[3];p.default.Dispatch(I.BCType.BattleWin_StartSkill,40006,o,!0)},t.prototype._TurnBackMoveOut=function(e){var o=this;e.SetLookDirection(I.LookDir.Right),e.mSkeleton.setAnimation(0,"zoulu",!0),e.mSkeleton.timeScale=4,cc.tween(e.node).to(1,{position:cc.v3(430,100,0)}).call(function(){e.node.opacity=0,e.ChangeState(S.EntityStateType.Wait),t.Ins.TriggerNextPlot(function(){o._ChangeLevel(),s.default.ReportEvent(I.BIPoint.Guide_Level1),s.default.mCurPlf.ReportHuoShanEvent(I.HuoShanEventType.EnterLevel,{level:r.default.Ins.ClientInfo.bestLevel}),s.default.mCurPlf.Register()}),s.default.ReportEvent(I.BIPoint.Guide_ShenmirenSpeak)}).start()},t.prototype._ChangeLevel=function(){var t=this;null!==this.mHero.mHPBar&&(this.mHero.mHPBar.node.opacity=0),null!==this.mEnemy.mHPBar&&(this.mEnemy.mHPBar.node.opacity=0),m.default.mNormalFightMode.RemoveHero(this.mHero),m.default.mNormalFightMode.RemoveEnemy(this.mEnemy),h.default.mBattleCam.WaitToFollow(1),this.mHero.node.destroy(),this.mEnemy.node.destroy(),m.default.mNormalFightMode.ChangeToLevel(1,function(){t.TriggerNextPlot()}),p.default.Dispatch(I.BCType.MainWin_PlotToFight),r.default.Ins.ClientInfo.passedGuideLevel=!0,r.default.Ins.Save(),i.default.Ins.LoadPrefab("prefab/win/HeroWin",null,null),f.default.Ins.SpecialInit()},t.mIns=null,t}();o.default=_,cc._RF.pop()},{"../Battle/AI/EntityState":"EntityState","../Common/EnumsDefine":"EnumsDefine","../Common/GameRunningData":"GameRunningData","../Common/SwitchConfig":"SwitchConfig","../MainGame":"MainGame","../Proxy/ProxyAllSP":"ProxyAllSP","../Proxy/ProxyImtSkill":"ProxyImtSkill","../Proxy/ProxyLargeNum":"ProxyLargeNum","./BCMgr":"BCMgr","./DataMgr":"DataMgr","./FightMgr":"FightMgr","./GuideMgr":"GuideMgr","./PlatformMgr":"PlatformMgr","./PoolMgr":"PoolMgr","./ResMgr":"ResMgr","./UserMgr":"UserMgr","./WinMgr":"WinMgr"}],PlotWin:[function(t,e,o){"use strict";cc._RF.push(e,"dd90b945hVDkoRPX21SMkM0","PlotWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/UserMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/PlatformMgr"),u=t("../../Manager/DataMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/SwitchConfig"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLeftHeroSp=null,e.mLeftCommonHeroSp=null,e.mLeftNameRoot=null,e.mLeftNameLbl=null,e.mRightHeroSp=null,e.mRightNameRoot=null,e.mRightNameLbl=null,e.mContentRT=null,e.mCurPlotID=0,e.mCurPlotIdx=0,e.mAllPlotDatasMap=null,e.mCurPlotDatasArr=null,e.mEndCallback=null,e.mSafeTime=.5,e.mCanClickNext=!1,e.mCanClickNext2=!0,e.mCurLeftIconStr="",e.mCurLeftCommonIconStr="",e.mCurRightIconStr="",e.mIsPlotting=!1,e}return r(e,t),Object.defineProperty(e.prototype,"IsPlotting",{get:function(){return this.mIsPlotting},enumerable:!1,configurable:!0}),e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),this.mMask.on(cc.Node.EventType.TOUCH_END,this.Invoke_ClickNext,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),this.mMask.off(cc.Node.EventType.TOUCH_END,this.Invoke_ClickNext,this)},e.prototype._CacheDialogDatas=function(){if(null===this.mAllPlotDatasMap){this.mAllPlotDatasMap=new Map;var t=u.default.Ins.m_DB.plotDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e],n=this.mAllPlotDatasMap.get(o.plotId);n||(n=[],this.mAllPlotDatasMap.set(o.plotId,n)),n.push(o)}}},e.prototype.GetPlotDialogTaskDatas=function(t){return this._CacheDialogDatas(),this.mAllPlotDatasMap.get(t)},e.prototype.TriggerPlot=function(t,e,o){if(void 0===e&&(e=null),void 0===o&&(o=!1),d.default.mGuideOpen||o){var n=this;return this.mCanClickNext=!1,this.mEndCallback=e,this.scheduleOnce(function(){n.mCanClickNext=!0},n.mSafeTime),this.mCurPlotDatasArr=this.GetPlotDialogTaskDatas(t),this.mCurPlotDatasArr?(this.mIsPlotting=!0,this.mCurPlotID=t,this.mCurPlotIdx=0,this.TriggerDialogStep(this.mCurPlotDatasArr[0]),!0):(console.error("\u83b7\u53d6\u5267\u60c5\u5bf9\u8bdd\u6570\u636e\u5931\u8d25: "+t),!1)}},e.prototype.TriggerDialogStep=function(t){var e=this;this.mLeftHeroSp.node.opacity=0,this.mRightHeroSp.node.opacity=0,this.mLeftNameRoot.opacity=0,this.mRightNameRoot.opacity=0;var o=t.icon;this.mContentRT.string=t.content,14===t.Id&&this.scheduleOnce(function(){e.mContentRT.string=t.content},.1);var n=this;1===t.part?(1===t.event?(this.mLeftCommonHeroSp.node.opacity=255,this.mLeftNameRoot.opacity=255,this.mLeftHeroSp.node.opacity=0,o!==this.mCurLeftCommonIconStr&&(this.mCurLeftCommonIconStr=o,l.default.Ins.LoadSpriteFrame("Guide",o,this.mLeftCommonHeroSp,function(t){h.default.ResetSpriteSize(n.mLeftCommonHeroSp,t,220)}))):(this.mLeftCommonHeroSp.node.opacity=0,this.mLeftNameRoot.opacity=255,this.mLeftHeroSp.node.opacity=255,o!==this.mCurLeftIconStr&&(this.mCurLeftIconStr=o,l.default.Ins.LoadSpriteFrame("Guide",o,this.mLeftHeroSp,null))),this.mLeftNameLbl.string=t.name):(this.mLeftCommonHeroSp.node.opacity=0,this.mRightNameRoot.opacity=255,this.mRightHeroSp.node.opacity=255,this.mRightNameLbl.string=t.name,o!==this.mCurRightIconStr&&(this.mCurRightIconStr=o,l.default.Ins.LoadSpriteFrame("Guide",o,this.mRightHeroSp,null))),this._HandleDialogEvent(t),t.audio&&c.default.PlayGuideAudio(t.audio)},e.prototype._HandleDialogEvent=function(){},e.prototype.Invoke_ClickNext=function(){this.mCanClickNext&&this.mCanClickNext2&&(this.mCurPlotDatasArr?(this.mCurPlotIdx++,this.mCurPlotIdx<this.mCurPlotDatasArr.length?this.TriggerDialogStep(this.mCurPlotDatasArr[this.mCurPlotIdx]):this.EndPlotDialog(),c.default.PlaySFX(f.AudioName.UI_ClickPlot,!0)):(console.error("\u5267\u60c5\u5f15\u5bfc\u914d\u7f6e\u4e3a\u7a7a..."),this.EndPlotDialog()))},e.prototype.EndPlotDialog=function(){this.mIsPlotting=!1,this.CloseWin(),s.default.Ins.ClientInfo.plotID=this.mCurPlotID,null!==this.mEndCallback&&(this.mEndCallback(),this.mEndCallback=null),p.default.Dispatch(f.BCType.Plot_End,this.mCurPlotID),s.default.Ins.Save(),m.default.ReportEvent(f.BIPoint.Guide_PlotEnd,{id:this.mCurPlotID}),0===this.mCurPlotID&&m.default.mCurPlf.ReportHuoShanEvent(f.HuoShanEventType.StartGuide)},i([I(cc.Sprite)],e.prototype,"mLeftHeroSp",void 0),i([I(cc.Sprite)],e.prototype,"mLeftCommonHeroSp",void 0),i([I(cc.Node)],e.prototype,"mLeftNameRoot",void 0),i([I(cc.Label)],e.prototype,"mLeftNameLbl",void 0),i([I(cc.Sprite)],e.prototype,"mRightHeroSp",void 0),i([I(cc.Node)],e.prototype,"mRightNameRoot",void 0),i([I(cc.Label)],e.prototype,"mRightNameLbl",void 0),i([I(cc.RichText)],e.prototype,"mContentRT",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","./WinBase":"WinBase"}],PoolMgr:[function(t,e,o){"use strict";cc._RF.push(e,"72460by0ElG54mkO3MIIq3w","PoolMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ResMgr"),r=function(){function t(){this.mObjsMap=new Map}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.Borrow=function(t,e,o){var r=this.mObjsMap.get(t);if(void 0===r&&(r=[],this.mObjsMap.set(t,r)),r.length<=0)n.default.Ins.LoadPrefab(t,function(n){var r=cc.instantiate(n).getComponent(e);r&&(r.OnSpawned(t),r.OnBeforeBorrow(),r.mIsPooled=!1,o(r),r.OnAfterBorrow())});else{var i=r.pop();i.OnBeforeBorrow(),i.mIsPooled=!1,o(i),i.OnAfterBorrow()}},t.prototype.Return=function(t){if(null!==t&&!t.mIsPooled){var e=this.mObjsMap.get(t.mKey);e&&e.push(t)}t.mIsPooled=!0,t.OnReturned()},t.mIns=null,t.TIP_PANEL="prefab/ui/tipPanel",t.AD_TIP_PANEL="prefab/ui/adTipPanel",t.HERO_PATH_ROOT="prefab/model/hero/",t.ENEMY_PATH_ROOT="prefab/model/enemy/",t.CRYSTAL="prefab/model/crystal",t.EFX_PATH_ROOT="prefab/efx/",t.HPBAR_PATH="prefab/ui/hpBar",t.BOSS_HPBAR_PATH="prefab/ui/bossHPBar",t.BULLET_PATH_ROOT="prefab/bullet/",t.FLY_COIN="prefab/ui/flyCoin",t.FLY_CRYSTAL="prefab/ui/flyCrystal",t.FLOAT_NUM="prefab/ui/floatNum",t.COUNTER_FLOAT_NUM="prefab/ui/counterFloatNum",t.SIMPLE_BATTLE_FLOAT="prefab/ui/simpleBattleFloat",t.FLOAT_ITEM="prefab/ui/FloatItem",t.DEAD_EXPLOSION="prefab/efx/deadExplosion",t}();o.default=r,cc._RF.pop()},{"./ResMgr":"ResMgr"}],PreloadWin:[function(t,e,o){"use strict";cc._RF.push(e,"fca92cQqCBGzKUtJzhuYapP","PreloadWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/WinMgr"),s=t("../../Manager/UserMgr"),l=t("../../Manager/TimeMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/PoolMgr"),p=t("../../Manager/PlatformMgr"),c=t("../../Manager/GameMgr"),d=t("../../InitGame"),f=t("../../Common/SwitchConfig"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mProgressLbl=null,e.mPb=null,e.mFirstLoadLbl=null,e.mAnimNode=null,e.mBarWidth=0,e.mFirstStepProgress=30,e.mFirstStepOK=!1,e.mFirstStepDuration=2,e.mFirstStepTiming=0,e.mInited=!1,e.mDescDuration=3,e.mDescTiming=3,e.mCurDescIdx=0,e.mIsNewPlayer=!1,e.mDescArr=["\u6362\u4e2a\u59ff\u52bf\uff0c\u518d\u7b49\u4f1a\u513f\uff0c\u62dc\u6258~","\u4e3b\u516c\u522b\u8d70\uff0c\u5c31\u5feb\u597d\u4e86\uff0c\u6c42\u6c42\u4e86~","\u9700\u8981\u6211\u7ed9\u4f60\u8868\u6f14\u4e00\u6bb5\u5355\u53e3\u76f8\u58f0\u5417\uff1f","\u6211\u60f3\u4e5f\u5c31\u5feb\u597d\u4e86..."],e.mRequestOK=!1,e}return r(e,t),e.prototype.Init=function(){this.node.active=!0,this.mProgressLbl.string="0%",this.mBarWidth=this.mPb.node.width,this.mPb.progress=0,this.mAnimNode.x=this.mPb.progress*this.mBarWidth,this.mInited=!0,this.schedule(this._OnSchedule_AutoLogin,.1)},e.prototype.update=function(t){if(this.mInited)if(this.mFirstStepOK)this.mIsNewPlayer&&(this.mDescTiming-=t,this.mDescTiming<=0&&(this.mDescTiming=this.mDescDuration,this.mCurDescIdx>=this.mDescArr.length&&(this.mCurDescIdx=0),this.mFirstLoadLbl.string=this.mDescArr[this.mCurDescIdx],this.mCurDescIdx++));else{this.mFirstStepTiming+=t,this.mFirstStepTiming>=this.mFirstStepDuration&&(this.mFirstStepTiming=this.mFirstStepDuration);var e=this.mFirstStepTiming/this.mFirstStepDuration;this.mPb.progress=e*(this.mFirstStepProgress/100),this.mAnimNode.x=this.mPb.progress*this.mBarWidth,this.mProgressLbl.string=(e*this.mFirstStepProgress).toFixed(0)+"%"}},e.prototype._FirstStepOK=function(){this.mFirstStepOK=!0,this.mPb.progress=this.mFirstStepProgress/100,this.mAnimNode.x=this.mPb.progress*this.mBarWidth,this.mProgressLbl.string=this.mFirstStepProgress.toFixed(0)+"%"},e.prototype._OnSchedule_AutoLogin=function(){d.default.HasDataLoaded&&d.default.HasMainSceneLoaded&&d.default.HasPrivacyOK&&!this.mRequestOK&&(this.mRequestOK=!0,p.default.mCurPlf.RequestGameServer(this._Login.bind(this)),this.unschedule(this._OnSchedule_AutoLogin))},e.prototype._Login=function(){var t=this;p.default.mCurPlf.Login(function(e){t._OnLoginSuccess(e)})},e.prototype._OnLoginSuccess=function(t){0==t.ret&&(l.default.SetServerTime(t.systemTime),l.default.mLastLogoutTime=t.lastLogoutTime,s.default.Ins.SyncGamerInfo(t,f.default.mClearInfo),c.default.InitOnLoginSuccess(),this._PreloadRes())},e.prototype._LoadGameScene=function(){cc.director.loadScene(y.default.MainScene,c.default.OnGameSceneLoaded)},e.prototype._PreloadRes=function(){var t=this,e=this;this._FirstStepOK();var o=this.mFirstStepProgress/100;if(s.default.Ins.ClientInfo.hasLookComic)m.default.Ins.LoadPrefab("prefab/win/MainWin",null,null),m.default.Ins.LoadPrefab("prefab/win/BattleWin",null,null),cc.resources.preload(["prefab/win/MainWin","prefab/win/BattleWin"],cc.Prefab,function(n,r){var i=n/r;o<i&&(e.mPb.progress=i,t.mAnimNode.x=t.mPb.progress*t.mBarWidth,e.mProgressLbl.string=(100*i).toFixed(0)+"%")},function(t){t?console.error(t):e._LoadGameScene()});else{this.mFirstLoadLbl.string="\u9996\u6b21\u8f83\u6162\uff0c\u9753\u4ed4\u8bf7\u8010\u5fc3\u7b49\u5f85~",this.mIsNewPlayer=!0,this._FirstStepOK();var n=null;f.default.mNeedComic?(m.default.Ins.LoadPrefab("prefab/comic/1",null,null),m.default.Ins.LoadPrefab("prefab/win/PlotWin",null,null),n=["prefab/win/ComicWin","prefab/comic/1"]):(s.default.Ins.ClientInfo.hasLookComic=!0,n=["prefab/win/BattleWin",u.default.HERO_PATH_ROOT+"sunshangxiang",u.default.ENEMY_PATH_ROOT+"zhangjiao","prefab/skill/40006_Lightning","prefab/ui/suduxian2"],m.default.Ins.LoadPrefab("prefab/skill/40006_Lightning",null,null),m.default.Ins.LoadPrefab(u.default.HERO_PATH_ROOT+"sunshangxiang",null,null),m.default.Ins.LoadPrefab(u.default.ENEMY_PATH_ROOT+"zhangjiao",null,null),m.default.Ins.LoadPrefab("prefab/win/BattleWin",null,null),m.default.Ins.LoadPrefab("prefab/ui/suduxian2",null,null)),cc.resources.preload(n,cc.Prefab,function(n,r){var i=n/r;o<i&&(e.mPb.progress=i,t.mAnimNode.x=t.mPb.progress*t.mBarWidth,e.mProgressLbl.string=(100*i).toFixed(0)+"%")},function(t){t?console.error(t):(p.default.ReportEvent(h.BIPoint.Guide_NewPlayerProgressComplete),s.default.Ins.ClientInfo.hasLookComic?e._LoadGameScene():a.default.Ins.Open(h.WinType.ComicWin,function(t){t.SetData(e._LoadGameScene),e.node.active=!1}))})}},e.prototype.Invoke_OpenAgeWin=function(){a.default.Ins.Open(h.WinType.AgeWin,null)},i([S(cc.Label)],e.prototype,"mProgressLbl",void 0),i([S(cc.ProgressBar)],e.prototype,"mPb",void 0),i([S(cc.Label)],e.prototype,"mFirstLoadLbl",void 0),i([S(cc.Node)],e.prototype,"mAnimNode",void 0),i([I],e)}(cc.Component);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../InitGame":"InitGame","../../Manager/GameMgr":"GameMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/PoolMgr":"PoolMgr","../../Manager/ResMgr":"ResMgr","../../Manager/TimeMgr":"TimeMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr"}],PrivacyHandler:[function(t,e,o){"use strict";cc._RF.push(e,"6778cUvUSdKOYQXSJTHRSQ4","PrivacyHandler");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.handler1=function(){cc.sys.openURL("https://xxy.wdyou.top/client/pvz/CJHService.html"),console.log("\u4fee\u6539\u5177\u4f53\u7684\u670d\u52a1\u534f\u8bae\u5730\u5740")},e.prototype.handler2=function(){cc.sys.openURL("https://ttk-1304758638.cos.ap-nanjing.myqcloud.com/app/ttk_privacy.html"),console.log("\u4fee\u6539\u5177\u4f53\u7684\u9690\u79c1\u6761\u6b3e\u5730\u5740")},i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],PrivacyWin:[function(t,e,o){"use strict";cc._RF.push(e,"119e93hhNBKCLRuuFQ4YMM0","PrivacyWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/SaveMgr"),l=t("../../Manager/PlatformMgr"),m=t("../../Manager/AudioMgr"),u=t("../../InitGame"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mDefaultPanel=null,e.mReconfirmPanel=null,e}return r(e,t),e.prototype.Invoke_DefaultCancel=function(){m.default.PlayBtnSound(),this.mDefaultPanel.active=!1,this.mReconfirmPanel.active=!0},e.prototype.Invoke_DefaultConfirm=function(){m.default.PlayBtnSound(),this._Agree()},e.prototype.Invoke_ConfirmExit=function(){m.default.PlayBtnSound(),l.default.mCurPlf.ExitPrivacy(),cc.game.end()},e.prototype.Invoke_ConfirmAgree=function(){m.default.PlayBtnSound(),this._Agree()},e.prototype._Agree=function(){s.default.Save(s.default.PRIVACY_FLAG,1),this.CloseWin(),setTimeout(function(){u.default.HasPrivacyOK=!0},1),l.default.mCurPlf.AgreePrivacy()},i([d(cc.Node)],e.prototype,"mDefaultPanel",void 0),i([d(cc.Node)],e.prototype,"mReconfirmPanel",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../InitGame":"InitGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/SaveMgr":"SaveMgr","./WinBase":"WinBase"}],ProblemWin:[function(t,e,o){"use strict";cc._RF.push(e,"f8fccX1Qi5Gt5IeN87kdFv/","ProblemWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/PlatformMgr"),l=t("../../Common/EnumsDefine"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mDescNode=null,e.mCloseFunc=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),s.default.ReportEvent(l.BIPoint.Guide_ProblemWinOpened)},e.prototype.SetData=function(t){this.mCloseFunc=t;var e=this;cc.tween(this.mDescNode).to(.6,{opacity:255}).delay(1.2).to(.45,{opacity:0}).call(function(){s.default.ReportEvent(l.BIPoint.Guide_ProblemWinClosed),e.mCloseFunc&&e.mCloseFunc(),e.CloseWin()}).start()},i([p(cc.Node)],e.prototype,"mDescNode",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/PlatformMgr":"PlatformMgr","./WinBase":"WinBase"}],ProxyAct:[function(t,e,o){"use strict";cc._RF.push(e,"2321fdv8w9Gz7GVQHxiWGXS","ProxyAct"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ProxyTurntable"),r=t("./ProxySign"),i=t("./ProxyFreeGoldAct"),a=t("./ProxyAllSP"),s=t("../Manager/FuncMgr"),l=function(){function t(){}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.CheckRedPoint=function(){s.default.IsUnlock(s.FuncType.Activity)&&(i.default.Ins.CheckRedPoint(),r.default.Ins.CheckRedPoint(),n.default.Ins.CheckRedPoint(),a.default.Ins.CheckRedPoint())},t.mIns=null,t}();o.default=l,cc._RF.pop()},{"../Manager/FuncMgr":"FuncMgr","./ProxyAllSP":"ProxyAllSP","./ProxyFreeGoldAct":"ProxyFreeGoldAct","./ProxySign":"ProxySign","./ProxyTurntable":"ProxyTurntable"}],ProxyAllSP:[function(t,e,o){"use strict";cc._RF.push(e,"9587cQFQMRDVpG/yDUQBJc4","ProxyAllSP"),Object.defineProperty(o,"__esModule",{value:!0}),o.y=o.AllSPActSaveInfo=o.AllSPTaskType=o.TaskState=o.AllSPImtTab=o.AllSPHeroTab=o.AllSPTaskGroup=void 0;var n,r,i,a,s,l=t("../Manager/WinMgr"),m=t("../Manager/UserMgr"),u=t("../Manager/RedPointMgr"),p=t("../Manager/DataMgr"),c=t("../Manager/BCMgr"),d=t("../Common/EnumsDefine"),f=t("../Common/Common");(function(t){t[t.Hero=0]="Hero",t[t.Imt=1]="Imt"})(n=o.AllSPTaskGroup||(o.AllSPTaskGroup={})),function(t){t[t.R=0]="R",t[t.SR=1]="SR",t[t.SSR=2]="SSR"}(r=o.AllSPHeroTab||(o.AllSPHeroTab={})),function(t){t[t.Imt=0]="Imt",t[t.Forge=1]="Forge"}(i=o.AllSPImtTab||(o.AllSPImtTab={})),function(t){t[t.None=0]="None",t[t.Progress=1]="Progress",t[t.Complete=2]="Complete",t[t.GotRewards=3]="GotRewards"}(a=o.TaskState||(o.TaskState={})),function(t){t[t.UpgradeRHeroToStar2=1]="UpgradeRHeroToStar2",t[t.AwakeRHeroToSR=2]="AwakeRHeroToSR",t[t.AwakeRHeroToSSR=3]="AwakeRHeroToSSR",t[t.UpgradeSRHeroToStar2=4]="UpgradeSRHeroToStar2",t[t.UpgradeSRHeroToStar5=5]="UpgradeSRHeroToStar5",t[t.AwakeSRHeroToSSR=6]="AwakeSRHeroToSSR",t[t.GetSSRHero=7]="GetSSRHero",t[t.UpgradeSSRHeroToStar2=8]="UpgradeSSRHeroToStar2",t[t.UpgradeSSRHeroToStar5=9]="UpgradeSSRHeroToStar5",t[t.GetImtNum=10]="GetImtNum",t[t.UpgradeImtStar3ToMaxLv=11]="UpgradeImtStar3ToMaxLv",t[t.GetSkillImt=12]="GetSkillImt",t[t.UnlockSmith=13]="UnlockSmith",t[t.UpgradeSmithToTitle3=14]="UpgradeSmithToTitle3",t[t.UpgradeSmithToTitle5=15]="UpgradeSmithToTitle5"}(s=o.AllSPTaskType||(o.AllSPTaskType={}));var h=function(){function t(){this.mHeroScoreRewardsArr=null,this.mImtScoreRewardsArr=null,this.mHeroMaxScore=3e3,this.mImtMaxScore=3e3,this.mHeroTaskMap=null,this.mImtTaskMap=null,this.mTaskTypeMap=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t,this.mIns.InitCacheData()),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=p.default.Ins.m_DB.paramDB,e=t.ALL_SP_HERO_SCORE_REWARDS.value.split("|");this.mHeroScoreRewardsArr=[];for(var o=0,n=e.length;o<n;++o)this.mHeroScoreRewardsArr.push(f.default.Split2NumArr(e[o],","));var r=t.ALL_SP_IMT_SCORE_REWARDS.value.split("|");for(this.mImtScoreRewardsArr=[],o=0,n=r.length;o<n;++o)this.mImtScoreRewardsArr.push(f.default.Split2NumArr(r[o],","))},t.prototype.SpecialInit=function(){this.UpdateTaskProgress(s.UpgradeRHeroToStar2,2,!0)},t.prototype.InitCacheData=function(){if(null===this.mHeroTaskMap){this.mHeroTaskMap=new Map,this.mImtTaskMap=new Map,this.mTaskTypeMap=new Map;var t=p.default.Ins.m_DB.allSPTaskDB,e=0,o=0;for(var n in t)if(t.hasOwnProperty(n)){var r,i,a=t[n],s=this.mTaskTypeMap.get(a.taskType);s||(s=new Array,this.mTaskTypeMap.set(a.taskType,s)),s.push(a),0===a.taskGroup?(e+=a.score,void 0===(r=this.mHeroTaskMap.get(a.tabGroup))&&(r=new Map,this.mHeroTaskMap.set(a.tabGroup,r)),(i=r.get(a.posId))||(i=new Array,r.set(a.posId,i)),i.push(a)):(o+=a.score,void 0===(r=this.mImtTaskMap.get(a.tabGroup))&&(r=new Map,this.mImtTaskMap.set(a.tabGroup,r)),(i=r.get(a.posId))||(i=new Array,r.set(a.posId,i)),i.push(a))}this.mHeroMaxScore=e,this.mImtMaxScore=o}},t.prototype.GetAllSPTaskDataArr=function(t,e,o){return t===n.Hero?this.mHeroTaskMap.get(e).get(o):this.mImtTaskMap.get(e).get(o)},t.prototype.GetProgressData=function(t,e,o){var n=this.GetAllSPTaskDataArr(t,e,o),r=n[0].taskType,i=m.default.Ins.ClientInfo.allSPInfo.taskInfoMap.Get(r);if(!i)return n[0];for(var a=0,s=n.length;a<s;++a)if(n[a].order===i.order)return n[a];return null},t.prototype.GetTaskDataByID=function(t){return p.default.Ins.m_DB.allSPTaskDB[t]},t.prototype.GetCurTaskData=function(t){var e=this.mTaskTypeMap.get(t),o=m.default.Ins.ClientInfo.allSPInfo.taskInfoMap.Get(t);if(o){var n=e.length;return o.taskState===a.Progress||o.taskState===a.Complete?e[o.order-1]:e[Math.min(n-1,o.order)]}return e[0]},t.prototype.UpdateTaskProgress=function(t,e,o){void 0===o&&(o=!1);var n=m.default.Ins.ClientInfo.allSPInfo.taskInfoMap,r=n.Get(t);if(r)i=this.GetCurTaskData(t),o?r.progress=e:r.progress+=e,r.taskState===a.Progress&&r.progress>=i.targetNum&&(r.taskState=a.Complete,u.default.SetInvokeData(this._GetRedPointType(i.taskGroup,i.tabGroup),1));else{r=new y;var i=this.GetCurTaskData(t);r.order=i.order,r.progress=e,r.taskState=a.Progress,r.progress>=i.targetNum&&(r.taskState=a.Complete,u.default.SetInvokeData(this._GetRedPointType(i.taskGroup,i.tabGroup),1)),n.Set(t,r)}m.default.Ins.Save()},t.prototype.GetTaskRewards=function(t){var e=p.default.Ins.m_DB.allSPTaskDB[t];m.default.Ins.UpdateItem(d.ItemType.Gold,e.goldNum),l.default.Ins.Open(d.WinType.GetRewardsWin,function(t){t.SetDataSingle(d.ItemType.Gold,e.goldNum)}),e.taskGroup===n.Hero?m.default.Ins.ClientInfo.allSPInfo.heroScore+=e.score:m.default.Ins.ClientInfo.allSPInfo.imtScore+=e.score;var o=m.default.Ins.ClientInfo.allSPInfo.taskInfoMap.Get(e.taskType);o.taskState=a.GotRewards;var r=this.GetCurTaskData(e.taskType),i=!1;o.order!==r.order&&(o.order=r.order,o.taskState=a.Progress,o.progress>=r.targetNum&&(o.taskState=a.Complete,i=!0,u.default.SetInvokeData(this._GetRedPointType(r.taskGroup,r.tabGroup),1))),m.default.Ins.Save(),i||u.default.SetInvokeData(this._GetRedPointType(r.taskGroup,r.tabGroup),0),this._CheckScoreRedPoint(e.taskGroup),c.default.Dispatch(d.BCType.AllSP_GetTaskRewards,e.taskGroup)},t.prototype.CheckHasGotScoreReward=function(t,e){for(var o,r=0,i=(o=t===n.Hero?m.default.Ins.ClientInfo.allSPInfo.hasGotHeroScoreArr:m.default.Ins.ClientInfo.allSPInfo.hasGotImtScoreArr).length;r<i;++r)if(o[r]===e)return!0;return!1},t.prototype.GetScoreRewards=function(e,o){var r=null;e===n.Hero?(r=t.Ins.mHeroScoreRewardsArr[o],m.default.Ins.ClientInfo.allSPInfo.hasGotHeroScoreArr.push(o)):(r=t.Ins.mImtScoreRewardsArr[o],m.default.Ins.ClientInfo.allSPInfo.hasGotImtScoreArr.push(o));var i=r[1],a=r[2];m.default.Ins.UpdateItem(i,a),l.default.Ins.Open(d.WinType.GetRewardsWin,function(t){t.SetDataSingle(i,a+"")}),m.default.Ins.Save(),this._CheckScoreRedPoint(e)},t.prototype._GetRedPointType=function(t,e){if(t===n.Hero)switch(e){case r.R:return u.RedPointType.Act_AllSP_Hero_R;case r.SR:return u.RedPointType.Act_AllSP_Hero_SR;case r.SSR:return u.RedPointType.Act_AllSP_Hero_SSR}else switch(e){case i.Imt:return u.RedPointType.Act_AllSP_Imt_Imt;case i.Forge:return u.RedPointType.Act_AllSP_Imt_Smith}},t.prototype._CheckScoreRedPoint=function(e){var o=null,r=0,i=u.RedPointType.Act_AllSP_Hero_Score;e===n.Hero?(m.default.Ins.ClientInfo.allSPInfo.hasGotHeroScoreArr,o=t.Ins.mHeroScoreRewardsArr,r=m.default.Ins.ClientInfo.allSPInfo.heroScore):(i=u.RedPointType.Act_AllSP_Imt_Score,m.default.Ins.ClientInfo.allSPInfo.hasGotImtScoreArr,o=t.Ins.mImtScoreRewardsArr,r=m.default.Ins.ClientInfo.allSPInfo.imtScore);for(var a=0,s=o.length;a<s;++a)if(r>=o[a][0]&&!this.CheckHasGotScoreReward(e,a))return void u.default.SetInvokeData(i,1);u.default.SetInvokeData(i,0)},t.prototype.CheckRedPoint=function(){var t=m.default.Ins.ClientInfo.allSPInfo.taskInfoMap.obj;for(var e in t)if(t.hasOwnProperty(e)&&t[e].taskState===a.Complete){var o=Number(e),r=this.mTaskTypeMap.get(o)[0];u.default.SetInvokeData(this._GetRedPointType(r.taskGroup,r.tabGroup),1)}this._CheckScoreRedPoint(n.Hero),this._CheckScoreRedPoint(n.Imt)},t.mIns=null,t}();o.default=h;o.AllSPActSaveInfo=function(){this.taskInfoMap=null,this.heroScore=0,this.imtScore=0,this.hasGotHeroScoreArr=[],this.hasGotImtScoreArr=[],this.taskInfoMap=new m.SelfObjMap(null)};var y=function(){this.order=0,this.progress=0,this.taskState=a.None};o.y=y,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr"}],ProxyBackCity:[function(t,e,o){"use strict";cc._RF.push(e,"0b062q+y6ZBqrEyrJUsclaC","ProxyBackCity"),Object.defineProperty(o,"__esModule",{value:!0}),o.BackCitySaveInfo=o.BackRunningInfo=void 0;var n=t("./ProxyVIP"),r=t("./ProxyTask"),i=t("./ProxyOffice"),a=t("./ProxyMainTask2"),s=t("./ProxyImmortal"),l=t("../Manager/UserMgr"),m=t("../Manager/SaveMgr"),u=t("../Common/SwitchConfig"),p=t("../Common/GameRunningData"),c=t("../Common/EnumsDefine"),d=function(){function t(){this.mBaseMedalNum=10,this.mMedalRewardLevelUnit=25,this.mMedalMultipler=.2,this.mWorkOnceAddRevenue=50,this.mWorkOnceAddLv=10,this.mAddRevenueLimit=4e5,this.mWorkAddLvLimit=600,this.mBackSaveInfo=null,this.mBackRunningInfo=null,this.mSaveFlag=!1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.CreateDefaultInfo=function(){var t=new h;t.backTimes=u.default.mBackCityTimes,this.mBackSaveInfo=t,this._ConvertToRunningInfo()},t.prototype.SyncSaveInfo=function(){var t=m.default.Get(m.default.BACK_INFO);this.mBackSaveInfo=new h,this.mBackSaveInfo=JSON.parse(t),this._HandleSelfMap(),this._ConvertToRunningInfo()},t.prototype._HandleSelfMap=function(){},t.prototype._ConvertToRunningInfo=function(){this.mBackRunningInfo=new f,this.mBackRunningInfo.mSI=this.mBackSaveInfo,this.mBackRunningInfo.curWorkAddRevenue=this._GetWorkAddRevenue(this.mBackSaveInfo.backTimes),this.mBackRunningInfo.curWorkAddLv=this._GetWorkAddLv(this.mBackSaveInfo.backTimes)},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mBackSaveInfo);m.default.Save(m.default.BACK_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.BackCity=function(){this.mBackSaveInfo.backTimes++,this.mBackSaveInfo.bestLevelWhenBack=l.default.Ins.ClientInfo.bestLevel,this.Save(),this.mBackRunningInfo.curWorkAddRevenue=this._GetWorkAddRevenue(this.mBackSaveInfo.backTimes),this.mBackRunningInfo.curWorkAddLv=this._GetWorkAddLv(this.mBackSaveInfo.backTimes),r.default.Ins.UpdateTaskProgress(r.DailyTaskType.BackCity,1),a.default.Ins.CheckBackCity(),p.default.Ins.mPassLevelCount=0,p.default.Ins.mPassFailCount=0},t.prototype.GetAddRevenueLimit=function(){return this.mAddRevenueLimit},t.prototype.GetAddLvLimit=function(){return this.mWorkAddLvLimit},t.prototype._GetWorkAddRevenue=function(t){var e=t*this.mWorkOnceAddRevenue,o=this.GetAddRevenueLimit();return e>o?o:e},t.prototype._GetWorkAddLv=function(t){var e=t*this.mWorkOnceAddLv,o=this.GetAddLvLimit();return e>o?o:e},t.prototype.GetPlayerAddMedal=function(){return 1+.01*s.default.Ins.GetAttrValue(c.ImtAttrType.MedalAdd)+.01*n.default.Ins.GetAttrValue(n.VIPAttrType.MedalAdd)+.01*i.default.Ins.GetAttrValue(i.OfficeAttrType.MedalAdd)},t.prototype.GetCanGetMedalNum=function(){var e=(l.default.Ins.ClientInfo.curLevel-1)*this.GetCurLevelGetMedalSpeed(),o=t.Ins.GetPlayerAddMedal();return Math.floor(e*o)},t.prototype.GetCurLevelGetMedalSpeed=function(){return this._GetLevelGetMedalSpeed(l.default.Ins.ClientInfo.curLevel)},t.prototype.GetBestLevelGetMedalSpeed=function(){return this._GetLevelGetMedalSpeed(l.default.Ins.ClientInfo.bestLevel)},t.prototype._GetLevelGetMedalSpeed=function(e){var o,n=Math.floor((e-1)/t.mIns.mMedalRewardLevelUnit);return o=this.mBaseMedalNum*(1+this.mMedalMultipler*n),Math.round(o)},t.prototype.GetBoxTargetLevel=function(){return this.mBackSaveInfo.bestLevelWhenBack+25},t.mIns=null,t}();o.default=d;var f=function(){this.curWorkAddRevenue=0,this.curWorkAddLv=0,this.mSI=null};o.BackRunningInfo=f;var h=function(){this.backTimes=0,this.bestLevelWhenBack=0};o.BackCitySaveInfo=h,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/GameRunningData":"GameRunningData","../Common/SwitchConfig":"SwitchConfig","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyImmortal":"ProxyImmortal","./ProxyMainTask2":"ProxyMainTask2","./ProxyOffice":"ProxyOffice","./ProxyTask":"ProxyTask","./ProxyVIP":"ProxyVIP"}],ProxyBattleBox:[function(t,e,o){"use strict";cc._RF.push(e,"44315qDRNlCPpZb4sIheO7H","ProxyBattleBox"),Object.defineProperty(o,"__esModule",{value:!0}),o.BattleBoxType=void 0;var n,r=t("./ProxyWork"),i=t("../Manager/UserMgr"),a=t("../Manager/FightMgr"),s=t("../Manager/DataMgr"),l=t("../Common/EnumsDefine"),m=t("../Common/Common");(function(t){t[t.None=0]="None",t[t.Coin=1]="Coin",t[t.Gold=2]="Gold"})(n=o.BattleBoxType||(o.BattleBoxType={}));var u=function(){function t(){this.mBattleGoldBoxCount=5,this.mBoxGoldBaseNum=100,this.mBoxWeightArr=null,this.mGoldDoubleRate=10}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParam=function(){var t=s.default.Ins.m_DB.paramDB;this.mBattleGoldBoxCount=Number(t.BATTLE_BOX_COUNT.value),this.mBoxGoldBaseNum=Number(t.BOX_GOLD_NUM.value),this.mGoldDoubleRate=Number(t.BOX_DOUBLE_RATE.value);var e=t.BOX_WEIGHT_ARR.value;this.mBoxWeightArr=m.default.Split2NumArr(e,"|")},t.prototype.GetBoxType=function(){if(a.default.mCurFightMode.CurFightModeType!==l.FightModeType.Normal)return n.None;var t=m.default.GetRandIdxByWeight(this.mBoxWeightArr,1)[0],e=i.default.Ins.ClientInfo.bestLevel;1!==e&&2!==e||(t=n.Coin),t===n.Gold&&(i.default.Ins.ClientInfo.battleGoldBoxLeftCount<=0||i.default.Ins.ClientInfo.bestLevel<=5)&&(t=n.Coin);var o=r.default.Ins.mRevenueCoinInSeconds;return t===n.Coin&&0===o.mBaseValue&&0===o.mExpoValue&&(t=n.None),t},t.prototype.GetGoldNum=function(){var t=this.mBoxGoldBaseNum;return m.default.GetRandValueBetween(0,100)<=this.mGoldDoubleRate&&(t*=3),t},t.mIns=null,t}();o.default=u,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/DataMgr":"DataMgr","../Manager/FightMgr":"FightMgr","../Manager/UserMgr":"UserMgr","./ProxyWork":"ProxyWork"}],ProxyBox:[function(t,e,o){"use strict";cc._RF.push(e,"24d1erYwhtC7qRmwHiuXW1y","ProxyBox"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../Manager/DataMgr"),r=t("../Common/Common"),i=function(){function t(){}return t.GetBoxRewards=function(t){var e=n.default.Ins.m_DB.boxRewardsDB[t];if(void 0!==e){for(var o=e.rewards,i=[],a=0,s=o.length;a<s;++a)i.push(o[a][1]);return o[r.default.GetRandIdxByWeight(i,1)[0]][0]}return null},t}();o.default=i,cc._RF.pop()},{"../Common/Common":"Common","../Manager/DataMgr":"DataMgr"}],ProxyCDBtn:[function(t,e,o){"use strict";cc._RF.push(e,"27ee0PUxL1ERIKvQGrebAUv","ProxyCDBtn"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){this.mBtnArr=[]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.AddBtn=function(t){this.mBtnArr.push(t)},t.prototype.RemoveBtn=function(t){var e=this.mBtnArr.indexOf(t);-1!==e&&this.mBtnArr.splice(e,1)},t.prototype.OnUpdate=function(){for(var t=this.mBtnArr.length-1;t>=0;--t)this.mBtnArr[t].OnUpdateTime()},t.mIns=null,t}();o.default=n,cc._RF.pop()},{}],ProxyCrystal:[function(t,e,o){"use strict";cc._RF.push(e,"6c08b5Sr1tDNYw7jWSRiSca","ProxyCrystal"),Object.defineProperty(o,"__esModule",{value:!0}),o.CrystalDropType=void 0;var n,r=t("./ProxyMainTask2"),i=t("../Manager/UserMgr"),a=t("../Manager/SaveMgr"),s=t("../Manager/RedPointMgr"),l=t("../Manager/PoolMgr"),m=t("../Manager/BCMgr"),u=t("../Common/EnumsDefine"),p=t("../Common/Common");(function(t){t[t.Crystal=0]="Crystal",t[t.Elite=1]="Elite",t[t.Boss=2]="Boss"})(n=o.CrystalDropType||(o.CrystalDropType={}));var c=function(){function t(){this.mInitSpeedFactor=1,this.mIsUsingItem=!1,this.mPaused=!1,this.mCurMaxTime=1,this.mSpeedTiming=0,this.mTargetNum=150,this.mSpeedItemDuration=10,this.mSpeedItemFactor=3,this.mNeedNumArr=[150,150,150,150,180,200,200,220,280,300,300,450,500,600,600,700,800,900,1e3],this._SyncDuration=5,this._SyncTimeCounter=5}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.UpdateCrystalTargetNum=function(){var t=i.default.Ins.ClientInfo.lottery.crystalTimes,e=this.mTargetNum;t>=this.mNeedNumArr.length?this.mTargetNum=this.mNeedNumArr[this.mNeedNumArr.length-1]:this.mTargetNum=this.mNeedNumArr[t],e!==this.mTargetNum&&(m.default.Dispatch(u.BCType.Lottery_UpdateCrystalState),this.CheckCrystalLottery())},t.prototype.UseMultipleItem=function(){this.mIsUsingItem=!0,this.mSpeedTiming+=60*this.mSpeedItemDuration,this.mCurMaxTime=this.mSpeedTiming,m.default.Dispatch(u.BCType.MainWin_UseMultipleItem),i.default.Ins.ClientInfo.useCrystalItems++,i.default.Ins.Save(),a.default.Save(a.default.CRYSTAL_MUL_INFO,this.mSpeedTiming),r.default.Ins.CheckUseCrystalItem()},t.prototype.SetItemState=function(t){this.mPaused=t},t.prototype.OnUpdate=function(t){this.mIsUsingItem&&!this.mPaused&&(this.mSpeedTiming-=t,m.default.Dispatch(u.BCType.MultipleCrystal_UpdateTime,this.mSpeedTiming),this._SyncTimeCounter-=t,this._SyncTimeCounter<=0&&(this._SyncTimeCounter=this._SyncDuration,a.default.Save(a.default.CRYSTAL_MUL_INFO,this.mSpeedTiming)),this.mSpeedTiming<=0&&(this.mSpeedTiming=0,this.mIsUsingItem=!1,a.default.Save(a.default.CRYSTAL_MUL_INFO,0)))},t.prototype.GetCrystalNum=function(t){var e=1;switch(t){case n.Crystal:e=4;break;case n.Elite:e=16;break;case n.Boss:e=50}var o=i.default.Ins.ClientInfo,r=1;return o.curLevel===o.bestLevel&&(r=5),e*r},t.prototype.GetFlyCrystal=function(t,e,o){if(void 0===o&&(o=1),!(i.default.Ins.ClientInfo.bestLevel<=10)){this.mIsUsingItem&&(o*=2,t*=this.mSpeedItemFactor);for(var n=0,r=t/o,a=function(t){var a=t,s=e;0!==a&&(s=cc.v2(e.x+p.default.GetRandValueBetween(-30,30),e.y-60)),setTimeout(function(){l.default.Ins.Borrow(l.default.FLY_CRYSTAL,"FlyCrystal",function(t){var a=t;++n===o?a.InitData(r,e,s,function(){i.default.Ins.SaveCrystal()}):a.InitData(r,e,s),a.TriggerFly()})},150*t-15*a)},s=0;s<o;++s)a(s)}},t.prototype.InitMultipleItemTime=function(){var t=Number(a.default.Get(a.default.CRYSTAL_MUL_INFO));t&&t>0&&(this.mIsUsingItem=!0,this.mSpeedTiming=t,this.mCurMaxTime=this.mSpeedTiming,m.default.Dispatch(u.BCType.MainWin_UseMultipleItem))},t.prototype.CheckRedPointNum=function(){s.default.SetInvokeData(s.RedPointType.MainMultiple,i.default.Ins.GetItemNum(u.ItemType.MultipleCrystal))},t.prototype.CheckCrystalLottery=function(){this.UpdateCrystalTargetNum();var t=this.GetCanLotteryTimes();s.default.SetInvokeData(s.RedPointType.MainLotteryBox_Crystal,t)},t.prototype.GetCanLotteryTimes=function(){var t=0,e=i.default.Ins.ClientInfo.lottery.crystalTimes;if(e>=this.mNeedNumArr.length)this.mTargetNum=this.mNeedNumArr[this.mNeedNumArr.length-1],t=Math.floor(i.default.Ins.mCrystal/this.mTargetNum);else for(var o=i.default.Ins.mCrystal;o>0;){if(e+t>=this.mNeedNumArr.length){this.mTargetNum=this.mNeedNumArr[this.mNeedNumArr.length-1],t+=Math.floor(o/this.mTargetNum);break}(o-=this.mNeedNumArr[e+t])>=0&&t++}return t},t.prototype.CheckTicketLottery=function(){var t=i.default.Ins.GetItemNum(u.ItemType.CampTicket);s.default.SetInvokeData(s.RedPointType.MainLotteryBox_Ticket,t)},t.mIns=null,t}();o.default=c,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/PoolMgr":"PoolMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyMainTask2":"ProxyMainTask2"}],ProxyExplore:[function(t,e,o){"use strict";cc._RF.push(e,"4ac8d6oRvBG+LrvTy1Gy+XR","ProxyExplore"),Object.defineProperty(o,"__esModule",{value:!0}),o.ExploreItemInfo=o.ExploreSaveInfo=void 0;var n=t("./ProxyLottery"),r=t("./ProxyHero"),i=t("../Manager/WinMgr"),a=t("../Manager/TimeMgr"),s=t("../Manager/SaveMgr"),l=t("../Manager/RedPointMgr"),m=t("../Manager/PlatformMgr"),u=t("../Manager/FuncMgr"),p=t("../Manager/BCMgr"),c=t("../Common/EnumsDefine"),d=function(){function t(){this.mLeftNeedTime=28800,this.mRightNeedTime=172800,this.mInfo=null,this.mSaveFlag=!1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){},t.prototype.CreateDefaultInfo=function(){this.mInfo=new f,this.mInfo.itemInfoArr.push(new h(1)),this.mInfo.itemInfoArr.push(new h(2))},t.prototype.SyncInfo=function(){var t=s.default.Get(s.default.EXPLORE_INFO);t?(this.mInfo=new f,this.mInfo=JSON.parse(t)):(this.CreateDefaultInfo(),this.Save(!0)),this._HandleSelfMap()},t.prototype._HandleSelfMap=function(){},t.prototype.HandleOfflineTime=function(t){for(var e=0,o=this.mInfo.itemInfoArr.length;e<o;++e){var n=this.mInfo.itemInfoArr[e];if(n.state===c.ExploreState.Exploring){var r=t-n.startTime;n.leftTime-=r,n.leftTime<=0&&(n.leftTime=0,n.state=c.ExploreState.Completed)}}},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mInfo);s.default.Save(s.default.EXPLORE_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.UpdateOnExploring=function(t){for(var e=this.mInfo.itemInfoArr,o=0,n=e.length;o<n;++o)e[o].state===c.ExploreState.Exploring&&(e[o].leftTime-=t,e[o].leftTime<=0&&(e[o].state=c.ExploreState.Completed,l.default.SetInvokeData(l.RedPointType.ExploreItem+""+e[o].id,1)),p.default.Dispatch(c.BCType.UpdateExploreTime,o,e[o].leftTime))},t.prototype.GetExploreItemSI=function(t){return this.mInfo.itemInfoArr[t-1]},t.prototype.StartExplore=function(t){var e=this.GetExploreItemSI(t);e.state=c.ExploreState.Exploring,e.startTime=a.default.GetServerTimeInSeconds(),1===t?e.totalTime=this.mLeftNeedTime:2===t&&(e.totalTime=this.mRightNeedTime),e.leftTime=e.totalTime,this.Save(),l.default.SetInvokeData(l.RedPointType.ExploreItem+t,0),m.default.ReportEvent(c.BIPoint.ExploreHero_Begin,{id:t})},t.prototype.GetExploreRewards=function(t){var e=this.GetExploreItemSI(t);if(e.state===c.ExploreState.Completed){e.state=c.ExploreState.Idle;var o=0;1===t?o=n.default.Ins.LotteryByQuality(c.HeroQuality.SR):2===t&&(o=n.default.Ins.LotteryByQuality(c.HeroQuality.SSR)),1===r.default.Ins.GetHero([o])[0]?i.default.Ins.Open(c.WinType.NewHeroShowWin,function(t){t.SetData(o)}):i.default.Ins.Open(c.WinType.RepeatHeroWin,function(t){t.SetData(o)}),this.Save(),l.default.SetInvokeData(l.RedPointType.ExploreItem+t,0),m.default.ReportEvent(c.BIPoint.ExploreHero_Get,{id:t})}},t.prototype.CheckRedPointNum=function(){if(u.default.IsUnlock(u.FuncType.Explore))for(var t=this.mInfo.itemInfoArr,e=0,o=t.length;e<o;++e){var n=e+1;t[e].state===c.ExploreState.Idle||t[e].state===c.ExploreState.Completed?l.default.SetInvokeData(l.RedPointType.ExploreItem+n,1):l.default.SetInvokeData(l.RedPointType.ExploreItem+n,0)}},t.mIns=null,t}();o.default=d;var f=function(){this.itemInfoArr=[]};o.ExploreSaveInfo=f;var h=function(t){this.id=1,this.state=c.ExploreState.Idle,this.startTime=0,this.totalTime=3600,this.leftTime=0,this.id=t};o.ExploreItemInfo=h,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/FuncMgr":"FuncMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/TimeMgr":"TimeMgr","../Manager/WinMgr":"WinMgr","./ProxyHero":"ProxyHero","./ProxyLottery":"ProxyLottery"}],ProxyForge:[function(t,e,o){"use strict";cc._RF.push(e,"2ecf68ZnVdLPaGHVxUgp3dY","ProxyForge"),Object.defineProperty(o,"__esModule",{value:!0}),o.BlackSmithSaveInfo=o.ForgeInfo=void 0;var n=t("./ProxyTask"),r=t("./ProxySmith"),i=t("./ProxyMainTask2"),a=t("./ProxyAllSP"),s=t("../Manager/UserMgr"),l=t("../Manager/TimeMgr"),m=t("../Manager/SaveMgr"),u=t("../Manager/RedPointMgr"),p=t("../Manager/PlatformMgr"),c=t("../Manager/DataMgr"),d=t("../Manager/BCMgr"),f=t("../Common/EnumsDefine"),h=t("../Common/Common"),y=function(){function t(){this.mSmith2PassedLevel=100,this.mSmith3PassedLevel=500,this.mSmith4PassedLevel=1e3,this.mSmith2NeedVIPLv=1,this.mSmith4NeedVIPLv=3,this.mAdvForgeGold=100,this.mLuckyRefineBaseRate=10,this.mLuckyImtPoolArr=null,this.mForgeInfo=null,this.mSaveFlag=!1,this.mTitleStrArr=["\u5b66\u5f92","\u5de7\u5320","\u5de5\u5320","\u5320\u5723","\u5320\u795e","\u8363\u8000\u5320\u795e"]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=c.default.Ins.m_DB.paramDB;this.mAdvForgeGold=Number(t.ADV_FORGE_GOLD.value),this.mLuckyRefineBaseRate=Number(t.LUCKY_IMT_REFINE_BASE_RATE.value);var e=t.LUCKY_IMT_POOL_ARR.value;this.mLuckyImtPoolArr=h.default.Split2NumArr(e)},t.prototype.CreateDefaultInfo=function(){var t=new g;t.blackSmithArr.push(new I(1)),t.blackSmithArr.push(new I(2)),t.blackSmithArr.push(new I(3)),t.blackSmithArr.push(new I(4)),t.blackSmithArr[0].forgeState=f.ForgeState.Idle,t.blackSmithArr[0].lv=0,t.blackSmithArr[1].lv=0,t.blackSmithArr[2].lv=0,t.blackSmithArr[3].lv=0,t.blackSmithArr[0].title=f.BlackSmithTitle.Trainee,t.blackSmithArr[1].title=f.BlackSmithTitle.Trainee,t.blackSmithArr[2].title=f.BlackSmithTitle.Trainee,t.blackSmithArr[3].title=f.BlackSmithTitle.Trainee,this.mForgeInfo=t,this._ConvertToAttrMap()},t.prototype.SyncInfo=function(){var t=m.default.Get(m.default.FORGE_INFO);this.mForgeInfo=null,this.mForgeInfo=JSON.parse(t),this._HandleSelfMap(),this._ConvertToAttrMap()},t.prototype._ConvertToAttrMap=function(){},t.prototype._HandleSelfMap=function(){},t.prototype.HandleOfflineTime=function(t){for(var e=0,o=this.mForgeInfo.blackSmithArr.length;e<o;++e){var n=this.mForgeInfo.blackSmithArr[e];if(n.forgeState===f.ForgeState.Forging){var r=t-n.startForgeTime;n.leftTime-=r,n.leftTime<=0&&(n.leftTime=0,n.forgeState=f.ForgeState.Completed)}}},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mForgeInfo);m.default.Save(m.default.FORGE_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.UpdateOnForging=function(t){for(var e=this.mForgeInfo.blackSmithArr,o=0,n=e.length;o<n;++o)e[o].forgeState===f.ForgeState.Forging&&(e[o].leftTime-=t,e[o].leftTime<=0&&(e[o].forgeState=f.ForgeState.Completed,u.default.SetInvokeData(u.RedPointType.Imt_Smith+(o+1),1)),d.default.Dispatch(f.BCType.UpdateForgeTime,o,e[o].leftTime))},t.prototype.GetBSmithSI=function(t){return this.mForgeInfo.blackSmithArr[t-1]},t.prototype.Forge=function(t,e){var o=this.GetBSmithSI(t),r=c.default.Ins.m_DB.blackSmithDB[o.title],a=r.pool[0][0],s=r.pool[1][0],m=a;if(e===f.ForgeType.Advance){var p=.01*r.pool[1][1];h.default.GetRandValueBetween(0,100)<=p&&(m=s)}for(var d=c.default.Ins.m_DB.forgePoolDB[m].pool,y=[],g=0,I=d.length;g<I;++g)y.push(d[g][1]);var S=d[h.default.GetRandIdxByWeight(y,1)[0]][0];return o.forgeState=f.ForgeState.Forging,o.startForgeTime=l.default.GetServerTimeInSeconds(),e===f.ForgeType.Normal?o.totalTime=60*r.time[0]:o.totalTime=60*r.time[1],o.leftTime=o.totalTime,this.mForgeInfo.forgeTimes++,1===this.mForgeInfo.forgeTimes&&(S=10004),this.Save(),u.default.SetInvokeData(u.RedPointType.Imt_Smith+t,0),n.default.Ins.UpdateTaskProgress(n.DailyTaskType.Forge,1),i.default.Ins.CheckForgeImt(),S},t.prototype.GetLuckyImtByStar=function(t){if(1===t)return console.error("\u6ca1\u67091\u661f\u7684\u5361\u6c60"),10001;for(var e=this.mLuckyImtPoolArr[t-2],o=c.default.Ins.m_DB.forgePoolDB[e].pool,n=[],r=0,i=o.length;r<i;++r)n.push(o[r][1]);return o[h.default.GetRandIdxByWeight(n,1)[0]][0]},t.prototype.GetForgeTitleStr=function(t){return this.mTitleStrArr[t-1]},t.prototype.CheckUnlock=function(){for(var t=this.mForgeInfo.blackSmithArr,e=s.default.Ins.ClientInfo.bestLevel,o=s.default.Ins.ClientInfo.vip.lv,n=0,r=t.length;n<r;++n)t[n].forgeState===f.ForgeState.Lock&&(1===n?e>this.mSmith2PassedLevel&&o>=this.mSmith2NeedVIPLv&&this.UnlockForge(n+1):2===n?e>this.mSmith3PassedLevel&&(this.GetBSmithSI(n+1).forgeState=f.ForgeState.BtnLock,d.default.Dispatch(f.BCType.RefreshSmithState,n+1)):3===n&&e>this.mSmith4PassedLevel&&o>=this.mSmith4NeedVIPLv&&this.UnlockForge(n+1))},t.prototype.UnlockForge=function(t){this.GetBSmithSI(t).forgeState=f.ForgeState.Idle,3===t&&(s.default.Ins.UpdateItem(f.ItemType.ADCoin,-5),p.default.ReportEvent(f.BIPoint.ADCoinItem,{id:101})),s.default.Ins.Save(),this.Save(),d.default.Dispatch(f.BCType.RefreshSmithState,t),a.default.Ins.UpdateTaskProgress(a.AllSPTaskType.UnlockSmith,1)},t.prototype.SpeedUp=function(t){var e=this.GetBSmithSI(t);e.forgeState=f.ForgeState.Completed,e.leftTime=0,this.Save(),u.default.SetInvokeData(u.RedPointType.Imt_Smith+t,1)},t.prototype.GetForgeImt=function(t){var e=this.GetBSmithSI(t);e.forgeState=f.ForgeState.Idle,e.imtID=0,this.Save(),u.default.SetInvokeData(u.RedPointType.Imt_Smith+t,1)},t.prototype.GetLuckyRefineRate=function(){var t=this.mLuckyRefineBaseRate;return 0===this.mForgeInfo.refineCount&&(t=100),t},t.prototype.LuckyRefine=function(){var t=!1,e=this.GetLuckyRefineRate();return h.default.GetRandValueBetween(0,100)<=e&&(t=!0),this.mForgeInfo.refineCount++,this.Save(),t},t.prototype.GetForgeExp=function(t,e){var o=this.GetBSmithSI(t),n=c.default.Ins.m_DB.blackSmithDB[o.title].forgeExp[e],i=r.default.Ins.GetData(o.title,o.lv).forgeExpAdd;return Math.floor(n*(1+.01*i))},t.prototype.GetBaseForgeExp=function(){for(var t=f.BlackSmithTitle.Trainee,e=1;e<=4;++e){var o=this.GetBSmithSI(e);o.title>t&&(t=o.title)}return c.default.Ins.m_DB.blackSmithDB[t].forgeExp[0]},t.prototype.FirstShowPicture=function(){this.mForgeInfo.hasShownPicture=!0,this.Save(),u.default.SetInvokeData(u.RedPointType.Imt_Picture,0)},t.prototype.CheckPictureRedPointNum=function(){this.mForgeInfo.hasShownPicture?u.default.SetInvokeData(u.RedPointType.Imt_Picture,0):u.default.SetInvokeData(u.RedPointType.Imt_Picture,1)},t.prototype.GetBestSmith=function(){for(var t=this.mForgeInfo.blackSmithArr,e=t[0],o=0,n=t.length;o<n;++o)(e.title<t[o].title||e.title===t[o].title&&e.lv<t[o].lv)&&(e=t[o]);return e},t.prototype.CheckRedPoint=function(){for(var t=this.mForgeInfo.blackSmithArr,e=0,o=t.length;e<o;++e)t[e].forgeState!==f.ForgeState.Completed&&t[e].forgeState!==f.ForgeState.Idle||u.default.SetInvokeData(u.RedPointType.Imt_Smith+(e+1),1)},t.mIns=null,t}();o.default=y;var g=function(){this.forgeTimes=0,this.blackSmithArr=[],this.refineCount=0,this.hasUnlockFirstSmith=!1,this.hasShownPicture=!1};o.ForgeInfo=g;var I=function(t){this.id=1,this.title=f.BlackSmithTitle.Trainee,this.lv=0,this.addSuccess=0,this.forgeState=f.ForgeState.Lock,this.imtID=0,this.startForgeTime=0,this.totalTime=3600,this.leftTime=0,this.id=t};o.BlackSmithSaveInfo=I,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","./ProxyAllSP":"ProxyAllSP","./ProxyMainTask2":"ProxyMainTask2","./ProxySmith":"ProxySmith","./ProxyTask":"ProxyTask"}],ProxyFreeGoldAct:[function(t,e,o){"use strict";cc._RF.push(e,"f3e65uR6F1EHJ+ydJEnrPXr","ProxyFreeGoldAct"),Object.defineProperty(o,"__esModule",{value:!0}),o.FreeGoldActInfo=void 0;var n=t("../Manager/UserMgr"),r=t("../Manager/RedPointMgr"),i=t("../Common/EnumsDefine"),a=function(){function t(){this.mNormalGoldNum=50,this.mAdvGoldNum=200}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.RefreshOnNewDay=function(t){n.default.Ins.ClientInfo.freeGoldActInfo.hasGot=!1,t||this.CheckRedPoint()},t.prototype.Upgrade=function(){n.default.Ins.ClientInfo.freeGoldActInfo.hasUpgraded=!0,n.default.Ins.Save()},t.prototype.GetGold=function(){var t,e=n.default.Ins.ClientInfo.freeGoldActInfo;return e.hasGot=!0,t=e.hasUpgraded?this.mAdvGoldNum:this.mNormalGoldNum,n.default.Ins.UpdateItem(i.ItemType.Gold,t),n.default.Ins.Save(),this.CheckRedPoint(),t},t.prototype.CheckRedPoint=function(){n.default.Ins.ClientInfo.freeGoldActInfo.hasGot?r.default.SetInvokeData(r.RedPointType.Act_FreeGold,0):r.default.SetInvokeData(r.RedPointType.Act_FreeGold,1)},t.mIns=null,t}();o.default=a;o.FreeGoldActInfo=function(){this.hasGot=!1,this.hasUpgraded=!1},cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/RedPointMgr":"RedPointMgr","../Manager/UserMgr":"UserMgr"}],ProxyHeroMap:[function(t,e,o){"use strict";cc._RF.push(e,"86b4bnQDZ5FxY3mqrYhjb8U","ProxyHeroMap"),Object.defineProperty(o,"__esModule",{value:!0}),o.MapSaveInfo=o.MapHeroState=void 0;var n,r=t("./ProxyLottery"),i=t("./ProxyHero"),a=t("../Manager/WinMgr"),s=t("../Manager/UserMgr"),l=t("../Manager/SaveMgr"),m=t("../Manager/RedPointMgr"),u=t("../Manager/DataMgr"),p=t("../Common/EnumsDefine");(function(t){t[t.Lock=0]="Lock",t[t.NotGot=1]="NotGot",t[t.HasGot=2]="HasGot"})(n=o.MapHeroState||(o.MapHeroState={}));var c=function(){function t(){this.mDataCount=0,this.mDataMap=new Map,this.mQualityColorArr=[new cc.Color(0,255,0,255),new cc.Color(122,199,255,255),new cc.Color(204,122,255,255),new cc.Color(255,247,122,255),new cc.Color(218,70,181,255)],this.mStateColorArr=[new cc.Color(222,67,42,255),new cc.Color(145,114,40),new cc.Color(20,123,0)],this.mMapInfo=null,this.mSaveFlag=!1,this.mCurMapID=0,this.mGoldNumArr=[10,20,30]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=u.default.Ins.m_DB.heroMapDB;for(var e in t)if(t.hasOwnProperty(e)){this.mDataCount++;var o=t[e],n=this.mDataMap.get(o.tab);n||(n=new Array,this.mDataMap.set(o.tab,n)),n.push(o)}},t.prototype.CreateDefaultInfo=function(){this.mMapInfo=new d},t.prototype.SyncInfo=function(){var t=l.default.Get(l.default.MAP_INFO);t?(this.mMapInfo=new d,this.mMapInfo=JSON.parse(t)):this.mMapInfo=new d,this._HandleSelfMap()},t.prototype._HandleSelfMap=function(){},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mMapInfo);l.default.Save(l.default.MAP_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.GetNameColor=function(t){return this.mQualityColorArr[t+1]},t.prototype.GetHeroState=function(t){var e=s.default.Ins.ClientInfo.bestLevel,o=u.default.Ins.m_DB.heroCardDB[t],r=i.default.Ins.GetHeroSI(t);if(!o)return n.Lock;if(o.baseQuality===p.HeroQuality.SSR){if(e<o.unlockLevel)return n.Lock}else if(null!==r)return n.HasGot;return e<o.unlockLevel?n.Lock:null===r?n.NotGot:n.HasGot},t.prototype.GetColorByHeroState=function(t){return this.mStateColorArr[t]},t.prototype.CheckOnPassBestLevel=function(){if(0===this.mCurMapID&&(this.mCurMapID=this._CalculateCurMapID()),-1!==this.mCurMapID){var t=u.default.Ins.m_DB.heroMapDB[this.mCurMapID],e=s.default.Ins.ClientInfo.bestLevel;t.levelArr[1]<e&&(this.mCurMapID++,this.mCurMapID>this.mDataCount?this.mCurMapID=-1:t=u.default.Ins.m_DB.heroMapDB[this.mCurMapID]);for(var o=t.heroArr,n=u.default.Ins.m_DB.heroCardDB,l=function(t){var s=n[o[t]];if(s.unlockLevel===e){0!==s.poolState&&r.default.Ins.AddDynamicHero(s.baseQuality,o[t]);var l=s.baseQuality;if(l===p.HeroQuality.SSR){var u=o[t];11!==e&&a.default.Ins.Open(p.WinType.HeroUnlockWin,function(t){t.SetData(u)}),l===p.HeroQuality.SSR&&null!==i.default.Ins.GetHeroSI(u)&&m.TagHeroReward(u)}}},m=this,c=0,d=o.length;c<d;++c)l(c)}},t.prototype.GetCachedCurMapID=function(){return 0!==this.mCurMapID?this.mCurMapID:(this.mCurMapID=this._CalculateCurMapID(),this.mCurMapID)},t.prototype._CalculateCurMapID=function(){var t=s.default.Ins.ClientInfo.bestLevel,e=u.default.Ins.m_DB.heroMapDB;for(var o in e)if(e.hasOwnProperty(o)){var n=e[o],r=n.levelArr;if(r[0]<=t&&t<=r[1])return n.Id}return-1},t.prototype.GetGoldNumByID=function(t){if(!this.mMapInfo.toGetArr.includes(t))return 0;var e=u.default.Ins.m_DB.heroCardDB[t];return e?this.mGoldNumArr[e.baseQuality]:0},t.prototype.GetHeroReward=function(t,e){var o=this.mMapInfo.toGetArr.indexOf(t);-1!==o&&this.mMapInfo.toGetArr.splice(o,1),s.default.Ins.UpdateItem(p.ItemType.Gold,e),a.default.Ins.Open(p.WinType.GetRewardsWin,function(t){t.SetDataSingle(p.ItemType.Gold,e+"")}),this.Save(),m.default.SetInvokeData(m.RedPointType.Main_Map,this.mMapInfo.toGetArr.length)},t.prototype.OnGetNewHero=function(t){var e=u.default.Ins.m_DB.heroCardDB[t];if(e){var o=e.unlockLevel;(s.default.Ins.ClientInfo.bestLevel>=o||e.baseQuality!==p.HeroQuality.SSR)&&this.TagHeroReward(t)}},t.prototype.CheckRedPointNum=function(){m.default.SetInvokeData(m.RedPointType.Main_Map,this.mMapInfo.toGetArr.length)},t.prototype.TagHeroReward=function(t){this.mMapInfo.toGetArr.includes(t)||(this.mMapInfo.toGetArr.push(t),m.default.SetInvokeData(m.RedPointType.Main_Map,this.mMapInfo.toGetArr.length),this.Save())},t.prototype.GetTabIDByHeroID=function(t){var e=-1;return this.mDataMap.forEach(function(o,n){for(var r=o,i=0,a=r.length;i<a;++i)if(r[i].heroArr.includes(t))return e=n}),e},t.mIns=null,t}();o.default=c;var d=function(){this.toGetArr=[]};o.MapSaveInfo=d,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/DataMgr":"DataMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyHero":"ProxyHero","./ProxyLottery":"ProxyLottery"}],ProxyHero:[function(t,e,o){"use strict";cc._RF.push(e,"202d4SIFxZCP61B0Nl+l5bb","ProxyHero"),Object.defineProperty(o,"__esModule",{value:!0}),o.SingleHeroAddAllAttrInfo=o.HeroAddAllAttrInfo=o.HeroAddSelfAttrInfo=o.HeroSaveInfo=o.HeroInfo=void 0;var n=t("./ProxyTask"),r=t("./ProxySkin"),i=t("./ProxyOffline"),a=t("./ProxyMainTask2"),s=t("./ProxyLottery"),l=t("./ProxyLargeNum"),m=t("./ProxyImmortal"),u=t("./ProxyHeroMap"),p=t("./ProxyAllSP"),c=t("../Manager/WinMgr"),d=t("../Manager/UserMgr"),f=t("../Manager/SaveMgr"),h=t("../Manager/RedPointMgr"),y=t("../Manager/PlatformMgr"),g=t("../Manager/FightMgr"),I=t("../Manager/DataMgr"),S=t("../Manager/BCMgr"),_=t("../Common/SwitchConfig"),v=t("../Common/EnumsDefine"),C=t("../Common/Common"),M=function(){function t(){this.mCampHeroIDArr=[[],[],[],[]],this.mQualityHeroIDArr=[[],[],[]],this.mAllHeroIDArr=[],this.mStarFramentArrByQuality=[],this.mQualityFragmentArr=[],this.mNewHeroGoldNum=25,this.mAwakeNeedArr=[],this.mExtendPosCostArr=[],this.mQualityFactorArr=null,this.mAccQualityFactorArr=[],this.mRecycleMedalGoldArr=[],this.mBaseCostMedal=10,this.mMedalCostArr=[],this.mMedalStartCostArr=[],this.mMedalTotalCostArr=[],this.mHeroAddSelfAttrMap=null,this.mHeroAddAllAttrInfo=new A,this.mHeroInfo=null,this.mSaveFlag=!1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitCampData=function(){var t=I.default.Ins.m_DB.heroCardDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];this.mCampHeroIDArr[o.camp].push(o.id),this.mQualityHeroIDArr[o.baseQuality].push(o.id),this.mAllHeroIDArr.push(o.id)}},t.prototype._InitMedalStartCostArr=function(){var t=this.mBaseCostMedal;this.mMedalStartCostArr.push(t);for(var e=0,o=0,n=this.mMedalCostArr.length;o<n;++o)t+=(this.mMedalCostArr[o][0]-e)*this.mMedalCostArr[o][1],e=this.mMedalCostArr[o][0],this.mMedalStartCostArr.push(t)},t.prototype._InitMedalTotalCostArr=function(){this.mMedalTotalCostArr.push(0);for(var t=this.mBaseCostMedal,e=0,o=0,n=0,r=this.mMedalCostArr.length;n<r;++n){var i=this.mMedalCostArr[n][0]-o,a=this.mMedalCostArr[n][1];0!==n&&(t+=a),e+=i*t+i*(i-1)/2*a,this.mMedalTotalCostArr.push(e),o=this.mMedalCostArr[n][0],t+=(i-1)*a}},t.prototype.InitParam=function(){for(var t=I.default.Ins.m_DB.paramDB,e=t.STAR_FRAGMENT_ARR.value.split("|"),o=0,n=e.length;o<n;++o)this.mStarFramentArrByQuality.push(C.default.Split2NumArr(e[o],","));var r=t.QUALITY_FRAGMENT_ARR.value.split("|");for(o=0,n=r.length;o<n;++o)this.mQualityFragmentArr.push(C.default.Split2NumArr(r[o],","));var i=t.AWAKE_NEED_NUM_ARR.value;this.mAwakeNeedArr=C.default.Split2NumArr(i,"|");var a=t.QUALITY_ADD_NUM_ARR.value;this.mQualityFactorArr=C.default.Split2NumArr(a,"|");var s=1;for(this.mAccQualityFactorArr.push(s),o=0,n=this.mQualityFactorArr.length;o<n;++o)s*=this.mQualityFactorArr[o],this.mAccQualityFactorArr.push(s);var l=t.EXTEND_POS_COST_ARR.value;this.mExtendPosCostArr=C.default.Split2NumArr(l,"|");var m=t.RECYCLE_MEDAL_GOLD.value.split("|");for(o=0,n=m.length;o<n;++o)this.mRecycleMedalGoldArr.push(C.default.Split2NumArr(m[o],","));this.mBaseCostMedal=Number(t.BASE_COST_MEDAL.value);var u=t.MEDAL_COST_ARR.value.split("|");for(o=0,n=u.length;o<n;++o)this.mMedalCostArr.push(C.default.Split2NumArr(u[o],","));this._InitMedalStartCostArr(),this._InitMedalTotalCostArr(),this.InitCampData()},t.prototype.CreateDefaultHeroInfo=function(){var t=new P;if(t.heroMap=new d.SelfObjMap(null),t.heroMap.Set(3004,new T(3004)),t.heroMap.Set(3001,new T(3001)),t.heroMap.Get(3004).heroQuality=v.HeroQuality.R,t.heroMap.Get(3004).starLv=2,t.heroMap.Get(3001).starLv=2,_.default.mAllHero)for(var e=0,o=this.mAllHeroIDArr.length;e<o;++e){var n=this.mAllHeroIDArr[e];t.heroMap.Set(n,new T(n)),I.default.Ins.m_DB.itemDB[n],t.heroMap.Get(n).heroQuality=v.HeroQuality.SP,t.heroMap.Get(n).starLv=5}t.heroTeam=[],t.heroTeam.push(3004),t.heroTeam.push(3001),t.heroTeam.push(0),t.heroTeam.push(0),this.mHeroInfo=t,this._ConvertToHeroSelfAttr(),this._ConvertToHeroAllAttr()},t.prototype.SyncHeroInfo=function(){var t=f.default.Get(f.default.HERO_INFO);this.mHeroInfo=new P,this.mHeroInfo=JSON.parse(t),this._HandleSelfMap(),this._ConvertToHeroSelfAttr(),this._ConvertToHeroAllAttr()},t.prototype._HandleSelfMap=function(){this.mHeroInfo.heroMap=new d.SelfObjMap(this.mHeroInfo.heroMap.obj)},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mHeroInfo);f.default.Save(f.default.HERO_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype._ConvertToHeroAllAttr=function(){var e=t.Ins.mHeroInfo.heroMap.obj;for(var o in e)if(e.hasOwnProperty(o)&&e[o].heroQuality===v.HeroQuality.SP){var n=Number(o);this.mHeroAddAllAttrInfo.AddHeroAttr(n)}},t.prototype._ConvertToHeroSelfAttr=function(){this.mHeroAddSelfAttrMap=new Map;var e=t.Ins.mHeroInfo.heroMap.obj;for(var o in e)if(e.hasOwnProperty(o)){var n=e[o].starLv,r=Number(o);this._UpdateHeroStarPassiveAddAttr(r,n)}},t.prototype._UpdateHeroStarPassiveAddAttr=function(t,e){if(e>=3){var o=I.default.Ins.m_DB.entityDB[t].passiveSkills,n=this.mHeroAddSelfAttrMap.get(t);void 0===n?(n=new D(t),this.mHeroAddSelfAttrMap.set(t,n)):n.starAddMap=new Map;for(var r=3;r<=e;++r){var i=I.default.Ins.m_DB.passiveDB[o[r-2]].effectParam,a=n.starAddMap,s=Number(i[0]),l=Number(i[1]),m=a.get(s);void 0===m?a.set(s,l):a.set(s,m+l)}}},t.prototype.CheckHasHero=function(t){return null!==this.mHeroInfo.heroMap.Get(t)},t.prototype.GetHeroSI=function(t){return this.mHeroInfo.heroMap.Get(t)},t.prototype.GetHeroSelfAddAttr=function(t,e){var o=this.mHeroAddSelfAttrMap.get(t);return void 0===o?0:o.GetAttrNumber(e)},t.prototype.GetHeroProfessionAllAddAttr=function(t,e){return this.mHeroAddAllAttrInfo.GetAttrByProfession(t,e)},t.prototype.GetHeroCampAllAddAttr=function(t,e){return this.mHeroAddAllAttrInfo.GetAttrByCamp(t,e)},t.prototype.UpgradeGoldLv=function(t,e){void 0===e&&(e=1),this.GetHeroSI(t).goldLv+=e,this.Save(),g.default.Ins.UpdateHeroAttr(t),i.default.Ins.OnHeroAttrChanged(t),a.default.Ins.CheckHeroCoinLv()},t.prototype.UpgradeMedalLv=function(t,e){void 0===e&&(e=1),this.GetHeroSI(t).medalLv+=e,this.Save(),g.default.Ins.UpdateHeroAttr(t),S.default.Dispatch(v.BCType.OnUpgradeHeroMedalLv,t),i.default.Ins.OnHeroAttrChanged(t),a.default.Ins.CheckMedalLv(),n.default.Ins.UpdateTaskProgress(n.DailyTaskType.MedalLv,1)},t.prototype.UpgradeStarLv=function(e){var o=this.GetHeroSI(e);if(o.starLv<t.MAX_STAR_LV){o.starLv++,this.Save(),this._UpdateHeroStarPassiveAddAttr(e,o.starLv),g.default.mNormalFightMode.AddPassiveSkill(e),g.default.Ins.UpdateHeroAttr(e),S.default.Dispatch(v.BCType.OnUpgradeHeroStarLv,e),i.default.Ins.OnHeroAttrChanged(e);var n=I.default.Ins.m_DB.heroCardDB[e].baseQuality;2===o.starLv?n===v.HeroQuality.R?p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.UpgradeRHeroToStar2,1):n===v.HeroQuality.SR?p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.UpgradeSRHeroToStar2,1):n===v.HeroQuality.SSR&&p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.UpgradeSSRHeroToStar2,1):5===o.starLv&&(n===v.HeroQuality.SR?p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.UpgradeSRHeroToStar5,1):n===v.HeroQuality.SSR&&p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.UpgradeSSRHeroToStar5,1)),this.CheckHeroStarAwake(e);var r=0,a=this.mHeroInfo.heroMap.obj;for(var s in a)if(a.hasOwnProperty(s)&&a[s].starLv>=o.starLv&&++r>1)break;1===r&&y.default.ReportEvent(v.BIPoint.MAX_HERO_STAR,{star:o.starLv})}},t.prototype.UpgradeQuality=function(t){var e=this.GetHeroSI(t);if(null!==e&&e.heroQuality<v.HeroQuality.SP){if(e.heroQuality++,this.Save(),e.heroQuality===v.HeroQuality.SP){this.mHeroAddAllAttrInfo.AddHeroAttr(t);for(var o=this.mHeroInfo.heroTeam,n=0,r=o.length;n<r;++n){var a=o[n];0!==a&&(g.default.Ins.UpdateHeroAttr(a),S.default.Dispatch(v.BCType.OnUpgradeHeroQuality,a))}i.default.Ins.OnAllAttrChanged()}else g.default.Ins.UpdateHeroAttr(t),S.default.Dispatch(v.BCType.OnUpgradeHeroQuality,t),i.default.Ins.OnHeroAttrChanged(t);if(e.heroQuality===v.HeroQuality.SR)p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.AwakeRHeroToSR,1);else if(e.heroQuality===v.HeroQuality.SSR){var s=I.default.Ins.m_DB.heroCardDB[t].baseQuality;s===v.HeroQuality.R?p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.AwakeRHeroToSSR,1):s===v.HeroQuality.SR&&p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.AwakeSRHeroToSSR,1)}this.CheckHeroStarAwake(t)}},t.prototype.GetAccQualityFactor=function(t){return this.mAccQualityFactorArr[t]},t.prototype.GetHeroAtk=function(e,o){void 0===o&&(o=!0);var n=I.default.Ins.m_DB.entityDB[e],i=I.default.Ins.m_DB.heroCardDB[e],a=this.GetHeroSI(e);if(null===a)return new l.LargeNumber(n.attack,0);var s=a.medalLv;o&&(s+=a.goldLv);var u=l.default.Pow(t.LV_FACTOR,s),p=(1===a.starLv?1:Math.pow(t.STAR_FACTOR,a.starLv-1))*this.GetAccQualityFactor(a.heroQuality),c=1+.01*this.GetHeroSelfAddAttr(e,v.AttributeType.Atk);return c+=.01*this.GetHeroCampAllAddAttr(i.camp,v.AttributeType.Atk),p*=c+=.01*this.GetHeroProfessionAllAddAttr(n.profession,v.AttributeType.Atk),p*=1+.01*(m.default.Ins.GetHeroAttrValue(v.ImtAttrType.Atk,-1)+m.default.Ins.GetHeroAttrValue(v.ImtAttrType.Atk,i.camp))+.01*(r.default.Ins.GetHeroAttrValue(r.SkinAttrType.Atk,-1)+r.default.Ins.GetHeroAttrValue(r.SkinAttrType.Atk,i.camp)),u.MultiplySelfSingle(n.attack*p),u},t.prototype.GetHeroDef=function(e,o){void 0===o&&(o=!0);var n=I.default.Ins.m_DB.entityDB[e],i=I.default.Ins.m_DB.heroCardDB[e],a=this.GetHeroSI(e);if(null===a)return new l.LargeNumber(n.defend,0);var s=a.medalLv;o&&(s+=a.goldLv);var u=l.default.Pow(t.LV_FACTOR,s),p=(1===a.starLv?1:Math.pow(t.STAR_FACTOR,a.starLv-1))*this.GetAccQualityFactor(a.heroQuality),c=1+.01*this.GetHeroSelfAddAttr(e,v.AttributeType.Def);return c+=.01*this.GetHeroCampAllAddAttr(i.camp,v.AttributeType.Def),p*=c+=.01*this.GetHeroProfessionAllAddAttr(n.profession,v.AttributeType.Def),p*=1+.01*(m.default.Ins.GetHeroAttrValue(v.ImtAttrType.Def,-1)+m.default.Ins.GetHeroAttrValue(v.ImtAttrType.Def,i.camp))+.01*(r.default.Ins.GetHeroAttrValue(r.SkinAttrType.Def,-1)+r.default.Ins.GetHeroAttrValue(r.SkinAttrType.Def,i.camp)),u.MultiplySelfSingle(n.defend*p),u},t.prototype.GetHeroHP=function(e,o){void 0===o&&(o=!0);var n=I.default.Ins.m_DB.entityDB[e],i=I.default.Ins.m_DB.heroCardDB[e],a=this.GetHeroSI(e);if(null===a)return new l.LargeNumber(n.hp,0);var s=a.medalLv;o&&(s+=a.goldLv);var u=l.default.Pow(t.LV_FACTOR,s),p=(1===a.starLv?1:Math.pow(t.STAR_FACTOR,a.starLv-1))*this.GetAccQualityFactor(a.heroQuality),c=1+.01*this.GetHeroSelfAddAttr(e,v.AttributeType.HP);return c+=.01*this.GetHeroCampAllAddAttr(i.camp,v.AttributeType.HP),p*=c+=.01*this.GetHeroProfessionAllAddAttr(n.profession,v.AttributeType.HP),p*=1+.01*(m.default.Ins.GetHeroAttrValue(v.ImtAttrType.HP,-1)+m.default.Ins.GetHeroAttrValue(v.ImtAttrType.HP,i.camp))+.01*(r.default.Ins.GetHeroAttrValue(r.SkinAttrType.HP,-1)+r.default.Ins.GetHeroAttrValue(r.SkinAttrType.HP,i.camp)),u.MultiplySelfSingle(n.hp*p),u},t.prototype._GetCostRate=function(){var t=.01*m.default.Ins.GetAttrValue(v.ImtAttrType.HeroUpgradeReduce);return 1-t/(t+1)},t.prototype.GetCostGold=function(e,o){void 0===o&&(o=1);var n=this.GetHeroSI(e).goldLv,r=t.HERO_BASE_COST;r*=this._GetCostRate();var i=l.default.Pow(t.LV_GOLD_FACTOR,n);if(i.MultiplySelfSingle(r),10===o)i=l.default.RateSum(i,t.LV_GOLD_FACTOR,o);else if(100===o)i=l.default.RateSum(i,t.LV_GOLD_FACTOR,o);else if(-1===o){var a=t.Ins.GetMaxCanUpradeLv(e,d.default.Ins.mCoin);if(0===a)return new l.LargeNumber(0,0);i=l.default.RateSum(i,t.LV_GOLD_FACTOR,a)}return i},t.prototype.GetMaxCanUpradeLv=function(e,o){var n=this.GetHeroSI(e).goldLv,r=t.HERO_BASE_COST,i=l.default.Pow(t.LV_GOLD_FACTOR,n);i.MultiplySelfSingle(r);for(var a=new l.LargeNumber(i.mBaseValue,i.mExpoValue),s=1;s<=5;++s){if(1===a.Compare(o))return s-1;i.MultiplySelfSingle(t.LV_GOLD_FACTOR),a.AddSelf(i)}var m=l.default.Pow(t.LV_GOLD_FACTOR,n);if(m.MultiplySelfSingle(r),o.Compare(m)<0)return 0;var u=m.DivideSingle(t.LV_GOLD_FACTOR-1);u=o.Divide(u);var p=(Math.log10(u.mBaseValue)+3*u.mExpoValue)/C.default.LOG10_GOLD_LV_FACTOR;return Math.floor(p)},t.prototype.CheckHeroInTeam=function(t){return this.mHeroInfo.heroTeam.indexOf(t)>=0},t.prototype.GetHeroCampArr=function(){var e=[[],[],[],[]],o=t.Ins.mHeroInfo.heroMap.obj,n=null;for(var r in o)o.hasOwnProperty(r)&&(n=o[r],e[I.default.Ins.m_DB.heroCardDB[n.id].camp].push(n.id));return e},t.prototype.GetHeroStarArr=function(){var e=[[],[],[],[],[]],o=t.Ins.mHeroInfo.heroMap.obj,n=null;for(var r in o)o.hasOwnProperty(r)&&e[5-(n=o[r]).starLv].push(n.id);return e},t.prototype.GetHeroQualityArr=function(){var e=[[],[],[],[]],o=t.Ins.mHeroInfo.heroMap.obj,n=null;for(var r in o)o.hasOwnProperty(r)&&e[3-(n=o[r]).heroQuality].push(n.id);return e},t.prototype.GetHeroCounterArr=function(){var e=[[],[],[]],o=t.Ins.mHeroInfo.heroMap.obj,n=null;for(var r in o)o.hasOwnProperty(r)&&(n=o[r],e[I.default.Ins.m_DB.heroCardDB[n.id].counter].push(n.id));return e},t.prototype.GetHeroProfessionArr=function(){var e=[[],[],[],[],[],[],[],[]],o=t.Ins.mHeroInfo.heroMap.obj,n=null;for(var r in o)o.hasOwnProperty(r)&&(n=o[r],e[I.default.Ins.m_DB.entityDB[n.id].profession].push(n.id));return e},t.prototype.ExcludeHeroArr=function(t,e){for(var o=0,n=t.length;o<n;++o)for(var r=t[o],i=r.length-1;i>=0;--i)e.indexOf(r[i])>=0&&r.splice(i,1)},t.prototype.GetTeamEmptyPosCount=function(){for(var t=0,e=this.mHeroInfo.heroTeam,o=0,n=e.length;o<n;++o)0===e[o]&&t++;return t},t.prototype.GetExtendPosCost=function(){var e=this.mHeroInfo.heroTeam.length;return this.mExtendPosCostArr[e-t.DEFAULT_POS_COUNT]},t.prototype.AddTeamPos=function(){this.mHeroInfo.heroTeam.length<t.HERO_MAX_NUM&&(this.mHeroInfo.heroTeam.push(0),this.Save(),S.default.Dispatch(v.BCType.HeroAdjustTeamWin_AddPos),a.default.Ins.CheckHeroPos())},t.prototype.PutHeroOnTeam=function(e){if(0===this.GetTeamEmptyPosCount())this.mHeroInfo.heroTeam.length<t.HERO_MAX_NUM?c.default.Ins.Open(v.WinType.AddPosWin,function(t){t.SetData()}):c.default.Ins.ShowTips("\u4e0a\u9635\u4f4d\u7f6e\u5df2\u8fbe\u4e0a\u9650\uff0c\u8bf7\u5148\u7559\u51fa\u5751\u4f4d\u54e6~");else{for(var o=this.mHeroInfo.heroTeam,n=0,r=o.length;n<r;++n)if(0===o[n]){o[n]=e;break}this.Save(),g.default.mCurFightMode.PutHeroOn(e),t.Ins.SortHeroTeam(),S.default.Dispatch(v.BCType.HeroAdjustTeamWin_PutHeroOnTeam,e),i.default.Ins.OnAllAttrChanged(),this.CheckRedPointMedal(e)}},t.prototype.PutHeroOffTeam=function(t){if(this.GetTeamEmptyPosCount()!==this.mHeroInfo.heroTeam.length-1){for(var e=this.mHeroInfo.heroTeam,o=0,n=e.length;o<n;++o)if(e[o]===t){e[o]=0;break}this.GetHeroSI(t).medalLv=0,this.SortHeroTeam(),this.Save(),g.default.mCurFightMode.PutHeroOff(t),S.default.Dispatch(v.BCType.HeroAdjustTeamWin_PutHeroOffTeam,t),i.default.Ins.OnAllAttrChanged(),h.default.SetInvokeData("Main.Hero."+t+".Medal",0)}else c.default.Ins.ShowTips("\u8bf7\u81f3\u5c11\u4fdd\u7559\u4e00\u4f4d\u6b66\u5c06\u5728\u9635~")},t.prototype.CompareFunc=function(e,o){if(0===e)return 1;if(0===o)return-1;var n=t.Ins.GetHeroSI(e),r=t.Ins.GetHeroSI(o);return n.heroQuality!==r.heroQuality?-(n.heroQuality-r.heroQuality):n.starLv!==r.starLv?-(n.starLv-r.starLv):void 0},t.prototype.SortHeroTeam=function(){this.mHeroInfo.heroTeam.sort(this.CompareFunc)},t.prototype.GetCostMedal=function(t,e){if(-1!==e){if(1===e)return this.GetCostMedalByLv(t);var o=t+e;return this.GetTotalCostMedalByLv(o)-this.GetTotalCostMedalByLv(t)}return 0},t.prototype.GetCostMedalByLv=function(t){for(var e=0,o=0,n=this.mMedalCostArr.length;o<n;++o){var r=this.mMedalCostArr[o][0];if(t<r)return this.mMedalStartCostArr[o]+(t-e)*this.mMedalCostArr[o][1];e=r}return this.mMedalStartCostArr[this.mMedalStartCostArr.length-1]+(t-this.mMedalCostArr[this.mMedalCostArr.length-1][0])*this.mMedalCostArr[this.mMedalCostArr.length-1][1]},t.prototype.GetTotalCostMedalByLv=function(t){if(0===t)return 0;for(var e=0,o=0,n=0,r=this.mMedalCostArr.length;n<r;++n){var i=this.mMedalCostArr[n][0];if(t<i){e=this.mMedalTotalCostArr[n];var a=t-o,s=this.mMedalCostArr[n][1];return e+(a*(0===n?this.mBaseCostMedal:this.GetCostMedalByLv(o))+a*(a-1)/2*s)}o=i}var l=this.mMedalCostArr[this.mMedalCostArr.length-1][0];e=this.mMedalTotalCostArr[this.mMedalTotalCostArr.length-1];var m=t-l,u=this.mMedalCostArr[this.mMedalCostArr.length-1][1];return e+(m*this.GetCostMedalByLv(l)+m*(m-1)/2*u)},t.prototype.GetGoldForRecycleMedal=function(t){for(var e=0,o=this.mRecycleMedalGoldArr.length;e<o;++e)if(t<=this.mRecycleMedalGoldArr[e][0])return this.mRecycleMedalGoldArr[e][1];return this.mRecycleMedalGoldArr[this.mRecycleMedalGoldArr.length-1][1]},t.prototype.GetOwnHeroByCamp=function(t){var e=[],o=this.mHeroInfo.heroMap.obj;for(var n in o)if(o.hasOwnProperty(n)){var r=Number(n);I.default.Ins.m_DB.heroCardDB[r].camp===t&&e.push(r)}return e},t.prototype.GetNoOwnHeroByCamp=function(t){for(var e=[],o=this.GetOwnHeroByCamp(t),n=this.mCampHeroIDArr[t],r=0,i=n.length;r<i;++r){var a=n[r];o.indexOf(a)<0&&e.push(a)}return e},t.prototype.GetOwnHeroArr=function(){var t=[],e=this.mHeroInfo.heroMap.obj;for(var o in e)e.hasOwnProperty(o)&&t.push(Number(o));return t},t.prototype.GetAllNoOwnHero=function(){for(var t=[],e=0;e<=v.CampType.Qun;++e){var o=this.GetNoOwnHeroByCamp(e);if(0!==o.length)for(var n=0,r=o.length;n<r;++n)t.push(o[n])}return t},t.prototype.GroupByQuality=function(e){for(var o=[[],[],[],[]],n=0,r=e.length;n<r;++n){var i=e[n],a=I.default.Ins.m_DB.heroCardDB[i];o[t.MAX_QUALITY-a.baseQuality].push(i)}return o},t.prototype.GetHero=function(t){for(var e=[],o=this.mHeroInfo.heroMap,n=0,r=t.length;n<r;++n){var i=t[n],a=I.default.Ins.m_DB.heroCardDB[i];if(null===o.Get(i)){e.push(1);var l=new T(i);l.heroQuality=a.baseQuality,l.starLv=a.baseStar,o.Set(i,l),S.default.Dispatch(v.BCType.GetNewHero,i),S.default.Dispatch(v.BCType.OnUpgradeHeroStarLv,i);for(var m=this.mHeroInfo.heroTeam,c=0,f=m.length;c<f;++c)if(0===m[c]){this.PutHeroOnTeam(i);break}u.default.Ins.OnGetNewHero(i),a.baseQuality===v.HeroQuality.SSR&&p.default.Ins.UpdateTaskProgress(p.AllSPTaskType.GetSSRHero,1)}else e.push(0),d.default.Ins.UpdateItem(i,s.default.Ins.mFragmentNumArr[a.baseQuality]),this.CheckHeroStarAwake(i),S.default.Dispatch(v.BCType.UpdateHeroFragment,i)}return this.Save(),e},t.prototype.CheckHeroStarAwake=function(e){var o=this.GetHeroSI(e),n=d.default.Ins.GetItemNum(e),r=I.default.Ins.m_DB.itemDB[e];if(null!==o){var i=t.Ins.GetNeedFragment(r.quality,o.heroQuality,o.starLv);if(o.starLv===t.MAX_STAR_LV)if(h.default.SetInvokeData("Main.Hero.Pack."+e+".Star",0),o.heroQuality===v.HeroQuality.SP)h.default.SetInvokeData("Main.Hero.Pack."+e+".Awake",0);else{var a=t.Ins.mAwakeNeedArr[o.heroQuality],s=d.default.Ins.GetItemNum(v.ItemType.Awake);n>=i&&s>=a?h.default.SetInvokeData("Main.Hero.Pack."+e+".Awake",1):h.default.SetInvokeData("Main.Hero.Pack."+e+".Awake",0)}else n>=i?h.default.SetInvokeData("Main.Hero.Pack."+e+".Star",1):h.default.SetInvokeData("Main.Hero.Pack."+e+".Star",0)}else n>=(i=t.Ins.GetNeedFragment(r.quality,r.quality,0))&&h.default.SetInvokeData("Main.Hero.Pack."+e+".Star",1)},t.prototype.CheckHeroRedPoint=function(){for(var t=this.mAllHeroIDArr,e=0,o=t.length;e<o;++e)this.CheckHeroStarAwake(t[e])},t.prototype.GetNeedFragment=function(e,o,n){return 0===n?s.default.Ins.mFragmentNumArr[o]:n!==t.MAX_STAR_LV?this.mStarFramentArrByQuality[o][n-1]:this.mQualityFragmentArr[e][o]},t.prototype.IsMax=function(e){var o=this.GetHeroSI(e);return null!==o&&o.heroQuality===v.HeroQuality.SP&&o.starLv===t.MAX_STAR_LV},t.prototype.GetNewHeroRewards=function(t){var e=this.GetHeroSI(t);null!==e&&0===e.gotNewRewardState&&(d.default.Ins.UpdateItem(v.ItemType.Gold,this.mNewHeroGoldNum),e.gotNewRewardState=1,this.Save())},t.prototype.CheckHeroMedalLv=function(t,e){for(var o=this.mHeroInfo.heroTeam,n=0,r=0,i=o.length;r<i;++r)0!==o[r]&&this.GetHeroSI(o[r]).medalLv>=e&&n++;return n>=t},t.prototype.CheckRedPointMedal=function(e){var o=0,n=this.GetHeroSI(e);if(null!==n){var r=Math.floor(t.Ins.GetCostMedal(n.medalLv,1));Math.floor(d.default.Ins.GetItemNum(v.ItemType.Medal))>=r&&(o=1)}h.default.SetInvokeData("Main.Hero."+e+".Medal",o)},t.prototype.GetHeroSkillData=function(t,e){if(9===e){var o=I.default.Ins.m_DB.heroCardDB[t].spSkillID;return I.default.Ins.m_DB.passiveDB[o]}var n=I.default.Ins.m_DB.entityDB[t];return 1===e?I.default.Ins.m_DB.skillDB[n.normalSkillId]:I.default.Ins.m_DB.passiveDB[n.passiveSkills[e-2]]},t.prototype.BackCity=function(){var t=this.mHeroInfo.heroMap.obj;for(var e in t)t.hasOwnProperty(e)&&t[e].goldLv&&(t[e].goldLv=1);this.Save()},t.prototype.EquipSkin=function(e){var o=I.default.Ins.m_DB.skinDB[e].entityID;t.Ins.GetHeroSI(o).skinID=e,this.Save(),S.default.Dispatch(v.BCType.Skin_Equip,o,e),g.default.mCurFightMode.EquipSkin(o,e)},t.mIns=null,t.DEFAULT_POS_COUNT=4,t.MAX_STAR_LV=5,t.HERO_MAX_NUM=10,t.LV_FACTOR=1.05,t.LV_GOLD_FACTOR=1.3,t.STAR_FACTOR=2,t.HERO_BASE_COST=100,t.MAX_QUALITY=v.HeroQuality.SP,t}();o.default=M;var P=function(){this.heroMap=null,this.heroTeam=null};o.HeroInfo=P;var T=function(t){this.id=0,this.skinID=0,this.goldLv=1,this.medalLv=0,this.starLv=1,this.heroQuality=v.HeroQuality.R,this.gotNewRewardState=0,this.id=t};o.HeroSaveInfo=T;var D=function(t){this.GetAttrNumber=function(t){var e=this.starAddMap.get(t);return void 0===e?0:e},this.id=0,this.starAddMap=new Map,this.id=t};o.HeroAddSelfAttrInfo=D;var A=function(){function t(){this.mHeroAddMap=new Map,this.mAllProfessionMap=new Map,this.mAllCampMap=new Map}return t.prototype.AddHeroAttr=function(t,e){void 0===e&&(e=!0);var o=I.default.Ins.m_DB.heroCardDB[t],n=I.default.Ins.m_DB.passiveDB[o.spSkillID],r=new O(n);if(this.mHeroAddMap.set(t,r),e)if(r.mAddAllType===v.AddAllAttrType.Profession){var i=this.mAllProfessionMap.get(r.mProfession);void 0===i?((a=new Map).set(r.mAttrType,r.mAddValue),this.mAllProfessionMap.set(r.mProfession,a)):void 0===(s=i.get(r.mAttrType))?i.set(r.mAttrType,r.mAddValue):i.set(r.mAttrType,s+r.mAddValue)}else{var a,s,l=this.mAllCampMap.get(r.mCamp);void 0===l?((a=new Map).set(r.mAttrType,r.mAddValue),this.mAllCampMap.set(r.mCamp,a)):void 0===(s=l.get(r.mAttrType))?l.set(r.mAttrType,r.mAddValue):l.set(r.mAttrType,s+r.mAddValue)}},t.prototype.GetAttrByProfession=function(t,e){var o=this.mAllProfessionMap.get(t);if(void 0===o)return 0;var n=o.get(e);return void 0===n?0:n},t.prototype.GetAttrByCamp=function(t,e){var o=this.mAllCampMap.get(t);if(void 0===o)return 0;var n=o.get(e);return void 0===n?0:n},t}();o.HeroAddAllAttrInfo=A;var O=function(t){this.mAddAllType=v.AddAllAttrType.Profession,this.mProfession=v.ProfessionType.Archer,this.mCamp=v.CampType.None,this.mAttrType=v.AttributeType.None,this.mAddValue=0;var e=t.effectParam;this.mAddAllType=Number(e[0]),this.mAddAllType===v.AddAllAttrType.Profession?this.mProfession=Number(e[1]):this.mCamp=Number(e[1]),this.mAttrType=Number(e[2]),this.mAddValue=Number(e[3])};o.SingleHeroAddAllAttrInfo=O,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FightMgr":"FightMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyAllSP":"ProxyAllSP","./ProxyHeroMap":"ProxyHeroMap","./ProxyImmortal":"ProxyImmortal","./ProxyLargeNum":"ProxyLargeNum","./ProxyLottery":"ProxyLottery","./ProxyMainTask2":"ProxyMainTask2","./ProxyOffline":"ProxyOffline","./ProxySkin":"ProxySkin","./ProxyTask":"ProxyTask"}],ProxyImmortal:[function(t,e,o){"use strict";cc._RF.push(e,"f9442kOi65IuLi1n194WdzD","ProxyImmortal"),Object.defineProperty(o,"__esModule",{value:!0}),o.ImmortalItemSaveInfo=o.ImmortalInfo=void 0;var n=t("./ProxyWork"),r=t("./ProxyOffline"),i=t("./ProxyMainTask2"),a=t("./ProxyLargeNum"),s=t("./ProxyImtSkill"),l=t("./ProxyAllSP"),m=t("../Manager/UserMgr"),u=t("../Manager/SaveMgr"),p=t("../Manager/PlatformMgr"),c=t("../Manager/FloatItemMgr"),d=t("../Manager/FightMgr"),f=t("../Manager/DataMgr"),h=t("../Manager/BCMgr"),y=t("../Common/SwitchConfig"),g=t("../Common/EnumsDefine"),I=t("../Common/Common"),S=function(){function t(){this.MAX_STAR=6,this.mAttrMap=null,this.mHeroAttrMap=null,this.mImtLvLimitArr=null,this.mNewImtGoldRewardsArr=[],this.mLuckyImtRate=0,this.mImmortalInfo=null,this.mSaveFlag=!1,this.mTargetStrArr=["\u6240\u6709","\u9b4f\u56fd","\u8700\u56fd","\u5434\u56fd","\u7fa4\u96c4"]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=f.default.Ins.m_DB.paramDB,e=t.IMT_LV_LIMIT_ARR.value;this.mImtLvLimitArr=I.default.Split2NumArr(e,"|");var o=t.NEW_IMT_GOLD_ARR.value;this.mNewImtGoldRewardsArr=I.default.Split2NumArr(o,"|"),this.mLuckyImtRate=Number(t.LUCKY_IMT_RATE.value)},t.prototype.CreateDefaultInfo=function(){var e=new _;if(e.immortalArr=[],y.default.mAllImmortal)for(var o=t.Ins.GetImtStarArr(),n=0;n<this.MAX_STAR;++n)for(var r=o[n],i=this.GetImtLimitLv(n+1),a=0,l=r.length;a<l;++a)e.immortalArr.push(new v(r[a],i));e.curSkillArr=[],e.curSkillArr.push(0),e.curSkillArr.push(0),this.mImmortalInfo=e,s.default.Ins.ConvertToRunningInfo(),this._ConvertToAttrMap()},t.prototype.SyncInfo=function(){var t=u.default.Get(u.default.IMMORTAL_INFO);this.mImmortalInfo=new _,this.mImmortalInfo=JSON.parse(t),this._HandleSelfMap(),s.default.Ins.ConvertToRunningInfo(),this._ConvertToAttrMap()},t.prototype._ConvertToAttrMap=function(){this.mAttrMap=new Map,this.mHeroAttrMap=new Map;for(var t=this.mImmortalInfo.immortalArr,e=f.default.Ins.m_DB.immortalDB,o=0,n=t.length;o<n;++o){var r=t[o],i=e[r.id];0!==i.attr1.length&&this._ConvertAttr(i.attr1,r.lv),0!==i.attr2.length&&this._ConvertAttr(i.attr2,r.lv)}},t.prototype._ConvertAttr=function(t,e,o){void 0===o&&(o=!1);var n=t[0];if(n===g.ImtAttrType.Atk||n===g.ImtAttrType.Def||n===g.ImtAttrType.HP)if(this.mHeroAttrMap.get(n))if((s=this.mHeroAttrMap.get(n)).get(t[1])){var r=s.get(t[1]),i=0;o||(i=t[2]);var a=i+(e-1)*t[3];s.set(t[1],r+a)}else s.set(t[1],t[2]+(e-1)*t[3]);else{var s;(s=new Map).set(t[1],t[2]+(e-1)*t[3]),this.mHeroAttrMap.set(n,s)}else this.mAttrMap.get(n)?(r=this.mAttrMap.get(n),i=0,o||(i=t[1]),a=i+(e-1)*t[2],this.mAttrMap.set(n,r+a)):this.mAttrMap.set(n,t[1]+(e-1)*t[2])},t.prototype._HandleSelfMap=function(){},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mImmortalInfo);u.default.Save(u.default.IMMORTAL_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.CheckHasImtByID=function(t){return null!==this.GetImtSI(t)},t.prototype.GetImtSI=function(t){for(var e=this.mImmortalInfo.immortalArr,o=0,n=e.length;o<n;++o)if(e[o].id===t)return e[o];return null},t.prototype.GetImtLimitLv=function(t){return this.mImtLvLimitArr[t-1]},t.prototype.GetNewImtGoldNum=function(t){return this.mNewImtGoldRewardsArr[t-1]},t.prototype.GetAttrDesc=function(t,e,o){void 0===o&&(o=!1);var n=this.GetImtSI(t),r=f.default.Ins.m_DB.immortalDB[t],i=1;return null===n||o||(i=n.lv),1===e?this._GetAttrDesc(r.attr1,i):this._GetAttrDesc(r.attr2,i)},t.prototype.GetAttrAddDesc=function(t,e){var o,n=f.default.Ins.m_DB.immortalDB[t],r=(o=1===e?n.attr1:n.attr2)[0];return r===g.ImtAttrType.Atk||r===g.ImtAttrType.Def||r===g.ImtAttrType.HP?"\u4e0b\u4e00\u7ea7\uff1a+"+o[3]+"%":r===g.ImtAttrType.WorkInitLevelAdd?"\u4e0b\u4e00\u7ea7\uff1a+"+o[2]:"\u4e0b\u4e00\u7ea7\uff1a+"+o[2]+"%"},t.prototype._GetAttrDesc=function(t,e){if(0===t.length)return"";var o=null,n=t[1]+t[2]*(e-1),r=t[0];if(r===g.ImtAttrType.Atk||r===g.ImtAttrType.Def||r===g.ImtAttrType.HP){switch(r){case g.ImtAttrType.Atk:o="- \u63d0\u5347{0}\u6b66\u5c06\u653b\u51fb\uff1a{1}";break;case g.ImtAttrType.Def:o="- \u63d0\u5347{0}\u6b66\u5c06\u9632\u5fa1\uff1a{1}";break;case g.ImtAttrType.HP:o="- \u63d0\u5347{0}\u6b66\u5c06\u751f\u547d\u503c\uff1a{1}"}var i=t[1],a=[];return a.push(this.mTargetStrArr[i+1]),a.push(t[2]+t[3]*(e-1)+"%"),I.default.FormatContent(o,a)}switch(r){case g.ImtAttrType.MedalAdd:return"- \u589e\u52a0\u6bcf\u6b21\u56de\u57ce\u7684\u52cb\u7ae0\u5956\u52b1\uff1a"+n+"%";case g.ImtAttrType.HeroUpgradeReduce:return"- \u7f29\u51cf\u6240\u6709\u6b66\u5c06\u7684\u94f6\u5e01\u5347\u7ea7\u8d39\u7528\uff1a"+n+"%";case g.ImtAttrType.WorkRevenueAdd:return"- \u6253\u5de5\u70b9\u6536\u76ca\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.WorkTimeReduce:return"- \u6253\u5de5\u70b9\u751f\u4ea7\u5468\u671f\u7f29\u51cf\uff1a"+n+"%";case g.ImtAttrType.WorkUpgradeReduce:return"- \u6253\u5de5\u70b9\u5347\u7ea7\u82b1\u8d39\u7f29\u51cf\uff1a"+n+"%";case g.ImtAttrType.WorkInitLevelAdd:return"- \u6253\u5de5\u70b9\u521d\u59cb\u7b49\u7ea7\u589e\u52a0\uff1a"+n;case g.ImtAttrType.ImtMatAdd:return"- \u795e\u5175\u5ce1\u8c37\u6389\u843d\u6750\u6599\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.SkipLevel:return"- \u8df3\u8fc7\u5173\u5361\u6982\u7387\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.BattleBoxCoinAdd:return"- \u5173\u5361\u5b9d\u7bb1\u6389\u843d\u94f6\u5e01\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.CoinOfflineTimeLimitAdd:return"- \u6253\u5de5\u70b9\u79bb\u7ebf\u6536\u76ca\u65f6\u95f4\u4e0a\u9650\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.MedalOfflineTimeLimitAdd:return"- \u79bb\u7ebf\u52cb\u7ae0\u6536\u76ca\u65f6\u95f4\u4e0a\u9650\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.OfflinePassLevelSpeedAdd:return"- \u79bb\u7ebf\u901a\u5173\u901f\u5ea6\u589e\u52a0\uff1a"+n+"%";case g.ImtAttrType.MedalOfflineNumAdd:return"- \u79bb\u7ebf\u52cb\u7ae0\u6536\u76ca\u6570\u91cf\u589e\u52a0\uff1a"+n+"%"}},t.prototype.UpdateAttrValue=function(t){switch(t){case g.ImtAttrType.WorkRevenueAdd:n.default.Ins.UpdateWorkRevenue();break;case g.ImtAttrType.WorkTimeReduce:n.default.Ins.UpdateWorkTime();break;case g.ImtAttrType.WorkUpgradeReduce:n.default.Ins.UpdateWorkCost();break;case g.ImtAttrType.ImtMatAdd:case g.ImtAttrType.SkipLevel:case g.ImtAttrType.BattleBoxCoinAdd:case g.ImtAttrType.CoinOfflineTimeLimitAdd:case g.ImtAttrType.MedalOfflineTimeLimitAdd:case g.ImtAttrType.OfflinePassLevelSpeedAdd:r.default.Ins.UpdateOfflineLevelSpeed();break;case g.ImtAttrType.MedalOfflineNumAdd:}},t.prototype.GetAttrValue=function(t){return this.mAttrMap.get(t)||0},t.prototype.GetHeroAttrValue=function(t,e){var o=this.mHeroAttrMap.get(t);return o&&o.get(e)||0},t.prototype.GetImt=function(t){for(var e=!0,o=this.mImmortalInfo.immortalArr,n=0,r=o.length;n<r;++n)if(o[n].id===t){e=!1;break}if(e){this.mImmortalInfo.immortalArr.push(new v(t)),this.mImmortalInfo.immortalArr.sort(this._ImtCompare);var i=f.default.Ins.m_DB.immortalDB[t],u=i.skill;if(0!==u){for(n=0,r=this.mImmortalInfo.curSkillArr.length;n<r;++n)if(0===this.mImmortalInfo.curSkillArr[n]){this.mImmortalInfo.curSkillArr[n]=u,s.default.Ins.UpdateSkill();break}l.default.Ins.UpdateTaskProgress(l.AllSPTaskType.GetSkillImt,1)}h.default.Dispatch(g.BCType.ImtWin_GetNewImt,t),this._UpdateImtAttr(t,!0),l.default.Ins.UpdateTaskProgress(l.AllSPTaskType.GetImtNum,1);var d=0,y=this.mImmortalInfo.immortalArr,I=f.default.Ins.m_DB.immortalDB;for(n=0,r=y.length;n<r&&!(I[y[n].id].star>=i.star&&++d>1);++n);1===d&&(console.error("\u7edf\u8ba1\u795e\u5175\u6700\u9ad8\u661f\u7ea7"),p.default.ReportEvent(g.BIPoint.MAX_IMT_STAR,{star:i.star}))}else{var S=this.GetConvertMat(t);m.default.Ins.UpdateItem(S[0],S[1]),c.default.Ins.ShowItem(S[0],a.default.FormatNumber(S[1],1))}return this.Save(),m.default.Ins.Save(),e},t.prototype._ImtCompare=function(t,e){var o=f.default.Ins.m_DB.immortalDB[t.id],n=f.default.Ins.m_DB.immortalDB[e.id];return o.star!=n.star?-(o.star-n.star):t.id-e.id},t.prototype._UpdateImtAttr=function(t,e){var o=f.default.Ins.m_DB.immortalDB[t],n=1;e||(n=2),0!==o.attr1.length&&(this._ConvertAttr(o.attr1,n,!e),this.UpdateAttrValue(o.attr1[0])),0!==o.attr2.length&&(this._ConvertAttr(o.attr2,n,!e),this.UpdateAttrValue(o.attr2[0]));var i=!1,a=o.attr1[0];if(a!==g.ImtAttrType.Atk&&a!==g.ImtAttrType.Def&&a!==g.ImtAttrType.HP||(i=!0),!i&&0!==o.attr2.length){var s=o.attr2[0];s!==g.ImtAttrType.Atk&&s!==g.ImtAttrType.Def&&s!==g.ImtAttrType.HP||(i=!0)}i&&(d.default.Ins.UpdateAllHeroAttr(),r.default.Ins.OnAllAttrChanged(),h.default.Dispatch(g.BCType.OnUpdateADH))},t.prototype.GetConvertMat=function(e){var o=[],n=t.Ins.GetImtSI(e),r=f.default.Ins.m_DB.immortalDB[e].cost,i=new a.LargeNumber(r[1],r[2]).ToNormalNum()*n.lv;return o.push(r[0],i),o},t.prototype.UpgradeImt=function(e){var o=this.GetImtSI(e);o.lv++,this._UpdateImtAttr(e,!1),this.Save();var n=f.default.Ins.m_DB.immortalDB[e];if(n.star>=3){var r=t.Ins.GetImtLimitLv(n.star);o.lv===r&&l.default.Ins.UpdateTaskProgress(l.AllSPTaskType.UpgradeImtStar3ToMaxLv,1)}i.default.Ins.CheckUpgradeImt()},t.prototype.GetImtStarArr=function(){var t=[[],[],[],[],[],[]],e=f.default.Ins.m_DB.immortalDB;for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];t[6-n.star].push(n.Id)}return t},t.prototype.GetBestLvImtByStar=function(t){var e=this.mImmortalInfo.immortalArr;if(null===e||0===e.length)return null;for(var o=null,n=0,r=e.length;n<r;++n)f.default.Ins.m_DB.immortalDB[e[n].id].star===t&&(null===o||o.lv<e[n].lv)&&(o=e[n]);return o},t.mIns=null,t}();o.default=S;var _=function(){this.immortalArr=null,this.curSkillArr=null};o.ImmortalInfo=_;var v=function(t,e){void 0===e&&(e=1),this.id=0,this.lv=0,this.id=t,this.lv=e};o.ImmortalItemSaveInfo=v,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FightMgr":"FightMgr","../Manager/FloatItemMgr":"FloatItemMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyAllSP":"ProxyAllSP","./ProxyImtSkill":"ProxyImtSkill","./ProxyLargeNum":"ProxyLargeNum","./ProxyMainTask2":"ProxyMainTask2","./ProxyOffline":"ProxyOffline","./ProxyWork":"ProxyWork"}],ProxyImtBoss:[function(t,e,o){"use strict";cc._RF.push(e,"dd907EUHexFmISYAoZ1U4GY","ProxyImtBoss"),Object.defineProperty(o,"__esModule",{value:!0}),o.ImtBossLevelInfo=void 0;var n=t("./ProxyVIP"),r=t("./ProxyTask"),i=t("./ProxyMainTask2"),a=t("./ProxyLottery"),s=t("./ProxyImmortal"),l=t("./ProxyHero"),m=t("../Manager/UserMgr"),u=t("../Manager/TimeMgr"),p=t("../Manager/DataMgr"),c=t("../Manager/BCMgr"),d=t("../Common/EnumsDefine"),f=t("../Common/Common"),h=function(){function t(){this.mBaseChallengeTimes=1,this.mFightTime=120,this.mFreeMopTicketNum=10,this.mFreeChallengeTimes=10,this.mBaseMatNum=1,this.mRecoverTime=1200,this.mEnbaleRecover=!1,this.mBossNameArr=["\u7206\u88c2\u673a\u795e","\u7532\u58f3\u6076\u7075","\u53cc\u5200\u6218\u673a","\u8d64\u7130\u6218\u7532"]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=p.default.Ins.m_DB.paramDB;this.mBaseMatNum=Number(t.IMT_BOSS_LEVEL_BASE_MAT_NUM.value),this.mBaseChallengeTimes=Number(t.IMT_BOSS_BASE_CHALLENGE_TIMES.value),this.mRecoverTime=Number(t.IMT_BOSS_CHALLENGE_RECOVER_TIME.value)},t.prototype.HandleOfflineTime=function(t){var e=this.GetMaxChallengeTimes(),o=m.default.Ins.ClientInfo.imtBossLevel,n=t-o.startRecoverTime,r=Math.floor(n/this.mRecoverTime);if(o.challengeTimes+=r,o.challengeTimes>=e)o.challengeTimes=e,this.mEnbaleRecover=!1,o.leftTime=this.mRecoverTime;else{this.mEnbaleRecover=!0,o.startRecoverTime+=r*this.mRecoverTime;var i=this.mRecoverTime-(t-o.startRecoverTime);o.leftTime=f.default.Clamp(i,0,this.mRecoverTime)}},t.prototype.OnUpdate=function(){if(this.mEnbaleRecover){var t=m.default.Ins.ClientInfo.imtBossLevel;if(--t.leftTime<=0){var e=this.GetMaxChallengeTimes();t.challengeTimes++,t.challengeTimes>=e?(t.challengeTimes=e,this.mEnbaleRecover=!1):(t.leftTime=this.mRecoverTime,t.startRecoverTime=u.default.GetServerTimeInSeconds()),m.default.Ins.Save(),c.default.Dispatch(d.BCType.ImtBoss_UpdateChallengeTimes)}else c.default.Dispatch(d.BCType.ImtBoSS_UpdateRecoverTime)}},t.prototype.GetLevelCount=function(){var t=p.default.Ins.m_DB.imtBossLevelDB,e=0;for(var o in t)t.hasOwnProperty(o)&&e++;return e},t.prototype.GetMatNumByLevel=function(t){return this.mBaseMatNum*Math.pow(2,t-1)},t.prototype.GetMatAddRate=function(){return.01*s.default.Ins.GetAttrValue(d.ImtAttrType.ImtMatAdd)},t.prototype.GetBossName=function(t){return this.mBossNameArr[t-1]},t.prototype.GetMaxChallengeTimes=function(){return this.mBaseChallengeTimes+n.default.Ins.GetAttrValue(n.VIPAttrType.ImtBossChallenge)},t.prototype.GetRandHeroFragment=function(t,e){var o=p.default.Ins.m_DB.imtBossLevelDB[e].weightArr,n=f.default.GetRandIdxByWeight(o,1)[0];return 0===n?0:a.default.Ins.LotteryByQuality(n-1)},t.prototype.PassLevel=function(e,o){var n=[],a=d.ItemType.ImtForgeMat+e-1,s=this.GetMatNumByLevel(o),u=t.Ins.GetMatAddRate(),f=s+Math.floor(s*u);n.push([a,f]),m.default.Ins.UpdateItem(a,f);var h=this.GetRandHeroFragment(e,o);0!==h&&(n.push([h,1]),m.default.Ins.UpdateItem(h,1),c.default.Dispatch(d.BCType.UpdateHeroFragment,h),l.default.Ins.CheckHeroStarAwake(h));var y=m.default.Ins.ClientInfo.imtBossLevel;if(y.passedLevelArr[e-1]<o){y.passedLevelArr[e-1]=o;var g=p.default.Ins.m_DB.imtBossLevelDB[o];m.default.Ins.UpdateItem(d.ItemType.Gold,g.goldNum),n.push([d.ItemType.Gold,g.goldNum])}return this.StartRecover(),y.challengeTimes--,c.default.Dispatch(d.BCType.ImtBoss_UpdateChallengeTimes),m.default.Ins.Save(),r.default.Ins.UpdateTaskProgress(r.DailyTaskType.ImtBoss,1),i.default.Ins.CheckImtBossLevel(),n},t.prototype.StartRecover=function(){var t=m.default.Ins.ClientInfo.imtBossLevel,e=this.GetMaxChallengeTimes();t.challengeTimes===e&&(this.mEnbaleRecover=!0,t.startRecoverTime=u.default.GetServerTimeInSeconds(),t.leftTime=this.mRecoverTime)},t.prototype.Mop=function(t,e){return m.default.Ins.UpdateItem(d.ItemType.MopTicket,-1),this.PassLevel(t,e)},t.prototype.RecoverChallengeTimes=function(t){var e=this.GetMaxChallengeTimes(),o=m.default.Ins.ClientInfo.imtBossLevel;o.challengeTimes=t,t>=e&&(o.leftTime=this.mRecoverTime,this.mEnbaleRecover=!1),m.default.Ins.Save(),c.default.Dispatch(d.BCType.ImtBoss_UpdateChallengeTimes)},t.prototype.GetPassedBestLevel=function(){for(var t=m.default.Ins.ClientInfo.imtBossLevel.passedLevelArr,e=0,o=0,n=t.length;o<n;++o)e<t[o]&&(e=t[o]);return e},t.mIns=null,t}();o.default=h;o.ImtBossLevelInfo=function(){this.startRecoverTime=0,this.leftTime=0,this.challengeTimes=0,this.passedLevelArr=[],this.challengeTimes=h.Ins.mBaseChallengeTimes,this.passedLevelArr.push(0),this.passedLevelArr.push(0),this.passedLevelArr.push(0),this.passedLevelArr.push(0)},cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","./ProxyHero":"ProxyHero","./ProxyImmortal":"ProxyImmortal","./ProxyLottery":"ProxyLottery","./ProxyMainTask2":"ProxyMainTask2","./ProxyTask":"ProxyTask","./ProxyVIP":"ProxyVIP"}],ProxyImtSkill:[function(t,e,o){"use strict";cc._RF.push(e,"e4eb4IZSzFCC6KTJZTKLuhD","ProxyImtSkill"),Object.defineProperty(o,"__esModule",{value:!0}),o.ImtSkillRunningInfo=void 0;var n=t("./ProxyMainTask2"),r=t("./ProxyImmortal"),i=t("../Manager/DataMgr"),a=t("../Manager/BCMgr"),s=t("../Common/EnumsDefine"),l=t("../Common/Common"),m=function(){function t(){this.mImtSkillRunningInfoArr=[],this.mEnableCountDown=!0,this.mLastSkillArr=[],this.mCanReleaseSkill=!0,this.MAX_SKILL_COUNT=4,this.DEFAULT_SKILL_COUNT=2,this.mExtendSkillCountCostArr=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=i.default.Ins.m_DB.paramDB.IMT_SKILL_EXTEND_POS_COST_ARR.value;this.mExtendSkillCountCostArr=l.default.Split2NumArr(t)},t.prototype.ConvertToRunningInfo=function(){for(var t=r.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e)0!==t[e]&&this.mImtSkillRunningInfoArr.push(new u(t[e]))},t.prototype.GetCurSkillIDArr=function(){return r.default.Ins.mImmortalInfo.curSkillArr},t.prototype.GetSkillInfo=function(t){for(var e=0,o=this.mImtSkillRunningInfoArr.length;e<o;++e)if(this.mImtSkillRunningInfoArr[e].skillID===t)return this.mImtSkillRunningInfoArr[e];return null},t.prototype.GetExtendPosCost=function(){var t=r.default.Ins.mImmortalInfo.curSkillArr.length;return this.mExtendSkillCountCostArr[t-this.DEFAULT_SKILL_COUNT]},t.prototype.AddSkillSlotCount=function(){r.default.Ins.mImmortalInfo.curSkillArr.length<this.MAX_SKILL_COUNT&&(r.default.Ins.mImmortalInfo.curSkillArr.push(0),r.default.Ins.Save(),a.default.Dispatch(s.BCType.ImtSkill_UpdateSkillTeam))},t.prototype.PutOffSkill=function(t){for(var e=r.default.Ins.mImmortalInfo.curSkillArr,o=0,n=e.length;o<n;++o)if(e[o]===t){e[o]=0;break}this.SortSkillID(),r.default.Ins.Save(),a.default.Dispatch(s.BCType.ImtSkill_UpdateSkillTeam,t)},t.prototype.PutOnSkill=function(t){for(var e=r.default.Ins.mImmortalInfo.curSkillArr,o=0,n=e.length;o<n;++o)if(0===e[o]){e[o]=t;break}r.default.Ins.Save(),a.default.Dispatch(s.BCType.ImtSkill_UpdateSkillTeam,t)},t.prototype.SortSkillID=function(){for(var t=r.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e)if(0===t[e])for(var n=e+1;n<o;++n)if(0!==t[n]){var i=t[e];t[e]=t[n],t[n]=i;break}},t.prototype.GetEmptySkillIdx=function(){for(var t=r.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e)if(0===t[e])return e;return-1},t.prototype.OnUpdate=function(t){if(this.mEnableCountDown){for(var e=null,o=0,n=0,r=this.mImtSkillRunningInfoArr.length;n<r;++n)(e=this.mImtSkillRunningInfoArr[n]).cdState===s.CDState.CDing&&(e.countDown-=t,e.countDown<=0?(e.countDown=0,e.cdState=s.CDState.Ready):o++,a.default.Dispatch(s.BCType.ImtSkill_UpdateCD,e));0===o&&(this.mEnableCountDown=!1)}},t.prototype.TriggerSkill=function(t){for(var e=0,o=this.mImtSkillRunningInfoArr.length;e<o;++e)if(this.mImtSkillRunningInfoArr[e].skillID===t){var r=this.mImtSkillRunningInfoArr[e];r.ResetCD(),this.mEnableCountDown=!0,a.default.Dispatch(s.BCType.ImtSkill_UpdateCD,r)}n.default.Ins.CheckImtSkill()},t.prototype.UpdateSkill=function(){for(var t=r.default.Ins.mImmortalInfo.curSkillArr,e=[],o=0,n=t.length;o<n;++o)0!==t[o]&&e.push(t[o]);var i=[];for(o=0,n=this.mImtSkillRunningInfoArr.length;o<n;++o)i.push(this.mImtSkillRunningInfoArr[o].skillID);for(o=i.length-1;o>=0;--o)-1===e.indexOf(i[o])&&(this.mImtSkillRunningInfoArr.splice(o,1),i.splice(o,1));for(o=0,n=e.length;o<n;++o)-1===i.indexOf(e[o])&&(this.mImtSkillRunningInfoArr.push(new u(e[o])),this.mEnableCountDown=!0);a.default.Dispatch(s.BCType.ImtSkill_UpdateSkill)},t.prototype.PauseImtSkill=function(){this.mCanReleaseSkill=!1},t.prototype.ResumeImtSkill=function(){this.mCanReleaseSkill=!0},t.mIns=null,t}();o.default=m;var u=function(){function t(t){this.skillID=0,this.countDown=0,this.cd=0,this.cdState=s.CDState.CDing,this.skillID=t;var e=i.default.Ins.m_DB.skillDB[t];this.cd=e.cd,this.countDown=this.cd,this.cdState=s.CDState.CDing}return t.prototype.ResetCD=function(){this.countDown=this.cd,this.cdState=s.CDState.CDing},t.prototype.SetCDOK=function(){this.countDown=0,this.cdState=s.CDState.Ready,a.default.Dispatch(s.BCType.ImtSkill_UpdateCD,this)},t}();o.ImtSkillRunningInfo=u,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","./ProxyImmortal":"ProxyImmortal","./ProxyMainTask2":"ProxyMainTask2"}],ProxyLargeNum:[function(t,e,o){"use strict";cc._RF.push(e,"5546ac6iehC8orgaa5SQ/Ea","ProxyLargeNum"),Object.defineProperty(o,"__esModule",{value:!0}),o.LargeNumber=void 0;var n=function(){function t(t,e){this.mBaseValue=0,this.mExpoValue=0,this.mBaseValue=t,this.mExpoValue=e}return t.prototype.SetValue=function(t){this.mBaseValue=t.mBaseValue,this.mExpoValue=t.mExpoValue},t.prototype.Normalize=function(){for(var t=this.mExpoValue;this.mBaseValue>=1e3;)this.mBaseValue*=.001,t++;return this.mBaseValue<1&&t>0&&(this.mBaseValue*=1e3,t--),this.mExpoValue=t,this},t.prototype.ToString=function(t){void 0===t&&(t=2),0===this.mExpoValue&&(t=0);var e=r.GetSuffixByID(this.mExpoValue);return parseFloat(this.mBaseValue.toFixed(t))+e},t.prototype.Add=function(e){if(this.mExpoValue===e.mExpoValue)return new t(this.mBaseValue+e.mBaseValue,this.mExpoValue).Normalize();var o=void 0,n=void 0;if(this.mExpoValue>e.mExpoValue?(o=this,n=e):(o=e,n=this),o.mExpoValue-n.mExpoValue>n.PRECISION)return new t(o.mBaseValue,o.mExpoValue);for(var r=o.mBaseValue,i=o.mExpoValue;i!==n.mExpoValue;)i--,r*=1e3;return new t(r+=n.mBaseValue,i).Normalize()},t.prototype.AddSelf=function(t){if(this.mExpoValue===t.mExpoValue)this.mBaseValue+=t.mBaseValue,this.Normalize();else{var e=void 0,o=void 0;if(this.mExpoValue>t.mExpoValue?(e=this,o=t):(e=t,o=this),e.mExpoValue-o.mExpoValue>o.PRECISION)this.mBaseValue=e.mBaseValue,this.mExpoValue=e.mExpoValue;else{for(var n=e.mBaseValue,r=e.mExpoValue;r!==o.mExpoValue;)r--,n*=1e3;n+=o.mBaseValue,this.mBaseValue=n,this.mExpoValue=r,this.Normalize()}}return this},t.prototype.Minus=function(e){var o=new t(-1*e.mBaseValue,e.mExpoValue);return this.Add(o)},t.prototype.MinusSelf=function(e){var o=new t(-1*e.mBaseValue,e.mExpoValue);return this.AddSelf(o)},t.prototype.Multiply=function(e){var o=this.mBaseValue,n=this.mExpoValue;return new t(o*=e.mBaseValue,n+=e.mExpoValue).Normalize()},t.prototype.MultiplySelf=function(t){return this.mBaseValue*=t.mBaseValue,this.mExpoValue+=t.mExpoValue,this.Normalize(),this},t.prototype.MultiplySingle=function(e){return this.Multiply(new t(e,0).Normalize())},t.prototype.MultiplySelfSingle=function(e){return this.MultiplySelf(new t(e,0).Normalize())},t.prototype.Divide=function(e){var o=new t(1/e.mBaseValue,-1*e.mExpoValue);return this.Multiply(o)},t.prototype.DivideSelf=function(e){var o=new t(1/e.mBaseValue,-1*e.mExpoValue);return this.MultiplySelf(o)},t.prototype.DivideSingle=function(e){return this.Divide(new t(e,0)).Normalize()},t.prototype.DivideSelfSingle=function(e){return this.DivideSelf(new t(e,0)).Normalize()},t.prototype.GetHPPercent=function(t){var e=t.mExpoValue-this.mExpoValue;return e<0?1:0===e?this.mBaseValue/t.mBaseValue:this.mBaseValue/(t.mBaseValue*Math.pow(10,3*e))},t.prototype.Compare=function(t){return this.Normalize(),t.Normalize(),this.mBaseValue>=0&&t.mBaseValue>=0?this.mExpoValue>t.mExpoValue?1:this.mExpoValue<t.mExpoValue?-1:this.mBaseValue>t.mBaseValue?1:this.mBaseValue<t.mBaseValue?-1:0:this.mBaseValue<0&&t.mBaseValue<0?this.mExpoValue>t.mExpoValue?-1:this.mExpoValue<t.mExpoValue?1:this.mBaseValue>t.mBaseValue?-1:this.mBaseValue<t.mBaseValue?1:0:this.mBaseValue>0&&t.mBaseValue<0?1:this.mBaseValue<0&&t.mBaseValue>0?-1:void 0},t.prototype.IsLessEqualThanZero=function(){return this.Normalize(),this.mBaseValue<=0},t.prototype.IsZero=function(){return 0===this.mBaseValue&&0===this.mExpoValue},t.prototype.ToNormalNum=function(){for(var t=this.mBaseValue,e=this.mExpoValue;e>0;--e)t*=1e3;return t},t.PRECISION=2,t}();o.LargeNumber=n;var r=function(){function t(){}return t.Pow=function(t,e){for(var o=new n(1,0),r=e,i=null;r>1e3;)r-=1e3,null===i&&(i=new n(Math.pow(t,1e3),0).Normalize()),o.MultiplySelf(i);return r>0&&o.MultiplySelf(new n(Math.pow(t,r),0).Normalize()),o},t.RateSum=function(t,e,o){var r=this.Pow(e,o),i=new n(1,0);return r.MinusSelf(i),t.MultiplySelfSingle(1/(e-1)),r.MultiplySelf(t),r},t.FormatNumber=function(t,e){void 0===e&&(e=2);for(var o=0;t>=1e3;)t*=.001,o++;return 0===o?""+t:parseFloat(t.toFixed(e))+this.GetSuffixByID(o)},t.GetSuffixByID=function(t){var e="";if(t<=0)return e;if(t<=4)e=e.concat(this.SUFFIX_ARR1[t-1]);else{var o=t-4;if(o<=26)e=e.concat(this.SUFFIX_ARR2[o-1]);else{var n=Math.floor((o-1)/26)-1,r=(o-1)%26;e=""+this.SUFFIX_ARR2[n]+this.SUFFIX_ARR2[r]}}return e},t.SUFFIX_ARR1=["K","M","B","T"],t.SUFFIX_ARR2=["a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],t}();o.default=r,cc._RF.pop()},{}],ProxyLevelReward:[function(t,e,o){"use strict";cc._RF.push(e,"55a5f41KhNM56+QLVy/8N4z","ProxyLevelReward"),Object.defineProperty(o,"__esModule",{value:!0}),o.LevelRewardSaveInfo=void 0;var n=t("../Manager/UserMgr"),r=t("../Manager/RedPointMgr"),i=t("../Manager/PlatformMgr"),a=t("../Manager/BCMgr"),s=t("../Common/EnumsDefine"),l=function(){function t(){this.mLevelInternal=100,this.mNormalGoldNum=200,this.mLuxuryGoldNum=300,this.mNeedADCoinNum=10}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.GetLuxuryCanGetGoldNum=function(){var t=n.default.Ins.ClientInfo.levelReward.luxuryID,e=n.default.Ins.ClientInfo.bestLevel-1;return Math.floor((e-t)/this.mLevelInternal)*this.mLuxuryGoldNum},t.prototype.GetNormalReward=function(t){n.default.Ins.UpdateItem(s.ItemType.Gold,this.mNormalGoldNum),n.default.Ins.ClientInfo.levelReward.normalID=t,n.default.Ins.Save(),a.default.Dispatch(s.BCType.LevelReward_GetRewards),this.CheckRedPointNum()},t.prototype.GetLuxuryReward=function(t){n.default.Ins.UpdateItem(s.ItemType.Gold,this.mLuxuryGoldNum),n.default.Ins.ClientInfo.levelReward.luxuryID=t,n.default.Ins.Save(),a.default.Dispatch(s.BCType.LevelReward_GetRewards),this.CheckRedPointNum()},t.prototype.UnlockLuxuryReward=function(){n.default.Ins.ClientInfo.levelReward.luxuryState=1,n.default.Ins.UpdateItem(s.ItemType.ADCoin,-this.mNeedADCoinNum);var t=this.GetLuxuryCanGetGoldNum();if(0!==t){n.default.Ins.UpdateItem(s.ItemType.Gold,t);var e=n.default.Ins.ClientInfo.bestLevel-1,o=Math.floor(e/this.mLevelInternal)*this.mLevelInternal;n.default.Ins.ClientInfo.levelReward.luxuryID=o}return n.default.Ins.Save(),a.default.Dispatch(s.BCType.LevelReward_UnlockLuxury),i.default.ReportEvent(s.BIPoint.ADCoinItem,{id:100}),t},t.prototype.GetTargetLevelID=function(){var t=n.default.Ins.ClientInfo.bestLevel;return Math.ceil(t/this.mLevelInternal)*this.mLevelInternal},t.prototype.GetLevelRewardNum=function(){return 1===n.default.Ins.ClientInfo.levelReward.luxuryState?this.mNormalGoldNum+this.mLuxuryGoldNum:this.mNormalGoldNum},t.prototype._GetRedPointNum=function(){var t=n.default.Ins.ClientInfo.levelReward,e=n.default.Ins.ClientInfo.bestLevel-1;return e>=t.normalID+this.mLevelInternal?1:1===t.luxuryState&&e>=t.luxuryID+this.mLevelInternal?1:0},t.prototype.CheckRedPointNum=function(){r.default.SetInvokeData(r.RedPointType.MainBackRewards,this._GetRedPointNum())},t.mIns=null,t}();o.default=l;o.LevelRewardSaveInfo=function(){this.luxuryState=0,this.normalID=0,this.luxuryID=0},cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/UserMgr":"UserMgr"}],ProxyLottery:[function(t,e,o){"use strict";cc._RF.push(e,"e94252FMQ5P2bgh8k2BE6lx","ProxyLottery"),Object.defineProperty(o,"__esModule",{value:!0}),o.LotterySaveInfo=void 0;var n=t("./ProxyMainTask2"),r=t("./ProxyHero"),i=t("./ProxyCrystal"),a=t("../Manager/UserMgr"),s=t("../Manager/DataMgr"),l=t("../Manager/BCMgr"),m=t("../Common/EnumsDefine"),u=t("../Common/Common"),p=function(){function t(){this.mLotteryScoreRewardID=101,this.mFragmentNumArr=null,this.mUnlockCampGold=300,this.mSSRMinTimes=0,this.mCampSSRMinTimes=0,this.mLuckyProbabilityArr=null,this.mCampProbabilityArr=null,this.mLotteryBoxScore=0,this.mFirstLotteryHeroID=2003,this.mLevel50HeroID=2007,this.mADFreeTimes=3,this.mLuckyPoolIDArr=[1,2,3],this.mSSRMinPoolID=4,this.mCampPoolIDArr=[11,12,13],this.mCampSSRMinPoolID=14,this.mDynamicHeroArr=[[],[],[]],this.mSRThreshold=1,this.mSSRThreshold=3}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitDynamicHeroArr=function(){var t=a.default.Ins.ClientInfo.bestLevel,e=s.default.Ins.m_DB.heroCardDB;for(var o in e)if(e.hasOwnProperty(o)){var n=e[o];(t>=n.unlockLevel||0===n.poolState)&&this.mDynamicHeroArr[n.baseQuality].push(n.id)}},t.prototype.AddDynamicHero=function(t,e){this.mDynamicHeroArr[t].push(e)},t.prototype.InitOnSecondDayGift=function(){},t.prototype.InitParamData=function(){var t=s.default.Ins.m_DB.paramDB,e=t.LUCKY_LOTTREY_PROBABILITY.value;this.mLuckyProbabilityArr=u.default.Split2NumArr(e,"|");var o=t.CAMP_LOTTREY_PROBABILITY.value;this.mCampProbabilityArr=u.default.Split2NumArr(o,"|"),this.mSSRMinTimes=Number(t.SSR_MIN_TIMES.value),this.mCampSSRMinTimes=Number(t.CAMP_SSR_MIN_TIMES.value);var n=t.FRAGMENT_NUM_ARR.value;this.mFragmentNumArr=u.default.Split2NumArr(n,"|"),this.mLotteryBoxScore=Number(t.LOTTERY_BOX_SCORE.value),this.mFirstLotteryHeroID=Number(t.FIRST_LOTTERY_HERO_ID.value)},t.prototype.RefreshOnNewDay=function(){a.default.Ins.ClientInfo.lottery.campADFreeTimes=this.mADFreeTimes},t.prototype.WrapDynamicHeroArr=function(t,e){for(var o=[],n=this.mDynamicHeroArr[t],r=0,i=n.length;r<i;++r)o.push([n[r],1]);return o.concat(e)},t.prototype.GetDynamicHeroArr=function(t){return this.mDynamicHeroArr[t]},t.prototype.GetHeroArrWrapProb=function(t){for(var e=[],o=this.mDynamicHeroArr[t],n=0,r=o.length;n<r;++n)e.push([o[n],1]);return e},t.prototype.LuckyLottery=function(t){var e=a.default.Ins.ClientInfo.lottery;e.score+=t,e.totalTimes+=t,e.crystalTimes+=t,e.firstLuckyTen&&10===t&&(e.firstLuckyTen=!1,e.luckySSRWaterLevel=10);for(var o=[],s=0,p=this.mLuckyProbabilityArr.length;s<p;++s)o.push(this.mLuckyProbabilityArr[s]);var c=[],d=[];for(s=0;s<t;++s){e.luckySSRWaterLevel--;var f=m.HeroQuality.R;0===e.luckySSRWaterLevel?(e.luckySSRWaterLevel=this.mSSRMinTimes,this.mSSRMinPoolID,f=m.HeroQuality.SSR):(f=u.default.GetRandIdxByWeight(o,1)[0],e.ssrThresholdLevel>0&&f===m.HeroQuality.SSR&&(f=m.HeroQuality.SR),e.srThresholdLevel>0&&f===m.HeroQuality.SR&&(f=m.HeroQuality.R),this.mLuckyPoolIDArr[f]),e.ssrThresholdLevel--,e.srThresholdLevel--,f===m.HeroQuality.SSR?e.ssrThresholdLevel=this.mSSRThreshold:f===m.HeroQuality.SR&&(e.srThresholdLevel=this.mSRThreshold),d.length=0;for(var h=this.GetHeroArrWrapProb(f),y=0,g=h.length;y<g;++y)d.push(h[y][1]);var I=h[u.default.GetRandIdxByWeight(d,1)[0]][0];1===e.totalTimes?I=this.mFirstLotteryHeroID:f===m.HeroQuality.R&&a.default.Ins.ClientInfo.bestLevel>=50&&!r.default.Ins.CheckHasHero(this.mLevel50HeroID)&&(I=this.mLevel50HeroID),c.push(I)}return u.default.GetRandArr(c),l.default.Dispatch(m.BCType.Lottery_GetHero),a.default.Ins.Save(),i.default.Ins.UpdateCrystalTargetNum(),l.default.Dispatch(m.BCType.Lottery_OnDrawCrystal),n.default.Ins.CheckCrystalDrawTimes(),c},t.prototype.CampLottery=function(t){var e=a.default.Ins.ClientInfo.lottery;e.score+=t,e.totalTimes+=t,e.firstCampTen&&10===t&&(e.firstCampTen=!1,e.campSSRWaterLevel=10);for(var o=[],n=0,r=this.mCampProbabilityArr.length;n<r;++n)o.push(this.mCampProbabilityArr[n]);var i=[],s=[];for(n=0;n<t;++n){e.campSSRWaterLevel--;var p=m.HeroQuality.R;0===e.campSSRWaterLevel?(e.campSSRWaterLevel=this.mCampSSRMinTimes,this.mCampSSRMinPoolID,p=m.HeroQuality.SSR):(p=u.default.GetRandIdxByWeight(o,1)[0],e.ssrThresholdLevel>0&&p===m.HeroQuality.SSR&&(p=m.HeroQuality.SR),e.srThresholdLevel>0&&p===m.HeroQuality.SR&&(p=m.HeroQuality.R),this.mCampPoolIDArr[p]),e.ssrThresholdLevel--,e.srThresholdLevel--,p===m.HeroQuality.SSR?e.ssrThresholdLevel=this.mSSRThreshold:p===m.HeroQuality.SR&&(e.srThresholdLevel=this.mSRThreshold);var c=this.GetHeroArrWrapProb(p);s.length=0;for(var d=0,f=c.length;d<f;++d)s.push(c[d][1]);var h=c[u.default.GetRandIdxByWeight(s,1)[0]][0];i.push(h)}return u.default.GetRandArr(i),l.default.Dispatch(m.BCType.Lottery_GetHero),a.default.Ins.Save(),i},t.prototype.ADLottery=function(){a.default.Ins.ClientInfo.lottery.campADFreeTimes--,a.default.Ins.Save()},t.prototype.GetLotteryScoreRewards=function(){a.default.Ins.ClientInfo.lottery.score-=this.mLotteryBoxScore,a.default.Ins.Save()},t.prototype.LotteryByQuality=function(t){for(var e=this.GetHeroArrWrapProb(t),o=[],n=0,r=e.length;n<r;++n)o.push(e[n][1]);return e[u.default.GetRandIdxByWeight(o,1)[0]][0]},t.prototype.LotteryAllByQuality=function(t){return u.default.GetRandValueInArr(r.default.Ins.mQualityHeroIDArr[t])},t.mIns=null,t}();o.default=p;o.LotterySaveInfo=function(){this.score=70,this.totalTimes=0,this.crystalTimes=0,this.firstLuckyTen=!0,this.firstCampTen=!0,this.luckySSRWaterLevel=0,this.campSSRWaterLevel=0,this.campADFreeTimes=0,this.srThresholdLevel=0,this.ssrThresholdLevel=0,this.luckySSRWaterLevel=p.Ins.mSSRMinTimes,this.campSSRWaterLevel=15,this.srThresholdLevel=p.Ins.mSRThreshold,this.ssrThresholdLevel=p.Ins.mSSRThreshold},cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/UserMgr":"UserMgr","./ProxyCrystal":"ProxyCrystal","./ProxyHero":"ProxyHero","./ProxyMainTask2":"ProxyMainTask2"}],ProxyMainTask2:[function(t,e,o){"use strict";cc._RF.push(e,"fdedaM8cmNGi6qjTlJ102dE","ProxyMainTask2"),Object.defineProperty(o,"__esModule",{value:!0}),o.MainTask2SaveInfo=o.MainTaskState=o.MainTaskType=void 0;var n,r,i=t("./ProxyWork"),a=t("./ProxyOffice"),s=t("./ProxyImtSkill"),l=t("./ProxyImtBoss"),m=t("./ProxyImmortal"),u=t("./ProxyHero"),p=t("./ProxyForge"),c=t("./ProxyBackCity"),d=t("../Manager/UserMgr"),f=t("../Manager/SaveMgr"),h=t("../Manager/PlatformMgr"),y=t("../Manager/MainTaskGuideMgr"),g=t("../Manager/DataMgr"),I=t("../Manager/BCMgr"),S=t("../Common/SwitchConfig"),_=t("../Common/EnumsDefine");(function(t){t[t.UnlockWork=1]="UnlockWork",t[t.UpgradeWork=2]="UpgradeWork",t[t.HeroLv=3]="HeroLv",t[t.PassCurLevel=4]="PassCurLevel",t[t.BackFromLevel=5]="BackFromLevel",t[t.LotteryBox=6]="LotteryBox",t[t.HeroMedalLv=7]="HeroMedalLv",t[t.ExtendHeroPos=8]="ExtendHeroPos",t[t.ForgeImt=9]="ForgeImt",t[t.ImtBossLevel=10]="ImtBossLevel",t[t.TrainSmith=11]="TrainSmith",t[t.UpgradeImt=12]="UpgradeImt",t[t.CrystalDrawTimes=13]="CrystalDrawTimes",t[t.UseCrystalItem=14]="UseCrystalItem",t[t.DoubleWork=15]="DoubleWork",t[t.AutoWork=16]="AutoWork",t[t.Office=17]="Office",t[t.UseImtSkill=18]="UseImtSkill"})(n=o.MainTaskType||(o.MainTaskType={})),function(t){t[t.None=0]="None",t[t.Progress=1]="Progress",t[t.Complete=2]="Complete",t[t.Got=3]="Got"}(r=o.MainTaskState||(o.MainTaskState={}));var v=function(){function t(){this.mMaxCount=0,this.mCurTaskData=null,this.mMainTaskInfo=null,this.mSaveFlag=!1,this.mCurGuideImtBossID=1,this.mCurGuideMedalHeroID=1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=g.default.Ins.m_DB.mainTask2DB;for(var e in t)t.hasOwnProperty(e)&&this.mMaxCount++},t.prototype.CreateDefaultInfo=function(){var t=new C;t.curTaskID=0,t.taskState=r.Progress,this.mMainTaskInfo=t},t.prototype.SyncInfo=function(){var t=f.default.Get(f.default.MAIN_TASK);this.mMainTaskInfo=new C,this.mMainTaskInfo=JSON.parse(t)},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mMainTaskInfo);f.default.Save(f.default.MAIN_TASK,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.RestartTask=function(){0===this.mMainTaskInfo.curTaskID?this.StartMainTask():(this.mCurTaskData=g.default.Ins.m_DB.mainTask2DB[this.mMainTaskInfo.curTaskID],this.mCurTaskData&&(I.default.Dispatch(_.BCType.MainTask2_StartTask),null!==this.mCurTaskData&&1===this.mCurTaskData.showFinger&&this.ShowGuideFinger()))},t.prototype.StartMainTask=function(){this.mMainTaskInfo.curTaskID=S.default.mMainTaskID,this.StartNextTask(),this.Save()},t.prototype.StartNextTask=function(){this.mMainTaskInfo.curTaskID++,this.mMainTaskInfo.taskState=r.Progress,this.mMaxCount<this.mMainTaskInfo.curTaskID?(this.mCurTaskData=null,this.mMainTaskInfo.taskState=r.Got):(this.mCurTaskData=g.default.Ins.m_DB.mainTask2DB[this.mMainTaskInfo.curTaskID],this.CheckCurTaskState()),this.Save(),I.default.Dispatch(_.BCType.MainTask2_StartTask),6===this.mMainTaskInfo.curTaskID&&I.default.Dispatch(_.BCType.ShowMainTaskGuidePanel,!1),null!==this.mCurTaskData&&1===this.mCurTaskData.showFinger&&this.ShowGuideFinger()},t.prototype.ShowGuideFinger=function(){if(null!==this.mCurTaskData&&this.mMainTaskInfo.taskState===r.Progress){var t=this.mCurTaskData.taskType,e=this.mCurTaskData.param;switch(t){case n.UnlockWork:case n.UpgradeWork:y.default.SetInvokeData(y.MainTaskGuideType.WorkItem+e[0],1);break;case n.HeroLv:for(var o=u.default.Ins.mHeroInfo.heroTeam,i=this.mCurTaskData.param[1],a=0,s=o.length;a<s;++a)if(u.default.Ins.GetHeroSI(o[a]).goldLv<i){y.default.SetInvokeData(y.MainTaskGuideType.HeroItem+(a+1),1);break}break;case n.BackFromLevel:break;case n.HeroMedalLv:var l=u.default.Ins.mHeroInfo.heroTeam,p=this.mCurTaskData.param[1];for(a=0,s=l.length;a<s;++a)if(u.default.Ins.GetHeroSI(l[a]).medalLv<p){this.mCurGuideMedalHeroID=a+1,y.default.SetInvokeData(y.MainTaskGuideType.HeroItemDetail+this.mCurGuideMedalHeroID,1),y.default.SetInvokeData(y.MainTaskGuideType.HeroItemDetailStrength,1);break}break;case n.ExtendHeroPos:y.default.SetInvokeData(y.MainTaskGuideType.HeroPosExtend,1);break;case n.ForgeImt:y.default.SetInvokeData(y.MainTaskGuideType.ForgeImt,1);break;case n.ImtBossLevel:var c=m.default.Ins.mImmortalInfo.immortalArr;if(0!==c.length){var d=c[0].id,f=g.default.Ins.m_DB.immortalDB[d].cost[0]-_.ItemType.ImtForgeMat+1;this.mCurGuideImtBossID=f,y.default.SetInvokeData(y.MainTaskGuideType.ImtBossLevel+f,1)}break;case n.TrainSmith:y.default.SetInvokeData(y.MainTaskGuideType.SmithTrain,1);break;case n.UpgradeImt:break;case n.CrystalDrawTimes:y.default.SetInvokeData(y.MainTaskGuideType.Lottery_Crystal,1);break;case n.UseCrystalItem:y.default.SetInvokeData(y.MainTaskGuideType.CrystalItem,1);break;case n.DoubleWork:case n.AutoWork:y.default.SetInvokeData(y.MainTaskGuideType.WorkItemActive+e[0],1);break;case n.Office:y.default.SetInvokeData(y.MainTaskGuideType.Main_More,1);break;case n.UseImtSkill:y.default.SetInvokeData(y.MainTaskGuideType.ImtSkillIocn,1)}}},t.prototype.CheckCurTaskState=function(){if(null!==this.mCurTaskData)switch(this.mCurTaskData.taskType){case n.UnlockWork:this.CheckUnlockWork();break;case n.UpgradeWork:this.CheckUpgradeWork();break;case n.HeroLv:this.CheckHeroCoinLv();break;case n.PassCurLevel:this.CheckPassCurLevel();break;case n.BackFromLevel:this.CheckBackCity();break;case n.HeroMedalLv:this.CheckMedalLv();break;case n.ExtendHeroPos:this.CheckHeroPos();break;case n.ForgeImt:this.CheckForgeImt();break;case n.ImtBossLevel:this.CheckImtBossLevel();break;case n.TrainSmith:this.CheckSmithLv();break;case n.UpgradeImt:this.CheckUpgradeImt();break;case n.CrystalDrawTimes:this.CheckCrystalDrawTimes();break;case n.UseCrystalItem:this.CheckUseCrystalItem();break;case n.DoubleWork:this.CheckDoubleWork();break;case n.AutoWork:this.CheckAutoWork();break;case n.Office:this.CheckOffice();break;case n.UseImtSkill:var t=s.default.Ins.GetSkillInfo(10004);t&&t.SetCDOK()}},t.prototype.CheckUnlockWork=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.UnlockWork){var e=this.mCurTaskData.param[0];if(this.mMainTaskInfo.taskState===r.Progress){var o=i.default.Ins.GetWorkSI(e);null!==o&&o.lv>0&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.WorkItem+e,0),1===e&&h.default.mCurPlf.ReportHuoShanEvent(_.HuoShanEventType.EnterGame))}}return t},t.prototype.CheckUpgradeWork=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.UpgradeWork){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress){var a=i.default.Ins.GetWorkSI(e);null!==a&&a.lv>=o&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.WorkItem+e,0))}}return t},t.prototype.CheckHeroCoinLv=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.HeroLv){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress)for(var i=0,a=u.default.Ins.mHeroInfo.heroTeam,s=0,l=a.length;s<l;++s)if(0!==a[s]){var m=u.default.Ins.GetHeroSI(a[s]);if(null!==m&&m.goldLv>=o&&++i>=e){t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),8===this.mCurTaskData.Id&&(I.default.Dispatch(_.BCType.ShowMainTaskGuidePanel,!1),h.default.mCurPlf.ReportHuoShanEvent(_.HuoShanEventType.UnlockHeroFunc)),y.default.SetInvokeData(y.MainTaskGuideType.HeroItem+(s+1),0);break}}}return t},t.prototype.CheckPassCurLevel=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.PassCurLevel){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&d.default.Ins.ClientInfo.curLevel>e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState))}return t},t.prototype.CheckBackCity=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.BackFromLevel&&(this.mCurTaskData.param[0],this.mMainTaskInfo.taskState===r.Progress)){var e=this.mCurTaskData.param[0];c.default.Ins.mBackRunningInfo.mSI.bestLevelWhenBack>e?(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.BackCity,0)):d.default.Ins.ClientInfo.curLevel>e&&y.default.SetInvokeData(y.MainTaskGuideType.BackCity,1)}return t},t.prototype.CheckMedalLv=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.HeroMedalLv){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress)for(var i=0,a=u.default.Ins.mHeroInfo.heroTeam,s=0,l=a.length;s<l;++s)if(0!==a[s]){var m=u.default.Ins.GetHeroSI(a[s]);if(null!==m&&m.medalLv>=o&&++i>=e){t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.HeroItemDetail+this.mCurGuideMedalHeroID,0),y.default.SetInvokeData(y.MainTaskGuideType.HeroItemDetailStrength,0);break}}}return t},t.prototype.CheckHeroPos=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.ExtendHeroPos){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&u.default.Ins.mHeroInfo.heroTeam.length>=e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.HeroPosExtend,0))}return t},t.prototype.CheckForgeImt=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.ForgeImt){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&p.default.Ins.mForgeInfo.forgeTimes>=e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.ForgeImt,0))}return t},t.prototype.CheckImtBossLevel=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.ImtBossLevel){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&l.default.Ins.GetPassedBestLevel()>=e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.ImtBossLevel+this.mCurGuideImtBossID,0))}return t},t.prototype.CheckSmithLv=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.TrainSmith){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress){var i=p.default.Ins.GetBestSmith();(i.title>e||i.title===e&&i.lv>=o)&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.SmithTrain,0))}}return t},t.prototype.CheckUpgradeImt=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.UpgradeImt){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress){var i=m.default.Ins.GetBestLvImtByStar(e);null!==i&&i.lv>=o&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState))}}return t},t.prototype.CheckCrystalDrawTimes=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.CrystalDrawTimes){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&d.default.Ins.ClientInfo.lottery.crystalTimes>=e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.Lottery_Crystal,0))}return t},t.prototype.CheckUseCrystalItem=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.UseCrystalItem){var e=this.mCurTaskData.param[0];this.mMainTaskInfo.taskState===r.Progress&&d.default.Ins.ClientInfo.useCrystalItems>=e&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.CrystalItem,0))}return t},t.prototype.CheckDoubleWork=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.DoubleWork){var e=this.mCurTaskData.param[0];if(this.mMainTaskInfo.taskState===r.Progress){var o=i.default.Ins.GetWorkSI(e);null!==o&&o.multiple>1&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),I.default.Dispatch(_.BCType.ShowMainTaskGuidePanel,!1),y.default.SetInvokeData(y.MainTaskGuideType.WorkItemActive+e,0))}}return t},t.prototype.CheckAutoWork=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.AutoWork){var e=this.mCurTaskData.param[0];if(this.mMainTaskInfo.taskState===r.Progress){var o=i.default.Ins.GetWorkSI(e);null!==o&&o.isAuto&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.WorkItemActive+e,0))}}return t},t.prototype.CheckOffice=function(){var t=!1;if(null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.Office){var e=this.mCurTaskData.param[0],o=this.mCurTaskData.param[1];if(this.mMainTaskInfo.taskState===r.Progress){var i=a.default.Ins.mOfficeInfo;(i.title>e||i.title===e&&i.step>=o)&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.Main_More,0))}}return t},t.prototype.CheckImtSkill=function(){var t=!1;return null!==this.mCurTaskData&&this.mCurTaskData.taskType===n.UseImtSkill&&this.mMainTaskInfo.taskState===r.Progress&&(t=!0,this.mMainTaskInfo.taskState=r.Complete,this.Save(),I.default.Dispatch(_.BCType.MainTask2_UpdateState),y.default.SetInvokeData(y.MainTaskGuideType.ImtSkillIocn,0)),t},t.mIns=null,t.m_Finger=null,t}();o.default=v;var C=function(){this.curTaskID=0,this.taskState=r.Progress};o.MainTask2SaveInfo=C,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/MainTaskGuideMgr":"MainTaskGuideMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyBackCity":"ProxyBackCity","./ProxyForge":"ProxyForge","./ProxyHero":"ProxyHero","./ProxyImmortal":"ProxyImmortal","./ProxyImtBoss":"ProxyImtBoss","./ProxyImtSkill":"ProxyImtSkill","./ProxyOffice":"ProxyOffice","./ProxyWork":"ProxyWork"}],ProxyOffice:[function(t,e,o){"use strict";cc._RF.push(e,"8c467KjQABMjJLCK19y1YMx","ProxyOffice"),Object.defineProperty(o,"__esModule",{value:!0}),o.OfficeSaveInfo=o.OfficeAttrType=void 0;var n,r=t("./ProxyOffline"),i=t("./ProxyMainTask2"),a=t("../Platform/PlatformBase"),s=t("../Manager/WinMgr"),l=t("../Manager/UserMgr"),m=t("../Manager/SaveMgr"),u=t("../Manager/RedPointMgr"),p=t("../Manager/PlatformMgr"),c=t("../Manager/DataMgr"),d=t("../Manager/BCMgr"),f=t("../Common/EnumsDefine");(function(t){t[t.None=0]="None",t[t.MedalAdd=1]="MedalAdd",t[t.OfflinePassLevelSpeedAdd=2]="OfflinePassLevelSpeedAdd",t[t.MedalOfflineNumAdd=3]="MedalOfflineNumAdd",t[t.MedalOfflineTimeLimitAdd=4]="MedalOfflineTimeLimitAdd",t[t.Gold=5]="Gold"})(n=o.OfficeAttrType||(o.OfficeAttrType={}));var h=function(){function t(){this.mOfficeInfo=null,this.mSaveFlag=!1,this.mDataMap=null,this.mIDMap=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.CreateDefaulInfo=function(){var t=new y;this.mOfficeInfo=t},t.prototype.SyncInfo=function(){var t=m.default.Get(m.default.OFFICE_INFO);this.mOfficeInfo=new y,this.mOfficeInfo=JSON.parse(t),this._HandleSelfMap()},t.prototype._HandleSelfMap=function(){},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mOfficeInfo);m.default.Save(m.default.OFFICE_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.RefreshOnNewDay=function(t){this.mOfficeInfo.dailyRewardState=0,t||0!==this.GetData(this.mOfficeInfo.title,this.mOfficeInfo.step).attr[n.Gold-1]&&u.default.SetInvokeData(u.RedPointType.Office_Daily,1),this.Save()},t.prototype._CacheData=function(){if(null===this.mDataMap){this.mDataMap=new Map,this.mIDMap=new Map;var t=c.default.Ins.m_DB.officeDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];this.mIDMap.set(Number(e),o);var n=this.mDataMap.get(o.title);n||(n=new Map,this.mDataMap.set(o.title,n)),n.set(o.step,o)}}},t.prototype.GetData=function(t,e){this._CacheData();var o=this.mDataMap.get(t);return o?o.get(e):o},t.prototype.GetNextData=function(t,e){var o=t,n=e+1;return this.GetData(o,n)||(o++,n=1,this.GetData(o,n))},t.prototype.GetStepCountByTitle=function(t){this._CacheData();var e=this.mDataMap.get(t);return void 0===e?0:e.size},t.prototype.CheckDailyRewards=function(){0===this.mOfficeInfo.dailyRewardState&&0!==this.GetData(this.mOfficeInfo.title,this.mOfficeInfo.step).attr[n.Gold-1]&&u.default.SetInvokeData(u.RedPointType.Office_Daily,1)},t.prototype.CheckCanUpgrade=function(){var e=t.Ins.mOfficeInfo,o=t.Ins.GetNextData(e.title,e.step);return!(!o||l.default.Ins.ClientInfo.bestLevel-1<o.level||(u.default.SetInvokeData(u.RedPointType.Office_Upgrade,1),0))},t.prototype.UpgradeLv=function(){var t=this.GetStepCountByTitle(this.mOfficeInfo.title),e=this.GetNextData(this.mOfficeInfo.title,this.mOfficeInfo.step);if(e){this.mOfficeInfo.step>=t?(this.mOfficeInfo.title++,this.mOfficeInfo.step=1):this.mOfficeInfo.step++;var o=e.rewards;l.default.Ins.UpdateItem(o[0],o[1]),l.default.Ins.Save(),i.default.Ins.CheckOffice(),e.level>=50&&p.default.mCurPlf.ShowInterstitial(a.ADUnitID.Interstitial_Func_ID,f.InsPoint.OfficeUpgrade)}this.Save(),d.default.Dispatch(f.BCType.Office_Upgraded),r.default.Ins.UpdateOfflineLevelSpeed(),this.CheckCanUpgrade()||u.default.SetInvokeData(u.RedPointType.Office_Upgrade,0),this.CheckDailyRewards()},t.prototype.GetDailyRewards=function(){var t=this.GetData(this.mOfficeInfo.title,this.mOfficeInfo.step).attr[n.Gold-1];l.default.Ins.UpdateItem(f.ItemType.Gold,t),l.default.Ins.Save(),this.mOfficeInfo.dailyRewardState=1,this.Save(),s.default.Ins.Open(f.WinType.GetRewardsWin,function(e){e.SetDataSingle(f.ItemType.Gold,t)}),u.default.SetInvokeData(u.RedPointType.Office_Daily,0)},t.prototype.GetAttrValue=function(t){var e=this.mOfficeInfo;return this.GetData(e.title,e.step).attr[t-1]},t.mIns=null,t}();o.default=h;var y=function(){this.title=0,this.step=1,this.dailyRewardState=0};o.OfficeSaveInfo=y,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","../Platform/PlatformBase":"PlatformBase","./ProxyMainTask2":"ProxyMainTask2","./ProxyOffline":"ProxyOffline"}],ProxyOffline:[function(t,e,o){"use strict";cc._RF.push(e,"0a5972EeGNLLahCvFNhUcYW","ProxyOffline"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ProxyVIP"),r=t("./ProxyOffice"),i=t("./ProxyImmortal"),a=t("./ProxyHero"),s=t("./ProxyBackCity"),l=t("../Manager/UserMgr"),m=t("../Manager/DataMgr"),u=t("../Manager/BCMgr"),p=t("../Common/EnumsDefine"),c=t("../Common/Common"),d=function(){function t(){this.mOfflineTime=0,this.mNeedOpenCoinWin=!1,this.mOfflineCoinNum=null,this.mPassedLevelNum=0,this.mNeedOpenMedalWin=!1,this.mOfflineMedalNum=0,this.mOfflinePassLevelSpeed=1,this.mOfflineMedalFactor=.25,this.mBaseMedalOfflineTime=120,this.mCurOfflineMedalMinTime=0,this.mOfflineMedalAddRate=0,this.mConfigEnemyAttack=42,this.mConfigEnemyDef=25,this.mConfigEnemyHP=400,this.mK1=6,this.mK2=2,this.mHighestLevelByCamp=[1,1,1,1],this.mBossLevelInterval=100}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=m.default.Ins.m_DB.paramDB;this.mOfflineMedalFactor=Number(t.OFFLINE_MEDAL_FACTOR.value),this.mBaseMedalOfflineTime=Number(t.OFFLINE_MEDAL_TIME.value)},t.prototype.UpdateOfflineLevelSpeed=function(){var t=.01*i.default.Ins.GetAttrValue(p.ImtAttrType.OfflinePassLevelSpeedAdd),e=.01*n.default.Ins.GetAttrValue(n.VIPAttrType.PassLevelSpeed),o=.01*r.default.Ins.GetAttrValue(r.OfficeAttrType.OfflinePassLevelSpeedAdd);this.mOfflinePassLevelSpeed=2*(1+t+e+o)},t.prototype._GetOfflineMedalTimeAddRate=function(){return 1+.01*i.default.Ins.GetAttrValue(p.ImtAttrType.MedalOfflineTimeLimitAdd)+.01*r.default.Ins.GetAttrValue(r.OfficeAttrType.MedalOfflineTimeLimitAdd)},t.prototype.UpdateOfflineMedalTime=function(){this.mCurOfflineMedalMinTime=Math.floor(this.mBaseMedalOfflineTime*this._GetOfflineMedalTimeAddRate())},t.prototype.UpdateOfflineMedalAddRate=function(){var t=1+.01*i.default.Ins.GetAttrValue(p.ImtAttrType.MedalOfflineNumAdd)+.01*r.default.Ins.GetAttrValue(r.OfficeAttrType.MedalOfflineNumAdd);this.mOfflineMedalAddRate=t},t.prototype.HandleOfflineTime=function(t,e){this.UpdateOfflineLevelSpeed(),this.UpdateOfflineMedalTime(),this.UpdateOfflineMedalAddRate(),this.UpdateHighestReachLevelByCamp();var o=this.GetHighestReachLevelByAllHero();if(s.default.Ins.mBackSaveInfo.backTimes>0){var n=Math.floor(e/60*this.mOfflinePassLevelSpeed),r=l.default.Ins.ClientInfo.curLevel,i=r+n;i>o&&(i=o),i<r&&(i=r),n=i-r,this.mPassedLevelNum=n,l.default.Ins.ClientInfo.curLevel=i;var a=s.default.Ins.GetCurLevelGetMedalSpeed(),m=e/60;m>this.mCurOfflineMedalMinTime&&(m=this.mCurOfflineMedalMinTime),n=Math.floor(m*this.mOfflinePassLevelSpeed);var u=Math.floor(a*n*this.mOfflineMedalFactor);u>0&&(this.mNeedOpenMedalWin=!0,this.mOfflineMedalNum=Math.floor(u*this.mOfflineMedalAddRate))}},t.prototype.GetCanReachLevelByCamp=function(t){return this.mHighestLevelByCamp[t]},t.prototype.UpdateHighestReachLevelByCamp=function(){for(var t=p.CampType.Wei;t<=p.CampType.Qun;++t)this.mHighestLevelByCamp[t]=1;for(var e=m.default.Ins.m_DB.heroCardDB,o=a.default.Ins.mHeroInfo.heroTeam,n=(t=0,o.length);t<n;++t){var r=o[t];if(0!==r){var i=e[r].camp,s=this.GetHighestReachLevel(r);this.mHighestLevelByCamp[i]<=s&&(this.mHighestLevelByCamp[i]=s)}}},t.prototype.GetHighestReachLevelByAllHero=function(){for(var t=l.default.Ins.ClientInfo,e=t.curLevel,o=t.bestLevel,n=0,r=0,i=this.mHighestLevelByCamp.length;r<i;++r){var a=this.mHighestLevelByCamp[r];n<a&&(n=a)}if(n<=m.default.Ins.mNoLimitCampLevelNum+this.mBossLevelInterval)return n>o&&(n=o),n;var s=this.GetNextLimitCamp(e),u=1e4;for(r=0,i=this.mHighestLevelByCamp.length;r<i;++r){var c=Math.max(0,Math.floor((this.mHighestLevelByCamp[r]-(m.default.Ins.mNoLimitCampLevelNum+100*(r+1)))/400));c<u&&(u=c)}for(var d=m.default.Ins.mNoLimitCampLevelNum+u*m.default.Ins.mNoLimitCampLevelNum+100*(s+1),f=this.mHighestLevelByCamp[s],h=0;f>=d;)n<f&&(n=f),++s>p.CampType.Qun&&(s=p.CampType.Wei,h+=400),d=m.default.Ins.mNoLimitCampLevelNum+u*m.default.Ins.mNoLimitCampLevelNum+100*(s+1)+h,f=this.mHighestLevelByCamp[s];return n<=f?n=f:n>d&&(n=d),n>o&&(n=o),n},t.prototype.GetNextLimitCamp=function(t){if(t<=m.default.Ins.mNoLimitCampLevelNum)return p.CampType.Wei;var e=Math.ceil(t/100)%4;return--e<0&&(e+=4),e},t.prototype.GetHighestReachLevel=function(t){var e=a.default.Ins.GetHeroAtk(t),o=a.default.Ins.GetHeroDef(t),n=a.default.Ins.GetHeroHP(t),r=e.MultiplySingle(this.mK1).DivideSingle(this.mConfigEnemyHP+this.mK1*this.mConfigEnemyDef),i=(Math.log10(r.mBaseValue)+3*r.mExpoValue)/c.default.LOG10_LV_FACTOR,s=n.Add(o.MultiplySingle(this.mK2)).DivideSingle(this.mK2*this.mConfigEnemyAttack),l=(Math.log10(s.mBaseValue)+3*s.mExpoValue)/c.default.LOG10_LV_FACTOR;return Math.max(1,Math.min(Math.floor(i),Math.floor(l)))},t.prototype.OnHeroAttrChanged=function(t){var e=this.GetHighestReachLevel(t),o=m.default.Ins.m_DB.heroCardDB[t].camp;if(e>this.mHighestLevelByCamp[o]){this.mHighestLevelByCamp[o]=e;var n=this.GetHighestReachLevelByAllHero();u.default.Dispatch(p.BCType.Offline_UpdateHighestLevelID,n)}},t.prototype.OnAllAttrChanged=function(){this.UpdateHighestReachLevelByCamp();var t=this.GetHighestReachLevelByAllHero();u.default.Dispatch(p.BCType.Offline_UpdateHighestLevelID,t)},t.mIns=null,t}();o.default=d,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/UserMgr":"UserMgr","./ProxyBackCity":"ProxyBackCity","./ProxyHero":"ProxyHero","./ProxyImmortal":"ProxyImmortal","./ProxyOffice":"ProxyOffice","./ProxyVIP":"ProxyVIP"}],ProxySevenDays:[function(t,e,o){"use strict";cc._RF.push(e,"ed96fVjyrFMHZhRlf1QwBAb","ProxySevenDays"),Object.defineProperty(o,"__esModule",{value:!0}),o.SevenDaysSaveInfo=void 0;var n=t("./ProxySkin"),r=t("./ProxyHero"),i=t("../Manager/WinMgr"),a=t("../Manager/UserMgr"),s=t("../Manager/RedPointMgr"),l=t("../Manager/PlatformMgr"),m=t("../Manager/FuncMgr"),u=t("../Manager/DataMgr"),p=t("../Common/EnumsDefine"),c=function(){function t(){}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.GetDayState=function(t){return a.default.Ins.ClientInfo.sevenDays.mDayStateArr[t-1]},t.prototype.GetRewards=function(t,e,o){void 0===e&&(e=0),void 0===o&&(o=!1);var s=u.default.Ins.m_DB.sevenDaysDB[t],m=s.rewards;if(1===s.special)r.default.Ins.GetHero([m[0]]),i.default.Ins.Open(p.WinType.NewHeroShowWin,function(t){t.SetData(m[0])});else if(2===s.special){var c=m[0],d=n.default.Ins.GetSkin(c);i.default.Ins.Open(p.WinType.GetSkinWin,function(t){t.SetData(c,d)})}else a.default.Ins.UpdateItem(m[0],m[1]),e&&o&&a.default.Ins.GetADExtraRewards(),i.default.Ins.Open(p.WinType.GetRewardsWin,function(t){var n=t;e&&o?n.SetDataWithADCoin(m[0],m[1]):n.SetDataSingle(m[0],m[1])});var f=a.default.Ins.ClientInfo.sevenDays;if(0===e&&1===s.onceMore?f.mDayStateArr[t-1]=1:f.mDayStateArr[t-1]=-1,a.default.Ins.Save(),0===e)switch(t){case 3:l.default.mCurPlf.ReportTrackingEvent(p.TrackingEventType.Sign_3),l.default.mCurPlf.ReportHuoShanEvent(p.HuoShanEventType.Sign_3);break;case 5:l.default.mCurPlf.ReportTrackingEvent(p.TrackingEventType.Sign_5),l.default.mCurPlf.ReportHuoShanEvent(p.HuoShanEventType.Sign_5);break;case 7:l.default.mCurPlf.ReportTrackingEvent(p.TrackingEventType.Sign_7),l.default.mCurPlf.ReportHuoShanEvent(p.HuoShanEventType.Sign_7)}else{var h=t+100;l.default.ReportEvent(p.BIPoint.Seven_Day_Get,{day:h})}this.CheckRedPoint()},t.prototype.RefreshOnNewDay=function(t){var e=a.default.Ins.ClientInfo.sevenDays;0!==e.mDayStateArr[e.mCurDay-1]&&(e.mCurDay++,e.mCurDay>7&&(e.mCurDay=7),a.default.Ins.Save()),t||this.CheckRedPoint()},t.prototype.NeedShowBtn=function(){return!(!m.default.IsUnlock(m.FuncType.SevenDays)||this.CheckAllRewardsGot())},t.prototype.CheckAllRewardsGot=function(){for(var t=a.default.Ins.ClientInfo.sevenDays.mDayStateArr,e=0,o=t.length;e<o;++e)if(-1!==t[e])return!1;return!0},t.prototype.CheckRedPoint=function(){for(var t=a.default.Ins.ClientInfo.sevenDays,e=t.mDayStateArr,o=0,n=0,r=e.length;n<r;++n)if(n<t.mCurDay&&0===e[n]){o=1;break}s.default.SetInvokeData(s.RedPointType.SevenDay,o)},t.mIns=null,t}();o.default=c;o.SevenDaysSaveInfo=function(){this.mDayStateArr=[],this.mCurDay=1;for(var t=0;t<7;++t)this.mDayStateArr.push(0)},cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/DataMgr":"DataMgr","../Manager/FuncMgr":"FuncMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyHero":"ProxyHero","./ProxySkin":"ProxySkin"}],ProxyShop:[function(t,e,o){"use strict";cc._RF.push(e,"6fc56Xj2zVHX5xbqe+Bx96Y","ProxyShop"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShopSaveInfo=void 0;var n=t("./ProxyLottery"),r=t("./ProxyImmortal"),i=t("../Manager/UserMgr"),a=t("../Manager/SaveMgr"),s=t("../Manager/RedPointMgr"),l=t("../Manager/FuncMgr"),m=t("../Manager/DataMgr"),u=t("../Manager/BCMgr"),p=t("../Common/EnumsDefine"),c=t("../Common/Common"),d=function(){function t(){this.mShopInfo=null,this.mSaveFlag=!1,this.mItemShopIDArr=[[17,1,-1],[13,1,-1],[15,1,2],[4,1,-1],[6,1,5]],this.mBaseQualityCostArr=[5,5,10,10,20],this.mHeroCount=5,this.mTotalRefreshCount=3,this.mADCoinItemCount=8,this.mRandomSkinItemID=201,this.mImtGiftBaseID=301,this.mGoldInfoArr=[[401,250,500],[402,600,1200],[403,1100,2200]],this.mImtPoolArr=[3,4,5]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.CreateDefaultInfo=function(){this.mShopInfo=new f;for(var t=0,e=this.mItemShopIDArr.length;t<e;++t)this.mShopInfo.propLeftNumArr.push(this.mItemShopIDArr[t][2]);for(t=0;t<this.mHeroCount;++t)this.mShopInfo.randHeroArr.push(0),this.mShopInfo.heroBoughtCountArr.push(0)},t.prototype.SyncInfo=function(){var t=a.default.Get(a.default.SHOP_INFO);this.mShopInfo=new f,this.mShopInfo=JSON.parse(t),this._HandleSelfMap()},t.prototype._HandleSelfMap=function(){},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mShopInfo);a.default.Save(a.default.SHOP_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.RefreshOnNewDay=function(t){for(var e=this.mShopInfo.propLeftNumArr,o=0,n=this.mItemShopIDArr.length;o<n;++o)e[o]=this.mItemShopIDArr[o][2];this.RefreshRandHero(),this.mShopInfo.heroLeftRefreshTimes=this.mTotalRefreshCount,this.mShopInfo.coinGotState=0,this.Save(),t||s.default.SetInvokeData(s.RedPointType.Shop_ADCoin_FreeItem,this.GetADCoinRedNum())},t.prototype.GetADCoinRedNum=function(){return l.default.IsUnlock(l.FuncType.Shop)&&0===this.mShopInfo.coinGotState?1:0},t.prototype.CheckShopRedNum=function(){s.default.SetInvokeData(s.RedPointType.Shop_ADCoin_FreeItem,this.GetADCoinRedNum())},t.prototype.GetPropLeftCanBuyNum=function(t){return this.mShopInfo.propLeftNumArr[t]},t.prototype.OnBuyProp=function(t,e){var o=this.mShopInfo.propLeftNumArr;-1!==o[t]&&(o[t]-=e),this.Save()},t.prototype.RefreshRandHero=function(){for(var t=n.default.Ins.GetHeroArrWrapProb(p.HeroQuality.R),e=[],o=0,r=t.length;o<r;++o)e.push(t[o][1]);var i=c.default.GetRandIdxByWeight(e,2);this.mShopInfo.randHeroArr[0]=t[i[0]][0],this.mShopInfo.randHeroArr[1]=t[i[1]][0];var a=n.default.Ins.GetHeroArrWrapProb(p.HeroQuality.SR);for(e=[],o=0,r=a.length;o<r;++o)e.push(a[o][1]);i=c.default.GetRandIdxByWeight(e,2),this.mShopInfo.randHeroArr[2]=a[i[0]][0],this.mShopInfo.randHeroArr[3]=a[i[1]][0];var s=n.default.Ins.GetHeroArrWrapProb(p.HeroQuality.SSR);for(e=[],o=0,r=s.length;o<r;++o)e.push(s[o][1]);i=c.default.GetRandIdxByWeight(e,1),this.mShopInfo.randHeroArr[4]=s[i[0]][0];for(var l=0;l<this.mHeroCount;++l)this.mShopInfo.heroBoughtCountArr[l]=0},t.prototype.GetHeroCost=function(t){var e=this.mShopInfo.heroBoughtCountArr[t];return this.mBaseQualityCostArr[t]*(e+1)},t.prototype.BuyHeroFragment=function(t){this.mShopInfo.heroBoughtCountArr[t]++,this.Save()},t.prototype.RefreshHeroFragmentManual=function(){this.RefreshRandHero(),this.mShopInfo.heroLeftRefreshTimes--,this.Save(),u.default.Dispatch(p.BCType.Shop_RefreshHeroFragment)},t.prototype.GetFreeADCoin=function(){this.mShopInfo.coinGotState=1,i.default.Ins.UpdateItem(p.ItemType.ADCoin,1),this.Save(),i.default.Ins.Save(),s.default.SetInvokeData(s.RedPointType.Shop_ADCoin_FreeItem,this.GetADCoinRedNum())},t.prototype.GetRandImt=function(t){for(var e=this.mImtPoolArr[t-2],o=m.default.Ins.m_DB.forgePoolDB[e].pool,n=[],i=0,a=o.length;i<a;++i)r.default.Ins.CheckHasImtByID(o[i][0])||n.push(o[i]);0===n.length&&(n=o);var s=[];for(i=0,a=n.length;i<a;++i)s.push(n[i][1]);return n[c.default.GetRandIdxByWeight(s,1)[0]][0]},t.prototype.CheckGoldHasExchanged=function(t){for(var e=this.mShopInfo.goldStateArr,o=0,n=e.length;o<n;++o)if(e[o]===t)return!0;return!1},t.prototype.ExchangeGold=function(t){var e=this.mShopInfo.goldStateArr,o=!1;return-1===e.indexOf(t)&&(o=!0,e.push(t),this.Save()),o},t.mIns=null,t}();o.default=d;var f=function(){this.propLeftNumArr=[],this.randHeroArr=[],this.heroBoughtCountArr=[],this.heroLeftRefreshTimes=2,this.coinGotState=0,this.skinIDArr=[],this.goldStateArr=[]};o.ShopSaveInfo=f,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FuncMgr":"FuncMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyImmortal":"ProxyImmortal","./ProxyLottery":"ProxyLottery"}],ProxySign:[function(t,e,o){"use strict";cc._RF.push(e,"305394+Eu5E7bpBw71uLDbG","ProxySign"),Object.defineProperty(o,"__esModule",{value:!0}),o.SignSaveInfo=void 0;var n=t("./ProxyTask"),r=t("./ProxyLargeNum"),i=t("../Manager/WinMgr"),a=t("../Manager/UserMgr"),s=t("../Manager/RedPointMgr"),l=t("../Manager/DataMgr"),m=t("../Manager/BCMgr"),u=t("../Common/EnumsDefine"),p=function(){function t(){this.mMaxDay=30}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.RefreshOnNewDay=function(t){var e=a.default.Ins.ClientInfo.signInfo;e.hasSignedDay===e.canSignDay&&(e.canSignDay++,e.canSignDay>this.mMaxDay&&(e.canSignDay=1,e.hasSignedDay=0)),a.default.Ins.Save(),t||this.CheckRedPoint()},t.prototype.Sign=function(t){var e=a.default.Ins.ClientInfo.signInfo;if(!(e.canSignDay<=e.hasSignedDay)){var o=l.default.Ins.m_DB.signDB[t].reward,s=o[0],p=o[1],c=p;s===u.ItemType.Medal&&(p=a.default.Ins.GetMedalNum(p),c=r.default.FormatNumber(p,1)),a.default.Ins.UpdateItem(s,p),i.default.Ins.Open(u.WinType.GetRewardsWin,function(t){t.SetDataSingle(s,c)}),a.default.Ins.ClientInfo.signInfo.hasSignedDay++,m.default.Dispatch(u.BCType.SignAct_OnSigned,t),a.default.Ins.Save(),n.default.Ins.UpdateTaskProgress(n.DailyTaskType.Sign,1),this.CheckRedPoint()}},t.prototype.CheckRedPoint=function(){var t=a.default.Ins.ClientInfo.signInfo;t.canSignDay>t.hasSignedDay?s.default.SetInvokeData(s.RedPointType.Act_Sign,1):s.default.SetInvokeData(s.RedPointType.Act_Sign,0)},t.mIns=null,t}();o.default=p;o.SignSaveInfo=function(){this.hasSignedDay=0,this.canSignDay=1},cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyLargeNum":"ProxyLargeNum","./ProxyTask":"ProxyTask"}],ProxySkin:[function(t,e,o){"use strict";cc._RF.push(e,"a2199wQSGZDBK3QXRcWljEX","ProxySkin"),Object.defineProperty(o,"__esModule",{value:!0}),o.SkinSaveInfo=o.SkinAttrType=o.SkinQuality=o.SkinFromType=void 0;var n,r,i=t("./ProxyOffline"),a=t("./ProxyHero"),s=t("../Manager/UserMgr"),l=t("../Manager/FloatItemMgr"),m=t("../Manager/FightMgr"),u=t("../Manager/DataMgr"),p=t("../Manager/BCMgr"),c=t("../Common/EnumsDefine"),d=t("../Common/Common");(function(t){t[t.Default=0]="Default",t[t.Fragment=1]="Fragment",t[t.VIP=2]="VIP",t[t.ADCoin=3]="ADCoin",t[t.SevenDay=4]="SevenDay"})(n=o.SkinFromType||(o.SkinFromType={})),function(t){t[t.Default=0]="Default",t[t.Normal=1]="Normal",t[t.Advance=2]="Advance"}(o.SkinQuality||(o.SkinQuality={})),function(t){t[t.Atk=1]="Atk",t[t.Def=2]="Def",t[t.HP=3]="HP"}(r=o.SkinAttrType||(o.SkinAttrType={}));var f=function(){function t(){this.mPoolArr=[[1,8],[2,2]],this.mHeroMap=null,this.mSkinDataArr=[],this.mHeroAttrMap=null,this.mTargetStrArr=["\u6240\u6709","\u9b4f\u56fd","\u8700\u56fd","\u5434\u56fd","\u7fa4\u96c4"]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.ConvertToAttr=function(){this._ConvertToAttrMap()},t.prototype.InitData=function(){this.mHeroMap=new Map;var t=u.default.Ins.m_DB.skinDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e],r=this.mHeroMap.get(o.entityID);r||(r=[],this.mHeroMap.set(o.entityID,r)),r.push(o),o.fromType!==n.Default&&this.mSkinDataArr.push(o)}},t.prototype.GetSkin=function(t,e){void 0===e&&(e=!0);var o=!this.CheckHasSkin(t);if(o)s.default.Ins.ClientInfo.skinInfo.skinArr.push(t),this.UpdateSkinAttr(t),p.default.Dispatch(c.BCType.Skin_GetNew,t);else{var n=u.default.Ins.m_DB.skinDB[t].repeatNum;s.default.Ins.UpdateItem(c.ItemType.SkinFrag,n),e&&l.default.Ins.ShowItem(c.ItemType.SkinFrag,n)}return s.default.Ins.Save(),o},t.prototype.GetRandSkin=function(){for(var t=[],e=0,o=this.mPoolArr.length;e<o;++e)t.push(this.mPoolArr[e][1]);var n;n=this.mPoolArr[d.default.GetRandIdxByWeight(t,1)[0]][0];for(var r=[],i=u.default.Ins.m_DB.skinPoolDB[n].pool,a=0,s=i.length;a<s;++a)r.push(i[a][1]);return i[d.default.GetRandIdxByWeight(r,1)[0]][0]},t.prototype.GetHeroDefaultSkin=function(t){return this.mHeroMap.get(t)[0]},t.prototype.GetHeroCurSkinData=function(t){var e=a.default.Ins.GetHeroSI(t);if(e&&0!==e.skinID){var o=e.skinID;return u.default.Ins.m_DB.skinDB[o]}return this.GetHeroDefaultSkin(t)},t.prototype.GetSkinsByHero=function(t){return this.mHeroMap.get(t)},t.prototype.CheckHasSkin=function(t,e){void 0===e&&(e=!1);var o=s.default.Ins.ClientInfo.skinInfo.skinArr;if(e&&u.default.Ins.m_DB.skinDB[t].fromType===n.Default)return!0;for(var r=0,i=o.length;r<i;++r)if(o[r]===t)return!0;return!1},t.prototype.GetSkinFromDesc=function(t){switch(t){case n.Default:return"\u9ed8\u8ba4\u76ae\u80a4";case n.Fragment:return"\u76ae\u80a4\u5546\u5e97\u5151\u6362";case n.VIP:return"VIP\u9650\u5b9a";case n.ADCoin:return"\u5e7f\u544a\u5e01\u5151\u6362";case n.SevenDay:return"\u4e03\u65e5\u72c2\u6b22\u9650\u5b9a"}},t.prototype._ConvertToAttrMap=function(){this.mHeroAttrMap=new Map;for(var t=s.default.Ins.ClientInfo.skinInfo.skinArr,e=u.default.Ins.m_DB.skinDB,o=0,n=t.length;o<n;++o){var r=e[t[o]];r&&0!==r.attr.length&&this._ConvertAttr(r.attr)}},t.prototype._ConvertAttr=function(t){var e,o=t[0];if(this.mHeroAttrMap.get(o))if((e=this.mHeroAttrMap.get(o)).get(t[1])){var n=e.get(t[1]);e.set(t[1],n+t[2])}else e.set(t[1],t[2]);else(e=new Map).set(t[1],t[2]),this.mHeroAttrMap.set(o,e)},t.prototype.GetAttrDesc=function(t){if(0===t.length)return"";var e=null;switch(t[0]){case r.Atk:e="\u63d0\u5347{0}\u6b66\u5c06\u653b\u51fb\uff1a{1}";break;case r.Def:e="\u63d0\u5347{0}\u6b66\u5c06\u9632\u5fa1\uff1a{1}";break;case r.HP:e="\u63d0\u5347{0}\u6b66\u5c06\u751f\u547d\u503c\uff1a{1}"}var o=t[1],n=[];return n.push(this.mTargetStrArr[o+1]),n.push(t[2]+"%"),d.default.FormatContent(e,n)},t.prototype.GetHeroAttrValue=function(t,e){var o=this.mHeroAttrMap.get(t);return o&&o.get(e)||0},t.prototype.UpdateSkinAttr=function(t){var e=u.default.Ins.m_DB.skinDB[t];this._ConvertAttr(e.attr),m.default.Ins.UpdateAllHeroAttr(),i.default.Ins.OnAllAttrChanged(),p.default.Dispatch(c.BCType.OnUpdateADH)},t.mIns=null,t}();o.default=f;o.SkinSaveInfo=function(){this.skinArr=[]},cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FightMgr":"FightMgr","../Manager/FloatItemMgr":"FloatItemMgr","../Manager/UserMgr":"UserMgr","./ProxyHero":"ProxyHero","./ProxyOffline":"ProxyOffline"}],ProxySmith:[function(t,e,o){"use strict";cc._RF.push(e,"2df8bVy6AlBeKxYfxFTXK+W","ProxySmith"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ProxyMainTask2"),r=t("./ProxyForge"),i=t("./ProxyAllSP"),a=t("../Manager/UserMgr"),s=t("../Manager/PlatformMgr"),l=t("../Manager/DataMgr"),m=t("../Common/EnumsDefine"),u=t("../Common/Common"),p=function(){function t(){this.mDataMap=null,this.mOnceAddRate=30}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype._CacheData=function(){if(null===this.mDataMap){this.mDataMap=new Map;var t=l.default.Ins.m_DB.smithStepDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e],n=this.mDataMap.get(o.step);n||(n=new Map,this.mDataMap.set(o.step,n)),n.set(o.star,o)}}},t.prototype.GetData=function(t,e){this._CacheData();var o=this.mDataMap.get(t);return o?o.get(e):o},t.prototype.GetNextData=function(t,e){var o=t,n=e+1;return this.GetData(o,n)||(o++,n=0,this.GetData(o,n))},t.prototype.GetStarCountByStep=function(t){this._CacheData();var e=this.mDataMap.get(t);return void 0===e?0:e.size-1},t.prototype.Upgrade=function(t,e){var o=this.GetData(t.title,t.lv);a.default.Ins.UpdateItem(m.ItemType.ForgeExp,-o.consume);var l=.01*o.baseSuccess+t.addSuccess,p=u.default.GetRandValueBetween(0,100);t.addSuccess=0;var c=!1;return p<=l?(e?(t.title++,t.lv=0,t.title===m.BlackSmithTitle.Master?i.default.Ins.UpdateTaskProgress(i.AllSPTaskType.UpgradeSmithToTitle3,1):t.title===m.BlackSmithTitle.God&&i.default.Ins.UpdateTaskProgress(i.AllSPTaskType.UpgradeSmithToTitle5,1),s.default.ReportEvent(m.BIPoint.MAX_SMITH,{title:t.title})):t.lv++,c=!0,n.default.Ins.CheckSmithLv()):c=!1,r.default.Ins.Save(),a.default.Ins.Save(),c},t.prototype.UseMedicine=function(t){r.default.Ins.GetBSmithSI(t).addSuccess+=this.mOnceAddRate,r.default.Ins.Save()},t.prototype.CheckDoubleImt=function(){return u.default.GetRandValueBetween(0,100)<=0},t.mIns=null,t}();o.default=p,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/DataMgr":"DataMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/UserMgr":"UserMgr","./ProxyAllSP":"ProxyAllSP","./ProxyForge":"ProxyForge","./ProxyMainTask2":"ProxyMainTask2"}],ProxySpeed:[function(t,e,o){"use strict";cc._RF.push(e,"5684055vVVPSIbBAEKRqOQ4","ProxySpeed"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ProxyBackCity"),r=t("../Manager/UserMgr"),i=t("../Manager/SaveMgr"),a=t("../Manager/RedPointMgr"),s=t("../Manager/FightMgr"),l=t("../Manager/DataMgr"),m=t("../Manager/BCMgr"),u=t("../Common/EnumsDefine"),p=function(){function t(){this.mInitSpeedFactor=1.2,this.mInitSpeedFactor2=this.mInitSpeedFactor,this.mSpeedFactor=this.mInitSpeedFactor,this.mTimeScale=1,this.mIsUsingSpeedItem=!1,this.mSpeedTiming=0,this.mCurMaxTime=1,this.mSpeedItemDuration=0,this.mSpeedItemFactor=2,this._SyncDuration=5,this._SyncTimeCounter=5}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=l.default.Ins.m_DB.paramDB;this.mSpeedItemDuration=Number(t.SPEED_DURATION.value),this.mSpeedItemFactor=Number(t.SPEED_FACTOR.value)},t.prototype.SpecialUpdateSpeed=function(){0===n.default.Ins.mBackSaveInfo.backTimes&&(2===r.default.Ins.ClientInfo.bestLevel?(this.mInitSpeedFactor=1.5,this.UpdateCurGameSpeed()):10===r.default.Ins.ClientInfo.bestLevel&&(this.mInitSpeedFactor=this.mInitSpeedFactor2,this.UpdateCurGameSpeed()))},t.prototype.UpdateCurGameSpeed=function(){var t=0;this.mIsUsingSpeedItem&&(t=this.mSpeedItemFactor-1),this.mSpeedFactor=this.mInitSpeedFactor+t,this.mTimeScale=1/this.mSpeedFactor,s.default.mCurFightMode.UpdateGameSpeed()},t.prototype.UseSpeedItem=function(){this.mIsUsingSpeedItem=!0,this.mSpeedTiming+=60*this.mSpeedItemDuration,this.mCurMaxTime=this.mSpeedTiming,this.UpdateCurGameSpeed(),m.default.Dispatch(u.BCType.MainWin_UseSpeedItem),i.default.Save(i.default.GAME_SPEED_INFO,this.mSpeedTiming)},t.prototype.OnUpdate=function(t){this.mIsUsingSpeedItem&&(this.mSpeedTiming-=t,m.default.Dispatch(u.BCType.GameSpeed_UpdateTime,this.mSpeedTiming),this._SyncTimeCounter-=t,this._SyncTimeCounter<=0&&(this._SyncTimeCounter=this._SyncDuration,i.default.Save(i.default.GAME_SPEED_INFO,this.mSpeedTiming)),this.mSpeedTiming<=0&&(this.mSpeedTiming=0,this.mIsUsingSpeedItem=!1,this.UpdateCurGameSpeed(),i.default.Save(i.default.GAME_SPEED_INFO,0)))},t.prototype.InitGameSpeedItemTime=function(){var t=Number(i.default.Get(i.default.GAME_SPEED_INFO));t&&t>0&&(this.mIsUsingSpeedItem=!0,this.mSpeedTiming=t,this.mCurMaxTime=this.mSpeedTiming,this.UpdateCurGameSpeed(),m.default.Dispatch(u.BCType.MainWin_UseSpeedItem))},t.prototype.CheckRedPointNum=function(){a.default.SetInvokeData(a.RedPointType.MainSpeed,r.default.Ins.GetItemNum(u.ItemType.SpeedUp2))},t.mIns=null,t}();o.default=p,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FightMgr":"FightMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","./ProxyBackCity":"ProxyBackCity"}],ProxyTask:[function(t,e,o){"use strict";cc._RF.push(e,"05c7a0hxgRNkqmiIX+ehPn6","ProxyTask"),Object.defineProperty(o,"__esModule",{value:!0}),o.DailyTaskSaveInfo=o.DailyTaskInfo=o.DailyTaskType=void 0;var n,r=t("./ProxyVIP"),i=t("./ProxyAllSP"),a=t("../Manager/WinMgr"),s=t("../Manager/UserMgr"),l=t("../Manager/SaveMgr"),m=t("../Manager/RedPointMgr"),u=t("../Manager/PlatformMgr"),p=t("../Manager/DataMgr"),c=t("../Manager/BCMgr"),d=t("../Common/EnumsDefine"),f=t("../Common/Common");(function(t){t[t.Sign=1]="Sign",t[t.Turntable=2]="Turntable",t[t.Forge=3]="Forge",t[t.ImtBoss=4]="ImtBoss",t[t.BackCity=5]="BackCity",t[t.Video=6]="Video",t[t.VideoClick=7]="VideoClick",t[t.TaskCount=100]="TaskCount",t[t.MedalLv=8]="MedalLv"})(n=o.DailyTaskType||(o.DailyTaskType={}));var h=function(){function t(){this.mDataMap=null,this.mTaskDataArr=null,this.mIsNew=!1,this.mScoreRewardsArr=null,this.mDailyTaskInfo=null,this.mSaveFlag=!1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t,this.mIns.InitCacheData()),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitCacheData=function(){if(null===this.mDataMap){this.mDataMap=new Map,this.mTaskDataArr=[];var t=p.default.Ins.m_DB.dailyTaskDB;for(var e in t)if(t.hasOwnProperty(e)){var o=t[e];this.mDataMap.set(o.taskType,o),this.mTaskDataArr.push(o)}}},t.prototype.InitParamData=function(){var t=p.default.Ins.m_DB.paramDB.DAILY_TASK_SCORE_REWARDS.value.split("|");this.mScoreRewardsArr=[];for(var e=0,o=t.length;e<o;++e)this.mScoreRewardsArr.push(f.default.Split2NumArr(t[e],","))},t.prototype.CreateDefaultHeroInfo=function(){this.mDailyTaskInfo=new y},t.prototype.SyncInfo=function(){var t=l.default.Get(l.default.DAILY_INFO);this.mDailyTaskInfo=JSON.parse(t),this._HandleSelfMap()},t.prototype._HandleSelfMap=function(){this.mDailyTaskInfo?this.mDailyTaskInfo.taskInfoMap=new s.SelfObjMap(this.mDailyTaskInfo.taskInfoMap.obj):(this.mDailyTaskInfo=new y,this.Save(!0))},t.prototype.RefreshOnNewDay=function(t){this.mIsNew=!0,this.mDailyTaskInfo.taskInfoMap=new s.SelfObjMap(null),t||m.default.SetInvokeData(m.RedPointType.DailyTask_Item,this._GetCompleteCount()),this.Save()},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mDailyTaskInfo);l.default.Save(l.default.DAILY_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.UpdateTaskProgress=function(t,e){var o=this.mDailyTaskInfo.taskInfoMap.Get(t);o||((o=new g).progress=0,o.taskState=i.TaskState.Progress,this.mDailyTaskInfo.taskInfoMap.Set(t,o)),o.progress+=e;var n=this.mDataMap.get(t);o.progress>=n.targetNum&&o.taskState===i.TaskState.Progress&&(o.taskState=i.TaskState.Complete,m.default.SetInvokeData(m.RedPointType.DailyTask_Item,1)),this.Save()},t.prototype.GetTaskRewards=function(t){var e=p.default.Ins.m_DB.dailyTaskDB[t];if(e){var o=this.mDailyTaskInfo.taskInfoMap.Get(e.taskType);if(o){o.taskState=i.TaskState.GotRewards;for(var l=e.rewards,f=[],h=0,y=l.length;h<y;++h){var g=l[h][0],I=l[h][1];I=s.default.Ins.UpdateConfigItem(g,I,r.VIPExpFromType.DailyTask),f.push([g,I])}a.default.Ins.Open(d.WinType.GetRewardsWin,function(t){t.SetData(f)}),this.mDailyTaskInfo.curScore+=e.score,this.UpdateTaskProgress(n.TaskCount,1),c.default.Dispatch(d.BCType.DailyTask_OnGetRewards),m.default.SetInvokeData(m.RedPointType.DailyTask_Item,this._GetCompleteCount()),m.default.SetInvokeData(m.RedPointType.DailyTask_Score,this.GetTaskScoreRedNum()),this.Save(),1061===t&&u.default.ReportEvent(d.BIPoint.Video_Click_Task)}}},t.prototype._GetCompleteCount=function(){var t=this.mDailyTaskInfo.taskInfoMap;if(!t)return 0;var e=0;for(var o in t.obj)t.obj.hasOwnProperty(o)&&t.obj[o].taskState===i.TaskState.Complete&&e++;return e},t.prototype.GetTaskSI=function(t){return this.mDailyTaskInfo.taskInfoMap.Get(t)},t.prototype.CheckHasGotScoreReward=function(t){for(var e=this.mDailyTaskInfo.hasGotIdsArr,o=0,n=e.length;o<n;++o)if(e[o]===t)return!0;return!1},t.prototype.GetScoreRewards=function(t){this.mDailyTaskInfo.hasGotIdsArr.push(t),this.mDailyTaskInfo.hasGotIdsArr.length===this.mScoreRewardsArr.length&&(this.mDailyTaskInfo.hasGotIdsArr=[],this.mDailyTaskInfo.curScore-=this.mScoreRewardsArr[this.mScoreRewardsArr.length-1][0]),c.default.Dispatch(d.BCType.DailyTask_GetScoreRewards),m.default.SetInvokeData(m.RedPointType.DailyTask_Score,this.GetTaskScoreRedNum()),this.Save()},t.prototype.GetTaskScoreRedNum=function(){for(var t=this.mScoreRewardsArr,e=t.length,o=this.mDailyTaskInfo.curScore,n=0;n<e;++n)if(o>=t[n][0]&&!this.CheckHasGotScoreReward(n))return 1;return 0},t.mIns=null,t}();o.default=h;var y=function(){this.taskInfoMap=new s.SelfObjMap(null),this.curScore=0,this.hasGotIdsArr=[]};o.DailyTaskInfo=y;var g=function(){this.progress=0,this.taskState=i.TaskState.None};o.DailyTaskSaveInfo=g,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyAllSP":"ProxyAllSP","./ProxyVIP":"ProxyVIP"}],ProxyTurntable:[function(t,e,o){"use strict";cc._RF.push(e,"6ebfbP9Mn1LDqRy3FJL9CEc","ProxyTurntable"),Object.defineProperty(o,"__esModule",{value:!0}),o.TurntableInfo=void 0;var n=t("./ProxyVIP"),r=t("./ProxyTask"),i=t("./ProxyLottery"),a=t("./ProxyLargeNum"),s=t("./ProxyHero"),l=t("../Manager/WinMgr"),m=t("../Manager/UserMgr"),u=t("../Manager/TimeMgr"),p=t("../Manager/RedPointMgr"),c=t("../Manager/DataMgr"),d=t("../Manager/BCMgr"),f=t("../Common/EnumsDefine"),h=t("../Common/Common"),y=function(){function t(){this.mCycleDays=7,this.mAccCounterTime=0,this.mWeightArr=[],this.mMaxRate=.05,this.mMinScore=30,this.mOnceLuckyScore=1,this.mTotalLuckySocre=100,this.mBaseFreeTimes=1,this.mBaseADTimes=3,this.mADForCoinNum=1,this.mAccRewardsInfoArr=[]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){for(var t=c.default.Ins.m_DB.paramDB.TURANTABLE_ACC_REWARDS.value.split("|"),e=0,o=t.length;e<o;++e)this.mAccRewardsInfoArr.push(h.default.Split2NumArr(t[e],","));for(e=1;e<=8;++e)this.mWeightArr.push(c.default.Ins.m_DB.turntableDB[e].rate)},t.prototype.HandleOfflineTime=function(){},t.prototype.HandleTime=function(){var t=m.default.Ins.ClientInfo.turntableInfo,e=m.default.Ins.ClientInfo.turntableInfo.startTime,o=u.default.GetServerTime(),n=new Date(e),r=n.getFullYear(),i=n.getMonth(),a=n.getDate(),s=new Date(r,i,a,0,0,0,0),l=.001*(new Date(o).valueOf()-s.valueOf()),p=Math.max(0,Math.floor(l/86400));p>=this.mCycleDays?(t.accTimesCycle=0,t.startTime=u.default.GetServerTime(),t.hasGotBoxCount=0,this.mAccCounterTime=86400*(this.mCycleDays-1)+u.default.mTodayLeftTime,m.default.Ins.Save()):this.mAccCounterTime=86400*(this.mCycleDays-1-p)+u.default.mTodayLeftTime},t.prototype.RefreshOnNewDay=function(t){var e=m.default.Ins.ClientInfo.turntableInfo;e.leftFreeTimes=this.GetFreeTimes(),e.leftADTimes=this.GetADTimes(),t||(this.mAccCounterTime<=60&&(e.accTimesCycle=0,e.startTime=u.default.GetServerTime(),e.hasGotBoxCount=0,this.mAccCounterTime=86400*(this.mCycleDays-1)+u.default.mTodayLeftTime,m.default.Ins.Save()),this.CheckRedPoint())},t.prototype.OnUpdate=function(){this.mAccCounterTime--,this.mAccCounterTime<0&&(this.mAccCounterTime=0),d.default.Dispatch(f.BCType.Turntadble_AccLeftTime,this.mAccCounterTime)},t.prototype.GetFreeTimes=function(){return this.mBaseFreeTimes+n.default.Ins.GetAttrValue(n.VIPAttrType.FreeTurntable)},t.prototype.GetADTimes=function(){return this.mBaseADTimes},t.prototype.GetADForCoinNum=function(){return this.mADForCoinNum+n.default.Ins.GetAttrValue(n.VIPAttrType.ADTurntableCoin)},t.prototype.GetRandSector=function(){var t=m.default.Ins.ClientInfo.turntableInfo.luckyScore;if(t>=this.mTotalLuckySocre)return 1;if(t>=this.mMinScore){var e=this.mMaxRate*t/this.mTotalLuckySocre;if(Math.random()<=e)return 1}return h.default.GetRandIdxByWeight(this.mWeightArr,1)[0]+1},t.prototype.AfterTurntable=function(){var t=m.default.Ins.ClientInfo.turntableInfo;t.leftFreeTimes>0?t.leftFreeTimes--:m.default.Ins.UpdateItem(f.ItemType.TurnCoin,-1),t.luckyScore+=this.mOnceLuckyScore,t.luckyScore>this.mTotalLuckySocre&&(t.luckyScore=this.mTotalLuckySocre),t.accTimes++,t.accTimesCycle++,this.CheckRedPoint()},t.prototype.GetRewards=function(t){var e=c.default.Ins.m_DB.turntableDB[t];if(1===t){m.default.Ins.ClientInfo.turntableInfo.luckyScore=0;var o=i.default.Ins.LotteryByQuality(f.HeroQuality.SSR);1===s.default.Ins.GetHero([o])[0]?l.default.Ins.Open(f.WinType.NewHeroShowWin,function(t){t.SetData(o)}):l.default.Ins.Open(f.WinType.RepeatHeroWin,function(t){t.SetData(o)})}else{var n=e.reward[0],u=e.reward[1],p=u;n===f.ItemType.Medal&&(u=m.default.Ins.GetMedalNum(u),p=a.default.FormatNumber(u,1)),m.default.Ins.UpdateItem(n,u),l.default.Ins.Open(f.WinType.GetRewardsWin,function(t){t.SetDataSingle(n,p)})}m.default.Ins.Save(),r.default.Ins.UpdateTaskProgress(r.DailyTaskType.Turntable,1)},t.prototype.GetNextAccTarget=function(){var t=m.default.Ins.ClientInfo.turntableInfo;return t.hasGotBoxCount>=this.mAccRewardsInfoArr.length?this.mAccRewardsInfoArr[this.mAccRewardsInfoArr.length-1][0]:this.mAccRewardsInfoArr[t.hasGotBoxCount][0]},t.prototype.GetAccBoxRewards=function(){var e=m.default.Ins.ClientInfo.turntableInfo,o=t.Ins.mAccRewardsInfoArr.length;if(e.hasGotBoxCount<o){for(var n=e.accTimesCycle,r=[],i=e.hasGotBoxCount;i<o;++i)n>=t.Ins.mAccRewardsInfoArr[i][0]&&(m.default.Ins.UpdateItem(t.Ins.mAccRewardsInfoArr[i][1],t.Ins.mAccRewardsInfoArr[i][2]),r.push([t.Ins.mAccRewardsInfoArr[i][1],t.Ins.mAccRewardsInfoArr[i][2]]),e.hasGotBoxCount++);l.default.Ins.Open(f.WinType.GetRewardsWin,function(t){t.SetData(r)})}m.default.Ins.Save(),this._CheckBoxRewards()},t.prototype.CheckRedPoint=function(){this._CheckFreeTimes(),this._CheckBoxRewards()},t.prototype._CheckFreeTimes=function(){m.default.Ins.ClientInfo.turntableInfo.leftFreeTimes>0||m.default.Ins.GetItemNum(f.ItemType.TurnCoin)>0?p.default.SetInvokeData(p.RedPointType.Act_Turntable_Free,1):p.default.SetInvokeData(p.RedPointType.Act_Turntable_Free,0)},t.prototype._CheckBoxRewards=function(){var e=m.default.Ins.ClientInfo.turntableInfo,o=t.Ins.mAccRewardsInfoArr.length;e.hasGotBoxCount<o&&e.accTimesCycle>=t.Ins.mAccRewardsInfoArr[e.hasGotBoxCount][0]?p.default.SetInvokeData(p.RedPointType.Act_Turntable_Box,1):p.default.SetInvokeData(p.RedPointType.Act_Turntable_Box,0)},t.mIns=null,t}();o.default=y;o.TurntableInfo=function(){this.leftFreeTimes=1,this.leftADTimes=3,this.accTimes=0,this.accTimesCycle=0,this.startTime=0,this.hasGotBoxCount=0,this.luckyScore=0,this.startTime=u.default.GetServerTime()},cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyHero":"ProxyHero","./ProxyLargeNum":"ProxyLargeNum","./ProxyLottery":"ProxyLottery","./ProxyTask":"ProxyTask","./ProxyVIP":"ProxyVIP"}],ProxyVIP:[function(t,e,o){"use strict";cc._RF.push(e,"444ecaY6GVC4bWLYLeg40Mr","ProxyVIP"),Object.defineProperty(o,"__esModule",{value:!0}),o.VIPSaveInfo=o.VIPExpFromType=o.VIPAttrType=void 0;var n,r,i=t("./ProxySkin"),a=t("./ProxyOffline"),s=t("./ProxyLottery"),l=t("./ProxyImmortal"),m=t("./ProxyHero"),u=t("./ProxyForge"),p=t("../Manager/WinMgr"),c=t("../Manager/UserMgr"),d=t("../Manager/PlatformMgr"),f=t("../Manager/FuncMgr"),h=t("../Manager/DataMgr"),y=t("../Manager/BCMgr"),g=t("../Common/EnumsDefine");(function(t){t[t.None=0]="None",t[t.FreeTurntable=1]="FreeTurntable",t[t.ADTurntableCoin=2]="ADTurntableCoin",t[t.ImtBossChallenge=3]="ImtBossChallenge",t[t.MedalAdd=4]="MedalAdd",t[t.PassLevelSpeed=5]="PassLevelSpeed",t[t.WorkInitLv=6]="WorkInitLv",t[t.LotteryScore=7]="LotteryScore",t[t.Smith2=8]="Smith2",t[t.Smith4=9]="Smith4"})(n=o.VIPAttrType||(o.VIPAttrType={})),function(t){t[t.None=0]="None",t[t.AD=1]="AD",t[t.DailyTask=2]="DailyTask",t[t.Gift=3]="Gift"}(r=o.VIPExpFromType||(o.VIPExpFromType={}));var I=function(){function t(){this.mVIPReawardLvArr=[2,3,5,8],this.mVIPRewards=[101,40009,400101,101301],this.mVIPGiftRewards=[[16,300],[2,100],[5,1]],this.mOnceADExp=3,this.MAX_LV=8,this.mAttrMap=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.ConvertToAttr=function(){var t=c.default.Ins.ClientInfo.vip.lv;if(0!==t){this.mAttrMap=new Map;for(var e=h.default.Ins.m_DB.vipDB[t].privilege,o=0,n=e.length;o<n;++o)this.mAttrMap.set(e[o][0],e[o][1])}},t.prototype.GetAttrDesc=function(t){switch(t){case n.FreeTurntable:return"-\u6bcf\u65e5\u514d\u8d39\u8f6c\u76d8\u6b21\u6570\uff1a";case n.ADTurntableCoin:return"-\u5e7f\u544a\u5151\u6362\u8f6c\u76d8\u5e01\u6570\u91cf\uff1a";case n.ImtBossChallenge:return"-\u9ec4\u5929\u79d8\u5883\u6311\u6218\u6b21\u6570\u4e0a\u9650\uff1a";case n.MedalAdd:return"-\u56de\u57ce\u8363\u8a89\u52cb\u7ae0\u6570\u91cf\u52a0\u6210\uff1a";case n.PassLevelSpeed:return"-\u79bb\u7ebf\u901a\u5173\u901f\u5ea6\u52a0\u6210\uff1a";case n.WorkInitLv:return"-\u6253\u5de5\u70b9\u521d\u59cb\u7b49\u7ea7\u52a0\u6210\uff1a";case n.LotteryScore:return"-\u5f00\u542f\u76f2\u76d2\u79ef\u5206\u5151\u6362\u795e\u5c06\u529f\u80fd\u3002";case n.Smith2:return"-\u5f00\u542f\u7b2c2\u4e2a\u94c1\u5320\u4f4d\u3002";case n.Smith4:return"-\u5f00\u542f\u7b2c4\u4e2a\u94c1\u5320\u4f4d\u3002"}},t.prototype.GetValueStr=function(t,e){switch(t){case n.FreeTurntable:case n.ADTurntableCoin:case n.ImtBossChallenge:return"+"+e;case n.MedalAdd:case n.PassLevelSpeed:return"+"+e+"%";case n.WorkInitLv:return"+"+e;case n.LotteryScore:case n.Smith2:case n.Smith4:return""}},t.prototype.GetAttrValue=function(t){return null===this.mAttrMap?0:this.mAttrMap.get(t)||0},t.prototype._GetVipLvByExp=function(t){var e=h.default.Ins.m_DB.vipDB,o=null;for(var n in e)if(e.hasOwnProperty(n)&&t<(o=e[n]).exp)return o.lv;return this.MAX_LV},t.prototype.OnGetVipExp=function(t,e){var o=c.default.Ins.ClientInfo.vip;switch(o.exp+=t,e){case r.AD:o.adExp+=t;break;case r.DailyTask:o.dailyExp+=t;break;case r.Gift:o.giftExp+=t}if(o.lv!==this.MAX_LV){var n=this._GetVipLvByExp(o.exp);o.lv!==n&&(o.lv=n,d.default.ReportEvent(g.BIPoint.VIP_Level,{lv:o.lv}),this.ConvertToAttr(),p.default.Ins.Open(g.WinType.VIPUpgradeWin,null),a.default.Ins.UpdateOfflineLevelSpeed(),u.default.Ins.CheckUnlock(),y.default.Dispatch(g.BCType.VIP_OnUpgraded))}c.default.Ins.Save()},t.prototype.CheckHasGotVIPReward=function(t){for(var e=c.default.Ins.ClientInfo.vip.hasGotIdxArr,o=0,n=e.length;o<n;++o)if(e[o]===t)return!0;return!1},t.prototype.GetVIPReward=function(t){c.default.Ins.ClientInfo.vip.hasGotIdxArr.push(t),c.default.Ins.Save();var e=this.mVIPRewards[t],o=h.default.Ins.m_DB.itemDB[e];if(o.itemType===g.ItemType.Immortal){var n=l.default.Ins.GetImt(e);p.default.Ins.Open(g.WinType.GetImtWin,function(t){t.SetData(e,n,!1)})}else if(o.itemType===g.ItemType.HeroSkin){var r=i.default.Ins.GetSkin(e);p.default.Ins.Open(g.WinType.GetSkinWin,function(t){t.SetData(e,r)})}else if(o.itemType===g.ItemType.RandomHero){var a=s.default.Ins.LotteryByQuality(g.HeroQuality.SSR);1===m.default.Ins.GetHero([a])[0]?p.default.Ins.Open(g.WinType.NewHeroShowWin,function(t){t.SetData(a)}):p.default.Ins.Open(g.WinType.RepeatHeroWin,function(t){t.SetData(a)})}y.default.Dispatch(g.BCType.VIP_GetReward)},t.prototype.NeedShowBtn=function(){return!!f.default.IsUnlock(f.FuncType.VIP)},t.prototype.GetVIPGift=function(){c.default.Ins.ClientInfo.vip.vipGiftState=1,y.default.Dispatch(g.BCType.VIP_BuyGift),c.default.Ins.Save()},t.mIns=null,t}();o.default=I;o.VIPSaveInfo=function(){this.lv=0,this.exp=0,this.adExp=0,this.dailyExp=0,this.giftExp=0,this.hasGotIdxArr=[],this.vipGiftState=0},cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/FuncMgr":"FuncMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","./ProxyForge":"ProxyForge","./ProxyHero":"ProxyHero","./ProxyImmortal":"ProxyImmortal","./ProxyLottery":"ProxyLottery","./ProxyOffline":"ProxyOffline","./ProxySkin":"ProxySkin"}],ProxyWork:[function(t,e,o){"use strict";cc._RF.push(e,"779832ReshJ5KNxOBTjZozY","ProxyWork"),Object.defineProperty(o,"__esModule",{value:!0}),o.WorkItemSaveInfo=o.WorkInfo=o.WorkRunningInfo=o.WorkItemRunningInfo=void 0;var n=t("./ProxyVIP"),r=t("./ProxyOffline"),i=t("./ProxyMainTask2"),a=t("./ProxyLargeNum"),s=t("./ProxyImmortal"),l=t("./ProxyBackCity"),m=t("../Manager/UserMgr"),u=t("../Manager/TimeMgr"),p=t("../Manager/SaveMgr"),c=t("../Manager/RedPointMgr"),d=t("../Manager/DataMgr"),f=t("../Manager/BCMgr"),h=t("../Common/EnumsDefine"),y=t("../Common/Common"),g=function(){function t(){this.mRevenueCoinInSeconds=new a.LargeNumber(1,0),this.mOfflineLimitHours=1,this.mOfflineRevenueFactor=.03,this.mWorkInfo=null,this.mWorkRunningInfo=null,this.mSaveFlag=!1,this.mRefreshInterval=.034,this.mTiming=0}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.InitParamData=function(){var t=d.default.Ins.m_DB.paramDB;this.mOfflineLimitHours=Number(t.WORK_OFFLINE_TIME_LIMIT.value),this.mOfflineRevenueFactor=Number(t.WORK_OFFLINE_REVENUE_FACTOR.value)},t.prototype.CreateDefaultWorkInfo=function(){var t=new _;t.mWorkMap=new m.SelfObjMap(null),this.mWorkInfo=t,this._ConvertToRunningInfo()},t.prototype.SyncWorkInfo=function(){var t=p.default.Get(p.default.WORK_INFO);this.mWorkInfo=new _,this.mWorkInfo=JSON.parse(t),this._HandleSelfMap(),this._ConvertToRunningInfo()},t.prototype._HandleSelfMap=function(){this.mWorkInfo.mWorkMap=new m.SelfObjMap(this.mWorkInfo.mWorkMap.obj)},t.prototype._ConvertToRunningInfo=function(){this.mWorkRunningInfo=new S,this.mWorkRunningInfo.mWorkRunningMap=new Map;for(var e=null,o=1;o<=t.MAX_WORK_ID;++o){e=d.default.Ins.m_DB.workDB[o];var n=new I;n.id=o,this.mWorkRunningInfo.mWorkRunningMap.set(o,n);var r=this.GetWorkSI(o);n.mSI=r,n.curCost=this.GetCostGold(e),n.curCost10=this.GetCostGold(e,10),n.curCost100=this.GetCostGold(e,100),n.curRev=this.GetRevenueGold(o),n.totalTime=this.GetWorkItemTimeByData(e),n.autoLv=e.autoLv,n.goldState=0,n.leftTime=n.totalTime,this._UpdateRevenueCoinInSeconds()}},t.prototype.HandleOfflineTime=function(e,o){for(var n=!1,i=null,a=null,s=1;s<=t.MAX_WORK_ID;++s)if(null!==(a=(i=this.GetWorkItemRunningInfo(s)).mSI)&&0!==a.lv){n=!0;var l=this.GetWorkItemTime(s),m=e-a.startTime;if(!a.isAuto){var u=l-m;u<=0&&(i.goldState=1),i.leftTime=y.default.Clamp(u,0,l)}}if(n&&o>=10){var p=o,c=3600*this.mOfflineLimitHours*this._GetOfflineCoinTimeAdd();o>=c&&(p=c);var d=p*this.mOfflineRevenueFactor*2,f=this.mRevenueCoinInSeconds.MultiplySingle(d);r.default.Ins.mOfflineTime=o,r.default.Ins.mNeedOpenCoinWin=!0,r.default.Ins.mOfflineCoinNum=f}},t.prototype._GetOfflineCoinTimeAdd=function(){return 1+.01*s.default.Ins.GetAttrValue(h.ImtAttrType.CoinOfflineTimeLimitAdd)},t.prototype.OnUpdate=function(){this.mSaveFlag&&(this._RealSave(),this.mSaveFlag=!1)},t.prototype._RealSave=function(){var t=JSON.stringify(this.mWorkInfo);p.default.Save(p.default.WORK_INFO,t)},t.prototype.Save=function(t){void 0===t&&(t=!1),t?this._RealSave():this.mSaveFlag=!0},t.prototype.UpdateForWorking=function(t){var e=this;this.mTiming-=t,this.mTiming<=0&&(this.mTiming=this.mRefreshInterval,this.mWorkRunningInfo.mWorkRunningMap.forEach(function(t){null!==t.mSI&&0!==t.mSI.lv&&1!==t.goldState&&(t.leftTime-=e.mRefreshInterval,t.leftTime<=0&&(t.mSI.isAuto?e.GetGoldAuto(t):(t.goldState=1,c.default.SetInvokeData(c.RedPointType.Work,1))))}),f.default.Dispatch(h.BCType.WorkWin_UpdateTimeState))},t.prototype.GetWorkItemRunningInfo=function(t){return this.mWorkRunningInfo.mWorkRunningMap.get(t)},t.prototype.GetWorkSI=function(t){return this.mWorkInfo.mWorkMap.Get(t)},t.prototype.GetWorkItemTime=function(t){var e=d.default.Ins.m_DB.workDB[t];return this.GetWorkItemTimeByData(e)},t.prototype._GetWorkTimeRate=function(){var t=.01*s.default.Ins.GetAttrValue(h.ImtAttrType.WorkTimeReduce);return 1-t/(t+1)},t.prototype.GetWorkItemTimeByData=function(t){var e=this._GetWorkTimeRate();return Math.max(1,Math.round(t.time*e))},t.prototype._GetWorkUpgradeCostRate=function(){var t=.01*s.default.Ins.GetAttrValue(h.ImtAttrType.WorkUpgradeReduce);return 1-t/(t+1)},t.prototype.GetCostGold=function(e,o){void 0===o&&(o=1);var n=this.GetWorkSI(e.Id);if(1===o){if(null===n||0===n.lv){var r=1;return r*=this._GetWorkUpgradeCostRate(),(i=new a.LargeNumber(e.baseCost,e.expCost)).MultiplySelfSingle(r),i}r=1===e.Id?1:.5,r*=this._GetWorkUpgradeCostRate();var i=new a.LargeNumber(e.baseCost,e.expCost),s=a.default.Pow(t.LV_GOLD_COST_FACTOR,n.lv);return i.MultiplySelf(s).MultiplySelfSingle(r),i}if(null===n||0===n.lv)return null;r=.5,r*=this._GetWorkUpgradeCostRate(),i=new a.LargeNumber(e.baseCost,e.expCost);var l=a.default.Pow(t.LV_GOLD_COST_FACTOR,n.lv);return l.MultiplySelf(i).MultiplySelfSingle(r),10===o?a.default.RateSum(l,t.LV_GOLD_COST_FACTOR,o):100===o?a.default.RateSum(l,t.LV_GOLD_COST_FACTOR,o):void 0},t.prototype._GetWorkRevenueAdd=function(){return.01*l.default.Ins.mBackRunningInfo.curWorkAddRevenue+.01*s.default.Ins.GetAttrValue(h.ImtAttrType.WorkRevenueAdd)},t.prototype.GetRevenueGold=function(t){var e=this.GetWorkSI(t),o=null===e?0:e.lv,n=d.default.Ins.m_DB.workDB[t],r=null===e?1:e.multiple,i=new a.LargeNumber(n.baseGet,n.expGet),s=i.MultiplySingle(.1);return s.mBaseValue<1&&0===s.mExpoValue&&(s.mBaseValue=1),s.MultiplySelfSingle(o*r),i.AddSelf(s),i.MultiplySelfSingle(1+this._GetWorkRevenueAdd()),i},t.prototype.UpdateWorkRevenue=function(){var t=this;this.mWorkRunningInfo.mWorkRunningMap.forEach(function(e,o){e.curRev=t.GetRevenueGold(o)}),this._UpdateRevenueCoinInSeconds()},t.prototype.UpdateWorkTime=function(){var t=this;this.mWorkRunningInfo.mWorkRunningMap.forEach(function(e,o){e.totalTime=t.GetWorkItemTime(o),e.leftTime*=t._GetWorkTimeRate()}),this._UpdateRevenueCoinInSeconds()},t.prototype.UpdateWorkCost=function(){var t=this;this.mWorkRunningInfo.mWorkRunningMap.forEach(function(e,o){var n=d.default.Ins.m_DB.workDB[o];e.curCost=t.GetCostGold(n),e.curCost10=t.GetCostGold(n,10),e.curCost100=t.GetCostGold(n,100)})},t.prototype.UnlockWork=function(e){var o=this.GetWorkSI(e),n=this.GetWorkItemRunningInfo(e);null===o&&(o=new v,this.mWorkInfo.mWorkMap.Set(e,o),n.mSI=o),o.lv=1,o.toGetRewardLv=t.REWARD_LV,o.startTime=u.default.GetServerTimeInSeconds();var r=d.default.Ins.m_DB.workDB[e];n.curCost=this.GetCostGold(r),n.curCost10=this.GetCostGold(r,10),n.curCost100=this.GetCostGold(r,100),n.curRev=this.GetRevenueGold(e),this._UpdateRevenueCoinInSeconds(),this.Save(),i.default.Ins.CheckUnlockWork()},t.prototype.UpgradeLv=function(t,e){var o=this.GetWorkSI(t),n=this.GetWorkItemRunningInfo(t);o.lv+=e;var r=d.default.Ins.m_DB.workDB[t];n.curCost=this.GetCostGold(r),n.curCost10=this.GetCostGold(r,10),n.curCost100=this.GetCostGold(r,100),n.curRev=this.GetRevenueGold(t),this._UpdateRevenueCoinInSeconds(),this.Save(),i.default.Ins.CheckUpgradeWork()},t.prototype.GetDoubleReward=function(e){var o=this.GetWorkItemRunningInfo(e),n=o.mSI,r=n.toGetRewardLv,a=this._GetAddMultiple(r);n.multiple*=a,n.toGetRewardLv+=t.REWARD_LV,o.curRev=this.GetRevenueGold(e),this._UpdateRevenueCoinInSeconds(),this.Save(),i.default.Ins.CheckDoubleWork()},t.prototype.GetAutoReward=function(e){var o=this.GetWorkItemRunningInfo(e);o.mSI.isAuto=!0,1===o.goldState&&(m.default.Ins.AddCoin(o.curRev),o.leftTime=o.totalTime,o.goldState=0,o.mSI.startTime=u.default.GetServerTimeInSeconds(),this.CheckRedPointNum()),o.mSI.toGetRewardLv+=t.REWARD_LV,this.Save(),i.default.Ins.CheckAutoWork()},t.prototype.GetGoldManual=function(t){var e=this.GetWorkItemRunningInfo(t);e.leftTime=e.totalTime,e.goldState=0,e.mSI.startTime=u.default.GetServerTimeInSeconds(),this.Save(),this.CheckRedPointNum()},t.prototype.GetGoldAuto=function(t){m.default.Ins.AddCoin(t.curRev),t.leftTime=t.totalTime,t.mSI.startTime=u.default.GetServerTimeInSeconds(),this.Save()},t.prototype._GetTotalWorkAddLv=function(){return l.default.Ins.mBackRunningInfo.curWorkAddLv+s.default.Ins.GetAttrValue(h.ImtAttrType.WorkInitLevelAdd)+n.default.Ins.GetAttrValue(n.VIPAttrType.WorkInitLv)},t.prototype.BackCity=function(){for(var e=this._GetTotalWorkAddLv(),o=u.default.GetServerTimeInSeconds(),n=1;n<=t.MAX_WORK_ID;++n){var r=this.GetWorkItemRunningInfo(n);if(this._ResetRunningInfo(r),e>0){var i=r.autoLv;e>=i?this.AutoAddLvWhenBackCity(r,i,o):this.AutoAddLvWhenBackCity(r,e,o),e-=i}}this._UpdateRevenueCoinInSeconds(),this.Save(),m.default.Ins.AddCoin(this.mRevenueCoinInSeconds.MultiplySingle(60))},t.prototype.AutoAddLvWhenBackCity=function(e,o,n){var r=null;null===e.mSI&&(e.mSI=new v,this.mWorkInfo.mWorkMap.Set(e.id,e.mSI)),(r=e.mSI).lv=o,r.startTime=n,r.lv>=e.autoLv&&(r.isAuto=!0);var i=Math.floor(o/t.REWARD_LV);r.toGetRewardLv=(i+1)*t.REWARD_LV;for(var a=t.REWARD_LV;o>=a;)a!==e.autoLv&&(r.multiple*=this._GetAddMultiple(a)),a+=t.REWARD_LV;var s=d.default.Ins.m_DB.workDB[e.id];e.curCost=this.GetCostGold(s),e.curCost10=this.GetCostGold(s,10),e.curCost100=this.GetCostGold(s,100),e.curRev=this.GetRevenueGold(e.id)},t.prototype._GetAddMultiple=function(t){return t%500==0?10:t%100==0?5:2},t.prototype._ResetRunningInfo=function(e){var o=e.mSI;if(null!==o&&o.lv>0){o.isAuto=!1,o.lv=0,o.multiple=1,o.startTime=0,o.toGetRewardLv=t.REWARD_LV;var n=d.default.Ins.m_DB.workDB[e.id];e.curCost=this.GetCostGold(n),e.curCost10=this.GetCostGold(n,10),e.curCost100=this.GetCostGold(n,100),e.curRev=this.GetRevenueGold(e.id),e.leftTime=e.totalTime,e.goldState=0}},t.prototype._UpdateRevenueCoinInSeconds=function(){var t=new a.LargeNumber(0,0);this.mWorkRunningInfo.mWorkRunningMap.forEach(function(e){null!==e.mSI&&e.mSI.lv>0&&t.AddSelf(e.curRev.DivideSingle(e.totalTime))}),this.mRevenueCoinInSeconds=t,0===this.mRevenueCoinInSeconds.mExpoValue&&this.mRevenueCoinInSeconds.mBaseValue<1&&(this.mRevenueCoinInSeconds.mBaseValue=1),f.default.Dispatch(h.BCType.WorkWin_UpdateRevenue)},t.prototype.CheckRedPointNum=function(){for(var e=0,o=1;o<=t.MAX_WORK_ID;++o)if(1===this.GetWorkItemRunningInfo(o).goldState){e=1;break}c.default.SetInvokeData(c.RedPointType.Work,e)},t.mIns=null,t.MAX_WORK_ID=30,t.REWARD_LV=25,t.LV_GOLD_COST_FACTOR=1.08,t.mExchangeCoinCostGoldNum=200,t}();o.default=g;var I=function(){this.id=1,this.curCost=null,this.curCost10=null,this.curCost100=null,this.curRev=null,this.totalTime=0,this.leftTime=0,this.autoLv=50,this.goldState=0,this.mSI=null};o.WorkItemRunningInfo=I;var S=function(){this.mWorkRunningMap=null};o.WorkRunningInfo=S;var _=function(){this.mWorkMap=null};o.WorkInfo=_;var v=function(){this.lv=0,this.multiple=1,this.isAuto=!1,this.startTime=0,this.toGetRewardLv=0};o.WorkItemSaveInfo=v,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Manager/BCMgr":"BCMgr","../Manager/DataMgr":"DataMgr","../Manager/RedPointMgr":"RedPointMgr","../Manager/SaveMgr":"SaveMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","./ProxyBackCity":"ProxyBackCity","./ProxyImmortal":"ProxyImmortal","./ProxyLargeNum":"ProxyLargeNum","./ProxyMainTask2":"ProxyMainTask2","./ProxyOffline":"ProxyOffline","./ProxyVIP":"ProxyVIP"}],QualitySuccessWin:[function(t,e,o){"use strict";cc._RF.push(e,"02602ScJ79ChYmxfRTJDG4j","QualitySuccessWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/AudioMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySFArr=[],e.mLhsQualitySp=null,e.mRhsQualitySp=null,e.mPreAtkLbl=null,e.mCurAtkLbl=null,e.mPreDefLbl=null,e.mCurDefLbl=null,e.mPreHpLbl=null,e.mCurHpLbl=null,e.mTitleSk=null,e.mEnableClose=!1,e}return r(e,t),e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mEnableClose=!1,this.scheduleOnce(function(){e.mEnableClose=!0},.5),l.default.PlaySFX(m.AudioName.UI_GetRewards,!0),this.mTitleSk.setAnimation(0,"juexingchenggong",!1)},e.prototype._OnEvent_ClickMask=function(){this.mEnableClose&&this.CloseWin()},e.prototype.SetData=function(t,e,o,n){var r=s.default.Ins.GetHeroSI(t).heroQuality;this.mLhsQualitySp.spriteFrame=this.mQualitySFArr[r-1],this.mRhsQualitySp.spriteFrame=this.mQualitySFArr[r];var i=s.default.Ins.GetHeroAtk(t),a=s.default.Ins.GetHeroDef(t),l=s.default.Ins.GetHeroHP(t);this.mCurAtkLbl.string=i.ToString(),this.mCurDefLbl.string=a.ToString(),this.mCurHpLbl.string=l.ToString(),s.default.Ins.mQualityFactorArr[r-1],this.mPreAtkLbl.string=e,this.mPreDefLbl.string=o,this.mPreHpLbl.string=n},e.prototype.Invoke_Close=function(){l.default.PlayBtnSound(),this._OnEvent_ClickMask()},i([c([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([c(cc.Sprite)],e.prototype,"mLhsQualitySp",void 0),i([c(cc.Sprite)],e.prototype,"mRhsQualitySp",void 0),i([c(cc.Label)],e.prototype,"mPreAtkLbl",void 0),i([c(cc.Label)],e.prototype,"mCurAtkLbl",void 0),i([c(cc.Label)],e.prototype,"mPreDefLbl",void 0),i([c(cc.Label)],e.prototype,"mCurDefLbl",void 0),i([c(cc.Label)],e.prototype,"mPreHpLbl",void 0),i([c(cc.Label)],e.prototype,"mCurHpLbl",void 0),i([c(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([p],e)}(a.default);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Proxy/ProxyHero":"ProxyHero","./WinBase":"WinBase"}],QuickSelectHeroIcon:[function(t,e,o){"use strict";cc._RF.push(e,"c11a9p6G9ZPALj9S0Ugl+M9","QuickSelectHeroIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyHero"),s=t("../../Manager/ResMgr"),l=t("../../Manager/BCMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mQualitySp2=null,e.mIcon=null,e.mStarSp=null,e.mMedalLvLbl=null,e.mHeroID=0,e.mHeroSI=null,e}return r(e,t),e.prototype.SetData=function(t){this.mHeroID!==t&&(this.mHeroID=t,this.mHeroSI=a.default.Ins.GetHeroSI(t)),s.default.Ins.LoadHeroSkinItemSprite(t,this.mIcon),s.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mQualitySp,null),s.default.Ins.LoadHeroStarSprite(this.mHeroSI.starLv,this.mStarSp),this.UpdateMedalLv(),this.mQualitySp2.opacity=this.mHeroSI.heroQuality===u.HeroQuality.SP?255:0},e.prototype.UpdateMedalLv=function(){0===this.mHeroSI.medalLv?this.mMedalLvLbl.string="":this.mMedalLvLbl.string="+"+this.mHeroSI.medalLv},e.prototype.UpdateStarLv=function(){s.default.Ins.LoadHeroStarSprite(this.mHeroSI.starLv,this.mStarSp)},e.prototype.UpdateQuality=function(){s.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mQualitySp,null),this.mQualitySp2.opacity=this.mHeroSI.heroQuality===u.HeroQuality.SP?255:0},e.prototype.UpdateOnChangeSkin=function(){s.default.Ins.LoadHeroSkinItemSprite(this.mHeroID,this.mIcon)},e.prototype.Invoke_ClickIcon=function(){m.default.PlayBtnSound(),l.default.Dispatch(u.BCType.HeroDetailWin_ClickQuickIcon,this.mHeroID)},i([d(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([d(cc.Node)],e.prototype,"mQualitySp2",void 0),i([d(cc.Sprite)],e.prototype,"mIcon",void 0),i([d(cc.Sprite)],e.prototype,"mStarSp",void 0),i([d(cc.Label)],e.prototype,"mMedalLvLbl",void 0),i([c],e)}(cc.Component);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero"}],QuickSelectPanel:[function(t,e,o){"use strict";cc._RF.push(e,"90613ky3hhPqajTDtU5Clbf","QuickSelectPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./QuickSelectHeroIcon"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/BCMgr"),m=t("../../Common/EnumsDefine"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mContentNode=null,e.mTemplate=null,e.mItemArr=[],e.mOriPosX=70,e.mPosY=-45,e.mCellWidth=120,e}return r(e,t),e.prototype.OnFirstOpen=function(){this.mItemArr.push(this.mTemplate)},e.prototype.OnOpen=function(){for(var t=0,e=s.default.Ins.mHeroInfo.heroTeam,o=0,n=e.length;o<n;++o){var r=e[o];if(this.mItemArr.length<=o){var i=cc.instantiate(this.mTemplate.node);i.parent=this.mContentNode,i.y=this.mPosY,this.mItemArr.push(i.getComponent(a.default))}0===r?this.mItemArr[o].node.active=!1:(t++,this.mItemArr[o].node.active=!0,this.mItemArr[o].SetData(r),this.mItemArr[o].node.x=this.mOriPosX+o*this.mCellWidth)}this.mContentNode.width=this.mCellWidth*t+20},e.prototype.Subscribe=function(){l.default.Subscribe(m.BCType.OnUpgradeHeroMedalLv,this._OnMsg_OnUpgradeMedalLv,this),l.default.Subscribe(m.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),l.default.Subscribe(m.BCType.OnUpgradeHeroQuality,this._OnMsg_UpgradeQuality,this),l.default.Subscribe(m.BCType.Skin_Equip,this._OnMsg_EquipSkin,this)},e.prototype.Remove=function(){l.default.Remove(m.BCType.OnUpgradeHeroMedalLv,this._OnMsg_OnUpgradeMedalLv,this),l.default.Remove(m.BCType.OnUpgradeHeroStarLv,this._OnMsg_OnUpgradeStarLv,this),l.default.Remove(m.BCType.OnUpgradeHeroQuality,this._OnMsg_UpgradeQuality,this),l.default.Remove(m.BCType.Skin_Equip,this._OnMsg_EquipSkin,this)},e.prototype._OnMsg_OnUpgradeMedalLv=function(t){for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].mHeroID===t&&this.mItemArr[e].UpdateMedalLv()},e.prototype._OnMsg_OnUpgradeStarLv=function(t){for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].mHeroID===t&&this.mItemArr[e].UpdateStarLv()},e.prototype._OnMsg_UpgradeQuality=function(t){for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].mHeroID===t&&this.mItemArr[e].UpdateQuality()},e.prototype._OnMsg_EquipSkin=function(t){for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].mHeroID===t&&this.mItemArr[e].UpdateOnChangeSkin()},i([c(cc.Node)],e.prototype,"mContentNode",void 0),i([c(a.default)],e.prototype,"mTemplate",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxyHero":"ProxyHero","./QuickSelectHeroIcon":"QuickSelectHeroIcon"}],RecycleMedalWin:[function(t,e,o){"use strict";cc._RF.push(e,"b7792a02DlM9bUu54bj0CAi","RecycleMedalWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLargeNum"),l=t("../../Proxy/ProxyHero"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEmptyRoot=null,e.mPayRoot=null,e.mMedalNumLbl=null,e.mPriceNumLbl=null,e.mRecycleNum=0,e.mPayGoldNum=0,e.mCurHeroID=0,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),c.default.PlaySFX(d.AudioName.UI_TanKuang,!0)},e.prototype.SetData=function(t){this.mCurHeroID=t;var e=l.default.Ins.GetHeroSI(t);0===e.medalLv?(this.mEmptyRoot.active=!0,this.mPayRoot.active=!1):(this.mEmptyRoot.active=!1,this.mPayRoot.active=!0,this.mRecycleNum=l.default.Ins.GetTotalCostMedalByLv(e.medalLv),this.mMedalNumLbl.string=s.default.FormatNumber(this.mRecycleNum,1),this.mPayGoldNum=l.default.Ins.GetGoldForRecycleMedal(e.medalLv),this.mPriceNumLbl.string=""+this.mPayGoldNum)},e.prototype.Invoke_AdBtn=function(){c.default.PlayBtnSound(),f.default.WatchADForRewards(this._ADCallback.bind(this),m.ADUnitID.CommonVideoID_15,d.ADPoint.RecycleMedal)},e.prototype._ADCallback=function(t){if(l.default.Ins.PutHeroOffTeam(this.mCurHeroID),0!==this.mRecycleNum){p.default.Ins.UpdateItem(d.ItemType.Medal,this.mRecycleNum),t&&p.default.Ins.GetADExtraRewards();var e=this;u.default.Ins.Open(d.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(d.ItemType.Medal,s.default.FormatNumber(e.mRecycleNum,1)):n.SetDataSingle(d.ItemType.Medal,s.default.FormatNumber(e.mRecycleNum,1))})}this.CloseWin()},e.prototype.Invoke_GoldBtn=function(){c.default.PlayBtnSound(),p.default.Ins.GetItemNum(d.ItemType.Gold)<this.mPayGoldNum?console.log("\u5143\u5b9d\u6570\u91cf\u4e0d\u8db3"):(p.default.Ins.UpdateItem(d.ItemType.Gold,-this.mPayGoldNum),l.default.Ins.PutHeroOffTeam(this.mCurHeroID),0!==this.mRecycleNum&&p.default.Ins.UpdateItem(d.ItemType.Medal,this.mRecycleNum),this.CloseWin())},e.prototype.Invoke_OkBtn=function(){c.default.PlayBtnSound(),l.default.Ins.PutHeroOffTeam(this.mCurHeroID),this.CloseWin()},e.prototype.Invoke_Close=function(){c.default.PlayBtnSound(),this.CloseWin()},i([g(cc.Node)],e.prototype,"mEmptyRoot",void 0),i([g(cc.Node)],e.prototype,"mPayRoot",void 0),i([g(cc.Label)],e.prototype,"mMedalNumLbl",void 0),i([g(cc.Label)],e.prototype,"mPriceNumLbl",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLargeNum":"ProxyLargeNum","./WinBase":"WinBase"}],RedPointMgr:[function(t,e,o){"use strict";cc._RF.push(e,"14e8bE8xWRPG7/OPPMIMfTC","RedPointMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.RedPointType=void 0;var n,r=t("./RedPoint"),i=t("../Proxy/ProxyWork"),a=t("../Proxy/ProxySpeed"),s=t("../Proxy/ProxyShop"),l=t("../Proxy/ProxySevenDays"),m=t("../Proxy/ProxyOffice"),u=t("../Proxy/ProxyLevelReward"),p=t("../Proxy/ProxyHeroMap"),c=t("../Proxy/ProxyHero"),d=t("../Proxy/ProxyForge"),f=t("../Proxy/ProxyExplore"),h=t("../Proxy/ProxyCrystal"),y=t("../Proxy/ProxyAct");(function(t){t.Main="Main",t.MainSpeed="Main.Speed",t.MainMultiple="Main.Multiple",t.MainBack="Main.Back",t.MainBackRewards="Main.Back.Rewards",t.MainLotteryBox="Main.Box",t.MainLotteryBox_Crystal="Main.Box.Crystal",t.MainLotteryBox_Ticket="Main.Box.Ticket",t.Main_More="Main.More",t.Main_Map="Main.Map",t.Hero="Main.Hero",t.Work="Main.Work",t.Imt="Main.Imt",t.Imt_Picture="Main.Imt2.Picture",t.Imt_Smith="Main.Imt.Forge.Smith",t.Challenge="Main.Challenge",t.ExploreItem="Main.Challenge.Explore.Item",t.Shop="Main.Shop",t.Act="Main.Act",t.Act_FreeGold="Main.Act.FreeGold",t.Act_Sign="Main.Act.Sign",t.Act_Turntable_Box="Main.Act.Turntable.Box",t.Act_Turntable_Free="Main.Act.Turntable.Free",t.Act_AllSP_Hero_R="Main.Act.AllSP.Hero.R",t.Act_AllSP_Hero_SR="Main.Act.AllSP.Hero.SR",t.Act_AllSP_Hero_SSR="Main.Act.AllSP.Hero.SSR",t.Act_AllSP_Hero_Score="Main.Act.AllSP.Hero.Score",t.Act_AllSP_Imt_Imt="Main.Act.AllSP.Imt.Imt",t.Act_AllSP_Imt_Smith="Main.Act.AllSP.Imt.Smith",t.Act_AllSP_Imt_Score="Main.Act.AllSP.Imt.Score",t.SevenDay="Main.More.SevenDay",t.Office="Main.More.Office",t.Office_Daily="Main.More.Office.Daily",t.Office_Upgrade="Main.More.Office.Upgrade",t.DailyTask_Item="Main.DailyTask.Item",t.DailyTask_Score="Main.DailyTask.Score",t.Shop_ADCoin_FreeItem="Main.Shop.AD.Free"})(n=o.RedPointType||(o.RedPointType={}));var g=function(){function t(){}return t.Init=function(){for(var t in this.mInited=!0,n)this.mRedPointTreeArr.push(n[t]);for(var e=1;e<=4;++e)this.mRedPointTreeArr.push(n.Imt_Smith+e);for(var o=c.default.Ins.mAllHeroIDArr,r=(e=0,o.length);e<r;++e)this.mRedPointTreeArr.push("Main.Hero.Pack."+o[e]+".Star"),this.mRedPointTreeArr.push("Main.Hero.Pack."+o[e]+".Awake"),this.mRedPointTreeArr.push("Main.Hero."+o[e]+".Medal");this.mRedPointTreeArr.push(n.ExploreItem+"1"),this.mRedPointTreeArr.push(n.ExploreItem+"2"),this._InitRedPointTree(),l.default.Ins.CheckRedPoint(),m.default.Ins.CheckCanUpgrade(),m.default.Ins.CheckDailyRewards(),s.default.Ins.CheckShopRedNum(),i.default.Ins.CheckRedPointNum(),u.default.Ins.CheckRedPointNum(),d.default.Ins.CheckPictureRedPointNum(),y.default.Ins.CheckRedPoint(),d.default.Ins.CheckRedPoint(),h.default.Ins.CheckRedPointNum(),h.default.Ins.CheckCrystalLottery(),h.default.Ins.CheckTicketLottery(),a.default.Ins.CheckRedPointNum(),c.default.Ins.CheckHeroRedPoint(),p.default.Ins.CheckRedPointNum(),f.default.Ins.CheckRedPointNum()},t._InitRedPointTree=function(){this.mRootNode=new r.default,this.mRootNode.mNodeName=n.Main;for(var t=0,e=this.mRedPointTreeArr.length;t<e;++t){var o=this.mRootNode,i=this.mRedPointTreeArr[t],a=i.split(".");if(a[0]==this.mRootNode.mNodeName){var s=a[0];if(a.length>1)for(var l=1,m=a.length;l<m;++l){var u=a[l],p=o.mChildNodeMap.get(u);s=s+"."+u,p||(p=new r.default,o.mChildNodeMap.set(u,p),p.mNodeFullName=s,p.mNodeName=u),p.mParentNode=o,o=p}}else console.error("\u6839\u8282\u70b9\u8bbe\u7f6e\u9519\u8bef\uff1a"+i)}},t.SetInvokeData=function(t,e){var o=t.split(".");if(1!==o.length)for(var n=this.mRootNode,r=1,i=o.length;r<i;++r){if(null===n||null===n.mChildNodeMap)return;var a=o[r];if(!n.mChildNodeMap.has(a))return void console.error("\u8282\u70b9\u6811\u4e2d\u4e0d\u5305\u542b\u8be5\u5b50\u8282\u70b9\uff1a"+a);if(void 0===(n=n.mChildNodeMap.get(a)))return void console.error("\u7a7a\u8282\u70b9, \u540d\u5b57\u4e3a\uff1a"+a);r===o.length-1&&n.SetRedPointNum(e)}else console.error("\u89e6\u53d1\u9519\u8bef\uff1a"+t)},t.GetRedPointNode=function(t){var e=t.split("."),o=this.mRootNode;if(1===e.length)return o;for(var n=1,r=e.length;n<r;++n){if(!o)return console.error("\u67e5\u627e\u8282\u70b9\u4e3a\u7a7a========="+t),null;o=o.mChildNodeMap.get(e[n])}return o},t.mInited=!1,t.mRootNode=null,t.mRedPointTreeArr=[],t}();o.default=g,cc._RF.pop()},{"../Proxy/ProxyAct":"ProxyAct","../Proxy/ProxyCrystal":"ProxyCrystal","../Proxy/ProxyExplore":"ProxyExplore","../Proxy/ProxyForge":"ProxyForge","../Proxy/ProxyHero":"ProxyHero","../Proxy/ProxyHeroMap":"ProxyHeroMap","../Proxy/ProxyLevelReward":"ProxyLevelReward","../Proxy/ProxyOffice":"ProxyOffice","../Proxy/ProxySevenDays":"ProxySevenDays","../Proxy/ProxyShop":"ProxyShop","../Proxy/ProxySpeed":"ProxySpeed","../Proxy/ProxyWork":"ProxyWork","./RedPoint":"RedPoint"}],RedPointNormal:[function(t,e,o){"use strict";cc._RF.push(e,"a0d27S0ykhEWYEPoYrgPj3p","RedPointNormal");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/RedPointMgr"),s=t("../../Manager/BCMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mPointType="",e.mRedPoint=null,e.onEnable=function(){this.mPointType&&(s.default.Subscribe(this.mPointType,this._OnMsg_UpdateRedPoint,this),a.default.mInited&&this._OnMsg_UpdateRedPoint(a.default.GetRedPointNode(this.mPointType)))},e}return r(e,t),e.prototype.onDisable=function(){this.mPointType&&s.default.Remove(this.mPointType,this._OnMsg_UpdateRedPoint,this)},e.prototype.UpdatePointName=function(t){this.mPointType&&s.default.Remove(this.mPointType,this._OnMsg_UpdateRedPoint,this),this.mPointType=t,this._OnMsg_UpdateRedPoint(a.default.GetRedPointNode(this.mPointType)),s.default.Subscribe(t,this._OnMsg_UpdateRedPoint,this)},e.prototype._OnMsg_UpdateRedPoint=function(t){this.mRedPoint?this.mRedPoint.active=!!t&&0!==t.mPointNum:console.error("\u7ea2\u70b9\u4e3a\u7a7a: "+this.mPointType)},i([u(cc.String)],e.prototype,"mPointType",void 0),i([u(cc.Node)],e.prototype,"mRedPoint",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/BCMgr":"BCMgr","../../Manager/RedPointMgr":"RedPointMgr"}],RedPoint:[function(t,e,o){"use strict";cc._RF.push(e,"1db50yazJNL9Ll0JZlTI0Zj","RedPoint"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./BCMgr"),r=function(){function t(){this.mNodeName="",this.mNodeFullName="",this.mPointNum=0,this.mParentNode=null,this.mNumChangeFunc=null,this.mChildNodeMap=new Map}return t.prototype.SetRedPointNum=function(t){this.mChildNodeMap.size>0?console.error("\u53ea\u80fd\u8bbe\u7f6e\u53f6\u5b50\u8282\u70b9"):(this.mPointNum=t,this.NotifyPointNumChange(),null!==this.mParentNode&&this.mParentNode.ChangeParentRPNum())},t.prototype.NotifyPointNumChange=function(){n.default.Dispatch(this.mNodeFullName,this)},t.prototype.ChangeParentRPNum=function(){var t=0;this.mChildNodeMap.forEach(function(e){t+=e.mPointNum}),t!==this.mPointNum&&(this.mPointNum=t,this.NotifyPointNumChange()),null!==this.mParentNode&&this.mParentNode.ChangeParentRPNum()},t}();o.default=r,cc._RF.pop()},{"./BCMgr":"BCMgr"}],RefreshShopHeroWin:[function(t,e,o){"use strict";cc._RF.push(e,"b36d0dkDWVIbpR2VK7YYStr","RefreshShopHeroWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyShop"),l=t("../../Platform/PlatformBase"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=t("../../Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mContentLbl=null,e.mLeftTimesLbl=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mContentLbl.string="\u514d\u8d39\u5237\u65b0\u6b66\u5c06\u788e\u7247\u5e76\u91cd\u7f6e\u4ef7\u683c"},e.prototype.SetData=function(){this.mLeftTimesLbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+s.default.Ins.mShopInfo.heroLeftRefreshTimes},e.prototype.Invoke_OK=function(){p.default.PlayBtnSound(),s.default.Ins.mShopInfo.heroLeftRefreshTimes<=0?m.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u4eca\u5929\u514d\u8d39\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u660e\u5929\u518d\u6765\u5427~"):d.default.WatchADForRewards(this._ADCallback.bind(this),l.ADUnitID.CommonVideoID_30,c.ADPoint.ManualRefreshHeroFrag)},e.prototype._ADCallback=function(t){t&&(u.default.Ins.GetADExtraRewards(),m.default.Ins.Open(c.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"")})),s.default.Ins.RefreshHeroFragmentManual(),this.CloseWin()},e.prototype.Invoke_Cancel=function(){p.default.PlayBtnSound(),this.CloseWin()},i([y(cc.Label)],e.prototype,"mContentLbl",void 0),i([y(cc.Label)],e.prototype,"mLeftTimesLbl",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyShop":"ProxyShop","./WinBase":"WinBase"}],RepeatHeroWin:[function(t,e,o){"use strict";cc._RF.push(e,"a972bQAeo5Lb5Cd1IjVgU0A","RepeatHeroWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLottery"),l=t("../../Proxy/ProxyHero"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBgEfx=null,e.mHeroRoot=null,e.mHeroSk=null,e.mQualitySp=null,e.mHintNode=null,e.mFragmentLbl=null,e.mNameLbl=null,e.mRepeatHeroRoot=null,e.mCurFragNumLbl=null,e.mPb=null,e.mStarInfoRoot=null,e.mSkillIcon=null,e.mSkillNameLbl=null,e.mSkillDescLbl=null,e.mStarUnlockLbl=null,e.mQualitySFArr=[],e.mDoubleBtnRoot=null,e.mUpAnim=null,e.mBottomAnim=null,e.mHeroID=0,e.mQualityArr=["r","sr","ssr"],e.mCurQuality=y.HeroQuality.R,e.mTargetFragNum=0,e.mLastFragNum=0,e.mCurFragNum=0,e.mRepeatTween=null,e.mStarCount=!1,e.mCountingTime=1,e.mTiming=0,e}return r(e,t),e.prototype.SetData=function(t){var e=this;this.mHeroID=t,this.mDoubleBtnRoot.active=!1,this.mHeroRoot.opacity=0,this.mRepeatHeroRoot.opacity=0,this.mBgEfx.node.opacity=0,this.mPb.node.active=!1,this.mStarCount=!1;var o=d.default.Ins.m_DB.heroCardDB[t],n=this,r=l.default.Ins.GetHeroSI(t),i=s.default.Ins.mFragmentNumArr[o.baseQuality];if(this.mTargetFragNum=l.default.Ins.GetNeedFragment(o.baseQuality,r.heroQuality,r.starLv),this.mCurFragNum=p.default.Ins.GetItemNum(t),this.mLastFragNum=this.mCurFragNum-i,null!==this.mHeroSk){this.mHeroSk.node.scale=o.scale,this.mHeroSk.skeletonData=null;var a=d.default.Ins.m_DB.entityDB[t];c.default.Ins.LoadSpine("spine/hero/"+a.model,function(t){n.mHeroSk&&(n.mHeroSk.skeletonData=t,n.mHeroSk.setAnimation(0,"daiji",!0))})}var m=o.baseQuality;this.mQualitySp.spriteFrame=this.mQualitySFArr[m],this.mCurQuality=m,this.mNameLbl.string=o.name,this.mHintNode.opacity=255,this.mFragmentLbl.string="x"+i,null===this.mBgEfx.skeletonData&&c.default.Ins.LoadSpine("spine/beijngguang",function(t){n.mBgEfx.skeletonData=t,n.mBgEfx.setAnimation(0,e.mQualityArr[m],!0)}),cc.tween(this.mHeroRoot).to(.2,{opacity:255}).start(),this.mBgEfx.node.opacity=255,this.mBgEfx.setAnimation(0,this.mQualityArr[m],!0),this._RepeatHeroAnim()},e.prototype._RepeatHeroAnim=function(){var t=this;null!==this.mRepeatTween&&this.mRepeatTween.stop();var e=this;this._SetStarInfo(),this.mRepeatTween=cc.tween(this.mRepeatHeroRoot).delay(.5).to(.3,{opacity:255}).call(function(){e.mPb.node.active=!0,e.mDoubleBtnRoot.active=!0,e.mUpAnim.node.scale=0,e.mBottomAnim.node.scale=0,t.scheduleOnce(function(){e.mUpAnim.play("btnAppear",0)},1.2),t.scheduleOnce(function(){e.mBottomAnim.play("btnAppear",0)},1.7),e.mTiming=0,e.mStarCount=!0,e._ShowStarInfo()}).start()},e.prototype._SetStarInfo=function(){var t=l.default.Ins.GetHeroSI(this.mHeroID);if(t.starLv<l.default.MAX_STAR_LV){var e=t.starLv+1,o=l.default.Ins.GetHeroSkillData(this.mHeroID,e);c.default.Ins.LoadHeroSkillSp(this.mHeroID,e,this.mSkillIcon),o&&(this.mSkillNameLbl.string=o.name,this.mSkillDescLbl.string=o.desc),this.mStarUnlockLbl.string="\uff08"+e+"\u661f\u89e3\u9501\uff09"}else this.mStarInfoRoot.opacity=0},e.prototype._ShowStarInfo=function(){l.default.Ins.GetHeroSI(this.mHeroID).starLv<l.default.MAX_STAR_LV&&(this.mStarInfoRoot.opacity=255)},e.prototype.update=function(t){if(this.mStarCount)if(this.mTiming+=t,this.mTiming>=this.mCountingTime)this.mStarCount=!1,this.mPb.progress=this.mCurFragNum/this.mTargetFragNum,this.mCurFragNumLbl.string=this.mCurFragNum+"/"+this.mTargetFragNum;else{var e=Math.floor(this.mLastFragNum+this.mTiming/this.mCountingTime*(this.mCurFragNum-this.mLastFragNum));this.mPb.progress=e/this.mTargetFragNum,this.mCurFragNumLbl.string=e+"/"+this.mTargetFragNum}},e.prototype.Invoke_GetFragment=function(){h.default.PlayBtnSound();var t=this.mHeroID,e=d.default.Ins.m_DB.heroCardDB[t],o=s.default.Ins.mFragmentNumArr[e.baseQuality];u.default.Ins.Open(y.WinType.GetRewardsWin,function(e){e.SetDataSingle(t,o+"")}),this.Back()},e.prototype.Invoke_DoubleFragment=function(){h.default.PlayBtnSound(),g.default.WatchADForRewards(this._FragADCallback.bind(this),m.ADUnitID.CommonVideo,y.ADPoint.ExploreDouble)},e.prototype._FragADCallback=function(t){t&&p.default.Ins.GetADExtraRewards();var e=this.mHeroID,o=d.default.Ins.m_DB.heroCardDB[e],n=s.default.Ins.mFragmentNumArr[o.baseQuality];p.default.Ins.UpdateItem(e,n),f.default.Dispatch(y.BCType.UpdateHeroFragment,e),u.default.Ins.Open(y.WinType.GetRewardsWin,function(o){var r=o;t?r.SetDataWithADCoin(e,2*n+""):r.SetDataSingle(e,2*n+"")}),p.default.Ins.Save(),l.default.Ins.CheckHeroStarAwake(e),this.Back()},e.prototype.Back=function(){this.CloseWin()},i([_(sp.Skeleton)],e.prototype,"mBgEfx",void 0),i([_(cc.Node)],e.prototype,"mHeroRoot",void 0),i([_(sp.Skeleton)],e.prototype,"mHeroSk",void 0),i([_(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([_(cc.Node)],e.prototype,"mHintNode",void 0),i([_(cc.Label)],e.prototype,"mFragmentLbl",void 0),i([_(cc.Label)],e.prototype,"mNameLbl",void 0),i([_(cc.Node)],e.prototype,"mRepeatHeroRoot",void 0),i([_(cc.Label)],e.prototype,"mCurFragNumLbl",void 0),i([_(cc.ProgressBar)],e.prototype,"mPb",void 0),i([_(cc.Node)],e.prototype,"mStarInfoRoot",void 0),i([_(cc.Sprite)],e.prototype,"mSkillIcon",void 0),i([_(cc.Label)],e.prototype,"mSkillNameLbl",void 0),i([_(cc.Label)],e.prototype,"mSkillDescLbl",void 0),i([_(cc.Label)],e.prototype,"mStarUnlockLbl",void 0),i([_([cc.SpriteFrame])],e.prototype,"mQualitySFArr",void 0),i([_(cc.Node)],e.prototype,"mDoubleBtnRoot",void 0),i([_(cc.Animation)],e.prototype,"mUpAnim",void 0),i([_(cc.Animation)],e.prototype,"mBottomAnim",void 0),i([S],e)}(a.default);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery","./WinBase":"WinBase"}],ResMgr:[function(t,e,o){"use strict";cc._RF.push(e,"cfc74zDOzRDwrxKau4NbAx8","ResMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./DataMgr"),r=t("../Proxy/ProxySkin"),i=t("../Common/EnumsDefine"),a=function(){function t(){this.mHeroQualitySFArr=["pinzhi_n","pinzhi_r","pinzhi_sr","pinzhi_ssr","pinzhi_sp"],this.mCampSFArr=["wei","shu","wu","qun"]}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.LoadPrefab=function(e,o,n,r){void 0===r&&(r=0),cc.resources.load(e,cc.Prefab,function(i,a){!i&&a?o&&o(a):++r<3?t.Ins.LoadPrefab(e,o,n,r):(console.error("\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25: "+e),n&&n())})},t.prototype.LoadSpriteFrame=function(t,e,o,n){var r="atlas/"+t;cc.loader.loadRes(r,cc.SpriteAtlas,function(t,r){if(!t&&r){var i=r.getSpriteFrame(e);i&&o&&o.isValid&&(o.spriteFrame=i,n&&n(o.spriteFrame))}else console.log("%c%s","color: green","\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25",",err:"+t)})},t.prototype.LoadItemSprite=function(t,e,o){var r=n.default.Ins.m_DB.itemDB[t];if(r){var a=r.atlas,s=r.icon;r.itemType===i.ItemType.HeroFragment&&(a="AutoAtlas/Heros/"+a),this.LoadSpriteFrame(a,s,e,o)}else console.log("\u4e0d\u5b58\u5728ItemID\u4e3a"+t+"\u7684\u9053\u5177\u914d\u7f6e")},t.prototype.LoadHeroSkinItemSprite=function(t,e,o){var n=r.default.Ins.GetHeroCurSkinData(t),i=t;n.fromType!==r.SkinFromType.Default&&(i=n.id),this.LoadItemSprite(i,e,o)},t.prototype.LoadTexture=function(e,o,n,r){void 0===r&&(r=0),cc.loader.loadRes(e,cc.SpriteFrame,function(i,a){!i&&a?o&&o(a):++r<3?t.Ins.LoadTexture(e,o,n,r):(console.error("texture\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25: "+e),n&&n())})},t.prototype.LoadItemQualitySprite=function(t,e,o){var n=this.mHeroQualitySFArr[t+1];this.LoadSpriteFrame("Items",n,e,o)},t.prototype.LoadHeroQualitySprite=function(t,e,o){var n=this.mHeroQualitySFArr[t+1];this.LoadSpriteFrame("AutoAtlas/Heros/Heros",n,e,o)},t.prototype.LoadHeroStarSprite=function(t,e,o){this.LoadSpriteFrame("AutoAtlas/Heros/Heros","x"+t,e,o)},t.prototype.LoadHeroSkillSp=function(t,e,o,r){var i=n.default.Ins.m_DB.entityDB[t].model+"_"+e;this.LoadSpriteFrame("Skills",i,o,r)},t.prototype.LoadImtSkillSp=function(t,e,o){var r=n.default.Ins.m_DB.immortalDB[t];this.LoadSpriteFrame("ImmortalSkills",r.skill,e,o)},t.prototype.LoadCampSprite=function(t,e,o){var n=this.mCampSFArr[t];this.LoadSpriteFrame("AutoAtlas/Heros/Heros",n,e,o)},t.prototype.LoadSpine=function(e,o,n,r){void 0===r&&(r=0),cc.loader.loadRes(e,sp.SkeletonData,function(i,a){!i&&a?o&&o(a):++r<3?t.Ins.LoadSpine(e,o,n,r):(console.error("spine\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25: "+e),n&&n())})},t.prototype.LoadAudioClip=function(t,e,o){cc.loader.loadRes(t,cc.AudioClip,function(n,r){!n&&r?e&&e(r):(console.error("\u8d44\u6e90\u52a0\u8f7d\u5931\u8d25: "+t),o&&o(n))})},t.prototype.LoadGetTypeSp=function(t,e,o){var n="shipin";t===i.GetRewardsType.Share&&(n="fenxiang"),this.LoadSpriteFrame("CommonUI",n,e,o)},t.mIns=null,t}();o.default=a,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Proxy/ProxySkin":"ProxySkin","./DataMgr":"DataMgr"}],RewardPreviewWin:[function(t,e,o){"use strict";cc._RF.push(e,"2e81eMHVmhBYqmWKX/O+xsV","RewardPreviewWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyVIP"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/AudioMgr"),c=t("../../MainGame"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBtnNode=null,e.mBtnSp=null,e.mHasGotNode=null,e.mTitleLbl=null,e.mItemRoot=null,e.mItemTemplate=null,e.mNeedItemCount=0,e.mItemsArr=[],e.mCellWidth=120,e.mCellHeight=150,e.mCanGet=!1,e.mHasGot=!1,e.mItemArr=null,e.mGetCallback=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mItemsArr.push(this.mItemTemplate)},e.prototype.SetData=function(t,e,o,n,r){void 0===e&&(e="\u5956\u52b1\u9884\u89c8"),void 0===r&&(r=null),this.mItemArr=t,this.mHasGot=o,this.mCanGet=n,this.mGetCallback=r,o?(this.mBtnNode.active=!1,this.mHasGotNode.opacity=255):(this.mBtnNode.active=!0,this.mHasGotNode.opacity=0,this.mCanGet?this.mBtnSp.setMaterial(0,c.default.mDefaultMat):this.mBtnSp.setMaterial(0,c.default.mGrayMat)),this.mTitleLbl.string=e,this._SetRewards(t)},e.prototype._SetRewards=function(t){this.mNeedItemCount=t.length;var e=this.mItemsArr.length;if(this.mNeedItemCount>e)for(var o=this.mNeedItemCount-e,n=0;n<o;++n){var r=cc.instantiate(this.mItemTemplate.node);r.setParent(this.mItemRoot),this.mItemsArr.push(r.getComponent(s.default))}for(var i=-(Math.min(this.mNeedItemCount,4)-1)*this.mCellWidth*.5,a=Math.floor((this.mNeedItemCount-1)/4)*this.mCellHeight*.5,l=(n=0,this.mItemsArr.length);n<l;++n)if(n<this.mNeedItemCount){var m=u.default.Ins.GetConfigItemNum(t[n][0],t[n][1]);this.mItemsArr[n].SetData(t[n][0],m+"");var p=n%4*this.mCellWidth+i,c=-Math.floor(n/4)*this.mCellHeight+a;this.mItemsArr[n].node.setPosition(p,c),this.mItemsArr[n].node.active=!0}else this.mItemsArr[n].node.active=!1},e.prototype.Invoke_GetRewards=function(){if(p.default.PlayBtnSound(),!this.mHasGot&&this.mCanGet){for(var t=[],e=0,o=this.mItemArr.length;e<o;++e){var n=u.default.Ins.GetConfigItemNum(this.mItemArr[e][0],this.mItemArr[e][1]);u.default.Ins.UpdateItem(this.mItemArr[e][0],n,l.VIPExpFromType.DailyTask),t.push([this.mItemArr[e][0],n])}m.default.Ins.Open(d.WinType.GetRewardsWin,function(e){e.SetData(t)}),null!==this.mGetCallback&&(this.mGetCallback(),this.mGetCallback=null),u.default.Ins.Save(),this.CloseWin()}},e.prototype.Invoke_Close=function(){p.default.PlayBtnSound(),this.CloseWin()},i([y(cc.Node)],e.prototype,"mBtnNode",void 0),i([y(cc.Sprite)],e.prototype,"mBtnSp",void 0),i([y(cc.Node)],e.prototype,"mHasGotNode",void 0),i([y(cc.Label)],e.prototype,"mTitleLbl",void 0),i([y(cc.Node)],e.prototype,"mItemRoot",void 0),i([y(s.default)],e.prototype,"mItemTemplate",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyVIP":"ProxyVIP","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],SaveMgr:[function(t,e,o){"use strict";cc._RF.push(e,"155e7aN9AFDQI5kpC1L+Zfe","SaveMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=function(){function t(){}return t.Save=function(t,e){cc.sys.localStorage.setItem(t,e)},t.Remove=function(t){cc.sys.localStorage.removeItem(t)},t.Get=function(t){return cc.sys.localStorage.getItem(t)},t.ClearInfo=function(){this.Remove(this.GAMER_INFO),this.Remove(this.LOCAL_OFFLINE_TIME),this.Remove(this.HERO_INFO),this.Remove(this.WORK_INFO),this.Remove(this.BACK_INFO),this.Remove(this.IMMORTAL_INFO),this.Remove(this.FORGE_INFO),this.Remove(this.GAME_SPEED_INFO),this.Remove(this.CRYSTAL_MUL_INFO)},t.PRIVACY_FLAG="PRIVACY",t.SOUND_SWITCH="SOUND_SWITCH",t.MUSIC_SWITCH="MUSIC_SWITCH",t.LOCAL_OFFLINE_TIME="Local_Offline_Time",t.GAMER_INFO="Gamer_Info",t.HERO_INFO="Hero_Info",t.WORK_INFO="Work_Info",t.BACK_INFO="Back_Info",t.IMMORTAL_INFO="Immortal_Info",t.FORGE_INFO="Forge_Info",t.GOLD="Gold",t.DAILY_INFO="Daily_Info",t.SHOP_INFO="SHOP_INFO",t.OFFICE_INFO="OFFICE_INFO",t.MAIN_TASK="MAIN_TASK",t.CRYSTAL_INFO="CRYSTAL_INFO",t.MAP_INFO="MAP_INFO",t.EXPLORE_INFO="EXPLORE_INFO",t.GAME_SPEED_INFO="GAME_SPEED_INFO",t.CRYSTAL_MUL_INFO="CRYSTAL_MUL_INFO",t}();o.default=n,cc._RF.pop()},{}],SecondDayWin:[function(t,e,o){"use strict";cc._RF.push(e,"a09866oqsxJg7xmCzkb/EKB","SecondDayWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyLottery"),l=t("../../Proxy/ProxyHero"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/PlatformMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mBtnLbl=null,e.mHeroSk=null,e.mHeroID=1002,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),p.default.Ins.ClientInfo.hasOpenedSecondDayWin||(p.default.Ins.ClientInfo.hasOpenedSecondDayWin=!0,p.default.Ins.Save())},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),p.default.Ins.ClientInfo.gameDay>1&&(this.mBtnLbl.string="\u9886\u53d6"),this.mHeroSk.setAnimation(0,"beidong",!1),this.mHeroSk.addAnimation(0,"zoulu",!0)},e.prototype.Invoke_Get=function(){if(f.default.PlayBtnSound(),p.default.Ins.ClientInfo.gameDay<=1)u.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u660e\u5929\u514d\u8d39\u9886\u53d6\u795e\u5c06\u5173\u7fbd~~\u8bb0\u5f97\u8981\u6765\u54e6\uff01");else if(p.default.Ins.ClientInfo.hasGotSecondDayGift)u.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u5df2\u7ecf\u9886\u53d6\u8fc7\u7684\uff0c\u4e0d\u80fd\u91cd\u590d\u9818\u53d6\u54e6~");else{var t=this;p.default.Ins.ClientInfo.hasGotSecondDayGift=!0,s.default.Ins.InitOnSecondDayGift(),l.default.Ins.GetHero([this.mHeroID]),u.default.Ins.Open(h.WinType.NewHeroShowWin,function(e){e.SetData(t.mHeroID)}),this.CloseWin(),p.default.Ins.Save(),d.default.Dispatch(h.BCType.MainWin_GetSecondDayGift),c.default.ReportEvent(h.BIPoint.GetSecondDayGift),c.default.mCurPlf.ShowInterstitial(m.ADUnitID.Interstitial_Func_ID,h.InsPoint.SecondDayGift)}},e.prototype.Invoke_Close=function(){this.CloseWin()},i([I(cc.Label)],e.prototype,"mBtnLbl",void 0),i([I(sp.Skeleton)],e.prototype,"mHeroSk",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyLottery":"ProxyLottery","./WinBase":"WinBase"}],ServiceWin:[function(t,e,o){"use strict";cc._RF.push(e,"ffe14y72olCLZu21I0SW+TV","ServiceWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/WinMgr"),l=t("../../Manager/PlatformMgr"),m=cc._decorator,u=m.ccclass,p=(m.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype.Invoke_AddGroup=function(){l.default.mCurPlf.AddQQGroup()?s.default.Ins.ShowTips("\u4e3b\u516c\u8bf7\u8010\u5fc3\u7b49\u5f85\uff0c\u6b63\u5728\u6253\u5f00\u9875\u9762\u54e6~"):s.default.Ins.ShowTips("\u4e3b\u516c~\u5982\u679c\u65e0\u6cd5\u4e00\u952e\u6dfb\u52a0\uff0c\u4e5f\u53ef\u4ee5\u624b\u52a8\u6dfb\u52a0\u54e6~")},i([u],e)}(a.default));o.default=p,cc._RF.pop()},{"../../Manager/PlatformMgr":"PlatformMgr","../../Manager/WinMgr":"WinMgr","./WinBase":"WinBase"}],SetWin:[function(t,e,o){"use strict";cc._RF.push(e,"bc346PWaoFNo7CjLie5kuM8","SetWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleToggle"),l=t("../../Manager/AudioMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_SoundToggle=null,e.m_MusicToggle=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.m_SoundToggle.SetState(l.default.m_SFXSwitch),this.m_MusicToggle.SetState(l.default.m_MusicSwitch),this.m_SoundToggle.node.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickSoundToggle.bind(this),this),this.m_MusicToggle.node.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMusicToggle.bind(this),this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype._OnEvent_ClickSoundToggle=function(){l.default.SetSFXEnable(!l.default.m_SFXSwitch),this.m_SoundToggle.SetState(l.default.m_SFXSwitch),l.default.PlayBtnSound()},e.prototype._OnEvent_ClickMusicToggle=function(){l.default.SetMusicEnable(!l.default.m_MusicSwitch),this.m_MusicToggle.SetState(l.default.m_MusicSwitch),l.default.PlayBtnSound()},i([p(s.default)],e.prototype,"m_SoundToggle",void 0),i([p(s.default)],e.prototype,"m_MusicToggle",void 0),i([u],e)}(a.default);o.default=c,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../Comp/SimpleToggle":"SimpleToggle","./WinBase":"WinBase"}],SevenDayItem:[function(t,e,o){"use strict";cc._RF.push(e,"154b5DpEExAZopFalDcJGQp","SevenDayItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySevenDays"),s=t("../../Platform/PlatformBase"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Common/EnumsDefine"),d=t("../../Common/Common"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mDayLbl=null,e.mItemSp=null,e.mFrameSp=null,e.mNumLbl=null,e.mMaskNode=null,e.mOnceMoreNode=null,e.mCheckMarkNode=null,e.mNameLbl=null,e.mCurDay=1,e.mData=null,e.mManager=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mData=p.default.Ins.m_DB.sevenDaysDB[t],this.mManager=e,this.mDayLbl.string="\u7b2c"+t+"\u5929",this.mCurDay=t;var o=this.mData.rewards,n=a.default.Ins.GetDayState(t);if(1===this.mData.special){this.mItemSp.node.y=6,this.mItemSp.node.scale=.55;var r=p.default.Ins.m_DB.itemDB[o[0]],i=p.default.Ins.m_DB.heroCardDB[o[0]],s=this;this.mNumLbl.string=i.name,u.default.Ins.LoadTexture("texture/hero/"+r.icon,function(t){null!==s.mItemSp&&(s.mItemSp.spriteFrame=t)},null)}else 2===this.mData.special||(u.default.Ins.LoadItemSprite(o[0],this.mItemSp,null),this.mNumLbl.string="+"+o[1],r=p.default.Ins.m_DB.itemDB[o[0]],this.mNameLbl.string=r.name);this._UpdateDayState(n)},e.prototype.UpdateDayState=function(){var t=a.default.Ins.GetDayState(this.mCurDay);this._UpdateDayState(t)},e.prototype._UpdateDayState=function(t){0===t?(this.mMaskNode.opacity=0,this.mOnceMoreNode.opacity=0,this.mCheckMarkNode.opacity=0):1===t?(this.mMaskNode.opacity=255,this.mOnceMoreNode.opacity=255,this.mCheckMarkNode.opacity=0):(this.mMaskNode.opacity=255,this.mOnceMoreNode.opacity=0,this.mCheckMarkNode.opacity=255),2!==this.mData.special&&(this.mCurDay===m.default.Ins.ClientInfo.sevenDays.mCurDay?this.mFrameSp.spriteFrame=this.mManager.mBGSFArr[1]:this.mFrameSp.spriteFrame=this.mManager.mBGSFArr[0])},e.prototype.Invove_Click=function(){var t=this;if(m.default.Ins.ClientInfo.sevenDays.mCurDay<this.mCurDay)2===this.mData.special?l.default.Ins.Open(c.WinType.SkinPreviewWin,function(e){e.SetData(t.mData.rewards[0])}):1===this.mData.special&&l.default.Ins.Open(c.WinType.HeroDetailWin,function(e){e.SetData(t.mData.rewards[0],c.WinType.SevenDaysWin)});else{var e=a.default.Ins.GetDayState(this.mCurDay);if(0===e)a.default.Ins.GetRewards(this.mCurDay),this.UpdateDayState(),this.mManager.UpdateDayState();else if(1===e){var o=this;d.default.WatchADForRewards(function(e){a.default.Ins.GetRewards(t.mCurDay,1,e),t.UpdateDayState(),o.mManager.UpdateDayState()},s.ADUnitID.CommonVideoID_15,c.ADPoint.SevenDayOnceMore)}}},i([y(cc.Label)],e.prototype,"mDayLbl",void 0),i([y(cc.Sprite)],e.prototype,"mItemSp",void 0),i([y(cc.Sprite)],e.prototype,"mFrameSp",void 0),i([y(cc.Label)],e.prototype,"mNumLbl",void 0),i([y(cc.Node)],e.prototype,"mMaskNode",void 0),i([y(cc.Node)],e.prototype,"mOnceMoreNode",void 0),i([y(cc.Node)],e.prototype,"mCheckMarkNode",void 0),i([y(cc.Label)],e.prototype,"mNameLbl",void 0),i([h],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxySevenDays":"ProxySevenDays"}],SevenDaysWin:[function(t,e,o){"use strict";cc._RF.push(e,"05dfa92ZilLwZ6FLXUefoxs","SevenDaysWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SevenDayItem"),l=t("../../Proxy/ProxySevenDays"),m=t("../../Manager/UserMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNormalItem=null,e.mSpecialItem=null,e.mGetRewardsBtnNode=null,e.mGetRewardsLbl=null,e.mBGSFArr=[],e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mItemRoot=null,e.mCellWidth=195,e.mCellHeight=190,e.mCurDay=1,e.mData=null,e.mCloseCallback=null,e.mItemArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mItemRoot=this.mNormalItem.node.parent;var e=this.mNormalItem.node.position;this.mCurDay=m.default.Ins.ClientInfo.sevenDays.mCurDay;for(var o=1;o<=7;++o)if(1===o)this.mItemArr.push(this.mNormalItem);else if(7===o)this.mItemArr.push(this.mSpecialItem);else{var n=cc.instantiate(this.mNormalItem.node);n.setParent(this.mItemRoot),n.setPosition(e.x+(o-1)%3*this.mCellWidth,e.y-Math.floor((o-1)/3)*this.mCellHeight),this.mItemArr.push(n.getComponent(s.default))}for(o=1;o<=7;++o)this.mItemArr[o-1].SetData(o,this);this.mSpecialItem.node.setSiblingIndex(6),this.UpdateDayState(),this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&p.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mCurDay=m.default.Ins.ClientInfo.sevenDays.mCurDay,this.UpdateDayState()},e.prototype.UpdateDayState=function(){0===l.default.Ins.GetDayState(this.mCurDay)?(this.mGetRewardsBtnNode.active=!0,this.mGetRewardsLbl.node.opacity=0):(this.mGetRewardsBtnNode.active=!1,this.mGetRewardsLbl.node.opacity=255);for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateDayState()},e.prototype.Invoke_Close=function(){u.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_GetRewards=function(){u.default.PlayBtnSound(),m.default.Ins.ClientInfo.sevenDays.mCurDay<this.mCurDay||0!==l.default.Ins.GetDayState(this.mCurDay)||(l.default.Ins.GetRewards(this.mCurDay),this.mItemArr[this.mCurDay-1].UpdateDayState(),this.mGetRewardsBtnNode.active=!1,this.mGetRewardsLbl.node.opacity=255)},i([f(s.default)],e.prototype,"mNormalItem",void 0),i([f(s.default)],e.prototype,"mSpecialItem",void 0),i([f(cc.Node)],e.prototype,"mGetRewardsBtnNode",void 0),i([f(cc.Label)],e.prototype,"mGetRewardsLbl",void 0),i([f([cc.SpriteFrame])],e.prototype,"mBGSFArr",void 0),i([f(cc.Node)],e.prototype,"mCloseBtn",void 0),i([f(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([d],e)}(a.default);o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxySevenDays":"ProxySevenDays","../Comp/SevenDayItem":"SevenDayItem","./WinBase":"WinBase"}],ShakeMgr:[function(t,e,o){"use strict";cc._RF.push(e,"d1dbaVZkjZGvJHP8B6ENGg6","ShakeMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.ShakeEvent=void 0;var n=t("../Common/Common"),r=function(){function t(){}return t.AddShakeEvent=function(t,e,o,n,r,a){void 0===a&&(a=!0);var s=this._FindEventByTag(r);null!==s?(s.timing=Math.max(e,s.timing),s.ResetData(e,o,n)):(s=new i(t,e,o,n,r,a),this.m_ShakeEventsArr.push(s))},t._FindEventByTag=function(t){for(var e=this.m_ShakeEventsArr.length;e-- >0;)if(this.m_ShakeEventsArr[e].tag===t)return this.m_ShakeEventsArr[e];return null},t.OnUpdate=function(t){for(var e=this.m_ShakeEventsArr.length;e-- >0;)this.m_ShakeEventsArr[e].timing-=t,this.m_ShakeEventsArr[e].OnUpdate(),this.m_ShakeEventsArr[e].timing<=0&&this.m_ShakeEventsArr.splice(e,1)},t.CAM_TAG="cam",t.m_ShakeEventsArr=[],t}();o.default=r;var i=function(){function t(t,e,o,n,r,i){void 0===i&&(i=!0),this.shakeNode=null,this.tag="",this.intensityX=0,this.intensityY=0,this.duration=0,this.timing=0,this.isFade=!1,this.shakeNode=t,this.duration=e,this.intensityX=o,this.intensityY=n,this.tag=r,this.isFade=i,this.timing=this.duration}return t.prototype.ResetData=function(t,e,o){this.duration=t,this.intensityX=e,this.intensityY=o},t.prototype.OnUpdate=function(){if(null!==this.shakeNode){var t=1;this.isFade&&(t=this.timing/this.duration),this.shakeNode.x=n.default.GetRandValueBetween(-this.intensityX,this.intensityX)*t,this.shakeNode.y=n.default.GetRandValueBetween(-this.intensityY,this.intensityY)*t}},t.prototype.OnCompleted=function(){this.shakeNode.x=0,this.shakeNode.y=0},t}();o.ShakeEvent=i,cc._RF.pop()},{"../Common/Common":"Common"}],ShopADCoinItem:[function(t,e,o){"use strict";cc._RF.push(e,"c8c7bG/K0dEdZxT2N1Yn6NI","ShopADCoinItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxySkin"),l=t("../../Proxy/ProxyShop"),m=t("../../Proxy/ProxyImmortal"),u=t("../../Platform/PlatformBase"),p=t("../../Manager/WinMgr"),c=t("../../Manager/UserMgr"),d=t("../../Manager/TimeMgr"),f=t("../../Manager/PlatformMgr"),h=t("../../Manager/DataMgr"),y=t("../../Manager/AudioMgr"),g=t("../../MainGame"),I=t("../../Common/EnumsDefine"),S=t("../../Common/Common"),_=cc._decorator,v=_.ccclass,C=_.property,M=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mDescLbl=null,e.mBuyBtnNode=null,e.mGetBtnNode=null,e.mGetBtnSp=null,e.mRefreshTimeLbl=null,e.mCostLbl=null,e.mGoldInfoRoot=null,e.mNormalNumLbl=null,e.mFirstNumLbl=null,e.mFirstGoldRoot=null,e.mNormalGoldRoot=null,e.mIdx=0,e.mItemData=null,e.mSI=null,e}return r(e,t),e.prototype.SetData=function(t){switch(this.mIdx=t,this.mSI=l.default.Ins.mShopInfo,this.mBuyBtnNode.active=!0,this.mGetBtnNode.active=!1,this.mGoldInfoRoot.active=!1,this.mIdx){case 0:this.mItem.SetData(I.ItemType.ADCoin,"1"),this.mItemData=h.default.Ins.m_DB.itemDB[I.ItemType.ADCoin],this.mDescLbl.string=this.mItemData.introduct,this.mBuyBtnNode.active=!1,this.mGetBtnNode.active=!0;break;case 1:this.mItem.SetData(l.default.Ins.mRandomSkinItemID,"1"),this.mItemData=h.default.Ins.m_DB.itemDB[l.default.Ins.mRandomSkinItemID],this.mDescLbl.string=this.mItemData.introduct,this.mCostLbl.string=this.mItemData.goldPrice;break;case 2:case 3:case 4:var e=l.default.Ins.mImtGiftBaseID+this.mIdx-2;this.mItem.SetData(e,"1"),this.mItemData=h.default.Ins.m_DB.itemDB[e],this.mDescLbl.string=this.mItemData.introduct,this.mCostLbl.string=this.mItemData.goldPrice;break;case 5:case 6:case 7:this.mDescLbl.string="",this.mGoldInfoRoot.active=!0;var o=l.default.Ins.mGoldInfoArr[this.mIdx-5];this.mItemData=h.default.Ins.m_DB.itemDB[o[0]],this.mItem.SetData(o[0],"1"),this.mNormalNumLbl.string="x"+o[1],this.mFirstNumLbl.string="x"+o[2],this.mCostLbl.string=this.mItemData.goldPrice,this.UpdateGoldItemState()}this.UpdateState()},e.prototype.UpdateState=function(){0===this.mIdx?0===l.default.Ins.mShopInfo.coinGotState?(this.mGetBtnSp.setMaterial(0,g.default.mDefaultMat),this.mRefreshTimeLbl.string="\u514d\u8d39\u9886\u53d6"):(this.mGetBtnSp.setMaterial(0,g.default.mGrayMat),this.mRefreshTimeLbl.string=S.default.FormatTimeBySeconds(d.default.mTodayLeftTime)):5!==this.mIdx&&6!==this.mIdx&&7!==this.mIdx||this.UpdateGoldItemState()},e.prototype.UpdateGoldItemState=function(){l.default.Ins.CheckGoldHasExchanged(this.mIdx)?(this.mNormalGoldRoot.scale=1,this.mFirstGoldRoot.opacity=0):(this.mNormalGoldRoot.scale=.8,this.mFirstGoldRoot.opacity=255)},e.prototype.UpdateRefreshTime=function(){null!==this.mSI&&1===this.mSI.coinGotState&&(this.mRefreshTimeLbl.string=S.default.FormatTimeBySeconds(d.default.mTodayLeftTime))},e.prototype.Invoke_Buy=function(){var t=this;y.default.PlayBtnSound();var e=this.mItemData.goldPrice;if(0!==this.mIdx&&c.default.Ins.GetItemNum(I.ItemType.ADCoin)<e)p.default.Ins.Open(I.WinType.ItemHintWin,function(t){t.SetData(I.ItemType.ADCoin)});else{var o=this,n=l.default.Ins.mShopInfo;switch(this.mIdx){case 0:if(0!==n.coinGotState)return;l.default.Ins.GetFreeADCoin(),this.UpdateState(),p.default.Ins.Open(I.WinType.GetRewardsWin,function(t){t.SetDataSingle(I.ItemType.ADCoin,"1")});break;case 1:p.default.Ins.Open(I.WinType.GiftOpenWin,function(t){t.SetData("lihe",function(){c.default.Ins.UpdateItem(I.ItemType.ADCoin,-e),c.default.Ins.Save();var t=s.default.Ins.GetRandSkin(),o=s.default.Ins.GetSkin(t);p.default.Ins.Open(I.WinType.GetSkinWin,function(e){e.SetData(t,o)}),o&&f.default.mCurPlf.ShowInterstitial(u.ADUnitID.Interstitial_Func_ID,I.InsPoint.ADCoin_Skin)})});break;case 2:case 3:case 4:p.default.Ins.Open(I.WinType.GiftOpenWin,function(e){e.SetData("lihe"+(t.mIdx-1),function(){c.default.Ins.UpdateItem(I.ItemType.ADCoin,-o.mItemData.goldPrice);var e=l.default.Ins.GetRandImt(t.mIdx),n=m.default.Ins.GetImt(e);p.default.Ins.Open(I.WinType.GetImtWin,function(t){t.SetData(e,n,!1)}),n&&f.default.mCurPlf.ShowInterstitial(u.ADUnitID.Interstitial_Func_ID,I.InsPoint.ADCoin_ImtBox)})});break;case 5:case 6:case 7:var r=l.default.Ins.ExchangeGold(this.mIdx),i=l.default.Ins.mGoldInfoArr[this.mIdx-5],a=i[1];r&&(a=i[2]),c.default.Ins.UpdateItem(I.ItemType.Gold,a),p.default.Ins.Open(I.WinType.GetRewardsWin,function(t){t.SetDataSingle(I.ItemType.Gold,a+"")}),c.default.Ins.UpdateItem(I.ItemType.ADCoin,-this.mItemData.goldPrice),this.UpdateGoldItemState()}c.default.Ins.Save(),f.default.ReportEvent(I.BIPoint.ADCoinItem,{id:this.mIdx})}},i([C(a.default)],e.prototype,"mItem",void 0),i([C(cc.Label)],e.prototype,"mDescLbl",void 0),i([C(cc.Node)],e.prototype,"mBuyBtnNode",void 0),i([C(cc.Node)],e.prototype,"mGetBtnNode",void 0),i([C(cc.Sprite)],e.prototype,"mGetBtnSp",void 0),i([C(cc.Label)],e.prototype,"mRefreshTimeLbl",void 0),i([C(cc.Label)],e.prototype,"mCostLbl",void 0),i([C(cc.Node)],e.prototype,"mGoldInfoRoot",void 0),i([C(cc.Label)],e.prototype,"mNormalNumLbl",void 0),i([C(cc.Label)],e.prototype,"mFirstNumLbl",void 0),i([C(cc.Node)],e.prototype,"mFirstGoldRoot",void 0),i([C(cc.Node)],e.prototype,"mNormalGoldRoot",void 0),i([v],e)}(cc.Component);o.default=M,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/TimeMgr":"TimeMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyShop":"ProxyShop","../../Proxy/ProxySkin":"ProxySkin","./SimpleItem":"SimpleItem"}],ShopADCoinPanel:[function(t,e,o){"use strict";cc._RF.push(e,"08958ZsTPdHE7UQKUrSMBGz","ShopADCoinPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopPanelBase"),s=t("./ShopADCoinItem"),l=t("../../Proxy/ProxyShop"),m=t("../../Manager/UserMgr"),u=t("../../Manager/BCMgr"),p=t("../../Common/SwitchConfig"),c=t("../../Common/EnumsDefine"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mContentNode=null,e.mTemplate=null,e.mADCoinHintRT=null,e.mItemArr=[],e.mOriPosY=-70,e.mCellHeight=135,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=0,o=l.default.Ins.mADCoinItemCount;e<o;e++){if(0===e)this.mItemArr.push(this.mTemplate);else{var n=cc.instantiate(this.mTemplate.node);n.parent=this.mContentNode,this.mItemArr.push(n.getComponent(s.default))}this.mItemArr[e].SetData(e),this.mItemArr[e].node.position=cc.v3(0,this.mOriPosY-e*this.mCellHeight,0)}this.mContentNode.height=this.mCellHeight*l.default.Ins.mADCoinItemCount+10},e.prototype._OnOpen=function(){if(t.prototype._OnOpen.call(this),this._OnMsg_UpdateTime(),this.mItemArr[0].UpdateState(),p.default.mNeedLimitADCoin){var e=Math.min(p.default.mADCoinLimitNum,m.default.Ins.ClientInfo.todayADCoinFromAD);this.mADCoinHintRT.string="<b>Tips\uff1a\u5e7f\u544a\u5e01\u6bcf\u65e5\u83b7\u5f97\u4e0a\u9650<color=#ffc843>"+p.default.mADCoinLimitNum+"</color>\u4e2a\uff0c\u4eca\u65e5\u5df2\u83b7\u5f97<color=#ffc843>"+e+"</color>\u4e2a\uff01</b>"}else this.mADCoinHintRT.string=""},e.prototype.OnToggleOpen=function(){this._OnMsg_UpdateTime(),this.mItemArr[0].UpdateState()},e.prototype.Subscribe=function(){u.default.Subscribe(c.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),u.default.Subscribe(c.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),u.default.Subscribe(c.BCType.Common_UpdateItem,this._OnMsg_UpdateItemUI,this)},e.prototype.Remove=function(){u.default.Remove(c.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),u.default.Remove(c.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),u.default.Remove(c.BCType.Common_UpdateItem,this._OnMsg_UpdateItemUI,this)},e.prototype._OnMsg_UpdateTime=function(){0!==this.mItemArr.length&&this.mItemArr[0].UpdateRefreshTime()},e.prototype._OnMsg_UpdateItemUI=function(t){if(t===c.ItemType.ADCoin)if(p.default.mNeedLimitADCoin){var e=Math.min(p.default.mADCoinLimitNum,m.default.Ins.ClientInfo.todayADCoinFromAD);this.mADCoinHintRT.string="<b>Tips\uff1a\u5e7f\u544a\u5e01\u6bcf\u65e5\u83b7\u5f97\u4e0a\u9650<color=#ffc843>"+p.default.mADCoinLimitNum+"</color>\u4e2a\uff0c\u4eca\u65e5\u5df2\u83b7\u5f97<color=#ffc843>"+e+"</color>\u4e2a\uff01</b>"}else this.mADCoinHintRT.string=""},e.prototype._OnMsg_RefreshOnNewDay=function(){if(0!==this.mItemArr.length&&this.mItemArr[0].UpdateState(),p.default.mNeedLimitADCoin){var t=Math.min(p.default.mADCoinLimitNum,m.default.Ins.ClientInfo.todayADCoinFromAD);this.mADCoinHintRT.string="<b>Tips\uff1a\u5e7f\u544a\u5e01\u6bcf\u65e5\u83b7\u5f97\u4e0a\u9650<color=#ffc843>"+p.default.mADCoinLimitNum+"</color>\u4e2a\uff0c\u4eca\u65e5\u5df2\u83b7\u5f97<color=#ffc843>"+t+"</color>\u4e2a\uff01</b>"}else this.mADCoinHintRT.string=""},i([h(cc.Node)],e.prototype,"mContentNode",void 0),i([h(s.default)],e.prototype,"mTemplate",void 0),i([h(cc.RichText)],e.prototype,"mADCoinHintRT",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyShop":"ProxyShop","./ShopADCoinItem":"ShopADCoinItem","./ShopPanelBase":"ShopPanelBase"}],ShopHeroItem:[function(t,e,o){"use strict";cc._RF.push(e,"1c242QCbHpL15Yz9B+zhoZF","ShopHeroItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyShop"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../MainGame"),h=t("../../Common/EnumsDefine"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mHeroIcon=null,e.mCampSp=null,e.mCounterSp=null,e.mNameLbl=null,e.mPB=null,e.mPbLblL=null,e.mCostLbl=null,e.mHeroID=0,e.mIdx=0,e.mHeroData=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mHeroID=t,this.mIdx=e,this.mHeroData=p.default.Ins.m_DB.heroCardDB[t],u.default.Ins.LoadItemSprite(t,this.mHeroIcon),u.default.Ins.LoadCampSprite(this.mHeroData.camp,this.mCampSp),u.default.Ins.LoadHeroQualitySprite(this.mHeroData.baseQuality,this.mQualitySp),this.mCounterSp.spriteFrame=f.default.mCounterSFArr[this.mHeroData.counter],this.mNameLbl.string=this.mHeroData.name,this.UpdateState()},e.prototype.UpdateState=function(){this.mCostLbl.string=a.default.Ins.GetHeroCost(this.mIdx)+"";var t=m.default.Ins.GetItemNum(this.mHeroID),e=this.mHeroData.baseQuality,o=0,n=s.default.Ins.GetHeroSI(this.mHeroID);null!==n&&(e=n.heroQuality,o=n.starLv);var r=s.default.Ins.GetNeedFragment(this.mHeroData.baseQuality,e,o);this.mPbLblL.string=t+"/"+r,this.mPB.progress=t/r},e.prototype.Invoke_Click=function(){d.default.PlayBtnSound();var t=this;l.default.Ins.Open(h.WinType.HeroDetailWin,function(e){e.SetData(t.mHeroID,h.WinType.ShopWin)})},e.prototype.Invoke_Buy=function(){d.default.PlayBtnSound();var t=m.default.Ins.GetItemNum(h.ItemType.Gold),e=a.default.Ins.GetHeroCost(this.mIdx);t<e?l.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u5143\u5b9d\u4e0d\u591f\u82b1\u5566~"):(m.default.Ins.UpdateItem(h.ItemType.Gold,-e),a.default.Ins.BuyHeroFragment(this.mIdx),m.default.Ins.UpdateItem(this.mHeroID,1),s.default.Ins.CheckHeroStarAwake(this.mHeroID),this.UpdateState(),c.default.Dispatch(h.BCType.UpdateHeroFragment,this.mHeroID))},i([I(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([I(cc.Sprite)],e.prototype,"mHeroIcon",void 0),i([I(cc.Sprite)],e.prototype,"mCampSp",void 0),i([I(cc.Sprite)],e.prototype,"mCounterSp",void 0),i([I(cc.Label)],e.prototype,"mNameLbl",void 0),i([I(cc.ProgressBar)],e.prototype,"mPB",void 0),i([I(cc.Label)],e.prototype,"mPbLblL",void 0),i([I(cc.Label)],e.prototype,"mCostLbl",void 0),i([g],e)}(cc.Component);o.default=S,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyHero":"ProxyHero","../../Proxy/ProxyShop":"ProxyShop"}],ShopHeroPanel:[function(t,e,o){"use strict";cc._RF.push(e,"4d9a8MoLW5FeqnkHTpTqCsr","ShopHeroPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopPanelBase"),s=t("./ShopHeroItem"),l=t("../../Proxy/ProxyShop"),m=t("../../Manager/WinMgr"),u=t("../../Manager/TimeMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mContentNode=null,e.mLeftTimeLbl=null,e.mItemArr=[],e.mOriPosY=-70,e.mCellHeight=135,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=l.default.Ins.mShopInfo.randHeroArr,o=0,n=e.length;o<n;o++){if(0===o)this.mItemArr.push(this.mTemplate);else{var r=cc.instantiate(this.mTemplate.node);r.parent=this.mContentNode,this.mItemArr.push(r.getComponent(s.default))}this.mItemArr[o].SetData(e[o],o),this.mItemArr[o].node.position=cc.v3(0,this.mOriPosY-o*this.mCellHeight,0)}this.mContentNode.height=this.mCellHeight*e.length+10},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._OnMsg_UpdateTime();for(var e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].UpdateState()},e.prototype.OnToggleOpen=function(){this._OnMsg_UpdateTime();for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateState()},e.prototype.Subscribe=function(){p.default.Subscribe(d.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),p.default.Subscribe(d.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),p.default.Subscribe(d.BCType.Shop_RefreshHeroFragment,this._OnMsg_ManualRefrehs,this)},e.prototype.Remove=function(){p.default.Remove(d.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),p.default.Remove(d.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),p.default.Remove(d.BCType.Shop_RefreshHeroFragment,this._OnMsg_ManualRefrehs,this)},e.prototype._OnMsg_UpdateTime=function(){var t=f.default.FormatTimeBySeconds(u.default.mTodayLeftTime);this.mLeftTimeLbl.string=t},e.prototype._OnMsg_RefreshOnNewDay=function(){for(var t=l.default.Ins.mShopInfo.randHeroArr,e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].SetData(t[e],e)},e.prototype._OnMsg_ManualRefrehs=function(){for(var t=l.default.Ins.mShopInfo.randHeroArr,e=0,o=this.mItemArr.length;e<o;++e)this.mItemArr[e].SetData(t[e],e)},e.prototype.Invoke_Refresh=function(){c.default.PlayBtnSound(),m.default.Ins.Open(d.WinType.RefreshShopHeroWin,function(t){t.SetData()})},i([g(s.default)],e.prototype,"mTemplate",void 0),i([g(cc.Node)],e.prototype,"mContentNode",void 0),i([g(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/TimeMgr":"TimeMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyShop":"ProxyShop","./ShopHeroItem":"ShopHeroItem","./ShopPanelBase":"ShopPanelBase"}],ShopItemPanel:[function(t,e,o){"use strict";cc._RF.push(e,"77cf3PO8sNLxqRbA+DkuHQe","ShopItemPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopPropItem"),s=t("./ShopPanelBase"),l=t("../../Proxy/ProxyShop"),m=t("../../Manager/TimeMgr"),u=t("../../Manager/BCMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mContentNode=null,e.mLeftTimeLbl=null,e.mItemArr=[],e.mOriPosY=-70,e.mCellHeight=135,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=l.default.Ins.mItemShopIDArr,o=0,n=e.length;o<n;o++){if(0===o)this.mItemArr.push(this.mTemplate);else{var r=cc.instantiate(this.mTemplate.node);r.parent=this.mContentNode,this.mItemArr.push(r.getComponent(a.default))}this.mItemArr[o].SetData(e[o][0],e[o][1],o),this.mItemArr[o].node.position=cc.v3(0,this.mOriPosY-o*this.mCellHeight,0)}this.mContentNode.height=this.mCellHeight*e.length+10},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._OnMsg_UpdateTime()},e.prototype.OnToggleOpen=function(){this._OnMsg_UpdateTime();for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateBtn()},e.prototype.Subscribe=function(){u.default.Subscribe(p.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),u.default.Subscribe(p.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype.Remove=function(){u.default.Remove(p.BCType.Common_OnSecondsPassed,this._OnMsg_UpdateTime,this),u.default.Remove(p.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype._OnMsg_UpdateTime=function(){var t=c.default.FormatTimeBySeconds(m.default.mTodayLeftTime);this.mLeftTimeLbl.string=t},e.prototype._OnMsg_RefreshOnNewDay=function(){for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateBtn()},i([h(a.default)],e.prototype,"mTemplate",void 0),i([h(cc.Node)],e.prototype,"mContentNode",void 0),i([h(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([f],e)}(s.default);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/TimeMgr":"TimeMgr","../../Proxy/ProxyShop":"ProxyShop","./ShopPanelBase":"ShopPanelBase","./ShopPropItem":"ShopPropItem"}],ShopPanelBase:[function(t,e,o){"use strict";cc._RF.push(e,"39126jMykBIQZIaw//sLTlP","ShopPanelBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=(a.property,function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOpenedTimes=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){},e.prototype.Open=function(){0===this.mOpenedTimes&&this._OnFirstOpen(),this.mOpenedTimes++,this.node.active=!0,this._OnOpen()},e.prototype.Close=function(){this.node.active=!1},e.prototype._OnOpen=function(){},e.prototype.OnToggleOpen=function(){},e.prototype.Subscribe=function(){},e.prototype.Remove=function(){},i([s],e)}(cc.Component));o.default=l,cc._RF.pop()},{}],ShopPropItem:[function(t,e,o){"use strict";cc._RF.push(e,"42444gwENlC76/cFneMjCV5","ShopPropItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxySpeed"),l=t("../../Proxy/ProxyShop"),m=t("../../Manager/WinMgr"),u=t("../../Manager/UserMgr"),p=t("../../Manager/DataMgr"),c=t("../../MainGame"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mOwnNumLbl=null,e.mDescLbl=null,e.mCostLbl=null,e.mUseBtnNode=null,e.mBuyBtnNode=null,e.mLimitNumLbl=null,e.mLimitTitle=null,e.mBuyBtnBg=null,e.mCurItemID=0,e.mIdx=0,e}return r(e,t),e.prototype.SetData=function(t,e,o){this.mCurItemID=t,this.mIdx=o,this.mItem.SetData(t,"");var n=p.default.Ins.m_DB.itemDB[t];this.mDescLbl.string=n.introduct;var r=u.default.Ins.GetItemNum(t);this.mOwnNumLbl.string=r+"",this.mCostLbl.string=n.goldPrice,this.UpdateBtn()},e.prototype.UpdateBtn=function(){this.mCurItemID===d.ItemType.SpeedUp2&&u.default.Ins.GetItemNum(this.mCurItemID)>0?(this.mUseBtnNode.active=!0,this.mBuyBtnNode.active=!1):(this.mUseBtnNode.active=!1,this.mBuyBtnNode.active=!0);var t=l.default.Ins.GetPropLeftCanBuyNum(this.mIdx);-1===t?this.mLimitTitle.opacity=0:(this.mLimitTitle.opacity=255,this.mLimitNumLbl.string=t+"",0===t?this.mBuyBtnBg.setMaterial(0,c.default.mGrayMat):this.mBuyBtnBg.setMaterial(0,c.default.mDefaultMat))},e.prototype._UpdateUI=function(){this.mOwnNumLbl.string=u.default.Ins.GetItemNum(this.mCurItemID)+"",this.UpdateBtn()},e.prototype.Invoke_Buy=function(){if(this.mCurItemID===d.ItemType.SpeedUp2&&u.default.Ins.GetItemNum(d.ItemType.SpeedUp2)>0)s.default.Ins.UseSpeedItem(),u.default.Ins.UpdateItem(d.ItemType.SpeedUp2,-1),this._UpdateUI(),m.default.Ins.ShowTips("2\u500d\u901f\u9053\u5177\u751f\u6548~");else{var t=l.default.Ins.GetPropLeftCanBuyNum(this.mIdx);if(0!==t){var e=this;m.default.Ins.Open(d.WinType.BuyItemWin,function(o){o.SetData(e.mCurItemID,function(t){l.default.Ins.OnBuyProp(e.mIdx,t),e._UpdateUI()},t)})}else m.default.Ins.ShowTips("\u4eca\u65e5\u9650\u8d2d\u6b21\u6570\u5df2\u7528\u5b8c\uff0c\u4e3b\u516c\u660e\u5929\u518d\u6765\u5440~")}},i([y(a.default)],e.prototype,"mItem",void 0),i([y(cc.Label)],e.prototype,"mOwnNumLbl",void 0),i([y(cc.Label)],e.prototype,"mDescLbl",void 0),i([y(cc.Label)],e.prototype,"mCostLbl",void 0),i([y(cc.Node)],e.prototype,"mUseBtnNode",void 0),i([y(cc.Node)],e.prototype,"mBuyBtnNode",void 0),i([y(cc.Label)],e.prototype,"mLimitNumLbl",void 0),i([y(cc.Node)],e.prototype,"mLimitTitle",void 0),i([y(cc.Sprite)],e.prototype,"mBuyBtnBg",void 0),i([h],e)}(cc.Component);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyShop":"ProxyShop","../../Proxy/ProxySpeed":"ProxySpeed","./SimpleItem":"SimpleItem"}],ShopSkinItemGroup:[function(t,e,o){"use strict";cc._RF.push(e,"5e695Y1biRE/5g14cFyr5DD","ShopSkinItemGroup");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopSkinItem"),s=t("./LoopScrollItem"),l=t("../../Proxy/ProxySkin"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTemplate=null,e.mItemNum=4,e.mItemArr=[],e.mShopSkinPanel=null,e}return r(e,t),e.prototype.Init=function(t,e){this.mShopSkinPanel=e,this.mIdx=t;for(var o=0;o<this.mItemNum;++o){if(0===o)this.mItemArr.push(this.mTemplate);else{var n=cc.instantiate(this.mTemplate.node);n.parent=this.mTemplate.node.parent,n.position=cc.v3(this.mTemplate.node.x+o*this.mTemplate.node.width,0,0),this.mItemArr.push(n.getComponent(a.default))}this.mItemArr[o].Init(this.mShopSkinPanel)}this.UpdateUI()},e.prototype.OnItemChange=function(e){t.prototype.OnItemChange.call(this,e)},e.prototype.UpdateUI=function(){t.prototype.UpdateUI.call(this);for(var e=l.default.Ins.mSkinDataArr,o=this.mIdx*this.mItemNum,n=0;n<this.mItemNum;++n)o+n<e.length?(this.mItemArr[n].node.active=!0,this.mItemArr[n].SetData(e[o+n])):this.mItemArr[n].node.active=!1},i([p(a.default)],e.prototype,"mTemplate",void 0),i([u],e)}(s.default);o.default=c,cc._RF.pop()},{"../../Proxy/ProxySkin":"ProxySkin","./LoopScrollItem":"LoopScrollItem","./ShopSkinItem":"ShopSkinItem"}],ShopSkinItem:[function(t,e,o){"use strict";cc._RF.push(e,"44c30gG129G/IQrUk6vnGz4","ShopSkinItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySkin"),s=t("../../Manager/WinMgr"),l=t("../../Manager/ResMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualityTagSp=null,e.mSkinSp=null,e.mNameLbl=null,e.mCostLbl=null,e.mFromLbl=null,e.mGotFlagNode=null,e.mCurSkinID=0,e.mShopSkinPanel=null,e}return r(e,t),e.prototype.Init=function(t){this.mShopSkinPanel=t},e.prototype.SetData=function(t){if(t.id!==this.mCurSkinID){this.mCurSkinID=t.id,this.mNameLbl.string=t.name,this.mQualityTagSp.spriteFrame=this.mShopSkinPanel.mQualityTagSFArr[t.quality];var e=this;l.default.Ins.LoadSpriteFrame(t.atlas,t.sprite,this.mSkinSp,function(o){if(null!==e.mSkinSp){e.mSkinSp.spriteFrame=o;var n=t.offset;p.default.ResetSpriteSize(e.mSkinSp,e.mSkinSp.spriteFrame,n[2]),e.mSkinSp.node.position=cc.v3(n[0],n[1],0)}})}var o=t.fromType;a.default.Ins.CheckHasSkin(this.mCurSkinID)?(this.mGotFlagNode.opacity=255,this.mCostLbl.node.opacity=0,this.mFromLbl.string="\u5df2\u62e5\u6709"):(this.mGotFlagNode.opacity=0,o===a.SkinFromType.Fragment?(this.mFromLbl.string="",this.mCostLbl.node.opacity=255,this.mCostLbl.string=t.cost):(this.mFromLbl.string=a.default.Ins.GetSkinFromDesc(o),this.mCostLbl.node.opacity=0))},e.prototype.Invoke_Click=function(){m.default.PlayBtnSound();var t=this;s.default.Ins.Open(u.WinType.SkinPreviewWin,function(e){e.SetData(t.mCurSkinID)})},i([f(cc.Sprite)],e.prototype,"mQualityTagSp",void 0),i([f(cc.Sprite)],e.prototype,"mSkinSp",void 0),i([f(cc.Label)],e.prototype,"mNameLbl",void 0),i([f(cc.Label)],e.prototype,"mCostLbl",void 0),i([f(cc.Label)],e.prototype,"mFromLbl",void 0),i([f(cc.Node)],e.prototype,"mGotFlagNode",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxySkin":"ProxySkin"}],ShopSkinPanel:[function(t,e,o){"use strict";cc._RF.push(e,"4a213qbZ2lIKZP6kstzx2gT","ShopSkinPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./ShopPanelBase"),s=t("./LoopScrollView"),l=t("../../Proxy/ProxySkin"),m=t("../../Manager/BCMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLoopSV=null,e.mQualityTagSFArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);var e=l.default.Ins.mSkinDataArr;e.sort(this._SkinCompareFunc),this.mLoopSV.Initialize(Math.floor((e.length+3)/4),this)},e.prototype._SkinCompareFunc=function(t,e){var o=l.default.Ins.CheckHasSkin(t.id),n=l.default.Ins.CheckHasSkin(e.id);return o&&!n?1:!o&&n?-1:t.order-e.order},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),l.default.Ins.mSkinDataArr.sort(this._SkinCompareFunc),this.mLoopSV.UpdateUI()},e.prototype.OnToggleOpen=function(){l.default.Ins.mSkinDataArr.sort(this._SkinCompareFunc),this.mLoopSV.UpdateUI()},e.prototype.Subscribe=function(){t.prototype.Subscribe.call(this),m.default.Subscribe(u.BCType.Skin_GetNew,this._OnMsg_GetNewSkin,this)},e.prototype.Remove=function(){t.prototype.Remove.call(this),m.default.Remove(u.BCType.Skin_GetNew,this._OnMsg_GetNewSkin,this)},e.prototype._OnMsg_GetNewSkin=function(){l.default.Ins.mSkinDataArr.sort(this._SkinCompareFunc),this.mLoopSV.UpdateUI()},i([d(s.default)],e.prototype,"mLoopSV",void 0),i([d([cc.SpriteFrame])],e.prototype,"mQualityTagSFArr",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Proxy/ProxySkin":"ProxySkin","./LoopScrollView":"LoopScrollView","./ShopPanelBase":"ShopPanelBase"}],ShopWin:[function(t,e,o){"use strict";cc._RF.push(e,"7d12aG90I1M1rE8LrGfwk6g","ShopWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/ShopSkinPanel"),l=t("../Comp/ShopItemPanel"),m=t("../Comp/ShopHeroPanel"),u=t("../Comp/ShopADCoinPanel"),p=t("../Comp/MyToggleGroup"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mToggleGroup=null,e.mItemPanel=null,e.mHeroPanel=null,e.mADCoinPanel=null,e.mSkinPanel=null,e.mCurPanel=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init(),this._OnMsg_ClickToggle(0,!0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),null!==this.mCurPanel&&this.mCurPanel.OnToggleOpen()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(f.BCType.ToggleGroup_Shop,this._OnMsg_ClickToggle,this),this.mItemPanel.Subscribe(),this.mHeroPanel.Subscribe(),this.mADCoinPanel.Subscribe(),this.mSkinPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(f.BCType.ToggleGroup_Shop,this._OnMsg_ClickToggle,this),this.mItemPanel.Remove(),this.mHeroPanel.Remove(),this.mADCoinPanel.Remove(),this.mSkinPanel.Remove()},e.prototype._OnMsg_ClickToggle=function(t,e){switch(void 0===e&&(e=!1),e||d.default.PlayBtnSound(),this.mToggleGroup.CurToggleIdx!==t&&null!==this.mCurPanel&&5!==t&&this.mCurPanel.Close(),t){case 0:this.mItemPanel.Open(),this.mCurPanel=this.mItemPanel;break;case 1:this.mHeroPanel.Open(),this.mCurPanel=this.mHeroPanel;break;case 2:this.mADCoinPanel.Open(),this.mCurPanel=this.mADCoinPanel;break;case 3:this.mSkinPanel.Open(),this.mCurPanel=this.mSkinPanel}this.mToggleGroup.UpdateToggleBtnState(t)},i([g(p.default)],e.prototype,"mToggleGroup",void 0),i([g(l.default)],e.prototype,"mItemPanel",void 0),i([g(m.default)],e.prototype,"mHeroPanel",void 0),i([g(u.default)],e.prototype,"mADCoinPanel",void 0),i([g(s.default)],e.prototype,"mSkinPanel",void 0),i([y],e)}(a.default);o.default=I,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/ShopADCoinPanel":"ShopADCoinPanel","../Comp/ShopHeroPanel":"ShopHeroPanel","../Comp/ShopItemPanel":"ShopItemPanel","../Comp/ShopSkinPanel":"ShopSkinPanel","./WinBase":"WinBase"}],SignItem:[function(t,e,o){"use strict";cc._RF.push(e,"c23767JBSxAz7YBpSmFHSiC","SignItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxySign"),l=t("../../Proxy/ProxyLargeNum"),m=t("../../Manager/UserMgr"),u=t("../../Manager/BCMgr"),p=t("../../Manager/AudioMgr"),c=t("../../Common/EnumsDefine"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItem=null,e.mCheckMark=null,e.mBg=null,e.mCurDay=0,e.mItemID=0,e.mSignWin=null,e}return r(e,t),e.prototype.SetData=function(t,e){this.mSignWin=e,this.mCurDay=t.id;var o=t.reward,n=o[0],r=o[1];n===c.ItemType.Medal&&(r=l.default.FormatNumber(m.default.Ins.GetMedalNum(r),1)),this.mItemID=n,this.mItem.SetData(n,r+""),this.UpdateCurState(),this.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_ItemTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_ItemTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_ItemTouchCancel,this)},e.prototype.UpdateCurState=function(){var t=m.default.Ins.ClientInfo.signInfo,e=t.hasSignedDay>=this.mCurDay;this.SetCheckState(e);var o=t.hasSignedDay<this.mCurDay&&this.mCurDay<=t.canSignDay;this.SetItemBg(o)},e.prototype.SetCheckState=function(t){this.mCheckMark.opacity=t?255:0},e.prototype.SetItemBg=function(t){this.mBg.spriteFrame=t?this.mSignWin.mToGetSF:this.mSignWin.mNormalSF,t&&(this.mSignWin.mToGetSk.parent=this.mBg.node,this.mSignWin.mToGetSk.position=cc.Vec3.ZERO,this.mSignWin.mToGetSk.active=t)},e.prototype._OnNodeEvent_ItemTouchStart=function(t){u.default.Dispatch(c.BCType.SignItem_TouchStart,this.mItemID,t.getLocation())},e.prototype._OnNodeEvent_ItemTouchEnd=function(){u.default.Dispatch(c.BCType.SignItem_TouchEnd),p.default.PlayBtnSound();var t=m.default.Ins.ClientInfo.signInfo;this.mCurDay<=t.hasSignedDay||t.hasSignedDay<this.mCurDay&&this.mCurDay<=t.canSignDay&&s.default.Ins.Sign(this.mCurDay)},e.prototype._OnNodeEvent_ItemTouchCancel=function(){u.default.Dispatch(c.BCType.SignItem_TouchCancel)},i([h(a.default)],e.prototype,"mItem",void 0),i([h(cc.Node)],e.prototype,"mCheckMark",void 0),i([h(cc.Sprite)],e.prototype,"mBg",void 0),i([f],e)}(cc.Component);o.default=y,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySign":"ProxySign","./SimpleItem":"SimpleItem"}],SignWin:[function(t,e,o){"use strict";cc._RF.push(e,"37314GhvkRIfZusv0yf04ot","SignWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SignItem"),l=t("../Comp/ItemDetailPanel"),m=t("../../Proxy/ProxySign"),u=t("../../Manager/UserMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../MainGame"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mContentRoot=null,e.mTemplate=null,e.mSignDayLbl=null,e.mBtnBg=null,e.mSignBtnLbl=null,e.mNormalSF=null,e.mToGetSF=null,e.mToGetSk=null,e.mItemDetailPanel=null,e.mItemArr=[],e.mOriPosX=-276,e.mOriPosY=-64,e.mCellWidth=138,e.mCellHeight=138,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=p.default.Ins.m_DB.signDB,o=0;o<30;++o)if(0===o)this.mItemArr.push(this.mTemplate);else{var n=cc.instantiate(this.mTemplate.node),r=n.getComponent(s.default);n.parent=this.mContentRoot,this.mItemArr.push(r);var i=this.mOriPosX+o%5*this.mCellWidth,a=this.mOriPosY-Math.floor(o/5)*this.mCellHeight;n.position=cc.v3(i,a)}for(o=0;o<30;++o)this.mItemArr[o].SetData(e[o+1],this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this._UpdateUI()},e.prototype._UpdateUI=function(){var t=u.default.Ins.ClientInfo.signInfo;this.mSignDayLbl.string=t.hasSignedDay+"/30",t.hasSignedDay>=t.canSignDay?(this.mBtnBg.setMaterial(0,f.default.mGrayMat),this.mSignBtnLbl.string="\u5df2\u7b7e\u5230"):(this.mBtnBg.setMaterial(0,f.default.mDefaultMat),this.mSignBtnLbl.string="\u7b7e\u5230")},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(h.BCType.SignAct_OnSigned,this._OnMsg_AfterSinged,this),c.default.Subscribe(h.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),c.default.Subscribe(h.BCType.SignItem_TouchStart,this._OnMsg_OnItemTouchStart,this),c.default.Subscribe(h.BCType.SignItem_TouchEnd,this._OnMsg_OnItemTouchEnd,this),c.default.Subscribe(h.BCType.SignItem_TouchCancel,this._OnMsg_OnItemTouchCancel,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(h.BCType.SignAct_OnSigned,this._OnMsg_AfterSinged,this),c.default.Remove(h.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this),c.default.Remove(h.BCType.SignItem_TouchStart,this._OnMsg_OnItemTouchStart,this),c.default.Remove(h.BCType.SignItem_TouchEnd,this._OnMsg_OnItemTouchEnd,this),c.default.Remove(h.BCType.SignItem_TouchCancel,this._OnMsg_OnItemTouchCancel,this)},e.prototype._OnMsg_AfterSinged=function(t){this._UpdateUI(),this.mItemArr[t-1].UpdateCurState(),this.mToGetSk.active=!1},e.prototype._OnMsg_RefreshOnNewDay=function(){this._UpdateUI();for(var t=0;t<30;++t)this.mItemArr[t].UpdateCurState()},e.prototype._OnMsg_OnItemTouchStart=function(t,e){this.mItemDetailPanel.SetData(t),this.mItemDetailPanel.node.opacity=255;var o=this.mItemDetailPanel.node.parent.convertToNodeSpaceAR(e);this.mItemDetailPanel.node.position=o.add(cc.v3(0,100,0));var n=.5*this.mItemDetailPanel.node.width,r=.5*-y.default.DESIGN_WIDTH+n,i=.5*y.default.DESIGN_WIDTH-n;this.mItemDetailPanel.node.x=y.default.Clamp(this.mItemDetailPanel.node.x,r,i)},e.prototype._OnMsg_OnItemTouchEnd=function(){this.mItemDetailPanel.node.opacity=0},e.prototype._OnMsg_OnItemTouchCancel=function(){this.mItemDetailPanel.node.opacity=0},e.prototype.Invoke_Ins=function(){d.default.PlayBtnSound()},e.prototype.Invoke_Sign=function(){d.default.PlayBtnSound(),m.default.Ins.Sign(u.default.Ins.ClientInfo.signInfo.canSignDay)},i([S(cc.Node)],e.prototype,"mContentRoot",void 0),i([S(s.default)],e.prototype,"mTemplate",void 0),i([S(cc.Label)],e.prototype,"mSignDayLbl",void 0),i([S(cc.Sprite)],e.prototype,"mBtnBg",void 0),i([S(cc.Label)],e.prototype,"mSignBtnLbl",void 0),i([S(cc.SpriteFrame)],e.prototype,"mNormalSF",void 0),i([S(cc.SpriteFrame)],e.prototype,"mToGetSF",void 0),i([S(cc.Node)],e.prototype,"mToGetSk",void 0),i([S(l.default)],e.prototype,"mItemDetailPanel",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxySign":"ProxySign","../Comp/ItemDetailPanel":"ItemDetailPanel","../Comp/SignItem":"SignItem","./WinBase":"WinBase"}],SimpleBattleFloat:[function(t,e,o){"use strict";cc._RF.push(e,"bf294HWBEBEE6y09/vMjltV","SimpleBattleFloat");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=t("../../MainGame"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFloatSp=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.SetData=function(t){this.mFloatSp.spriteFrame=s.default.mBattleFloatArr[t],this._Trigger()},e.prototype._Trigger=function(){var t=cc.tween,e=this;t(this.node).delay(.15).parallel(t().to(1.3,{opacity:0}),t().by(.8,{position:cc.v3(0,30,0)})).call(function(){e.Return()}).start()},e.prototype.Return=function(){a.default.Ins.Return(this)},i([u(cc.Sprite)],e.prototype,"mFloatSp",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../MainGame":"MainGame","../../Manager/PoolMgr":"PoolMgr"}],SimpleItem:[function(t,e,o){"use strict";cc._RF.push(e,"291c8mrSHREjYCieeyF1DNR","SimpleItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=t("../../Manager/DataMgr"),l=t("../../Manager/BCMgr"),m=t("../../MainGame"),u=t("../../Common/EnumsDefine"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mSPTag=null,e.mIconSp=null,e.mNameLbl=null,e.mNumLbl=null,e.mFragmentTag=null,e.mFrameSk=null,e.mStarSp=null,e.mEnableSSREfx=!0,e.mEnableSPEfx=!0,e.mItemData=null,e.mHasRegistered=!1,e}return r(e,t),e.prototype.SetData=function(t,e,o,n){void 0===o&&(o=!1),void 0===n&&(n=!1),this.mItemData=s.default.Ins.m_DB.itemDB[t],null!==this.mFragmentTag&&(this.mItemData.itemType===u.ItemType.HeroFragment?this.mFragmentTag.opacity=255:this.mFragmentTag.opacity=0),this.mSPTag.opacity=this.mItemData.quality==u.ItemQuality.SP?255:0;var r=this.mItemData.quality;if(a.default.Ins.LoadItemQualitySprite(r,this.mQualitySp,null),a.default.Ins.LoadItemSprite(t,this.mIconSp,null),this.mNameLbl.string=this.mItemData.name,this.mNameLbl.node.color=p.default.GetQualityColor(this.mItemData.quality),null!==this.mNumLbl&&(this.mNumLbl.string="x"+e),null!==this.mFrameSk){this.mFrameSk.skeletonData=null;var i=this;r===u.ItemQuality.SSR&&this.mEnableSSREfx?a.default.Ins.LoadSpine("spine/biankuangtexiao",function(t){i.mFrameSk&&(i.mFrameSk.skeletonData=t,i.mFrameSk.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.mFrameSk.enableBatch=!0,i.mFrameSk.setAnimation(0,"animation",!0))}):r===u.ItemQuality.SP&&this.mEnableSPEfx&&a.default.Ins.LoadSpine("spine/wushuang",function(t){i.mFrameSk&&(i.mFrameSk.skeletonData=t,i.mFrameSk.setAnimationCacheMode(sp.Skeleton.AnimationCacheMode.SHARED_CACHE),i.mFrameSk.enableBatch=!0,i.mFrameSk.setAnimation(0,"animation",!0))})}o&&!this.mHasRegistered&&(this.mHasRegistered=!0,this.node.on(cc.Node.EventType.TOUCH_START,this._OnNodeEvent_ItemTouchStart,this),this.node.on(cc.Node.EventType.TOUCH_END,this._OnNodeEvent_ItemTouchEnd,this),this.node.on(cc.Node.EventType.TOUCH_CANCEL,this._OnNodeEvent_ItemTouchCancel,this)),null!==this.mStarSp&&(n?(this.mStarSp.node.opacity=255,this.mStarSp.spriteFrame=m.default.mStarSFArr[this.mItemData.quality+1],this.mNumLbl.string=""):this.mStarSp.node.opacity=0)},e.prototype._OnNodeEvent_ItemTouchStart=function(t){l.default.Dispatch(u.BCType.SimpleItem_TouchStart,this.mItemData.itemId,t.getLocation())},e.prototype._OnNodeEvent_ItemTouchEnd=function(){l.default.Dispatch(u.BCType.SimpleItem_TouchEnd)},e.prototype._OnNodeEvent_ItemTouchCancel=function(){l.default.Dispatch(u.BCType.SimpleItem_TouchCancel)},i([f(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([f(cc.Node)],e.prototype,"mSPTag",void 0),i([f(cc.Sprite)],e.prototype,"mIconSp",void 0),i([f(cc.Label)],e.prototype,"mNameLbl",void 0),i([f(cc.Label)],e.prototype,"mNumLbl",void 0),i([f(cc.Node)],e.prototype,"mFragmentTag",void 0),i([f(sp.Skeleton)],e.prototype,"mFrameSk",void 0),i([f(cc.Sprite)],e.prototype,"mStarSp",void 0),i([f(cc.Boolean)],e.prototype,"mEnableSSREfx",void 0),i([f(cc.Boolean)],e.prototype,"mEnableSPEfx",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr"}],SimpleToggle:[function(t,e,o){"use strict";cc._RF.push(e,"7440bZ44JxBOJVuLX3tH8Hf","SimpleToggle");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_DeactivedNode=null,e.m_ActivedNode=null,e}return r(e,t),e.prototype.SetState=function(t){this.m_ActivedNode.opacity=t?255:0,this.m_DeactivedNode.opacity=t?0:255},i([l(cc.Node)],e.prototype,"m_DeactivedNode",void 0),i([l(cc.Node)],e.prototype,"m_ActivedNode",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],SkillCompCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"1f702USD6ZG6pt5dqjVQnnR","SkillCompCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./AttackBehavior/AttackBehaviorFactory"),r=t("../../UI/Win/BattleWin"),i=t("../../Manager/ShakeMgr"),a=t("../../Manager/DataMgr"),s=function(){function t(){this.m_SkillCtrl=null,this.m_SkillData=null,this.mSkillCompData=null,this.m_AtkBehavior=null}return t.prototype.Init=function(t,e,o){this.m_SkillCtrl=t,this.m_SkillData=e,this.mSkillCompData=a.default.Ins.m_DB.skillCompDB[o],this.m_AtkBehavior=n.default.Instance.Create(this.mSkillCompData.atkType,this)},t.prototype.Trigger=function(){this.m_AtkBehavior.Trigger(),this.TriggerShakeEvent()},t.prototype.TriggerByIdx=function(t){this.m_AtkBehavior.TriggerByIdx(t),this.TriggerShakeEvent()},t.prototype.TriggerShakeEvent=function(){var t=this.mSkillCompData.shake;0!==t.length&&i.default.AddShakeEvent(r.default.ShakeRoot,t[0],t[1],t[2],i.default.CAM_TAG)},t}();o.default=s,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","../../Manager/ShakeMgr":"ShakeMgr","../../UI/Win/BattleWin":"BattleWin","./AttackBehavior/AttackBehaviorFactory":"AttackBehaviorFactory"}],SkillCtrl:[function(t,e,o){"use strict";cc._RF.push(e,"dd218lBTpNLcaIRElolfile","SkillCtrl"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./SkillCompCtrl"),r=t("../../Manager/DataMgr"),i=function(){function t(t){this.mSkillDataMap=null,this.mSkillCompMap=null,this.mIsUsingSkill=!1,this.mCurSkillCompCtrlArr=null,this.mCD=0,this.mCDTimer=0,this.mIsCDing=!1,this.mNormalSkillID=0,this.mNormalSkillData=null,this.m_SkillEndCallback=null,this.mImtSkillData=null,this.mEntity=t}return Object.defineProperty(t.prototype,"SkillData",{get:function(){return this.mCurSkillData},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"SkillID",{get:function(){return this.mCurSkillID},enumerable:!1,configurable:!0}),t.prototype.GetSkillCompCtrl=function(t){return void 0===t&&(t=0),null!==this.mCurSkillCompCtrlArr?this.mCurSkillCompCtrlArr[t]:null},t.prototype.InitOnce=function(){var t=this.mEntity.mEntityData;this.mNormalSkillID=t.normalSkillId,this.mNormalSkillData=r.default.Ins.m_DB.skillDB[this.mNormalSkillID],this.mSkillDataMap=new Map,this.mSkillCompMap=new Map;var e=[];e.push(this.mNormalSkillID);for(var o=0,i=t.totalSkills.length;o<i;++o)e.push(t.totalSkills[o]);for(o=0,i=e.length;o<i;++o){var a=e[o],s=r.default.Ins.m_DB.skillDB[a];this.mSkillDataMap.set(a,s);for(var l=s.compIds,m=0,u=l.length;m<u;++m){var p=new n.default;p.Init(this,s,l[m]);var c=this.mSkillCompMap.get(a);c||(c=new Array,this.mSkillCompMap.set(a,c)),c.push(p)}}},t.prototype.InitImtSkillData=function(t){this.mImtSkillData=t},t.prototype.Reset=function(){this.mIsCDing=!1,this.mCDTimer=0},t.prototype.TriggerSkill=function(t){void 0===t&&(t=0),this.mIsUsingSkill=!0,this.mIsCDing=!0,this.mCurSkillID=t,0===t&&(this.mCurSkillID=this.mNormalSkillID),this.mCurSkillData=this.mSkillDataMap.get(this.mCurSkillID),this.mCurSkillCompCtrlArr=this.mSkillCompMap.get(this.mCurSkillID),this.mCD=this.mCurSkillData.cd,this.mCDTimer=0,this.mEntity.mSkeleton.setAnimation(0,this.mCurSkillData.animName,!1)},t.prototype.EndSkill=function(){this.mIsUsingSkill=!1},Object.defineProperty(t.prototype,"IsUsingSkill",{get:function(){return this.mIsUsingSkill},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"IsCDing",{get:function(){return this.mIsCDing},enumerable:!1,configurable:!0}),t.prototype.OnUpdate=function(t){this.mIsCDing&&(this.mCDTimer+=t,this.mCDTimer>=this.mCD&&(this.mIsCDing=!1,this.mCDTimer=0))},t}();o.default=i,cc._RF.pop()},{"../../Manager/DataMgr":"DataMgr","./SkillCompCtrl":"SkillCompCtrl"}],SkillDetailPanel:[function(t,e,o){"use strict";cc._RF.push(e,"e7cbc+U459CT6XGRhqXtXHc","SkillDetailPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyHero"),s=t("../../Manager/ResMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIcon=null,e.mNameLbl=null,e.mDescLbl=null,e.mUnlockLbl=null,e.mHeroID=0,e.mSkillNumID=0,e}return r(e,t),e.prototype.SetData=function(t,e){if(this.mHeroID!==t||this.mSkillNumID!==e){this.mHeroID=t,this.mSkillNumID=e,s.default.Ins.LoadHeroSkillSp(t,e,this.mIcon);var o=a.default.Ins.GetHeroSkillData(t,e);this.mNameLbl.string=o.name,this.mDescLbl.string=o.desc,1===e?this.mUnlockLbl.node.opacity=0:9===e?(this.mUnlockLbl.node.opacity=255,this.mUnlockLbl.string="\u65e0\u53cc\u54c1\u8d28\u89e3\u9501"):(this.mUnlockLbl.node.opacity=255,this.mUnlockLbl.string=e+"\u661f\u89e3\u9501")}},i([u(cc.Sprite)],e.prototype,"mIcon",void 0),i([u(cc.Label)],e.prototype,"mNameLbl",void 0),i([u(cc.Label)],e.prototype,"mDescLbl",void 0),i([u(cc.Label)],e.prototype,"mUnlockLbl",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero"}],SkinPreviewWin:[function(t,e,o){"use strict";cc._RF.push(e,"75af9P04V1IHb8Ws6KtK5hX","SkinPreviewWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxySkin"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=cc._decorator,h=f.ccclass,y=f.property,g=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNameLbl=null,e.mTagSp=null,e.mAttrLbl=null,e.mCostLbl=null,e.mFromDescLbl=null,e.mExchangeBtnNode=null,e.mSk=null,e.mTagSFArr=[],e.mCurSkinID=0,e.mSkinData=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask,this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype.SetData=function(t){if(this.mCurSkinID!==t){this.mCurSkinID=t,this.mSkinData=p.default.Ins.m_DB.skinDB[t],this.mNameLbl.string=this.mSkinData.name,this.mAttrLbl.string=s.default.Ins.GetAttrDesc(this.mSkinData.attr),this.mTagSp.spriteFrame=this.mTagSFArr[this.mSkinData.quality];var e=this;u.default.Ins.LoadSpine("spine/hero/"+this.mSkinData.model,function(t){null!==e.mSk&&(e.mSk.skeletonData=t,e.mSk.setAnimation(0,"daiji",!0))})}s.default.Ins.CheckHasSkin(t)?(this.mFromDescLbl.string="\u5df2\u62e5\u6709",this.mExchangeBtnNode.active=!1):this.mSkinData.fromType===s.SkinFromType.Fragment?(this.mCostLbl.string=this.mSkinData.cost,this.mExchangeBtnNode.active=!0,this.mFromDescLbl.string=""):(this.mExchangeBtnNode.active=!1,this.mFromDescLbl.string=s.default.Ins.GetSkinFromDesc(this.mSkinData.fromType))},e.prototype.Invoke_Exchange=function(){if(c.default.PlayBtnSound(),this.mSkinData.fromType===s.SkinFromType.Fragment){if(!s.default.Ins.CheckHasSkin(this.mSkinData.id)){var t=this.mSkinData.cost;if(m.default.Ins.GetItemNum(d.ItemType.SkinFrag)<t)l.default.Ins.Open(d.WinType.ItemHintWin,function(t){t.SetData(d.ItemType.SkinFrag)});else{m.default.Ins.UpdateItem(d.ItemType.SkinFrag,-t);var e=s.default.Ins.GetSkin(this.mCurSkinID,!1),o=this;l.default.Ins.Open(d.WinType.GetSkinWin,function(t){t.SetData(o.mCurSkinID,e)}),this.SetData(this.mCurSkinID),m.default.Ins.Save()}}}else console.error("\u76ae\u80a4\u76f8\u5173\u903b\u8f91\u51fa\u9519\uff0c\u8bf7\u68c0\u67e5")},i([y(cc.Label)],e.prototype,"mNameLbl",void 0),i([y(cc.Sprite)],e.prototype,"mTagSp",void 0),i([y(cc.Label)],e.prototype,"mAttrLbl",void 0),i([y(cc.Label)],e.prototype,"mCostLbl",void 0),i([y(cc.Label)],e.prototype,"mFromDescLbl",void 0),i([y(cc.Node)],e.prototype,"mExchangeBtnNode",void 0),i([y(sp.Skeleton)],e.prototype,"mSk",void 0),i([y([cc.SpriteFrame])],e.prototype,"mTagSFArr",void 0),i([h],e)}(a.default);o.default=g,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxySkin":"ProxySkin","./WinBase":"WinBase"}],SmithBookWin:[function(t,e,o){"use strict";cc._RF.push(e,"d86841ertZIG7UuoQKhHbge","SmithBookWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SmithCharacter"),l=t("../../Proxy/ProxyForge"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTitleLbl=null,e.mStarLbl=null,e.mLhsArrowNode=null,e.mRhsArrowNode=null,e.mChar1=null,e.mChar2=null,e.mCurChar=null,e.mNextChar=null,e.mFarPosX=500,e.mCurShowTitle=u.BlackSmithTitle.Trainee,e.mIsMoving=!1,e.mMoveSpeed=.35,e}return r(e,t),e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mCurChar=this.mChar1,this.mNextChar=this.mChar2,this.mCurChar.node.x=0,this.mNextChar.node.x=this.mFarPosX,this.mNextChar.node.active=!1,this._SetData(this.mCurShowTitle)},e.prototype._SetData=function(t){this.mCurChar.SetData(t),this._UpadteUI()},e.prototype._UpadteUI=function(){this.mTitleLbl.string=l.default.Ins.GetForgeTitleStr(this.mCurShowTitle),this.mStarLbl.string=this.mCurShowTitle+"",this.mLhsArrowNode.active=this.mCurShowTitle!==u.BlackSmithTitle.Trainee,this.mRhsArrowNode.active=this.mCurShowTitle!==u.BlackSmithTitle.MAX},e.prototype._OnMoveCompleted=function(){this.mIsMoving=!1,this._UpadteUI(),this.mCurChar.node.active=!1;var t=this.mCurChar;this.mCurChar=this.mNextChar,this.mNextChar=t},e.prototype.Inovke_Close=function(){this.CloseWin()},e.prototype.Invoke_Left=function(){if(m.default.PlayBtnSound(),!this.mIsMoving){this.mIsMoving=!0;var t=this;this.mCurShowTitle--,this.mNextChar.SetData(this.mCurShowTitle),this.mNextChar.node.x=-this.mFarPosX,this.mNextChar.node.active=!0;var e=cc.moveTo(this.mMoveSpeed,cc.v2(this.mFarPosX,0)).easing(cc.easeCubicActionOut()),o=cc.moveTo(this.mMoveSpeed,cc.v2(0,0)).easing(cc.easeCubicActionOut());this.mCurChar.node.runAction(e),this.mNextChar.node.runAction(cc.sequence(o,cc.callFunc(function(){t._OnMoveCompleted()})))}},e.prototype.Invoke_Right=function(){if(m.default.PlayBtnSound(),!this.mIsMoving){this.mIsMoving=!0;var t=this;this.mCurShowTitle++,this.mNextChar.SetData(this.mCurShowTitle),this.mNextChar.node.x=this.mFarPosX,this.mNextChar.node.active=!0;var e=cc.moveTo(this.mMoveSpeed,cc.v2(-this.mFarPosX,0)).easing(cc.easeCubicActionOut()),o=cc.moveTo(this.mMoveSpeed,cc.v2(0,0)).easing(cc.easeCubicActionOut());this.mCurChar.node.runAction(e),this.mNextChar.node.runAction(cc.sequence(o,cc.callFunc(function(){t._OnMoveCompleted()})))}},i([d(cc.Label)],e.prototype,"mTitleLbl",void 0),i([d(cc.Label)],e.prototype,"mStarLbl",void 0),i([d(cc.Node)],e.prototype,"mLhsArrowNode",void 0),i([d(cc.Node)],e.prototype,"mRhsArrowNode",void 0),i([d(s.default)],e.prototype,"mChar1",void 0),i([d(s.default)],e.prototype,"mChar2",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Proxy/ProxyForge":"ProxyForge","../Comp/SmithCharacter":"SmithCharacter","./WinBase":"WinBase"}],SmithCharacter:[function(t,e,o){"use strict";cc._RF.push(e,"4319d+W2y5NO5cgr/sJCiFt","SmithCharacter");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/ResMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSmithSk=null,e.mSmithTitle=0,e}return r(e,t),e.prototype.SetData=function(t){if(this.mSmithTitle!==t){this.mSmithTitle=t,this.mSmithSk.skeletonData=null;var e=this;a.default.Ins.LoadSpine("spine/blacksmith/tiejiang_"+t,function(t){null!==e.mSmithSk&&(e.mSmithSk.skeletonData=t,e.mSmithSk.setAnimation(0,"animation",!0))})}},i([m(sp.Skeleton)],e.prototype,"mSmithSk",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/ResMgr":"ResMgr"}],SmithFailWin:[function(t,e,o){"use strict";cc._RF.push(e,"f46bb5ZphBD6oQL2xXN0QQB","SmithFailWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxySmith"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mRetainLbl=null,e.mItem=null,e.mCurSI=null,e}return r(e,t),e.prototype.SetData=function(t){this.mCurSI=t;var e=l.default.Ins.GetData(t.title,t.lv),o=Math.floor(.8*e.consume);this.mRetainLbl.string=o+""},e.prototype.Invoke_Giveup=function(){this.CloseWin()},e.prototype.Invoke_Retain=function(){d.default.PlayBtnSound(),h.default.WatchADForRewards(this._RetainADCallback.bind(this),m.ADUnitID.CommonVideoID_30,f.ADPoint.SmithStepFailRetainMat)},e.prototype._RetainADCallback=function(t){this.CloseWin();var e=l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv),o=Math.floor(.8*e.consume);p.default.Ins.UpdateItem(f.ItemType.ForgeExp,o),t&&p.default.Ins.GetADExtraRewards(),u.default.Ins.Open(f.WinType.GetRewardsWin,function(e){var n=e;t?n.SetDataWithADCoin(f.ItemType.ForgeExp,""+o):n.SetDataSingle(f.ItemType.ForgeExp,""+o)}),p.default.Ins.Save(),c.default.Dispatch(f.BCType.SmithWin_UpdateMat)},i([I(cc.Label)],e.prototype,"mRetainLbl",void 0),i([I(s.default)],e.prototype,"mItem",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxySmith":"ProxySmith","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],SmithForgePanel:[function(t,e,o){"use strict";cc._RF.push(e,"49705//ow9IWqWY8xYLlRhJ","SmithForgePanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyLargeNum"),s=t("../../Proxy/ProxyForge"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/GuideMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mNormalTag=null,e.mAdvTag=null,e.mMatSp=null,e.mMatSFArr=[],e.mMatNumLbl=null,e.mGoldNumLbl=null,e.mMat1Root=null,e.mMat2Root=null,e.mForgeRoot=null,e.mForgingStateRoot=null,e.mLeftTimeLbl=null,e.mCurForgeType=d.ForgeType.Normal,e.mCurSI=null,e}return r(e,t),e.prototype.SetData=function(t){this.mCurSI=t,this._UpdateMat(),this._UpdateForgeState()},e.prototype.Subscribe=function(){c.default.Subscribe(d.BCType.UpdateForgeTime,this._OnMsg_UpdateTime,this)},e.prototype.Remove=function(){c.default.Remove(d.BCType.UpdateForgeTime,this._OnMsg_UpdateTime,this)},e.prototype._UpdateMat=function(){var t=this.mCurSI.id;this.mMatSp.spriteFrame=this.mMatSFArr[t-1];var e=p.default.Ins.m_DB.blackSmithDB[this.mCurSI.title].matNum,o=new a.LargeNumber(e[0],e[1]),n=m.default.Ins.GetItemNum(d.ItemType.ImtForgeMat+t-1);this.mMatNumLbl.string=a.default.FormatNumber(n,0)+"/"+o.ToString(0);var r=m.default.Ins.GetItemNum(d.ItemType.Gold);this.mGoldNumLbl.string=r+"/"+s.default.Ins.mAdvForgeGold,this._UpdateMatPos()},e.prototype._UpdateForgeState=function(){this.mCurSI.forgeState===d.ForgeState.Idle?(this.mForgeRoot.active=!0,this.mForgingStateRoot.active=!1):(this.mForgeRoot.active=!1,this.mForgingStateRoot.active=!0,this.mLeftTimeLbl.string=f.default.FormatTimeBySeconds(this.mCurSI.leftTime))},e.prototype._UpdateTime=function(){this.mLeftTimeLbl.string=f.default.FormatTimeBySeconds(this.mCurSI.leftTime)},e.prototype._UpdateMatPos=function(){this.mCurForgeType===d.ForgeType.Normal?(this.mMat2Root.active=!1,this.mMat1Root.x=0):(this.mMat2Root.active=!0,this.mMat1Root.x=-100)},e.prototype._SetForgeType=function(t){this.mCurForgeType!==t&&(this.mCurForgeType=t,this.mNormalTag.opacity=0,this.mAdvTag.opacity=0),this.mCurForgeType===d.ForgeType.Normal?this.mNormalTag.opacity=255:this.mAdvTag.opacity=255,this._UpdateMatPos()},e.prototype._OnMsg_UpdateTime=function(){this._UpdateTime()},e.prototype.Invoke_NormalForge=function(){this._SetForgeType(d.ForgeType.Normal)},e.prototype.Invoke_AdvForge=function(){this._SetForgeType(d.ForgeType.Advance)},e.prototype.Invoke_Forge=function(){if(this.mCurSI.forgeState===d.ForgeState.Idle){var t=p.default.Ins.m_DB.blackSmithDB[this.mCurSI.title].matNum,e=new a.LargeNumber(t[0],t[1]).ToNormalNum();if(m.default.Ins.GetItemNum(d.ItemType.ImtForgeMat+this.mCurSI.id-1)<e)l.default.Ins.ShowTips("\u6253\u9020\u6750\u6599\u4e0d\u8db3\uff0c\u524d\u5f80 \u201c\u6311\u6218-\u9ec4\u5929\u79d8\u5883\u201d \u83b7\u53d6~");else if(this.mCurForgeType===d.ForgeType.Advance&&m.default.Ins.GetItemNum(d.ItemType.Gold)<s.default.Ins.mAdvForgeGold)l.default.Ins.ShowTips("\u5143\u5b9d\u4e0d\u8db3~");else{this.mCurSI.imtID=s.default.Ins.Forge(this.mCurSI.id,this.mCurForgeType),m.default.Ins.UpdateItem(d.ItemType.ImtForgeMat+this.mCurSI.id-1,-e),this.mCurForgeType===d.ForgeType.Advance&&m.default.Ins.UpdateItem(d.ItemType.Gold,-s.default.Ins.mAdvForgeGold);var o=s.default.Ins.GetForgeExp(this.mCurSI.id,this.mCurForgeType);m.default.Ins.UpdateItem(d.ItemType.ForgeExp,o),c.default.Dispatch(d.BCType.SmithWin_UpdateMat),l.default.Ins.Open(d.WinType.GetRewardsWin,function(t){var e=t;e.SetDataSingle(d.ItemType.ForgeExp,o+""),1===s.default.Ins.mForgeInfo.forgeTimes&&e.SetCloseCallback(function(){u.default.TriggerNextGuide(!0)})}),m.default.Ins.Save(),this._UpdateForgeState(),c.default.Dispatch(d.BCType.SmithWin_Forge,this.mCurSI)}}else l.default.Ins.ShowTips("\u6b63\u5728\u6253\u9020\u4e2d~")},i([g(cc.Node)],e.prototype,"mNormalTag",void 0),i([g(cc.Node)],e.prototype,"mAdvTag",void 0),i([g(cc.Sprite)],e.prototype,"mMatSp",void 0),i([g([cc.SpriteFrame])],e.prototype,"mMatSFArr",void 0),i([g(cc.Label)],e.prototype,"mMatNumLbl",void 0),i([g(cc.Label)],e.prototype,"mGoldNumLbl",void 0),i([g(cc.Node)],e.prototype,"mMat1Root",void 0),i([g(cc.Node)],e.prototype,"mMat2Root",void 0),i([g(cc.Node)],e.prototype,"mForgeRoot",void 0),i([g(cc.Node)],e.prototype,"mForgingStateRoot",void 0),i([g(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/GuideMgr":"GuideMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyForge":"ProxyForge","../../Proxy/ProxyLargeNum":"ProxyLargeNum"}],SmithLvNode:[function(t,e,o){"use strict";cc._RF.push(e,"46128RgKmNAhpm9xZVtueJU","SmithLvNode");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLvSp=null,e.mStarActiveAnim=null,e.mCallback=null,e.mTrainPanel=null,e}return r(e,t),e.prototype.Init=function(t){this.mTrainPanel=t,this.mStarActiveAnim.setEventListener(this._OnAnimEvent.bind(this)),this.mStarActiveAnim.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype._OnAnimEvent=function(t,e){"chuxian"==e.data.name&&(this.SetActive(!0),null!==this.mCallback&&(this.mCallback(),this.mCallback=null))},e.prototype._OnAnimCompleted=function(){this.mStarActiveAnim.node.active=!1},e.prototype.SetActive=function(t){this.mLvSp.spriteFrame=t?this.mTrainPanel.mFullSF:this.mTrainPanel.mEmptySF},e.prototype.PlayShowAnim=function(t){this.mStarActiveAnim.node.active=!0,this.mStarActiveAnim.setAnimation(0,"animation",!1),this.mCallback=t},i([l(cc.Sprite)],e.prototype,"mLvSp",void 0),i([l(sp.Skeleton)],e.prototype,"mStarActiveAnim",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],SmithStepPanel:[function(t,e,o){"use strict";cc._RF.push(e,"80b16l57mtI9oUfd2d/sWim","SmithStepPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxySmith"),s=t("../../Platform/PlatformBase"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/ResMgr"),p=t("../../Manager/BCMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/EnumsDefine"),f=t("../../Common/Common"),h=cc._decorator,y=h.ccclass,g=h.property,I=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mSuccessPanelNode=null,e.mFailPanelNode=null,e.mStepSk=null,e.mTilteSFArr=[],e.mAttr1Lbl=null,e.mAttr2Lbl=null,e.mGoldNumLbl=null,e.mQuanSk=null,e.mTitleSp=null,e.mConsumeLbl=null,e.mRetainLbl=null,e.mOKUpAnim=null,e.mOKBottomAnim=null,e.mFailUpAnim=null,e.mFailBottomAnim=null,e.mIsSuccess=!1,e.mCurSI=null,e.mInited=!1,e.mTrainPanel=null,e}return r(e,t),e.prototype.OpenPanel=function(t,e,o){if(this.node.active=!0,this.mCurSI=t,this.mIsSuccess=e,this.mTrainPanel=o,this.mSuccessPanelNode.active=!1,this.mFailPanelNode.active=!1,this.mInited||(this.mInited=!0,this.mStepSk.setCompleteListener(this._OnSpineAnimCompleted.bind(this)),this.mStepSk.setEventListener(this._OnSpineAnimEvent.bind(this))),this.mStepSk.node.active=!0,this.mStepSk.skeletonData)this.mStepSk.setAnimation(0,"animation",!1);else{var n=this;u.default.Ins.LoadSpine("spine/jinjieguocheng",function(t){null!==n.mStepSk&&(n.mStepSk.skeletonData=t,n.mStepSk.setAnimation(0,"animation",!1))})}c.default.PlaySFX(d.AudioName.UI_SmithStep),this.mQuanSk.node.active=!1},e.prototype._OnSpineAnimCompleted=function(){this.mIsSuccess?(this._ShowSuccessPanel(),p.default.Dispatch(d.BCType.SmithWin_UpdateTitle)):this._ShowFailPanel()},e.prototype._OnSpineAnimEvent=function(t,e){"huantu"==e.data.name&&this.mIsSuccess&&p.default.Dispatch(d.BCType.SmithWin_StepSucess,this.mCurSI)},e.prototype._ShowSuccessPanel=function(){var t=this;c.default.PlaySFX(d.AudioName.UI_UpgradeSuccess),this.mSuccessPanelNode.active=!0,this.mQuanSk.node.active=!0;var e=this;u.default.Ins.LoadSpine("spine/shengjichenggong",function(t){null!==e.mTrainPanel&&(e.mTrainPanel.mHintSk.skeletonData=t,e.mTrainPanel.mHintSk.setAnimation(0,"animation",!1))}),this.mTitleSp.spriteFrame=this.mTilteSFArr[this.mCurSI.title-1];var o=a.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv);this.mAttr1Lbl.string="\u89e3\u9501"+this.mCurSI.title+"\u661f\u795e\u5175\u5361\u6c60",this.mAttr2Lbl.string="\u795e\u5175\u6253\u9020\u5fc3\u5f97\u52a0\u6210 +"+o.forgeExpAdd+"%",this.mGoldNumLbl.string="+"+o.shareReward[1],this.mOKUpAnim.node.scale=0,this.mOKBottomAnim.node.scale=0,this.scheduleOnce(function(){t.mOKUpAnim.play("btnAppear",0)},.5),this.scheduleOnce(function(){t.mOKBottomAnim.play("btnAppear",0)},1)},e.prototype._ShowFailPanel=function(){var t=this;this.mFailPanelNode.active=!0;var e=a.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv);this.mConsumeLbl.string="\u5fc3\u5f97 -"+e.consume,this.mRetainLbl.string="+"+Math.floor(.8*e.consume),this.mFailUpAnim.node.scale=0,this.mFailBottomAnim.node.scale=0,this.scheduleOnce(function(){t.mFailUpAnim.play("btnAppear",0)},.5),this.scheduleOnce(function(){t.mFailBottomAnim.play("btnAppear",0)},1)},e.prototype.Invoke_Refuse=function(){c.default.PlayBtnSound(),this.node.active=!1},e.prototype.Invoke_GetRewards=function(){c.default.PlayBtnSound(),f.default.WatchADForRewards(this._RewardsADCallback.bind(this),s.ADUnitID.CommonVideoID_30,d.ADPoint.SmithStepSuccessGold)},e.prototype._RewardsADCallback=function(t){this.node.active=!1;var e=a.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv);m.default.Ins.UpdateItem(d.ItemType.Gold,e.shareReward[1]),t&&m.default.Ins.GetADExtraRewards(),l.default.Ins.Open(d.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(d.ItemType.Gold,e.shareReward[1]):n.SetDataSingle(d.ItemType.Gold,e.shareReward[1])}),m.default.Ins.Save()},e.prototype.Invoke_Retain=function(){c.default.PlayBtnSound(),f.default.WatchADForRewards(this._RetainADCallback.bind(this),s.ADUnitID.CommonVideoID_30,d.ADPoint.SmithStepFailRetainMat)},e.prototype._RetainADCallback=function(t){this.node.active=!1;var e=a.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv),o=Math.floor(.8*e.consume);m.default.Ins.UpdateItem(d.ItemType.ForgeExp,o),t&&m.default.Ins.GetADExtraRewards(),l.default.Ins.Open(d.WinType.GetRewardsWin,function(e){var n=e;t?n.SetDataWithADCoin(d.ItemType.ForgeExp,""+o):n.SetDataSingle(d.ItemType.ForgeExp,""+o)}),m.default.Ins.Save(),p.default.Dispatch(d.BCType.SmithWin_UpdateMat)},i([g(cc.Node)],e.prototype,"mSuccessPanelNode",void 0),i([g(cc.Node)],e.prototype,"mFailPanelNode",void 0),i([g(sp.Skeleton)],e.prototype,"mStepSk",void 0),i([g([cc.SpriteFrame])],e.prototype,"mTilteSFArr",void 0),i([g(cc.Label)],e.prototype,"mAttr1Lbl",void 0),i([g(cc.Label)],e.prototype,"mAttr2Lbl",void 0),i([g(cc.Label)],e.prototype,"mGoldNumLbl",void 0),i([g(sp.Skeleton)],e.prototype,"mQuanSk",void 0),i([g(cc.Sprite)],e.prototype,"mTitleSp",void 0),i([g(cc.Label)],e.prototype,"mConsumeLbl",void 0),i([g(cc.Label)],e.prototype,"mRetainLbl",void 0),i([g(cc.Animation)],e.prototype,"mOKUpAnim",void 0),i([g(cc.Animation)],e.prototype,"mOKBottomAnim",void 0),i([g(cc.Animation)],e.prototype,"mFailUpAnim",void 0),i([g(cc.Animation)],e.prototype,"mFailBottomAnim",void 0),i([y],e)}(cc.Component);o.default=I,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxySmith":"ProxySmith"}],SmithTrainPanel:[function(t,e,o){"use strict";cc._RF.push(e,"be106Za0RRCWa30Vyepk/g3","SmithTrainPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SmithStepPanel"),s=t("./SmithLvNode"),l=t("../../Proxy/ProxySmith"),m=t("../../Proxy/ProxyLargeNum"),u=t("../../Platform/PlatformBase"),p=t("../../Manager/WinMgr"),c=t("../../Manager/UserMgr"),d=t("../../Manager/ResMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mEmptySF=null,e.mFullSF=null,e.mStarRoot=null,e.mStarTemplate=null,e.mLhsLbl=null,e.mRhsLbl=null,e.mRateRT=null,e.mExpLbl=null,e.mBtnLbl=null,e.mHintSk=null,e.mStepPanel=null,e.mCurSI=null,e.mStarItemArr=[],e.mCellWidth=50,e.mWaitUpgrading=!1,e}return r(e,t),e.prototype.SetData=function(t){this.mCurSI=t,this.mWaitUpgrading=!1,this._UpdateStarNode(),this._UpdateUI(),this.mStepPanel.node.active=!1},e.prototype.Subscribe=function(){f.default.Subscribe(y.BCType.SmithWin_StepSucess,this._OnMsg_StepSuccess,this),f.default.Subscribe(y.BCType.SmithWin_UpdateMat,this._OnMsg_UpdateMat,this)},e.prototype.Remove=function(){f.default.Remove(y.BCType.SmithWin_StepSucess,this._OnMsg_StepSuccess,this),f.default.Remove(y.BCType.SmithWin_UpdateMat,this._OnMsg_UpdateMat,this)},e.prototype._UpdateUI=function(){var t=l.default.Ins.GetNextData(this.mCurSI.title,this.mCurSI.lv);this._UpdateForgeExpAdd(),this._UpdateSuccessRate(),void 0===t||(this._UpdateMatNum(),this._UpdateBtnLbl())},e.prototype._UpdateForgeExpAdd=function(){var t=l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv),e=l.default.Ins.GetNextData(this.mCurSI.title,this.mCurSI.lv);this.mLhsLbl.string="\u5fc3\u5f97\u52a0\u6210 +"+t.forgeExpAdd+"%",this.mRhsLbl.string=void 0===e?"\u606d\u559c\uff01\u5df2\u6ee1\u7ea7~":"\u5fc3\u5f97\u52a0\u6210 +"+e.forgeExpAdd+"%"},e.prototype._UpdateSuccessRate=function(){var t=.01*l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv).baseSuccess+this.mCurSI.addSuccess;t>=100&&(t=100),0===this.mCurSI.addSuccess?this.mRateRT.string="\u5347\u7ea7\u6210\u529f\u7387\uff1a"+t.toFixed(0)+"%":this.mRateRT.string="\u5347\u7ea7\u6210\u529f\u7387\uff1a"+t.toFixed(0)+"%<color=#00ff00>\uff08+"+this.mCurSI.addSuccess+"%\uff09</c>"},e.prototype._UpdateMatNum=function(){var t=l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv);this.mExpLbl.string=m.default.FormatNumber(c.default.Ins.GetItemNum(y.ItemType.ForgeExp),1)+"/"+m.default.FormatNumber(t.consume,1)},e.prototype._UpdateBtnLbl=function(){var t=l.default.Ins.GetStarCountByStep(this.mCurSI.title);this.mCurSI.lv===t?this.mBtnLbl.string="\u7a81\u7834":this.mBtnLbl.string="\u5347\u7ea7"},e.prototype._UpdateStarNode=function(){var t=l.default.Ins.GetStarCountByStep(this.mCurSI.title);0===this.mStarItemArr.length&&((r=this.mStarTemplate.getComponent(s.default)).Init(this),this.mStarItemArr.push(r));for(var e=0,o=this.mStarItemArr.length;e<o;++e)this.mStarItemArr[e].node.opacity=0;var n=this.mStarItemArr.length;for(e=1;e<=t;++e){if(e<=n)this.mStarItemArr[e-1].node.opacity=255;else{var r,i=cc.instantiate(this.mStarTemplate);(r=i.getComponent(s.default)).Init(this),this.mStarRoot.addChild(i),this.mStarItemArr.push(r)}e<=this.mCurSI.lv?this.mStarItemArr[e-1].SetActive(!0):this.mStarItemArr[e-1].SetActive(!1),this.mStarItemArr[e-1].node.setPosition((e-1)*this.mCellWidth-.5*(t-1)*this.mCellWidth,0)}},e.prototype._OnMsg_StepSuccess=function(){this._UpdateStarNode(),this._UpdateForgeExpAdd()},e.prototype._OnMsg_UpdateMat=function(){this._UpdateMatNum()},e.prototype.Invoke_UseMedicine=function(){h.default.PlayBtnSound(),.01*l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv).baseSuccess+this.mCurSI.addSuccess>=100?p.default.Ins.ShowTips("\u4e3b\u516c\uff0c\u6210\u529f\u7387\u5df2\u6ee1\uff0c\u5feb\u53bb\u5347\u7ea7\u5427~"):g.default.WatchADForRewards(this._ADCallback.bind(this),u.ADUnitID.CommonVideo,y.ADPoint.SmithUpgradeMedicine)},e.prototype._ADCallback=function(t){t&&(c.default.Ins.GetADExtraRewards(),p.default.Ins.Open(y.WinType.GetRewardsWin,function(t){t.SetDataWithADCoin(0,"1")})),l.default.Ins.UseMedicine(this.mCurSI.id),this._UpdateSuccessRate()},e.prototype.Invoke_Upgrade=function(){var t=this;if(!this.mWaitUpgrading)if(h.default.PlayBtnSound(),this.mCurSI.title!==y.BlackSmithTitle.MAX){var e=l.default.Ins.GetData(this.mCurSI.title,this.mCurSI.lv).consume;if(c.default.Ins.GetItemNum(y.ItemType.ForgeExp)<e)p.default.Ins.ShowTips("\u6750\u6599\u4e0d\u8db3\uff0c\u6253\u9020\u795e\u5175\u53ef\u4ee5\u83b7\u5f97\u5fc3\u5f97\u54e6~");else{var o=l.default.Ins.GetStarCountByStep(this.mCurSI.title);if(this.mCurSI.lv===o){var n=l.default.Ins.Upgrade(this.mCurSI,!0);this.mStepPanel.OpenPanel(this.mCurSI,n,this)}else{n=l.default.Ins.Upgrade(this.mCurSI,!1);var r=this;n?(this.mWaitUpgrading=!0,this.mStarItemArr[this.mCurSI.lv-1].PlayShowAnim(function(){r.mWaitUpgrading=!1,d.default.Ins.LoadSpine("spine/shengjichenggong",function(t){null!==r.mHintSk&&(r.mHintSk.skeletonData=t,r.mHintSk.setAnimation(0,"animation",!1),h.default.PlaySFX(y.AudioName.UI_UpgradeSuccess),f.default.Dispatch(y.BCType.SmithWin_UpdateTitle))})}),h.default.PlaySFX(y.AudioName.UI_UpgradeStar)):(d.default.Ins.LoadSpine("spine/shengjishibai",function(t){null!==r.mHintSk&&(r.mHintSk.skeletonData=t,r.mHintSk.setAnimation(0,"animation",!1),h.default.PlaySFX(y.AudioName.UI_UpgradeFailed))}),this.mWaitUpgrading=!0,this.scheduleOnce(function(){t.mWaitUpgrading=!1,p.default.Ins.Open(y.WinType.SmithFailWin,function(t){t.SetData(r.mCurSI)})},1))}this._UpdateSuccessRate(),this._UpdateMatNum(),this._UpdateBtnLbl(),this._UpdateForgeExpAdd()}}else p.default.Ins.ShowTips("\u606d\u559c\uff01\u8be5\u94c1\u5320\u5df2\u7ecf\u7a81\u7834\u5230\u6700\u9ad8\u54c1\u9636\u5566~")},i([_(cc.SpriteFrame)],e.prototype,"mEmptySF",void 0),i([_(cc.SpriteFrame)],e.prototype,"mFullSF",void 0),i([_(cc.Node)],e.prototype,"mStarRoot",void 0),i([_(cc.Node)],e.prototype,"mStarTemplate",void 0),i([_(cc.Label)],e.prototype,"mLhsLbl",void 0),i([_(cc.Label)],e.prototype,"mRhsLbl",void 0),i([_(cc.RichText)],e.prototype,"mRateRT",void 0),i([_(cc.Label)],e.prototype,"mExpLbl",void 0),i([_(cc.Label)],e.prototype,"mBtnLbl",void 0),i([_(sp.Skeleton)],e.prototype,"mHintSk",void 0),i([_(a.default)],e.prototype,"mStepPanel",void 0),i([S],e)}(cc.Component);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxySmith":"ProxySmith","./SmithLvNode":"SmithLvNode","./SmithStepPanel":"SmithStepPanel"}],SmithWin:[function(t,e,o){"use strict";cc._RF.push(e,"8f981Ox0G1G46AtNBH4ZOpg","SmithWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SmithTrainPanel"),l=t("../Comp/SmithForgePanel"),m=t("../Comp/MyToggleGroup"),u=t("../../Proxy/ProxyForge"),p=t("../../Manager/WinMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/BCMgr"),f=t("../../Manager/AudioMgr"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mForgePanel=null,e.mTrainPanel=null,e.mToggleGroup=null,e.mTitleLbl=null,e.mSmithSk=null,e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mCurSmithID=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mToggleGroup.Init(),this._OnMsg_ClickToggle(0,!0),this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&y.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mMask.once(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype.SetData=function(t){var e=u.default.Ins.GetBSmithSI(t);if(this.mCurSmithID!==t){this.mCurSmithID=t,this.mSmithSk.skeletonData=null;var o=this;c.default.Ins.LoadSpine("spine/blacksmith/tiejiang_"+e.title,function(t){null!==o.mSmithSk&&(o.mSmithSk.skeletonData=t,o.mSmithSk.setAnimation(0,"animation",!0))})}this.mForgePanel.SetData(e),this.mTrainPanel.SetData(e),this._UpdateCommonUI(t)},e.prototype._UpdateCommonUI=function(t){var e=u.default.Ins.GetBSmithSI(t);e.title===h.BlackSmithTitle.MAX?this.mTitleLbl.string=u.default.Ins.GetForgeTitleStr(e.title)+"MAX":this.mTitleLbl.string=u.default.Ins.GetForgeTitleStr(e.title)+"Lv."+e.lv},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),d.default.Subscribe(h.BCType.ToggleGroup_SmithWin,this._OnMsg_ClickToggle,this),d.default.Subscribe(h.BCType.SmithWin_StepSucess,this._OnMsg_UpadteSmithSk,this),d.default.Subscribe(h.BCType.SmithWin_UpdateTitle,this._OnMsg_UpdateTitle,this),this.mForgePanel.Subscribe(),this.mTrainPanel.Subscribe()},e.prototype._Remove=function(){t.prototype._Remove.call(this),d.default.Remove(h.BCType.ToggleGroup_SmithWin,this._OnMsg_ClickToggle,this),d.default.Remove(h.BCType.SmithWin_StepSucess,this._OnMsg_UpadteSmithSk,this),d.default.Remove(h.BCType.SmithWin_UpdateTitle,this._OnMsg_UpdateTitle,this),this.mForgePanel.Remove(),this.mTrainPanel.Remove()},e.prototype._OnMsg_ClickToggle=function(t,e){switch(void 0===e&&(e=!1),e||f.default.PlayBtnSound(),t){case 0:this.mTrainPanel.node.active=!1,this.mForgePanel.node.active=!0;break;case 1:this.mForgePanel.node.active=!1,this.mTrainPanel.node.active=!0}this.mToggleGroup.UpdateToggleBtnState(t)},e.prototype._OnMsg_UpadteSmithSk=function(){var t=this,e=u.default.Ins.GetBSmithSI(this.mCurSmithID);c.default.Ins.LoadSpine("spine/blacksmith/tiejiang_"+e.title,function(e){null!==t.mSmithSk&&(t.mSmithSk.skeletonData=e,t.mSmithSk.setAnimation(0,"animation",!0))})},e.prototype._OnMsg_UpdateTitle=function(){this._UpdateCommonUI(this.mCurSmithID)},e.prototype.Invoke_ShowPicture=function(){p.default.Ins.Open(h.WinType.SmithBookWin,function(){})},e.prototype.Invoke_Close=function(){this.CloseWin()},i([S(l.default)],e.prototype,"mForgePanel",void 0),i([S(s.default)],e.prototype,"mTrainPanel",void 0),i([S(m.default)],e.prototype,"mToggleGroup",void 0),i([S(cc.Label)],e.prototype,"mTitleLbl",void 0),i([S(sp.Skeleton)],e.prototype,"mSmithSk",void 0),i([S(cc.Node)],e.prototype,"mCloseBtn",void 0),i([S(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyForge":"ProxyForge","../Comp/MyToggleGroup":"MyToggleGroup","../Comp/SmithForgePanel":"SmithForgePanel","../Comp/SmithTrainPanel":"SmithTrainPanel","./WinBase":"WinBase"}],StarSuccessWin:[function(t,e,o){"use strict";cc._RF.push(e,"abaf1gkujJAq4xTxiwqPgCo","StarSuccessWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Proxy/ProxyHero"),l=t("../../Manager/ResMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=cc._decorator,c=p.ccclass,d=p.property,f=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mStarSFArr=[],e.mLhsStarSp=null,e.mRhsStarSp=null,e.mPreAtkLbl=null,e.mCurAtkLbl=null,e.mPreDefLbl=null,e.mCurDefLbl=null,e.mPreHpLbl=null,e.mCurHpLbl=null,e.mSkillSp=null,e.mSkillTypeTag=[],e.mSkillNameLbl=null,e.mTitleSk=null,e.mEnableClose=!1,e}return r(e,t),e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mEnableClose=!1,this.scheduleOnce(function(){e.mEnableClose=!0},.5),m.default.PlaySFX(u.AudioName.UI_GetRewards,!0),this.mTitleSk.setAnimation(0,"shengxingchenggong",!1)},e.prototype._OnEvent_ClickMask=function(){this.mEnableClose&&this.CloseWin()},e.prototype.SetData=function(t,e,o,n){var r=s.default.Ins.GetHeroAtk(t),i=s.default.Ins.GetHeroDef(t),a=s.default.Ins.GetHeroHP(t);this.mCurAtkLbl.string=r.ToString(),this.mCurDefLbl.string=i.ToString(),this.mCurHpLbl.string=a.ToString(),this.mPreAtkLbl.string=e,this.mPreDefLbl.string=o,this.mPreHpLbl.string=n;var m=s.default.Ins.GetHeroSI(t).starLv;this.mLhsStarSp.spriteFrame=this.mStarSFArr[m-2],this.mRhsStarSp.spriteFrame=this.mStarSFArr[m-1],2===m?(this.mSkillTypeTag[0].opacity=255,this.mSkillTypeTag[1].opacity=0):(this.mSkillTypeTag[0].opacity=0,this.mSkillTypeTag[1].opacity=255),l.default.Ins.LoadHeroSkillSp(t,m,this.mSkillSp);var u=s.default.Ins.GetHeroSkillData(t,m);this.mSkillNameLbl.string=u.name},e.prototype.Invoke_Close=function(){m.default.PlayBtnSound(),this._OnEvent_ClickMask()},i([d([cc.SpriteFrame])],e.prototype,"mStarSFArr",void 0),i([d(cc.Sprite)],e.prototype,"mLhsStarSp",void 0),i([d(cc.Sprite)],e.prototype,"mRhsStarSp",void 0),i([d(cc.Label)],e.prototype,"mPreAtkLbl",void 0),i([d(cc.Label)],e.prototype,"mCurAtkLbl",void 0),i([d(cc.Label)],e.prototype,"mPreDefLbl",void 0),i([d(cc.Label)],e.prototype,"mCurDefLbl",void 0),i([d(cc.Label)],e.prototype,"mPreHpLbl",void 0),i([d(cc.Label)],e.prototype,"mCurHpLbl",void 0),i([d(cc.Sprite)],e.prototype,"mSkillSp",void 0),i([d([cc.Node])],e.prototype,"mSkillTypeTag",void 0),i([d(cc.Label)],e.prototype,"mSkillNameLbl",void 0),i([d(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([c],e)}(a.default);o.default=f,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero","./WinBase":"WinBase"}],SwitchConfig:[function(t,e,o){"use strict";cc._RF.push(e,"ad661drlvxObbBpiThvg77E","SwitchConfig"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./EnumsDefine"),r=function(){function t(){}return t.InitData=function(){},t.mClearInfo=!1,t.mGuideOpen=!0,t.mNeedLimitADCoin=!0,t.mADCoinLimitNum=20,t.mAllHero=!1,t.mAllImmortal=!1,t.mNeedComic=!1,t.mMainTaskID=0,t.mBackCityTimes=1,t.mForceGetRewardsType=n.GetRewardsType.AD,t.mCurPlatformType="Local",t}();o.default=r,cc._RF.pop()},{"./EnumsDefine":"EnumsDefine"}],TeamActiveSkillIcon:[function(t,e,o){"use strict";cc._RF.push(e,"73403vwmN1EEbiwWSATLsRg","TeamActiveSkillIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyImtSkill"),s=t("../../Manager/ResMgr"),l=t("../../Manager/AudioMgr"),m=cc._decorator,u=m.ccclass,p=m.property,c=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCampSp=null,e.mIcon=null,e.mEmptyNode=null,e.mSkillID=-1,e}return r(e,t),e.prototype.SetData=function(t){this.mSkillID!==t&&(this.mSkillID=t,0===t?(this.mEmptyNode.opacity=255,this.mCampSp.node.opacity=0,this.mIcon.node.opacity=0):(this.mEmptyNode.opacity=0,this.mCampSp.node.opacity=255,this.mIcon.node.opacity=255,s.default.Ins.LoadImtSkillSp(t,this.mIcon)))},e.prototype.Invoke_Click=function(){l.default.PlayBtnSound(),0!==this.mSkillID&&a.default.Ins.PutOffSkill(this.mSkillID)},i([p(cc.Sprite)],e.prototype,"mCampSp",void 0),i([p(cc.Sprite)],e.prototype,"mIcon",void 0),i([p(cc.Node)],e.prototype,"mEmptyNode",void 0),i([u],e)}(cc.Component);o.default=c,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyImtSkill":"ProxyImtSkill"}],TeamHeroIcon:[function(t,e,o){"use strict";cc._RF.push(e,"284b473sXVMEq3ZX02qFpSl","TeamHeroIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyHero"),s=t("../../Manager/ResMgr"),l=t("../../Manager/DataMgr"),m=t("../../Manager/AudioMgr"),u=t("../../Common/EnumsDefine"),p=t("../../Common/Common"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mQualitySp=null,e.mSPTag=null,e.mIcon=null,e.mStarSp=null,e.mNameLbl=null,e.mMedalLbl=null,e.mCanUpgradeStarTag=null,e.mNewTag=null,e.mHeroSI=null,e.mCallback=null,e.mData=null,e.mCurHeroID=0,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){},e.prototype.OnReturned=function(){},e.prototype.SetData=function(t){this.mCurHeroID=t,this._SetAllShow(),this.mHeroSI=a.default.Ins.GetHeroSI(t),this.mData=l.default.Ins.m_DB.heroCardDB[t],s.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mQualitySp,null),s.default.Ins.LoadHeroSkinItemSprite(t,this.mIcon),s.default.Ins.LoadHeroStarSprite(this.mHeroSI.starLv,this.mStarSp),this.mNameLbl.string=this.mData.name,this.mMedalLbl.node.opacity=0===this.mHeroSI.medalLv?0:255,this.mMedalLbl.string="+"+this.mHeroSI.medalLv,this.mSPTag.opacity=this.mHeroSI.heroQuality==u.HeroQuality.SP?255:0,this.mNameLbl.node.color=p.default.GetQualityColor(Number(this.mHeroSI.heroQuality))},e.prototype.SetCallback=function(t){void 0===t&&(t=null),this.mCallback=t},e.prototype._SetAllShow=function(){this.mStarSp.node.opacity=255,this.mNameLbl.node.opacity=255,this.mMedalLbl.node.opacity=255,this.mNewTag.opacity=255},e.prototype.SetEmpty=function(){this.mIcon.node.opacity=0,this.mStarSp.node.opacity=0,this.mNameLbl.node.opacity=0,this.mMedalLbl.node.opacity=0,this.mCanUpgradeStarTag.opacity=0,this.mNewTag.opacity=0},e.prototype.SetTeamHeroDefaultUI=function(){this.mMedalLbl.node.opacity=this.mHeroSI.medalLv>0?255:0,this.mNewTag.opacity=0},e.prototype.UpdateOnPutoff=function(){this.mMedalLbl.node.opacity=0},e.prototype.UpdateOnUpgradeMedalLv=function(){this.mMedalLbl.node.opacity=this.mHeroSI.medalLv>0?255:0,this.mMedalLbl.string="+"+this.mHeroSI.medalLv},e.prototype.UpdateOnUpgradeStarLv=function(){s.default.Ins.LoadHeroStarSprite(this.mHeroSI.starLv,this.mStarSp)},e.prototype.UpdateOnUpgradeQuality=function(){s.default.Ins.LoadHeroQualitySprite(this.mHeroSI.heroQuality,this.mQualitySp,null),this.mSPTag.opacity=this.mHeroSI.heroQuality==u.HeroQuality.SP?255:0},e.prototype.UpdateOnChangeSkin=function(){s.default.Ins.LoadHeroSkinItemSprite(this.mCurHeroID,this.mIcon)},e.prototype.Invoke_Click=function(){m.default.PlayBtnSound(),null!==this.mCallback&&this.mCallback()},i([f(cc.Sprite)],e.prototype,"mQualitySp",void 0),i([f(cc.Node)],e.prototype,"mSPTag",void 0),i([f(cc.Sprite)],e.prototype,"mIcon",void 0),i([f(cc.Sprite)],e.prototype,"mStarSp",void 0),i([f(cc.Label)],e.prototype,"mNameLbl",void 0),i([f(cc.Label)],e.prototype,"mMedalLbl",void 0),i([f(cc.Node)],e.prototype,"mCanUpgradeStarTag",void 0),i([f(cc.Node)],e.prototype,"mNewTag",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/ResMgr":"ResMgr","../../Proxy/ProxyHero":"ProxyHero"}],TeamSkillIcon:[function(t,e,o){"use strict";cc._RF.push(e,"0bee0rjyc9IiYFt5QrJ/JAG","TeamSkillIcon");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyImtSkill"),s=t("../../Proxy/ProxyImmortal"),l=t("../../Manager/WinMgr"),m=t("../../Manager/ResMgr"),u=t("../../Manager/AudioMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mCampSp=null,e.mIcon=null,e.mSkillID=-1,e.mBlackColor=new cc.Color(150,150,150,255),e}return r(e,t),e.prototype.SetData=function(t){this.mSkillID=t,m.default.Ins.LoadImtSkillSp(t,this.mIcon),this.UpdateState()},e.prototype.UpdateState=function(){for(var t=s.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e)if(t[e]===this.mSkillID)return this.mCampSp.node.color=this.mBlackColor,void(this.mIcon.node.color=this.mBlackColor);this.mCampSp.node.color=cc.Color.WHITE,this.mIcon.node.color=cc.Color.WHITE},e.prototype.Invoke_Click=function(){u.default.PlayBtnSound();for(var t=s.default.Ins.mImmortalInfo.curSkillArr,e=0,o=t.length;e<o;++e)if(t[e]===this.mSkillID)return;if(-1!==a.default.Ins.GetEmptySkillIdx())a.default.Ins.PutOnSkill(this.mSkillID),this.UpdateState();else{if(t.length===a.default.Ins.MAX_SKILL_COUNT)return;l.default.Ins.Open(p.WinType.AddSkillPosWin,function(t){t.SetData()})}},i([f(cc.Sprite)],e.prototype,"mCampSp",void 0),i([f(cc.Sprite)],e.prototype,"mIcon",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/ResMgr":"ResMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyImmortal":"ProxyImmortal","../../Proxy/ProxyImtSkill":"ProxyImtSkill"}],TimeMgr:[function(t,e,o){"use strict";cc._RF.push(e,"ed0eeEQmFVMyqYQ2KIKkjES","TimeMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./UserMgr"),r=t("./SaveMgr"),i=t("./PlatformMgr"),a=t("./BCMgr"),s=t("../Proxy/ProxyTurntable"),l=t("../Proxy/ProxySpeed"),m=t("../Proxy/ProxyImtSkill"),u=t("../Proxy/ProxyImtBoss"),p=t("../Proxy/ProxyForge"),c=t("../Proxy/ProxyExplore"),d=t("../Proxy/ProxyCrystal"),f=t("../Proxy/ProxyCDBtn"),h=t("../Common/GameRunningData"),y=t("../Common/EnumsDefine"),g=function(){function t(){}return t.GetServerTime=function(){return this.mServerTime+((new Date).getTime()-this.mGameStartTime)},t.GetServerTimeInSeconds=function(){return Math.floor(.001*this.GetServerTime())},t.SetServerTime=function(t){this.mServerTime=t,this.mGameStartTime=(new Date).getTime()},t.InitLeftTimeOnLogin=function(e){var o=new Date(e),n=o.getHours(),r=o.getMinutes(),i=o.getSeconds();t.mTodayLeftTime=86400-3600*n-60*r-i},t.OnUpdate=function(e){this.mUpdateTimer-=e,this.mUpdateTimer<=0&&(this.mUpdateTimer=this.mUpdateInternal,this.mTodayLeftTime--,this.mTodayLeftTime<=0&&(this.mTodayLeftTime=86400,n.default.Ins.RefreshNewDay(!1)),this.mLastLeftTime=this.mTodayLeftTime,l.default.Ins.OnUpdate(this.mUpdateInternal),d.default.Ins.OnUpdate(this.mUpdateInternal),p.default.Ins.UpdateOnForging(this.mUpdateInternal),u.default.Ins.OnUpdate(this.mUpdateInternal),m.default.Ins.OnUpdate(this.mUpdateInternal),s.default.Ins.OnUpdate(),c.default.Ins.UpdateOnExploring(this.mUpdateInternal),f.default.Ins.OnUpdate(),h.default.Ins.CheckAutoTemplateInterTime(this.mUpdateInternal),a.default.Dispatch(y.BCType.Common_OnSecondsPassed),this.mUpdateTimer5-=this.mUpdateInternal,this.mUpdateTimer5<=0&&(this.mUpdateTimer5=this.mUpdateInternal5,t._ExecuteOnTime5()),this._CheckInterstitialAD(this.mUpdateInternal))},t._ExecuteOnTime5=function(){var e=this.GetServerTime();t.InitLeftTimeOnLogin(e),this.mTodayLeftTime>this.mLastLeftTime+100&&(n.default.Ins.RefreshNewDay(!1),this.mLastLeftTime=this.mTodayLeftTime),r.default.Save(r.default.LOCAL_OFFLINE_TIME,e)},t._CheckInterstitialAD=function(t){i.default.mCurPlf.AutoInterstitialAD&&n.default.Ins.ClientInfo.bestLevel>9&&(this.mInterADCountTime-=t,this.mInterADCountTime<=0&&(this.mInterADCountTime=this.mInterADWaitTime,i.default.mCurPlf.ShowInterstitial("","")))},t.mGameStartTime=0,t.mLastLogoutTime=0,t.mServerTime=0,t.mTodayLeftTime=86400,t.mUpdateInternal=1,t.mUpdateTimer=1,t.mUpdateInternal5=5,t.mUpdateTimer5=5,t.mLastLeftTime=0,t.mInterADWaitTime=120,t.mInterADCountTime=120,t}();o.default=g,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/GameRunningData":"GameRunningData","../Proxy/ProxyCDBtn":"ProxyCDBtn","../Proxy/ProxyCrystal":"ProxyCrystal","../Proxy/ProxyExplore":"ProxyExplore","../Proxy/ProxyForge":"ProxyForge","../Proxy/ProxyImtBoss":"ProxyImtBoss","../Proxy/ProxyImtSkill":"ProxyImtSkill","../Proxy/ProxySpeed":"ProxySpeed","../Proxy/ProxyTurntable":"ProxyTurntable","./BCMgr":"BCMgr","./PlatformMgr":"PlatformMgr","./SaveMgr":"SaveMgr","./UserMgr":"UserMgr"}],TipPanel:[function(t,e,o){"use strict";cc._RF.push(e,"5ee06Iv1QhNKa4l5aaQ4yJj","TipPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_ContentLbl=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype.SetData=function(t){this.m_ContentLbl.string=t},e.prototype.Return=function(){a.default.Ins.Return(this)},i([m(cc.Label)],e.prototype,"m_ContentLbl",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr"}],TipsWin:[function(t,e,o){"use strict";cc._RF.push(e,"968d1G4giFC5KVbuqO7CYu3","TipsWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/PoolMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTipRoot=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this)},e.prototype.Show=function(t,e){var o=this;void 0===e&&(e=!1);var n=this,r=s.default.TIP_PANEL;e&&(r=s.default.AD_TIP_PANEL),s.default.Ins.Borrow(r,"TipPanel",function(e){e.node.opacity=255,e.node.setParent(n.mTipRoot),e.node.setPosition(0,0),e.node.scale=1.5,o.node.opacity=255,e.SetData(t);var r=cc.sequence(cc.scaleTo(.16,1).easing(cc.easeBackOut()),cc.delayTime(1.5),cc.spawn(cc.fadeTo(.35,10),cc.moveBy(.45,cc.v2(0,80)).easing(cc.easeSineIn())));e.node.runAction(cc.sequence(r,cc.callFunc(function(){e.Return()})))})},i([u(cc.Node)],e.prototype,"mTipRoot",void 0),i([m],e)}(a.default);o.default=p,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr","./WinBase":"WinBase"}],TouchEfxPanel:[function(t,e,o){"use strict";cc._RF.push(e,"f6d5bAzju5CWLKEIeqLPqhp","TouchEfxPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.onLoad=function(){this.node.on(cc.Node.EventType.TOUCH_END,this._TouchEnd,this),this.node._touchListener.setSwallowTouches(!1)},e.prototype._TouchEnd=function(t){var e=this.node.convertToNodeSpaceAR(t.getLocation()),o=this;a.default.Ins.Borrow(a.default.EFX_PATH_ROOT+"touchEfx","UIEfxBase",function(t){var n=t.node;n.parent!==o.node&&(n.parent=o.node),n.position=cc.v3(e)})},i([l],e)}(cc.Component));o.default=m,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr"}],TurntableAccRewardsWin:[function(t,e,o){"use strict";cc._RF.push(e,"e7288IOTqRGLKi1q7Fjju76","TurntableAccRewardsWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/AccRewardItem"),l=t("../../Proxy/ProxyTurntable"),m=t("../../Manager/UserMgr"),u=t("../../Manager/BCMgr"),p=t("../../Common/EnumsDefine"),c=t("../../Common/Common"),d=cc._decorator,f=d.ccclass,h=d.property,y=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAccTimsLbl=null,e.mLeftTimeLbl=null,e.mItemRoot=null,e.mTemplate=null,e.mItemArr=[],e.mOriPosY=-25,e.mCellHeight=90,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this);for(var e=l.default.Ins.mAccRewardsInfoArr,o=1;o<=e.length;++o){if(1===o)this.mItemArr.push(this.mTemplate);else{var n=cc.instantiate(this.mTemplate.node);n.parent=this.mItemRoot;var r=n.getComponent(s.default);this.mItemArr.push(r)}this.mItemArr[o-1].SetData(o),this.mItemArr[o-1].node.position=cc.v3(0,this.mOriPosY-this.mCellHeight*(o-1))}this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask.bind(this),this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mLeftTimeLbl.string=c.default.FormatTimeBySeconds(l.default.Ins.mAccCounterTime),this._OnMsg_RefreshOnNewDay()},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),u.default.Subscribe(p.BCType.Turntadble_AccLeftTime,this._OnMsg_UpdateTime,this),u.default.Subscribe(p.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),u.default.Remove(p.BCType.Turntadble_AccLeftTime,this._OnMsg_UpdateTime,this),u.default.Remove(p.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype._OnMsg_UpdateTime=function(t){this.mLeftTimeLbl.string=c.default.FormatTimeBySeconds(t)},e.prototype._OnMsg_RefreshOnNewDay=function(){for(var t=l.default.Ins.mAccRewardsInfoArr,e=1;e<=t.length;++e)this.mItemArr[e-1].UpdateState(e);this.mAccTimsLbl.string=m.default.Ins.ClientInfo.turntableInfo.accTimesCycle+""},i([h(cc.Label)],e.prototype,"mAccTimsLbl",void 0),i([h(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([h(cc.Node)],e.prototype,"mItemRoot",void 0),i([h(s.default)],e.prototype,"mTemplate",void 0),i([f],e)}(a.default);o.default=y,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyTurntable":"ProxyTurntable","../Comp/AccRewardItem":"AccRewardItem","./WinBase":"WinBase"}],TurntableInsWin:[function(t,e,o){"use strict";cc._RF.push(e,"d1898fF3PpCaYvHPwpG1hCd","TurntableInsWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickMask,this)},e.prototype._OnEvent_ClickMask=function(){this.CloseWin()},i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./WinBase":"WinBase"}],TurntableWin:[function(t,e,o){"use strict";cc._RF.push(e,"8b470/lx39H54YaJVGSfSSg","TurntableWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../Comp/ItemDetailPanel"),m=t("../../Proxy/ProxyTurntable"),u=t("../../Proxy/ProxyLargeNum"),p=t("../../Manager/WinMgr"),c=t("../../Manager/UserMgr"),d=t("../../Manager/DataMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mFreeBtnNode=null,e.mFreeTimesLbl=null,e.mCoinBtnNode=null,e.mCoinLbl=null,e.mTableRoot=null,e.mItemArr=[],e.mBoxLbl=null,e.mBoxAnim=null,e.mLuckyBar=null,e.mLuckyScoreLbl=null,e.mItemDetailPanel=null,e.mAnglesArr=null,e.mTargetAngle=0,e.mTargetSectorID=0,e.mIsTurning=!1,e.mCount=0,e.mSp=0,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mAnglesArr=[];for(var e=1;e<=8;++e)this.mAnglesArr.push(-45*(e-1));this.mIsTurning=!1,this.SetItemUI()},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.UpdateUIAfterTurn()},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),f.default.Subscribe(y.BCType.SimpleItem_TouchStart,this._OnMsg_OnItemTouchStart,this),f.default.Subscribe(y.BCType.SimpleItem_TouchEnd,this._OnMsg_OnItemTouchEnd,this),f.default.Subscribe(y.BCType.SimpleItem_TouchCancel,this._OnMsg_OnItemTouchCancel,this),f.default.Subscribe(y.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),f.default.Remove(y.BCType.SimpleItem_TouchStart,this._OnMsg_OnItemTouchStart,this),f.default.Remove(y.BCType.SimpleItem_TouchEnd,this._OnMsg_OnItemTouchEnd,this),f.default.Remove(y.BCType.SimpleItem_TouchCancel,this._OnMsg_OnItemTouchCancel,this),f.default.Remove(y.BCType.Common_RefreshOnNewDay,this._OnMsg_RefreshOnNewDay,this)},e.prototype.SetItemUI=function(){for(var t=0,e=this.mItemArr.length;t<e;++t){var o=d.default.Ins.m_DB.turntableDB[t+1],n=o.reward[0],r=o.reward[1];n===y.ItemType.Medal&&(r=u.default.FormatNumber(c.default.Ins.GetMedalNum(r),1)),this.mItemArr[t].SetData(n,r,!0)}},e.prototype.UpdateUIAfterTurn=function(){var t=c.default.Ins.ClientInfo.turntableInfo;this.mLuckyScoreLbl.string=t.luckyScore+"",this.mLuckyBar.progress=t.luckyScore/m.default.Ins.mTotalLuckySocre;var e=m.default.Ins.mAccRewardsInfoArr.length;if(t.hasGotBoxCount>=e){this.mBoxAnim.stop(),this.mBoxAnim.node.y=0,this.mBoxAnim.node.angle=0;var o=t.accTimesCycle,n=m.default.Ins.mAccRewardsInfoArr[e-1][0];this.mBoxLbl.string=o+"/"+n}else o=t.accTimesCycle,n=m.default.Ins.mAccRewardsInfoArr[t.hasGotBoxCount][0],this.mBoxLbl.string=o+"/"+n,o>=n?this.mBoxAnim.play():(this.mBoxAnim.stop(),this.mBoxAnim.node.y=0,this.mBoxAnim.node.angle=0);t.leftFreeTimes<=0?(this.mFreeBtnNode.active=!1,this.mCoinBtnNode.active=!0,this.mCoinLbl.string=c.default.Ins.GetItemNum(y.ItemType.TurnCoin)+"/1"):(this.mFreeBtnNode.active=!0,this.mCoinBtnNode.active=!1,this.mFreeTimesLbl.string="\u4eca\u65e5\u5269\u4f59\u6b21\u6570\uff1a"+t.leftFreeTimes)},e.prototype.update=function(){if(this.mCount>0){var t=!1;this.mCount>260?this.mSp*=1.1:this.mCount>220?this.mSp*=.92:this.mSp<=5?(this.mSp*=.995,t=!0):this.mSp*=.97;var e=this.mTableRoot.angle%360;t&&this.mTargetAngle<e&&e-this.mSp<=this.mTargetAngle?(this.mTableRoot.angle=this.mTargetAngle,this.mCount=0,this._EndTurn()):(this.mTableRoot.angle-=this.mSp,this.mCount--)}},e.prototype._RealTurn=function(){this.mTargetSectorID=m.default.Ins.GetRandSector(),this._StartTurn(this.mTargetSectorID)},e.prototype._StartTurn=function(t){this.mIsTurning=!0,this.mCount=300,this.mSp=5,this.mTargetAngle=this.mAnglesArr[t-1]-g.default.GetRandValueBetween(10,35)},e.prototype._EndTurn=function(){var t=this,e=this;this.scheduleOnce(function(){e.mIsTurning=!1,m.default.Ins.AfterTurntable(),m.default.Ins.GetRewards(e.mTargetSectorID),t.UpdateUIAfterTurn(),f.default.Dispatch(y.BCType.Activity_SetMaskState,!1)},.3)},e.prototype._OnMsg_OnItemTouchStart=function(t,e){this.mItemDetailPanel.SetData(t),this.mItemDetailPanel.node.opacity=255;var o=this.mItemDetailPanel.node.parent.convertToNodeSpaceAR(e);this.mItemDetailPanel.node.position=o.add(cc.v3(0,100,0));var n=.5*this.mItemDetailPanel.node.width,r=.5*-g.default.DESIGN_WIDTH+n,i=.5*g.default.DESIGN_WIDTH-n;this.mItemDetailPanel.node.x=g.default.Clamp(this.mItemDetailPanel.node.x,r,i)},e.prototype._OnMsg_OnItemTouchEnd=function(){this.mItemDetailPanel.node.opacity=0},e.prototype._OnMsg_OnItemTouchCancel=function(){this.mItemDetailPanel.node.opacity=0},e.prototype._OnMsg_RefreshOnNewDay=function(){this.UpdateUIAfterTurn()},e.prototype.Invoke_BoxRewards=function(){var t=c.default.Ins.ClientInfo.turntableInfo,e=m.default.Ins.mAccRewardsInfoArr.length;t.hasGotBoxCount<e&&t.accTimesCycle>=m.default.Ins.mAccRewardsInfoArr[t.hasGotBoxCount][0]?(m.default.Ins.GetAccBoxRewards(),this.UpdateUIAfterTurn()):p.default.Ins.Open(y.WinType.TurntableAccRewardsWin,null)},e.prototype.Invoke_Turn=function(){if(h.default.PlayBtnSound(),!this.mIsTurning)if(c.default.Ins.ClientInfo.turntableInfo.leftFreeTimes<=0&&c.default.Ins.GetItemNum(y.ItemType.TurnCoin)<=0){var t=this;p.default.Ins.Open(y.WinType.FreeRewardWin,function(e){e.SetData("\u6b23\u8d4f\u4e00\u6bb5\u89c6\u9891\uff0c\u514d\u8d39\u83b7\u5f97\u5956\u52b1~",y.ItemType.TurnCoin,m.default.Ins.GetADForCoinNum(),null,function(){c.default.Ins.ClientInfo.turntableInfo.leftADTimes--,t.mCoinLbl.string=c.default.Ins.GetItemNum(y.ItemType.TurnCoin)+"/1",c.default.Ins.Save(),m.default.Ins.CheckRedPoint()},c.default.Ins.ClientInfo.turntableInfo.leftADTimes)})}else f.default.Dispatch(y.BCType.Activity_SetMaskState,!0),this._RealTurn()},e.prototype.Invoke_Instruction=function(){h.default.PlayBtnSound(),p.default.Ins.Open(y.WinType.TurntableInsWin,null)},i([_(cc.Node)],e.prototype,"mFreeBtnNode",void 0),i([_(cc.Label)],e.prototype,"mFreeTimesLbl",void 0),i([_(cc.Node)],e.prototype,"mCoinBtnNode",void 0),i([_(cc.Label)],e.prototype,"mCoinLbl",void 0),i([_(cc.Node)],e.prototype,"mTableRoot",void 0),i([_([s.default])],e.prototype,"mItemArr",void 0),i([_(cc.Label)],e.prototype,"mBoxLbl",void 0),i([_(cc.Animation)],e.prototype,"mBoxAnim",void 0),i([_(cc.ProgressBar)],e.prototype,"mLuckyBar",void 0),i([_(cc.Label)],e.prototype,"mLuckyScoreLbl",void 0),i([_(l.default)],e.prototype,"mItemDetailPanel",void 0),i([S],e)}(a.default);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyLargeNum":"ProxyLargeNum","../../Proxy/ProxyTurntable":"ProxyTurntable","../Comp/ItemDetailPanel":"ItemDetailPanel","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],TwoThreeThreePlf:[function(t,e,o){"use strict";cc._RF.push(e,"16fe8FF/Q5OVojCGLVv/7VG","TwoThreeThreePlf");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("../Proxy/ProxyTask"),a=t("../Manager/WinMgr"),s=t("../Manager/SaveMgr"),l=t("../Manager/PlatformMgr"),m=t("../Common/SwitchConfig"),u=t("../Common/EnumsDefine"),p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.AutoInterstitialAD=function(){return!0},e.prototype.NeedShowPrivacy=function(){return!0},e.prototype.Login=function(t){var e,o=cc.sys.localStorage.getItem("233id"),n=0;o?(e=o,n=0):(e=Math.floor(1e4*Math.random())+"-"+(new Date).getTime(),cc.sys.localStorage.setItem("233id",e),n=1,l.default.ReportEvent(u.BIPoint.Guide_NewPlayer));var r=(new Date).getTime(),i=s.default.Get(s.default.LOCAL_OFFLINE_TIME);i&&(r=i),t({ret:0,isNewUser:1===n,systemTime:(new Date).getTime(),lastLogoutTime:r/1e3}),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","Login","(Ljava/lang/String;Ljava/lang/String;)V",""+e,""+n)},e.prototype.Register=function(){},e.prototype.ReportPay=function(){},e.prototype.ReportEvent=function(){},e.prototype.ReportLevel=function(){},e.prototype.WatchAd=function(t,e,o,n,r){void 0===r&&(r=null),m.default.mForceGetRewardsType!==u.GetRewardsType.Direct?(window.videoResult=function(t){"101"==t||(o("1"==t),r&&r()),"201"==t?i.default.Ins.UpdateTaskProgress(i.DailyTaskType.VideoClick,1):"1001"==t&&a.default.Ins.ShowTips("\u4e09\u56fd\u7ebf\u8def\u62e5\u5835\uff0c\u8bf71\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u5427\uff0c\u5956\u52b1\u4f1a\u66f4\u591a\u54e6\uff01",!0)},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowAd","(Ljava/lang/String;)V",t)):(o&&o(!0),r&&r())},e.prototype.Share=function(t){t&&t(!0)},e.prototype.ShowBanner=function(){},e.prototype.HideBanner=function(){},e.prototype.RefreshBanner=function(){},e.prototype.ShowInterstitial=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowInterstitial","()V")},e.prototype.ReportTrackingEvent=function(){},e.prototype.ReportHuoShanEvent=function(t,e){void 0===e&&(e=null)},e.prototype.AgreePrivacy=function(){},e}(t("./PlatformBase").default);o.default=p,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/WinMgr":"WinMgr","../Proxy/ProxyTask":"ProxyTask","./PlatformBase":"PlatformBase"}],UIEfxBase:[function(t,e,o){"use strict";cc._RF.push(e,"50d2cKy7rFCz75hWvbbjjQ4","UIEfxBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/PoolMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.m_Skeleton=null,e}return r(e,t),e.prototype.OnSpawned=function(t){this.mKey=t,null!==this.m_Skeleton&&this.m_Skeleton.setCompleteListener(this._OnAnimCompleted.bind(this))},e.prototype.OnBeforeBorrow=function(){},e.prototype.OnAfterBorrow=function(){this.node.opacity=255,this.m_Skeleton.setAnimation(0,"animation",!1)},e.prototype.OnReturned=function(){this.node.opacity=0},e.prototype._OnAnimCompleted=function(){a.default.Ins.Return(this)},i([m(sp.Skeleton)],e.prototype,"m_Skeleton",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/PoolMgr":"PoolMgr"}],UnlockFuncPanel:[function(t,e,o){"use strict";cc._RF.push(e,"749ac6sjl9BXbUuqmwxWNiR","UnlockFuncPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/FuncMgr"),s=cc._decorator,l=s.ccclass,m=s.property,u=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLevelLbl=null,e.mFuncLbl=null,e.mCurFuncID=-1,e}return r(e,t),e.prototype.SetData=function(t){var e=a.default.GetNextUnlockFuncData(t);null===e?this.node.active=!1:this.mCurFuncID!==e.Id&&(this.mLevelLbl.string="\u7b2c"+e.unlockCondition+"\u5173",this.mFuncLbl.string="\u89e3\u9501"+e.name,this.mCurFuncID=e.Id)},i([m(cc.Label)],e.prototype,"mLevelLbl",void 0),i([m(cc.Label)],e.prototype,"mFuncLbl",void 0),i([l],e)}(cc.Component);o.default=u,cc._RF.pop()},{"../../Manager/FuncMgr":"FuncMgr"}],UnlockLevelLuxuryWin:[function(t,e,o){"use strict";cc._RF.push(e,"4b0dfQr9PZOTKVPCQMPMhtt","UnlockLevelLuxuryWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/AudioMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTitleSk=null,e.mEnableClose=!1,e}return r(e,t),e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mEnableClose=!1,this.scheduleOnce(function(){e.mEnableClose=!0},.5),this.mTitleSk.setAnimation(0,"gongxijiesuo",!1)},e.prototype._OnEvent_ClickMask=function(){this.mEnableClose&&this.CloseWin()},e.prototype.Invoke_Close=function(){s.default.PlayBtnSound(),this._OnEvent_ClickMask()},i([u(sp.Skeleton)],e.prototype,"mTitleSk",void 0),i([m],e)}(a.default);o.default=p,cc._RF.pop()},{"../../Manager/AudioMgr":"AudioMgr","./WinBase":"WinBase"}],UserMgr:[function(t,e,o){"use strict";cc._RF.push(e,"37d7bYMl45CRbvc87C8qS4W","UserMgr"),Object.defineProperty(o,"__esModule",{value:!0}),o.SelfObjMap=o.SelfMap=o.ClientInfo=o.GamerInfo=void 0;var n=t("./TimeMgr"),r=t("./SaveMgr"),i=t("./PlatformMgr"),a=t("./BCMgr"),s=t("../Proxy/ProxyWork"),l=t("../Proxy/ProxyVIP"),m=t("../Proxy/ProxyTurntable"),u=t("../Proxy/ProxyTask"),p=t("../Proxy/ProxySkin"),c=t("../Proxy/ProxySign"),d=t("../Proxy/ProxyShop"),f=t("../Proxy/ProxySevenDays"),h=t("../Proxy/ProxyOffline"),y=t("../Proxy/ProxyOffice"),g=t("../Proxy/ProxyMainTask2"),I=t("../Proxy/ProxyLottery"),S=t("../Proxy/ProxyLevelReward"),_=t("../Proxy/ProxyLargeNum"),v=t("../Proxy/ProxyImtBoss"),C=t("../Proxy/ProxyImmortal"),M=t("../Proxy/ProxyHeroMap"),P=t("../Proxy/ProxyHero"),T=t("../Proxy/ProxyFreeGoldAct"),D=t("../Proxy/ProxyForge"),A=t("../Proxy/ProxyExplore"),O=t("../Proxy/ProxyBattleBox"),k=t("../Proxy/ProxyBackCity"),B=t("../Proxy/ProxyAllSP"),b=t("../Common/SwitchConfig"),R=t("../Common/EnumsDefine"),L=t("../Common/Common"),F=function(){this.clientInfo=null};o.GamerInfo=F;var x=function(){this.hasLookComic=!1,this.passedGuideLevel=!1,this.accVideoCount=0,this.curLevel=1,this.bestLevel=1,this.bag=null,this.lottery=null,this.levelReward=null,this.sevenDays=null,this.vip=null,this.imtBossLevel=null,this.hasOpenedChallengeWin=!1,this.battleGoldBoxLeftCount=0,this.hasShownBackCityInstructionWin=!1,this.gameDay=0,this.hasGotSecondDayGift=!1,this.freeGoldActInfo=null,this.turntableInfo=null,this.signInfo=null,this.allSPInfo=null,this.skinInfo=null,this.useCrystalItems=0,this.hasOpenedSecondDayWin=!1,this.plotID=0,this.guideID=-2,this.hasShownFailWin=!1,this.todayADCoinFromAD=0,this.reachedECPM80=!1,this.reachedECPM100=!1,this.reportedECPM80Times5=!1,this.reportedECPM80Times10=!1,this.reportedECPM80Times15=!1,this.reportedECPM100Times5=!1,this.reportedECPM100Times10=!1,this.reportedECPM100Times15=!1,this.reachedECPM150=!1,this.reachedECPM200=!1,this.reportedECPM150Times5=!1,this.reportedECPM150Times10=!1,this.reportedECPM150Times15=!1,this.reportedECPM200Times5=!1,this.reportedECPM200Times10=!1,this.reportedECPM200Times15=!1,this.firstGameTime=0,this.arpu=0,this.curCheckArpuArrIdx=0,this.recentECPMArr=[],this.hasReportedEventArr=[],this.ipu=0};o.ClientInfo=x;var N=function(){function t(){this.NEED_REPORT_ARPU_ARR=[.5,1,1.5,2,2.5,3],this.ARPU_REPORT_ARR=[R.HuoShanEventType.ARPU_0_5,R.HuoShanEventType.ARPU_1,R.HuoShanEventType.ARPU_1_5,R.HuoShanEventType.ARPU_2,R.HuoShanEventType.ARPU_2_5,R.HuoShanEventType.ARPU_3],this.mGamerInfo=null,this.mCoin=null,this.mMedal=null,this.mCrystal=0,this.mIsNewGamer=!1}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),t.prototype.OnUpdate=function(){t.mSaveFlag&&(t._RealSave(),t.mSaveFlag=!1),t.mSaveCoin&&(t._RealSaveCoin(),t.mSaveCoin=!1),t.mSaveCrystal&&(t._RealSaveCrystal(),t.mSaveCrystal=!1),y.default.Ins.OnUpdate(),P.default.Ins.OnUpdate(),s.default.Ins.OnUpdate(),k.default.Ins.OnUpdate(),C.default.Ins.OnUpdate(),D.default.Ins.OnUpdate(),u.default.Ins.OnUpdate(),d.default.Ins.OnUpdate(),g.default.Ins.OnUpdate(),M.default.Ins.OnUpdate(),A.default.Ins.OnUpdate()},t._RealSave=function(){var e=JSON.stringify(t.Ins.mGamerInfo.clientInfo);r.default.Save(r.default.GAMER_INFO,e)},t._RealSaveCoin=function(){var e=JSON.stringify(t.Ins.mCoin);r.default.Save(r.default.GOLD,e)},t.prototype.Save=function(e){void 0===e&&(e=!1),e?t._RealSave():t.mSaveFlag=!0},t.prototype.SaveCoin=function(e){void 0===e&&(e=!1),e?t._RealSaveCoin():t.mSaveCoin=!0},t.prototype.AddCoin=function(e){t.mIns.mCoin.AddSelf(e),this.SaveCoin(),a.default.Dispatch(R.BCType.Common_ChangeCoin)},t.prototype.MinusCoin=function(e){t.mIns.mCoin.MinusSelf(e),this.SaveCoin(),a.default.Dispatch(R.BCType.Common_ChangeCoin)},t.prototype.IsCoinEnough=function(e){return t.mIns.mCoin.Compare(e)>=0},t.prototype.SaveCrystal=function(e){void 0===e&&(e=!1),e?t._RealSaveCrystal():t.mSaveCrystal=!0},t._RealSaveCrystal=function(){var e=JSON.stringify(t.Ins.mCrystal);r.default.Save(r.default.CRYSTAL_INFO,e)},t.prototype.SyncGamerInfo=function(e,o){if(void 0===o&&(o=!1),this.mIsNewGamer=e.isNewUser,this.mIsNewGamer||o)t.Ins.mGamerInfo=t.Ins.CreateDefaultInfo(),t.Ins.mCoin=t.Ins.CreateDefaultCoin(),t.Ins.mCrystal=t.Ins.CreateDefaultCrystal(),y.default.Ins.CreateDefaulInfo(),C.default.Ins.CreateDefaultInfo(),D.default.Ins.CreateDefaultInfo(),k.default.Ins.CreateDefaultInfo(),P.default.Ins.CreateDefaultHeroInfo(),s.default.Ins.CreateDefaultWorkInfo(),u.default.Ins.CreateDefaultHeroInfo(),d.default.Ins.CreateDefaultInfo(),g.default.Ins.CreateDefaultInfo(),M.default.Ins.CreateDefaultInfo(),A.default.Ins.CreateDefaultInfo(),r.default.ClearInfo(),b.default.InitData(),this.Save(!0),this.SaveCoin(!0),this.SaveCrystal(!0),y.default.Ins.Save(!0),P.default.Ins.Save(!0),s.default.Ins.Save(!0),k.default.Ins.Save(!0),C.default.Ins.Save(!0),D.default.Ins.Save(!0),u.default.Ins.Save(!0),d.default.Ins.Save(!0),g.default.Ins.Save(!0),M.default.Ins.Save(!0),A.default.Ins.Save(!0);else{console.log("\u4f7f\u7528\u5b58\u6863");var i=r.default.Get(r.default.GAMER_INFO);t.Ins.mGamerInfo=new F,t.Ins.mGamerInfo.clientInfo=JSON.parse(i);var a=r.default.Get(r.default.GOLD);t.Ins.mCoin=JSON.parse(a);var c=r.default.Get(r.default.CRYSTAL_INFO);t.Ins.mCrystal=JSON.parse(c),this._HandleSelfMap(),y.default.Ins.SyncInfo(),C.default.Ins.SyncInfo(),D.default.Ins.SyncInfo(),k.default.Ins.SyncSaveInfo(),P.default.Ins.SyncHeroInfo(),s.default.Ins.SyncWorkInfo(),u.default.Ins.SyncInfo(),d.default.Ins.SyncInfo(),g.default.Ins.SyncInfo(),M.default.Ins.SyncInfo(),A.default.Ins.SyncInfo();var f=r.default.Get(r.default.LOCAL_OFFLINE_TIME);f&&(n.default.mLastLogoutTime=Number(f))}l.default.Ins.ConvertToAttr(),p.default.Ins.ConvertToAttr(),I.default.Ins.InitDynamicHeroArr(),this._HandleOfflineTime();var h=this.GetLastLogoutTime(),S=n.default.GetServerTime();L.default.IsAnotherDay(h,S)&&this.RefreshNewDay(),this.Save(!0),P.default.Ins.Save(!0),C.default.Ins.Save(!0),D.default.Ins.Save(!0),n.default.InitLeftTimeOnLogin(S),m.default.Ins.HandleTime()},t.prototype._HandleSelfMap=function(){this.mGamerInfo.clientInfo.bag=new G(this.mGamerInfo.clientInfo.bag.obj),this.mGamerInfo.clientInfo.allSPInfo&&(this.mGamerInfo.clientInfo.allSPInfo.taskInfoMap=new w(this.mGamerInfo.clientInfo.allSPInfo.taskInfoMap.obj)),t.Ins.mCoin=new _.LargeNumber(t.Ins.mCoin.mBaseValue,t.Ins.mCoin.mExpoValue)},t.prototype.GetLastLogoutTime=function(){return n.default.mLastLogoutTime},t.prototype.GetOfflineTimeByLimits=function(t){var e=this.GetOfflineTime(),o=3600*t;return e>o?o:e},t.prototype.GetOfflineTime=function(){if(this.mIsNewGamer)return 0;var t=n.default.GetServerTime(),e=this.GetLastLogoutTime();return 0===e?0:Math.floor(.001*Math.max(0,t-e))},t.prototype._HandleOfflineTime=function(){var t=n.default.GetServerTime(),e=Math.floor(.001*t),o=this.GetOfflineTime();s.default.Ins.HandleOfflineTime(e,o),h.default.Ins.HandleOfflineTime(e,o),D.default.Ins.HandleOfflineTime(e,o),v.default.Ins.HandleOfflineTime(e,o),A.default.Ins.HandleOfflineTime(e,o),r.default.Save(r.default.LOCAL_OFFLINE_TIME,t)},t.prototype.RefreshNewDay=function(t){void 0===t&&(t=!0),this.ClientInfo.battleGoldBoxLeftCount=O.default.Ins.mBattleGoldBoxCount,this.ClientInfo.gameDay++,this.ClientInfo.todayADCoinFromAD=0,console.log("POLAR_GAME:  \u7b2c\u51e0\u5929: "+this.ClientInfo.gameDay),2===this.ClientInfo.gameDay&&i.default.mCurPlf.ReportHuoShanEvent(R.HuoShanEventType.DAY_2),I.default.Ins.RefreshOnNewDay(),f.default.Ins.RefreshOnNewDay(t),T.default.Ins.RefreshOnNewDay(t),m.default.Ins.RefreshOnNewDay(t),c.default.Ins.RefreshOnNewDay(t),u.default.Ins.RefreshOnNewDay(t),d.default.Ins.RefreshOnNewDay(t),y.default.Ins.RefreshOnNewDay(t),a.default.Dispatch(R.BCType.Common_RefreshOnNewDay)},t.prototype.GetDay=function(){return(new Date).getDay()},t.prototype.CreateDefaultInfo=function(){var t=new F,e=new x;return e.bag=new G(null),e.bag.Set(R.ItemType.TurnCoin,2),e.bag.Set(R.ItemType.ImtForgeMat+0,100),e.bag.Set(R.ItemType.ForgeExp,800),e.bag.Set(R.ItemType.Awake,1),e.bag.Set(R.ItemType.MultipleCrystal,3),e.bag.Set(R.ItemType.SpeedUp2,2),e.bag.Set(R.ItemType.MopTicket,2),e.lottery=new I.LotterySaveInfo,e.levelReward=new S.LevelRewardSaveInfo,e.battleGoldBoxLeftCount=O.default.Ins.mBattleGoldBoxCount,e.sevenDays=new f.SevenDaysSaveInfo,e.vip=new l.VIPSaveInfo,e.imtBossLevel=new v.ImtBossLevelInfo,e.freeGoldActInfo=new T.FreeGoldActInfo,e.turntableInfo=new m.TurntableInfo,e.signInfo=new c.SignSaveInfo,e.allSPInfo=new B.AllSPActSaveInfo,e.skinInfo=new p.SkinSaveInfo,e.firstGameTime=n.default.GetServerTimeInSeconds(),t.clientInfo=e,t},t.prototype.CreateDefaultCoin=function(){return new _.LargeNumber(10,0).Normalize()},t.prototype.CreateDefaultCrystal=function(){return 0},Object.defineProperty(t.prototype,"ClientInfo",{get:function(){return this.mGamerInfo.clientInfo},enumerable:!1,configurable:!0}),t.prototype.GetItemNum=function(t){if(t===R.ItemType.Crystal)return this.mCrystal;var e=this.ClientInfo.bag.Get(t);return void 0===e?0:e},t.prototype.GetADExtraRewards=function(){b.default.mNeedLimitADCoin&&(t.Ins.ClientInfo.todayADCoinFromAD++,t.Ins.Save()),(!b.default.mNeedLimitADCoin||t.Ins.ClientInfo.todayADCoinFromAD<=b.default.mADCoinLimitNum)&&t.Ins.UpdateItem(R.ItemType.ADCoin,1),t.Ins.UpdateItem(R.ItemType.VIPExp,l.default.Ins.mOnceADExp,l.VIPExpFromType.AD)},t.prototype.UpdateItem=function(t,e,o){if(void 0===o&&(o=l.VIPExpFromType.None),t===R.ItemType.Crystal)this.mCrystal+=e;else{var n=this.ClientInfo.bag,r=n.Get(t);void 0===r?n.Set(t,e):n.Set(t,r+e),t===R.ItemType.VIPExp&&l.default.Ins.OnGetVipExp(e,o)}a.default.Dispatch(R.BCType.Common_UpdateItem,t)},t.prototype.UpdateConfigItem=function(t,e,o){void 0===o&&(o=l.VIPExpFromType.None);var n=this.GetConfigItemNum(t,e);return this.UpdateItem(t,n,o),n},t.prototype.GetConfigItemNum=function(t,e){var o=e;return t===R.ItemType.Medal?o=Math.floor(this.GetMedalNum(e)):t===R.ItemType.ForgeExp&&(o=Math.floor(D.default.Ins.GetBaseForgeExp()*e)),o},t.prototype.BackCity=function(){t.mIns.mCoin.mBaseValue=0,t.mIns.mCoin.mExpoValue=0,this.ClientInfo.curLevel=1,this.Save(),t.Ins.SaveCoin(),a.default.Dispatch(R.BCType.Common_ChangeCoin)},t.prototype.GetMedalNum=function(t){var e=k.default.Ins.GetBestLevelGetMedalSpeed(),o=Math.floor(60*h.default.Ins.mOfflinePassLevelSpeed)*e*t;return Math.floor(o)},t.prototype.CheckTodayADCoinFull=function(){return this.ClientInfo.todayADCoinFromAD>=b.default.mADCoinLimitNum},t.mIns=null,t.mSaveFlag=!1,t.mSaveCoin=!1,t.mSaveCrystal=!1,t}();o.default=N;var G=function(){function t(t){this.obj={},t&&(this.obj=t)}return t.prototype.Get=function(t){return this.obj.hasOwnProperty(t)?this.obj[t]:0},t.prototype.Set=function(t,e){this.obj[t]=e},t.prototype.Remove=function(t){delete this.obj[t]},t.prototype.Has=function(t){return this.obj.hasOwnProperty(t)},t}();o.SelfMap=G;var w=function(){function t(t){this.obj={},t&&(this.obj=t)}return t.prototype.Get=function(t){return this.obj.hasOwnProperty(t)?this.obj[t]:null},t.prototype.Set=function(t,e){this.obj[t]=e},t.prototype.Remove=function(t){delete this.obj[t]},t.prototype.Has=function(t){return this.obj.hasOwnProperty(t)},t.prototype.GetSize=function(){var t=0;for(var e in this.obj)this.obj.hasOwnProperty(e)&&t++;return t},t}();o.SelfObjMap=w,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Proxy/ProxyAllSP":"ProxyAllSP","../Proxy/ProxyBackCity":"ProxyBackCity","../Proxy/ProxyBattleBox":"ProxyBattleBox","../Proxy/ProxyExplore":"ProxyExplore","../Proxy/ProxyForge":"ProxyForge","../Proxy/ProxyFreeGoldAct":"ProxyFreeGoldAct","../Proxy/ProxyHero":"ProxyHero","../Proxy/ProxyHeroMap":"ProxyHeroMap","../Proxy/ProxyImmortal":"ProxyImmortal","../Proxy/ProxyImtBoss":"ProxyImtBoss","../Proxy/ProxyLargeNum":"ProxyLargeNum","../Proxy/ProxyLevelReward":"ProxyLevelReward","../Proxy/ProxyLottery":"ProxyLottery","../Proxy/ProxyMainTask2":"ProxyMainTask2","../Proxy/ProxyOffice":"ProxyOffice","../Proxy/ProxyOffline":"ProxyOffline","../Proxy/ProxySevenDays":"ProxySevenDays","../Proxy/ProxyShop":"ProxyShop","../Proxy/ProxySign":"ProxySign","../Proxy/ProxySkin":"ProxySkin","../Proxy/ProxyTask":"ProxyTask","../Proxy/ProxyTurntable":"ProxyTurntable","../Proxy/ProxyVIP":"ProxyVIP","../Proxy/ProxyWork":"ProxyWork","./BCMgr":"BCMgr","./PlatformMgr":"PlatformMgr","./SaveMgr":"SaveMgr","./TimeMgr":"TimeMgr"}],VIPDescItem:[function(t,e,o){"use strict";cc._RF.push(e,"d105a4g+npHgobsEk4UjgT3","VIPDescItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Proxy/ProxyVIP"),s=t("../../Manager/UserMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mTitleLbl=null,e.mNumLbl=null,e.mCurVIPLv=0,e.mCurAttrType=a.VIPAttrType.None,e.mCurNum=0,e}return r(e,t),e.prototype.SetData=function(t,e){var o=s.default.Ins.ClientInfo.vip.lv;o===this.mCurVIPLv&&this.mCurAttrType===t&&this.mCurNum===e||(this.mCurVIPLv=o,this.mCurAttrType=t,this.mCurNum=e,this._UpdateUI())},e.prototype._UpdateUI=function(){var t=this;this.mTitleLbl.string=a.default.Ins.GetAttrDesc(this.mCurAttrType),this.mNumLbl.string=a.default.Ins.GetValueStr(this.mCurAttrType,this.mCurNum),this.scheduleOnce(function(){t.mNumLbl.node.x=t.mTitleLbl.node.width+t.mTitleLbl.node.x},.1)},i([u(cc.Label)],e.prototype,"mTitleLbl",void 0),i([u(cc.Label)],e.prototype,"mNumLbl",void 0),i([m],e)}(cc.Component);o.default=p,cc._RF.pop()},{"../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyVIP":"ProxyVIP"}],VIPGiftWin:[function(t,e,o){"use strict";cc._RF.push(e,"4cf24L1GM9GkYwL2cKpT1r5","VIPGiftWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/SimpleItem"),l=t("../../Proxy/ProxyVIP"),m=t("../../Platform/PlatformBase"),u=t("../../Manager/WinMgr"),p=t("../../Manager/UserMgr"),c=t("../../Manager/AudioMgr"),d=t("../../Common/SwitchConfig"),f=t("../../Common/EnumsDefine"),h=t("../../Common/Common"),y=cc._decorator,g=y.ccclass,I=y.property,S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mItemArr=[],e.mBackNode=null,e}return r(e,t),e.prototype._OnFirstOpen=function(){var e=this;t.prototype._OnFirstOpen.call(this);for(var o=l.default.Ins.mVIPGiftRewards,n=0,r=this.mItemArr.length;n<r;++n)this.mItemArr[n].SetData(o[n][0],""+p.default.Ins.GetConfigItemNum(o[n][0],o[n][1]));this.mBackNode.active=!1,this.scheduleOnce(function(){e.mBackNode.active=!0},h.default.BACK_BTN_SHOW_DELAY_TIME)},e.prototype.Invoke_Close=function(){c.default.PlayBtnSound(),this.CloseWin()},e.prototype.Invoke_GetRewards=function(){c.default.PlayBtnSound(),h.default.WatchADForRewards(this._Callback.bind(this),m.ADUnitID.CommonVideoID_30,f.ADPoint.VIPGift)},e.prototype._Callback=function(t){t&&p.default.Ins.GetADExtraRewards(),l.default.Ins.GetVIPGift();for(var e=[],o=l.default.Ins.mVIPGiftRewards,n=0,r=this.mItemArr.length;n<r;++n){var i=p.default.Ins.GetConfigItemNum(o[n][0],o[n][1]);p.default.Ins.UpdateItem(o[n][0],i,l.VIPExpFromType.Gift),e.push([o[n][0],i])}u.default.Ins.Open(f.WinType.GetRewardsWin,function(o){var n=o;t&&((!d.default.mNeedLimitADCoin||p.default.Ins.ClientInfo.todayADCoinFromAD<=d.default.mADCoinLimitNum)&&e.push([f.ItemType.ADCoin+"",1]),e.push([f.ItemType.VIPExp+"",l.default.Ins.mOnceADExp])),n.SetData(e)}),p.default.Ins.Save(),this.CloseWin()},i([I([s.default])],e.prototype,"mItemArr",void 0),i([I(cc.Node)],e.prototype,"mBackNode",void 0),i([g],e)}(a.default);o.default=S,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Common/SwitchConfig":"SwitchConfig","../../Manager/AudioMgr":"AudioMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyVIP":"ProxyVIP","../Comp/SimpleItem":"SimpleItem","./WinBase":"WinBase"}],VIPReward:[function(t,e,o){"use strict";cc._RF.push(e,"254ccLlb69DrofadHfML3XN","VIPReward");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./SimpleItem"),s=t("../../Proxy/ProxyVIP"),l=t("../../Manager/WinMgr"),m=t("../../Manager/UserMgr"),u=t("../../Manager/DataMgr"),p=t("../../Common/EnumsDefine"),c=cc._decorator,d=c.ccclass,f=c.property,h=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mAnim=null,e.mHasGotNode=null,e.mItem=null,e.mCurIdx=0,e.mCurItemID=0,e.mCurItemData=null,e}return r(e,t),e.prototype.SetData=function(t){this.mCurIdx=t,this.mCurItemID=s.default.Ins.mVIPRewards[t],this.mCurItemData=u.default.Ins.m_DB.itemDB[this.mCurItemID],this.mItem.SetData(this.mCurItemID,"1",!1,!0)},e.prototype.UpdateState=function(){if(s.default.Ins.CheckHasGotVIPReward(this.mCurIdx))this.mAnim.stop(),this.mAnim.node.angle=0,this.mAnim.node.y=0,this.mHasGotNode.opacity=255;else{this.mHasGotNode.opacity=0;var t=s.default.Ins.mVIPReawardLvArr[this.mCurIdx];m.default.Ins.ClientInfo.vip.lv>=t?this.mAnim.play():(this.mAnim.stop(),this.mAnim.node.angle=0,this.mAnim.node.y=0)}},e.prototype.Invoke_Click=function(){if(!s.default.Ins.CheckHasGotVIPReward(this.mCurIdx)){var t=s.default.Ins.mVIPReawardLvArr[this.mCurIdx];if(m.default.Ins.ClientInfo.vip.lv>=t)return void s.default.Ins.GetVIPReward(this.mCurIdx)}var e=this;this.mCurItemData.itemType===p.ItemType.Immortal?l.default.Ins.Open(p.WinType.ImtDetailWin,function(t){t.SetData(e.mCurItemID)}):this.mCurItemData.itemType===p.ItemType.HeroSkin&&l.default.Ins.Open(p.WinType.SkinPreviewWin,function(t){t.SetData(e.mCurItemID)})},i([f(cc.Animation)],e.prototype,"mAnim",void 0),i([f(cc.Node)],e.prototype,"mHasGotNode",void 0),i([f(a.default)],e.prototype,"mItem",void 0),i([d],e)}(cc.Component);o.default=h,cc._RF.pop()},{"../../Common/EnumsDefine":"EnumsDefine","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Proxy/ProxyVIP":"ProxyVIP","./SimpleItem":"SimpleItem"}],VIPUpgradeWin:[function(t,e,o){"use strict";cc._RF.push(e,"9da87SJI8JLerI4COGQqLOY","VIPUpgradeWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../../Manager/UserMgr"),l=cc._decorator,m=l.ccclass,u=l.property,p=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mVIPSp=null,e.mSFArr=[],e}return r(e,t),e.prototype._OnOpen=function(){var e=this;t.prototype._OnOpen.call(this),this.mVIPSp.spriteFrame=this.mSFArr[s.default.Ins.ClientInfo.vip.lv-1];var o=cc.tween;this.mTweenAnimRoot.opacity=0,this.mTweenAnimRoot.position=cc.v3(0,-280,0),o(this.mTweenAnimRoot).parallel(o().to(.3,{opacity:255}),o().to(.3,{position:cc.v3(0,-180,0)})).delay(2.5).parallel(o().to(.3,{opacity:0}),o().to(.3,{position:cc.v3(0,-280,0)})).call(function(){e.CloseWin()}).start()},i([u(cc.Sprite)],e.prototype,"mVIPSp",void 0),i([u([cc.SpriteFrame])],e.prototype,"mSFArr",void 0),i([m],e)}(a.default);o.default=p,cc._RF.pop()},{"../../Manager/UserMgr":"UserMgr","./WinBase":"WinBase"}],VipWin:[function(t,e,o){"use strict";cc._RF.push(e,"a199fWK8IhII795rZeBLvW/","VipWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/VIPReward"),l=t("../Comp/VIPDescItem"),m=t("../../Proxy/ProxyVIP"),u=t("../../Manager/UserMgr"),p=t("../../Manager/DataMgr"),c=t("../../Manager/BCMgr"),d=t("../../Manager/AudioMgr"),f=t("../../MainGame"),h=t("../../Common/EnumsDefine"),y=t("../../Common/Common"),g=cc._decorator,I=g.ccclass,S=g.property,_=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLayoutRoot=null,e.mTemplate=null,e.mNextVipTitle=null,e.mPb=null,e.mPbLbl=null,e.mADExpLbl=null,e.mDailyExpLbl=null,e.mGiftExpLbl=null,e.mCurShowLvLbl=null,e.mVipArr=[],e.mPageContent=null,e.mPageView=null,e.mRightArrow=null,e.mLeftArrow=null,e.mRewardsPb=null,e.mInsPanel=null,e.mInsPanelMask=null,e.mVIPRewardArr=[],e.mCloseBtn=null,e.mCloseBtnRoot=null,e.mItemArr=[],e.mCurShowLv=0,e.mCellWidth=153,e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mItemArr.push(this.mTemplate),this.mInsPanelMask.on(cc.Node.EventType.TOUCH_END,this._OnEvent_ClickCloseInsPanel,this);for(var e=0,o=this.mVIPRewardArr.length;e<o;++e)this.mVIPRewardArr[e].SetData(e);this._AdaptCloseBtnPos()},e.prototype._AdaptCloseBtnPos=function(){this.m_NeedBanner&&y.default.RealAspect>=this.m_ShowBannerAspect&&(this.mCloseBtn.parent=this.mCloseBtnRoot,this.mCloseBtn.y=0)},e.prototype._OnEvent_ClickCloseInsPanel=function(){this.mInsPanel.active=!1},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this);var e=u.default.Ins.ClientInfo.vip.lv,o=e+1;o>m.default.Ins.MAX_LV&&(o=m.default.Ins.MAX_LV),this.mNextVipTitle.string="\u8ddd\u79bbVIP"+o+"\u8fdb\u5ea6";var n=p.default.Ins.m_DB.vipDB[e],r=u.default.Ins.ClientInfo.vip;this.mPbLbl.string=r.exp+"/"+n.exp,this.mPb.progress=r.exp/n.exp,this.mADExpLbl.string=r.adExp+"",this.mDailyExpLbl.string=r.dailyExp+"",this.mGiftExpLbl.string=r.giftExp+"";var i=e;0===i&&(i=1),this.mCurShowLv!==i&&this.SetData(i),this.mRewardsPb.progress=e/m.default.Ins.MAX_LV;for(var a=0,s=this.mVIPRewardArr.length;a<s;++a)this.mVIPRewardArr[a].UpdateState();for(a=1,s=this.mVipArr.length;a<=s;++a)e>=a?this.mVipArr[a-1].setMaterial(0,f.default.mDefaultMat):this.mVipArr[a-1].setMaterial(0,f.default.mGrayMat)},e.prototype.SetData=function(t,e){void 0===e&&(e=!1),this.mCurShowLv=t,this.mCurShowLvLbl.string="VIP"+t+"\u7279\u6743",e||this.mPageView.scrollToPage(t-1,0);for(var o=p.default.Ins.m_DB.vipDB[t].privilege,n=o.length;this.mItemArr.length<n;){var r=cc.instantiate(this.mTemplate.node);r.parent=this.mLayoutRoot,r.x=-268,this.mItemArr.push(r.getComponent(l.default))}for(var i=0,a=this.mItemArr.length;i<a;++i)i<n?(this.mItemArr[i].node.opacity=255,this.mItemArr[i].SetData(o[i][0],o[i][1])):this.mItemArr[i].node.opacity=0;this.mRightArrow.active=t!==m.default.Ins.MAX_LV,this.mLeftArrow.active=1!==t},e.prototype.update=function(){for(var t=null,e=0,o=this.mVipArr.length;e<o;++e){t=this.mVipArr[e].node;var n=Math.min(1,Math.abs(t.x+this.mPageContent.x)/this.mCellWidth);t.scale=y.default.Lerp(1,.7,n)}},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),c.default.Subscribe(h.BCType.VIP_GetReward,this._OnMsg_UpdateRewardState,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),c.default.Remove(h.BCType.VIP_GetReward,this._OnMsg_UpdateRewardState,this)},e.prototype.PageView_EventHandler=function(t){this.SetData(t.getCurrentPageIndex()+1,!0)},e.prototype._OnMsg_UpdateRewardState=function(){for(var t=0,e=this.mVIPRewardArr.length;t<e;++t)this.mVIPRewardArr[t].UpdateState()},e.prototype.Invoke_ClickRight=function(){d.default.PlayBtnSound();var t=this.mCurShowLv+1;t>m.default.Ins.MAX_LV&&(t=m.default.Ins.MAX_LV),this.SetData(t)},e.prototype.Invoke_ClickLeft=function(){d.default.PlayBtnSound();var t=this.mCurShowLv-1;t<1&&(t=1),this.SetData(t)},e.prototype.Invoke_Ins=function(){d.default.PlayBtnSound(),this.mInsPanel.active=!0},e.prototype.Invoke_Close=function(){d.default.PlayBtnSound(),this.CloseWin()},i([S(cc.Node)],e.prototype,"mLayoutRoot",void 0),i([S(l.default)],e.prototype,"mTemplate",void 0),i([S(cc.Label)],e.prototype,"mNextVipTitle",void 0),i([S(cc.ProgressBar)],e.prototype,"mPb",void 0),i([S(cc.Label)],e.prototype,"mPbLbl",void 0),i([S(cc.Label)],e.prototype,"mADExpLbl",void 0),i([S(cc.Label)],e.prototype,"mDailyExpLbl",void 0),i([S(cc.Label)],e.prototype,"mGiftExpLbl",void 0),i([S(cc.Label)],e.prototype,"mCurShowLvLbl",void 0),i([S([cc.Sprite])],e.prototype,"mVipArr",void 0),i([S(cc.Node)],e.prototype,"mPageContent",void 0),i([S(cc.PageView)],e.prototype,"mPageView",void 0),i([S(cc.Node)],e.prototype,"mRightArrow",void 0),i([S(cc.Node)],e.prototype,"mLeftArrow",void 0),i([S(cc.ProgressBar)],e.prototype,"mRewardsPb",void 0),i([S(cc.Node)],e.prototype,"mInsPanel",void 0),i([S(cc.Node)],e.prototype,"mInsPanelMask",void 0),i([S([s.default])],e.prototype,"mVIPRewardArr",void 0),i([S(cc.Node)],e.prototype,"mCloseBtn",void 0),i([S(cc.Node)],e.prototype,"mCloseBtnRoot",void 0),i([I],e)}(a.default);o.default=_,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/DataMgr":"DataMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyVIP":"ProxyVIP","../Comp/VIPDescItem":"VIPDescItem","../Comp/VIPReward":"VIPReward","./WinBase":"WinBase"}],WeChatPlf:[function(t,e,o){"use strict";cc._RF.push(e,"bc1b55CSB5H/qnba1A3tsy/","WeChatPlf");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./PlatformBase"),a=t("../Manager/WinMgr"),s=t("../Manager/SaveMgr"),l=t("../Manager/PlatformMgr"),m=t("../Common/EnumsDefine"),u=function(t){function e(){var o=t.call(this)||this;return o.m_ShareSuccessTime=3e3,o.shareSuccess=!1,o.defaultShareTitle="\u5927\u4eba\uff0c\u65f6\u4ee3\u53d8\u4e86\uff01\u8fc7\u6765\u5355\u6311\u554a~",o.defaultShareImgUrl="https://ttk-1304758638.cos.ap-nanjing.myqcloud.com/share/1.png",o.m_CachedAdObj=new Object,o.mOpenID="wxID",o.m_SDK=window[e.m_SDKName],o._CheckVersion(),o._OnShow(),o}return r(e,t),e.prototype._CheckVersion=function(){var t=this.m_SDK.getUpdateManager();t.onCheckForUpdate(function(t){console.log("\u65b0\u7248\u672c: "+t.hasUpdate)});var e=this;t.onUpdateReady(function(){e.m_SDK.showModal({title:"\u66f4\u65b0\u63d0\u793a",content:"\u65b0\u7248\u672c\u5df2\u7ecf\u51c6\u5907\u597d\uff0c\u662f\u5426\u91cd\u542f\u5e94\u7528\uff1f",success:function(e){e.confirm&&t.applyUpdate()}})})},e.prototype._GetShareMsgObj=function(){var t={serial:0,title:this.defaultShareTitle,image:this.defaultShareImgUrl};return this.shareSuccess=!0,console.log("\u53f3\u4e0a\u89d2\u5206\u4eab\u6309\u94ae"),t},e.prototype._OnShow=function(){var t=this;this.m_SDK.showShareMenu(),this.m_SDK.onShareAppMessage(t._GetShareMsgObj.bind(t)),this.m_SDK.setKeepScreenOn({keepScreenOn:!0}),this.m_SDK.onShow(function(){t.m_ShareCallback&&((new Date).getTime()-t.m_ShareTime>=t.m_ShareSuccessTime?(t.m_ShareCallback(!0),t.m_ShareCallback=null):(a.default.Ins.ShowTips("\u5206\u4eab\u5931\u8d25"),t.m_ShareCallback=null)),t.m_SDK.setKeepScreenOn({keepScreenOn:!0})})},e.prototype.Share=function(t){this._RealShare(t)},e.prototype._RealShare=function(t){this.m_ShareCallback=t,this.m_ShareTime=(new Date).getTime();var e={serial:1,title:this.defaultShareTitle,image:this.defaultShareImgUrl};this.shareSuccess=!0,this.m_SDK.shareAppMessage(e)},e.prototype.Login=function(t){var e=this;this.m_SDK.login({success:function(o){if(o&&"login:ok"==o.errMsg){var n=o.code;e._OnSDKLoginSuccess(n,t),e.PreloadVideoAd(i.ADUnitID.CommonVideoID_15,function(){}),e.PreloadVideoAd(i.ADUnitID.CommonVideoID_30,function(){}),e.PreloadVideoAd(i.ADUnitID.CommonVideoID_60,null)}},fail:function(){console.warn("\u5fae\u4fe1\u767b\u5f55\u5931\u8d25\u4fe1\u606f")}})},e.prototype._OnSDKLoginSuccess=function(t,e){var o=0;cc.sys.localStorage.getItem(this.mOpenID)?o=0:(cc.sys.localStorage.setItem(this.mOpenID,t),o=1,l.default.ReportEvent(m.BIPoint.Guide_NewPlayer));var n=(new Date).getTime(),r=s.default.Get(s.default.LOCAL_OFFLINE_TIME);r&&(n=r),e({ret:0,isNewUser:1===o,systemTime:(new Date).getTime(),lastLogoutTime:n/1e3})},e.prototype.PreloadVideoAd=function(t,e){void 0===e&&(e=null);var o=this,n=o.m_SDK.createRewardedVideoAd({adUnitId:t,multiton:!0});n.onError(function(){}),n.load().then(function(){o.m_CachedAdObj[t]=n,e&&e()}).catch(function(){})},e.prototype.WatchAd=function(t,e,o,n,r){void 0===r&&(r=null),""===t&&(t=i.ADUnitID.CommonVideoID);var s=this,l=null;(l=s.m_CachedAdObj[t])?(console.log("\u64ad\u653e\u7f13\u5b58\u5e7f\u544a: "+t),l.show().catch(function(t){console.log("\u89c6\u9891\u663e\u793a\u5931\u8d25",t),l.load().then(function(){return l.show().catch(function(t){console.log("\u89c6\u9891\u52a0\u8f7d\u5931\u8d25",t),n?n():a.default.Ins.ShowTips("\u5e7f\u544a\u5c1a\u672a\u51c6\u5907\u597d~"),r&&r()})})})):(console.log("\u53ca\u65f6\u521b\u5efa\u5e7f\u544a: "+t),(l=this.m_SDK.createRewardedVideoAd({adUnitId:t,multiton:!0})).load().then(function(){l.show().catch(function(t){console.log("\u89c6\u9891\u663e\u793a\u5931\u8d25",t),l.load().then(function(){return l.show()})})}).catch(function(t){console.log("\u89c6\u9891\u52a0\u8f7d\u5931\u8d25",t),n?n():a.default.Ins.ShowTips("\u5e7f\u544a\u5c1a\u672a\u51c6\u5907\u597d~"),r&&r()}));var m=function(e){var n=e&&e.isEnded||void 0===e;o(n),l.offClose(m),r&&r(),delete s.m_CachedAdObj[t],s.PreloadVideoAd(t)};l.onClose(m),l.onError(function(){r&&r()})},e.prototype.ReportEvent=function(){},e.m_SDKName="wx",e}(i.default);o.default=u,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/WinMgr":"WinMgr","./PlatformBase":"PlatformBase"}],WeaponController:[function(t,e,o){"use strict";cc._RF.push(e,"60f27D87lNOU5M7XNZJ3dHj","WeaponController"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("../../Manager/PoolMgr"),r=t("../../Manager/FightMgr"),i=t("../../Manager/BCMgr"),a=t("../../Common/EnumsDefine"),s=t("../../Common/Common"),l=function(){function t(t){this.mWpType=a.WeaponType.None,this.mOwner=null,this.mOwner=t,this.mWpType=this.mOwner.mEntityData.weaponType}return t.prototype.Fire=function(t,e){if(null===t){if(this.mOwner){var o=this.mOwner.FindTarget();null!==o&&(this.mOwner.mCurTargetEntity=o,t=o)}if(null===t)return}switch(this.mWpType){case a.WeaponType.Sniper:case a.WeaponType.MG:this._FireBySniper(t,e);break;case a.WeaponType.Missile:this._FireByMissile(t,e);break;case a.WeaponType.Arrow:this._FireArrow(t,e)}},t.prototype.FireByImtSkill=function(t){if(null!==this.mOwner.mMuzzleBone){var e=cc.v2(this.mOwner.mMuzzleBone.worldX,this.mOwner.mMuzzleBone.worldY),o=this.mOwner.mSkeleton.node.convertToWorldSpaceAR(e),n=cc.Vec2.RIGHT,r=t.mSkillCompData.targetLimit;this._SpawnBullet(t,o,n,0,0,this.mOwner,!0,r)}},t.prototype._FireBySniper=function(t,e){if(null!==this.mOwner.mMuzzleBone){var o=cc.v2(this.mOwner.mMuzzleBone.worldX,this.mOwner.mMuzzleBone.worldY),n=this.mOwner.mSkeleton.node.convertToWorldSpaceAR(o),r=t.WorldMiddlePosition.sub(n),i=cc.v2(r).signAngle(cc.v2(1,0))*s.default.m_Rad2Deg,a=r.normalize(),l=e.mSkillCompData.targetLimit;this._SpawnBullet(e,n,a,i,i,this.mOwner,!0,l)}},t.prototype._FireByMissile=function(t,e){var o=null;if(null!==this.mOwner.mMuzzleBone){var n=cc.v2(this.mOwner.mMuzzleBone.worldX,this.mOwner.mMuzzleBone.worldY);o=this.mOwner.mSkeleton.node.convertToWorldSpaceAR(n)}else o=this.mOwner.WorldMiddlePosition;this._SpawnMissile(o,t,e)},t.prototype._FireArrow=function(t,e){var o=null;if(null!==this.mOwner.mMuzzleBone){var n=cc.v2(this.mOwner.mMuzzleBone.worldX,this.mOwner.mMuzzleBone.worldY);o=this.mOwner.mSkeleton.node.convertToWorldSpaceAR(n)}else o=this.mOwner.WorldMiddlePosition;this._SpawnArrow(o,t,e)},t.prototype._SpawnMissile=function(t,e,o){var s=this;n.default.Ins.Borrow(n.default.BULLET_PATH_ROOT+o.mSkillCompData.atkParam[0],"BulletBase",function(n){var l=n;i.default.Dispatch(a.BCType.BattleWin_AddBullet,n,t),r.default.mCurFightMode.AddBullet(n),l.InitData(o,s.mOwner),l.InitParabolaData(t,e,s.mOwner.mCurLookDir),s.mOwner.mCurLookDir===a.LookDir.Right?l.node.angle=-30:l.node.angle=30})},t.prototype._SpawnArrow=function(t,e,o){var s=this;n.default.Ins.Borrow(n.default.BULLET_PATH_ROOT+o.mSkillCompData.atkParam[0],"BulletBase",function(n){var l=n;i.default.Dispatch(a.BCType.BattleWin_AddBullet,n,t),r.default.mCurFightMode.AddBullet(n),l.InitData(o,s.mOwner),l.InitParabolaData(t,e,s.mOwner.mCurLookDir),s.mOwner.mCurLookDir===a.LookDir.Right?l.node.angle=-45:l.node.angle=45})},t.prototype._SpawnBullet=function(t,e,o,s,l,m,u,p){void 0===u&&(u=!0),void 0===p&&(p=1),n.default.Ins.Borrow(n.default.BULLET_PATH_ROOT+t.mSkillCompData.atkParam[0],"BulletBase",function(n){var l=n;i.default.Dispatch(a.BCType.BattleWin_AddBullet,n,e),r.default.mCurFightMode.AddBullet(n),l.InitData(t,m),l.InitLineData(o,p),l.node.angle=-s})},t}();o.default=l,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/BCMgr":"BCMgr","../../Manager/FightMgr":"FightMgr","../../Manager/PoolMgr":"PoolMgr"}],WinBase:[function(t,e,o){"use strict";cc._RF.push(e,"6c5e4eB1dJFiI1kwJtR08vp","WinBase");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("../../Manager/WinMgr"),s=t("../../Manager/PlatformMgr"),l=t("../../Common/EnumsDefine"),m=t("../../Common/Common"),u=cc._decorator,p=u.ccclass,c=u.property,d=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mOrder=0,e.mCloseMode=l.CloseMode.Hide,e.mAdaptRoot=null,e.mNeedMaskAnim=!1,e.mMask=null,e.mTweenAnimRoot=null,e.m_NeedBanner=!1,e.m_NeedInter=!1,e.m_NeedIOSInter=!1,e.m_ShowBannerAspect=1.78,e.mWinType=l.WinType.None,e._hasSubscribed=!1,e._openedTimes=0,e._closeCallback=null,e}return r(e,t),e.prototype.onLoad=function(){this._AdaptScreen()},e.prototype._AdaptScreen=function(){null!==this.mAdaptRoot&&(this.mAdaptRoot.width=m.default.ScreenWidth,this.mAdaptRoot.height=m.default.ScreenHeight)},e.prototype._AddListener=function(){this._hasSubscribed||(this._hasSubscribed=!0,this._Subscribe())},e.prototype._RemoveListener=function(){this._hasSubscribed&&(this._hasSubscribed=!1,this._Remove())},e.prototype._Subscribe=function(){},e.prototype._Remove=function(){},e.prototype.Open=function(){this.node.active||(this.node.active=!0),this.mCloseMode===l.CloseMode.Opacity&&(this.node.setPosition(cc.Vec2.ZERO),this.node.opacity=255),0===this._openedTimes&&this._OnFirstOpen(),this._OnOpen(),this._openedTimes++},e.prototype.CloseWin=function(){a.default.Ins.Close(this.mWinType)},e.prototype.Close=function(){this._OnClose(),null!==this._closeCallback&&this._closeCallback()},e.prototype._OnFirstOpen=function(){this.node.zIndex=this.mOrder},e.prototype._OnOpen=function(){this._AddListener(),this._CheckMaskAnim(),this._PlayTweenAnim(),this.m_NeedBanner&&this._ShowBanner(),this.m_NeedInter&&this._ShowTemplateInter(),this.m_NeedIOSInter&&this._ShowIOSInterAD()},e.prototype._ShowIOSInterAD=function(){s.default.mCurPlf.ShowIOSInterAD()},e.prototype._ShowTemplateInter=function(){s.default.mCurPlf.ShowTemplateInter()},e.prototype._HideTemplateInter=function(){s.default.mCurPlf.HideTemplateInter()},e.prototype._ShowBanner=function(){m.default.RealAspect>=this.m_ShowBannerAspect&&s.default.ShowBanner()},e.prototype._HideBanner=function(){m.default.RealAspect>=this.m_ShowBannerAspect&&s.default.HideBanner()},e.prototype._OnClose=function(){this._RemoveListener(),this.m_NeedBanner&&this._HideBanner(),this.m_NeedInter&&this._HideTemplateInter()},e.prototype._CheckMaskAnim=function(){if(this.mNeedMaskAnim&&this.mMask){var t=cc.fadeIn(.12);this.mMask.opacity=0,this.mMask.runAction(t)}},e.prototype._PlayTweenAnim=function(){this.mTweenAnimRoot&&(this.mTweenAnimRoot.scale=1.2,this.mTweenAnimRoot.opacity=0,cc.tween(this.mTweenAnimRoot).to(.12,{scale:1,opacity:255}).start())},i([c(cc.Integer)],e.prototype,"mOrder",void 0),i([c({type:cc.Enum(l.CloseMode)})],e.prototype,"mCloseMode",void 0),i([c(cc.Node)],e.prototype,"mAdaptRoot",void 0),i([c(cc.Boolean)],e.prototype,"mNeedMaskAnim",void 0),i([c(cc.Node)],e.prototype,"mMask",void 0),i([c(cc.Node)],e.prototype,"mTweenAnimRoot",void 0),i([c(cc.Boolean)],e.prototype,"m_NeedBanner",void 0),i([c(cc.Boolean)],e.prototype,"m_NeedInter",void 0),i([c(cc.Boolean)],e.prototype,"m_NeedIOSInter",void 0),i([c(cc.Float)],e.prototype,"m_ShowBannerAspect",void 0),i([p],e)}(cc.Component);o.default=d,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/PlatformMgr":"PlatformMgr","../../Manager/WinMgr":"WinMgr"}],WinMgr:[function(t,e,o){"use strict";cc._RF.push(e,"f0372lLD/NNm43k5aLrM5di","WinMgr"),Object.defineProperty(o,"__esModule",{value:!0});var n=t("./ResMgr"),r=t("../Common/EnumsDefine"),i=t("../Common/Common"),a=function(){function t(){this.mAllWins=new Map,this.mOpeningWins=new Map,this.mWinRoot=null,this.mHideRoot=null,this.mTopRoot=null,this.mTipRoot=null,this.m_GuideRoot=null,this.m_GuideMask=null,this.m_GuideMaskHeidi=null,this.mHudTips=null,this.mTransClosedCallback=null,this.mTransCompletedCallback=null,this.mTransNode=null,this.mTransSk=null}return Object.defineProperty(t,"Ins",{get:function(){return null===this.mIns&&(this.mIns=new t),this.mIns},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"WinRoot",{get:function(){return null!==this.mWinRoot&&this.mWinRoot.isValid||(this.mWinRoot=cc.find("Canvas/UIRoot/WinRoot")),this.mWinRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"HideRoot",{get:function(){return null!==this.mHideRoot&&this.mHideRoot.isValid||(this.mHideRoot=cc.find("Canvas/UIRoot/HideRoot")),this.mHideRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TopRoot",{get:function(){return null!==this.mTopRoot&&this.mTopRoot.isValid||(this.mTopRoot=cc.find("Canvas/UIRoot/TopRoot")),this.mTopRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"TipRoot",{get:function(){return null!==this.mTipRoot&&this.mTipRoot.isValid||(this.mTipRoot=cc.find("Canvas/UIRoot/TipRoot")),this.mTipRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GuideRoot",{get:function(){return null!==this.m_GuideRoot&&this.m_GuideRoot.isValid||(this.m_GuideRoot=cc.find("Canvas/UIRoot/GuideRoot")),this.m_GuideRoot},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GuideMask",{get:function(){return null!==this.m_GuideMask&&this.m_GuideMask.isValid||(this.m_GuideMask=cc.find("Canvas/UIRoot/GuideRoot/GuideMask")),this.m_GuideMask},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"GuideMaskHeiDi",{get:function(){return null!==this.m_GuideMaskHeidi&&this.m_GuideMaskHeidi.isValid||(this.m_GuideMaskHeidi=this.GuideMask.getChildByName("heidi")),this.m_GuideMaskHeidi},enumerable:!1,configurable:!0}),t.prototype.OpenTips=function(e){var o=this;null===this.mHudTips?this.Open(r.WinType.TipsWin,function(n){t.Ins.mHudTips=n,n.node.parent=o.TipRoot,null!=e&&e(n)}):(t.Ins.mHudTips.Open(),null!==e&&e(t.Ins.mHudTips))},t.prototype.ShowTips=function(t,e){void 0===e&&(e=!1),this.OpenTips(function(o){o.Show(t,e)})},t.prototype.ShowTransitionClose=function(t,e){if(this.mTransClosedCallback=t,this.mTransCompletedCallback=e,null===this.mTransNode){var o=new cc.Node;o.setParent(this.TopRoot),o.setPosition(cc.Vec3.ZERO),this.mTransNode=o,this.mTransSk=this.mTransNode.addComponent(sp.Skeleton),this.mTransSk.setCompleteListener(this._OnTransEndCallback.bind(this))}if(this.mTransNode.active=!0,this.mTransSk.skeletonData)this.mTransSk.setAnimation(0,"guanmen",!1);else{var r=this;n.default.Ins.LoadSpine("spine/zhuanchang",function(t){r.mTransSk.skeletonData=t,r.mTransSk.setAnimation(0,"guanmen",!1)})}},t.prototype.ShowTransitionOpen=function(){this.mTransSk.skeletonData&&this.mTransSk.setAnimation(0,"kaimen",!1)},t.prototype._OnTransEndCallback=function(t){"guanmen"===t.animation.name?this._OnTransClosedCallback():"kaimen"===t.animation.name&&this._OnTransCompletedCallback()},t.prototype._OnTransClosedCallback=function(){null!==this.mTransClosedCallback&&(this.mTransClosedCallback(),this.mTransClosedCallback=null)},t.prototype._OnTransCompletedCallback=function(){this.mTransNode.active=!1,null!==this.mTransCompletedCallback&&(this.mTransCompletedCallback(),this.mTransCompletedCallback=null)},t.prototype.Open=function(t,e,o,r){var i=this;void 0===o&&(o=!1),void 0===r&&(r=null);var a=this.mOpeningWins.get(t);if(void 0===a)a=0,this.mOpeningWins.set(t,a);else if(1===a)return;this.mOpeningWins.set(t,1);var s=this.mAllWins.get(t);void 0===s?n.default.Ins.LoadPrefab("prefab/win/"+t.toString(),function(n){var a=cc.instantiate(n);if(null!==a){if(null===(s=a.getComponent("WinBase")))return;s.mWinType=t,i.mAllWins.set(t,s),o||i._OnWinOpened(s),r&&r(s),s.Open(),e&&e(s),i.mOpeningWins.set(t,0)}}):(o||this._OnWinOpened(s),r&&r(s),s.Open(),e&&e(s),this.mOpeningWins.set(t,0))},t.prototype.Close=function(t){var e=this.mAllWins.get(t);if(e)switch(e.Close(),e.mCloseMode){case r.CloseMode.Hide:e.node.active=!1,this._OnWinClosed(e);break;case r.CloseMode.Opacity:e.node.setPosition(i.default.OUT_SCREEN_POS),e.node.opacity=0;break;case r.CloseMode.Destroy:e.node.destroy(),this.mAllWins.delete(t)}},t.prototype._OnWinOpened=function(t){t.node.parent!==this.WinRoot&&(t.node.parent=this.WinRoot)},t.prototype._OnWinClosed=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]},t.mIns=null,t}();o.default=a,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","./ResMgr":"ResMgr"}],WorkDetailPanel:[function(t,e,o){"use strict";cc._RF.push(e,"88ef10Yyq9GZ4GzyafyMjlp","WorkDetailPanel");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=cc._decorator,s=a.ccclass,l=a.property,m=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mMask=null,e}return r(e,t),e.prototype.Open=function(){this.node.active=!0,this.mMask.once(cc.Node.EventType.TOUCH_END,this._Click,this)},e.prototype._Click=function(){this.node.active=!1},i([l(cc.Node)],e.prototype,"mMask",void 0),i([s],e)}(cc.Component);o.default=m,cc._RF.pop()},{}],WorkItem:[function(t,e,o){"use strict";cc._RF.push(e,"98fdegb3z9G74pP9/R8tLfT","WorkItem");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./MainTaskGuideFinger"),s=t("./LoopScrollItem"),l=t("../../Proxy/ProxyWork"),m=t("../../Proxy/ProxyMainTask2"),u=t("../../Proxy/ProxyBackCity"),p=t("../../Manager/UserMgr"),c=t("../../Manager/ResMgr"),d=t("../../Manager/MainTaskGuideMgr"),f=t("../../Manager/DataMgr"),h=t("../../Manager/AudioMgr"),y=t("../../MainGame"),g=t("../../Common/EnumsDefine"),I=t("../../Common/Common"),S=cc._decorator,_=S.ccclass,v=S.property,C=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mIDLbl=null,e.mNameLbl=null,e.mLvLbl=null,e.mGetNumLbl=null,e.mManualGoldNumLbl=null,e.mLeftTimeLbl=null,e.mBtnLbl=null,e.mCost1Lbl=null,e.mCost10Lbl=null,e.mCost100Lbl=null,e.mBtn1Sp=null,e.mBtn10Sp=null,e.mBtn100Sp=null,e.mIconSp=null,e.mIconBg=null,e.mTimePb=null,e.mRewardPb=null,e.mIconRoot=null,e.mDoubleRoot=null,e.mAutoRoot=null,e.mGetBtnRoot=null,e.mCommonInfoRoot=null,e.mFastBtnRoot=null,e.mCost1PriceRoot=null,e.mLockLbl=null,e.mUpgradeSk=null,e.mUpgrade1BtnNode=null,e.mGuideFinger=null,e.mActiveFinger=null,e.mFastBtnStay=!1,e.mCurData=null,e.mCurRunningItemInfo=null,e.mDefaultColor=new cc.Color(255,255,255,255),e.mGrayColor=new cc.Color(100,100,100,255),e.mOwnerWin=null,e.mLastClickBtnFrame=0,e.mIsFastBtnOn=!1,e.mPersistDuration=2,e.mTiming=e.mPersistDuration,e}return r(e,t),e.prototype.Init=function(t,e){this.mOwnerWin=e,this.mIdx=t,this._InitOnce(),this.UpdateUI()},e.prototype.UpdateUI=function(){this.HideFastBtn(),this.mGuideFinger.UpdatePointName(d.MainTaskGuideType.WorkItem+(this.mIdx+1)),this.mActiveFinger.UpdatePointName(d.MainTaskGuideType.WorkItemActive+(this.mIdx+1)),this.mIDLbl.string=""+(this.mIdx+1),this.mCurData=f.default.Ins.m_DB.workDB[this.mIdx+1],this.mCurRunningItemInfo=l.default.Ins.GetWorkItemRunningInfo(this.mIdx+1);var t=this.mCurRunningItemInfo.mSI;c.default.Ins.LoadSpriteFrame("AutoAtlas/WorkWin/WorkWin",""+(this.mIdx+1),this.mIconSp,null);var e=0;null===t||0===t.lv?(this.mBtnLbl.string="\u89e3\u9501",e=0,this.mTimePb.progress=0,this.mIconSp.setMaterial(0,y.default.mGrayMat),this.mIconBg.node.color=this.mGrayColor):(this.mBtnLbl.string="\u5347\u7ea7",e=t.lv,this.mIconSp.setMaterial(0,y.default.mDefaultMat),this.mIconBg.node.color=this.mDefaultColor),this.mLeftTimeLbl.string=I.default.FormatTimeWithSeconds(l.default.Ins.GetWorkItemTimeByData(this.mCurData)),this.mCost1Lbl.string=this.mCurRunningItemInfo.curCost.ToString(1);var o=this.mCurRunningItemInfo.curRev.ToString(1);this.mGetNumLbl.string=o;var n="Lv."+e;this.mLvLbl.string=n,this.mNameLbl.string=this.mCurData.name,this.mRewardPb.progress=e%l.default.REWARD_LV/l.default.REWARD_LV,1===this.mCurRunningItemInfo.goldState?(this.mGetBtnRoot.active||(this.mGetBtnRoot.active=!0,this.mManualGoldNumLbl.string=o),this.mCommonInfoRoot.active&&(this.mCommonInfoRoot.active=!1)):(this.mGetBtnRoot.active&&(this.mGetBtnRoot.active=!1),this.mCommonInfoRoot.active||(this.mCommonInfoRoot.active=!0)),this.mUpgradeSk.node.opacity=0,this.UpdateUIIfGoldIsEnough(),this._UpdateIconUI(),this._UpdateLockState()},e.prototype._UpdateLockState=function(){u.default.Ins.mBackSaveInfo.backTimes<this.mCurData.unlockTimes?(this.mCost1PriceRoot.opacity=0,this.mLockLbl.node.opacity=255,this.mLockLbl.string="\u56de\u57ce"+this.mCurData.unlockTimes+"\u6b21\u540e\u89e3\u9501"):(this.mCost1PriceRoot.opacity=255,this.mLockLbl.node.opacity=0)},e.prototype.UpdateOnUnlock=function(){this.mIconSp.setMaterial(0,y.default.mDefaultMat),this.mIconBg.node.color=this.mDefaultColor,this.mBtnLbl.string="\u5347\u7ea7",this.mLvLbl.string="Lv."+this.mCurRunningItemInfo.mSI.lv,this.mCost1Lbl.string=this.mCurRunningItemInfo.curCost.ToString(1);var t=this.mCurRunningItemInfo.curRev.ToString(1);this.mGetNumLbl.string=t,this.mManualGoldNumLbl.string=t,this.mRewardPb.progress=this.mCurRunningItemInfo.mSI.lv%l.default.REWARD_LV/l.default.REWARD_LV},e.prototype.UpdateTimeUI=function(){1===this.mCurRunningItemInfo.goldState?(this.mGetBtnRoot.active||(this.mGetBtnRoot.active=!0,this.mManualGoldNumLbl.string=this.mCurRunningItemInfo.curRev.ToString(1)),this.mCommonInfoRoot.active&&(this.mCommonInfoRoot.active=!1)):null!==this.mCurRunningItemInfo.mSI&&0!==this.mCurRunningItemInfo.mSI.lv&&(this.mTimePb.progress=this.mCurRunningItemInfo.leftTime/this.mCurRunningItemInfo.totalTime,this.mLeftTimeLbl.string=I.default.FormatTimeWithSeconds(Math.ceil(this.mCurRunningItemInfo.leftTime)))},e.prototype.UpdateOnUpgrade=function(){var t=this.mCurRunningItemInfo.mSI.lv;this.mLvLbl.string="Lv."+t,this.mCost1Lbl.string=this.mCurRunningItemInfo.curCost.ToString(1);var e=this.mCurRunningItemInfo.curRev.ToString(1);this.mGetNumLbl.string=e,this.mManualGoldNumLbl.string=e,this.mNameLbl.string=this.mCurData.name,this.mRewardPb.progress=t%l.default.REWARD_LV/l.default.REWARD_LV;var o=this.mCurRunningItemInfo.mSI.toGetRewardLv;t>=o&&(this.mIconRoot.active&&(this.mIconRoot.active=!1),o===this.mCurData.autoLv?this.mAutoRoot.active||(this.mAutoRoot.active=!0):this.mDoubleRoot.active||(this.mDoubleRoot.active=!0)),this.mIsFastBtnOn&&this._UpdateFastCost(),this.mUpgradeSk.node.opacity=255,this.mUpgradeSk.setAnimation(0,"animation",!1)},e.prototype._UpdateOnDouble=function(){var t=this.mCurRunningItemInfo.curRev.ToString(1);this.mGetNumLbl.string=t,this.mManualGoldNumLbl.string=t,this._UpdateIconUI()},e.prototype._UpdateIconUI=function(){if(null===this.mCurRunningItemInfo.mSI)this.mIconRoot.active=!0,this.mDoubleRoot.active=!1,this.mAutoRoot.active=!1;else{var t=this.mCurRunningItemInfo.mSI.lv,e=this.mCurRunningItemInfo.mSI.toGetRewardLv;t>=e?(this.mIconRoot.active=!1,e===this.mCurData.autoLv?(this.mAutoRoot.active||(this.mAutoRoot.active=!0),this.mDoubleRoot.active&&(this.mDoubleRoot.active=!1)):(this.mDoubleRoot.active||(this.mDoubleRoot.active=!0),this.mAutoRoot.active&&(this.mAutoRoot.active=!1))):(this.mIconRoot.active=!0,this.mDoubleRoot.active=!1,this.mAutoRoot.active=!1)}},e.prototype.UpdateUIIfGoldIsEnough=function(){if(u.default.Ins.mBackSaveInfo.backTimes<this.mCurData.unlockTimes)this.mBtn1Sp.spriteFrame=this.mOwnerWin.mSFArr[1];else{var t=!1,e=m.default.Ins.mCurTaskData;if(null!==e){var o=this.mCurRunningItemInfo.mSI;e.taskType!==m.MainTaskType.UnlockWork||e.param[0]!==this.mIdx+1||null!==o&&0!==o.lv||(this.mBtn1Sp.spriteFrame=this.mOwnerWin.mSFArr[0],t=!0)}t||(p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost)?this.mBtn1Sp.spriteFrame=this.mOwnerWin.mSFArr[0]:this.mBtn1Sp.spriteFrame=this.mOwnerWin.mSFArr[1]),this._UpdateFastIsEnoughUI()}},e.prototype._UpdateFastIsEnoughUI=function(){this.mIsFastBtnOn&&(p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost10)?this.mBtn10Sp.setMaterial(0,y.default.mDefaultMat):this.mBtn10Sp.setMaterial(0,y.default.mGrayMat),p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost100)?this.mBtn100Sp.setMaterial(0,y.default.mDefaultMat):this.mBtn100Sp.setMaterial(0,y.default.mGrayMat))},e.prototype.update=function(t){this.mIsFastBtnOn&&!this.mFastBtnStay&&(this.mTiming-=t,this.mTiming<=0&&this.HideFastBtn())},e.prototype._CheckFastBtn=function(){y.default.mFrameCount-this.mLastClickBtnFrame<=60&&this.ShowFastBtn(),this.mIsFastBtnOn&&this._UpdateFastBtn(),this.mLastClickBtnFrame=y.default.mFrameCount},e.prototype.ShowFastBtn=function(){null===this.mCurRunningItemInfo.mSI||0===this.mCurRunningItemInfo.mSI.lv||null!==m.default.Ins.mCurTaskData&&m.default.Ins.mCurTaskData.Id<15||this.mIsFastBtnOn||(this.mIsFastBtnOn=!0,this.mTiming=this.mPersistDuration,this.mFastBtnRoot.active=!0,this._UpdateFastCost(),this._UpdateFastIsEnoughUI())},e.prototype._UpdateFastCost=function(){this.mCost10Lbl.string=this.mCurRunningItemInfo.curCost10.ToString(1),this.mCost100Lbl.string=this.mCurRunningItemInfo.curCost100.ToString(1)},e.prototype._UpdateFastBtn=function(){this.mTiming=this.mPersistDuration},e.prototype.HideFastBtn=function(){this.mIsFastBtnOn=!1,this.mFastBtnRoot.active=!1},e.prototype.Invoke_Upgrade1=function(){if(h.default.PlayBtnSound(),!(u.default.Ins.mBackSaveInfo.backTimes<this.mCurData.unlockTimes)){var t=!1,e=m.default.Ins.mCurTaskData;if(null!==e){var o=this.mCurRunningItemInfo.mSI;e.taskType!==m.MainTaskType.UnlockWork||e.param[0]!==this.mIdx+1||null!==o&&0!==o.lv||(t=!0)}var n=p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost);if(t||n){h.default.PlaySFX(g.AudioName.UI_CoinUpgrade,!0),n&&p.default.Ins.MinusCoin(this.mCurRunningItemInfo.curCost);var r=this.mCurRunningItemInfo.mSI;null===r||0===r.lv?(l.default.Ins.UnlockWork(this.mIdx+1),this.UpdateOnUnlock(),t&&this.UpdateUIIfGoldIsEnough()):(l.default.Ins.UpgradeLv(this.mIdx+1,1),this.UpdateOnUpgrade()),this._CheckFastBtn()}}},e.prototype.Invoke_Upgrade10=function(){h.default.PlayBtnSound(),this._UpdateFastBtn(),p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost10)&&(h.default.PlaySFX(g.AudioName.UI_CoinUpgrade,!0),p.default.Ins.MinusCoin(this.mCurRunningItemInfo.curCost10),l.default.Ins.UpgradeLv(this.mIdx+1,10),this.UpdateOnUpgrade())},e.prototype.Invoke_Upgrade100=function(){h.default.PlayBtnSound(),this._UpdateFastBtn(),p.default.Ins.IsCoinEnough(this.mCurRunningItemInfo.curCost100)&&(h.default.PlaySFX(g.AudioName.UI_CoinUpgrade,!0),p.default.Ins.MinusCoin(this.mCurRunningItemInfo.curCost100),l.default.Ins.UpgradeLv(this.mIdx+1,100),this.UpdateOnUpgrade())},e.prototype.Invoke_GetGold=function(){h.default.PlaySFX(g.AudioName.UI_GetCoin,!0);var t=this.mCurRunningItemInfo.curRev;l.default.Ins.GetGoldManual(this.mIdx+1),this.mGetBtnRoot.active=!1,this.mCommonInfoRoot.active=!0;var e=this.node.parent.convertToWorldSpaceAR(this.node.position);I.default.GetFlyCoin(t,cc.v2(e),6)},e.prototype.Invoke_Double=function(){h.default.PlaySFX(g.AudioName.UI_CoinDouble,!0),l.default.Ins.GetDoubleReward(this.mIdx+1),this._UpdateOnDouble()},e.prototype.Invoke_Auto=function(){h.default.PlaySFX(g.AudioName.UI_CoinDouble,!0),l.default.Ins.GetAutoReward(this.mIdx+1),this._UpdateIconUI(),this.mCurRunningItemInfo.mSI.isAuto&&(this.mGetBtnRoot.active=!1,this.mCommonInfoRoot.active=!0)},i([v(cc.Label)],e.prototype,"mIDLbl",void 0),i([v(cc.Label)],e.prototype,"mNameLbl",void 0),i([v(cc.Label)],e.prototype,"mLvLbl",void 0),i([v(cc.Label)],e.prototype,"mGetNumLbl",void 0),i([v(cc.Label)],e.prototype,"mManualGoldNumLbl",void 0),i([v(cc.Label)],e.prototype,"mLeftTimeLbl",void 0),i([v(cc.Label)],e.prototype,"mBtnLbl",void 0),i([v(cc.Label)],e.prototype,"mCost1Lbl",void 0),i([v(cc.Label)],e.prototype,"mCost10Lbl",void 0),i([v(cc.Label)],e.prototype,"mCost100Lbl",void 0),i([v(cc.Sprite)],e.prototype,"mBtn1Sp",void 0),i([v(cc.Sprite)],e.prototype,"mBtn10Sp",void 0),i([v(cc.Sprite)],e.prototype,"mBtn100Sp",void 0),i([v(cc.Sprite)],e.prototype,"mIconSp",void 0),i([v(cc.Sprite)],e.prototype,"mIconBg",void 0),i([v(cc.ProgressBar)],e.prototype,"mTimePb",void 0),i([v(cc.ProgressBar)],e.prototype,"mRewardPb",void 0),i([v(cc.Node)],e.prototype,"mIconRoot",void 0),i([v(cc.Node)],e.prototype,"mDoubleRoot",void 0),i([v(cc.Node)],e.prototype,"mAutoRoot",void 0),i([v(cc.Node)],e.prototype,"mGetBtnRoot",void 0),i([v(cc.Node)],e.prototype,"mCommonInfoRoot",void 0),i([v(cc.Node)],e.prototype,"mFastBtnRoot",void 0),i([v(cc.Node)],e.prototype,"mCost1PriceRoot",void 0),i([v(cc.Label)],e.prototype,"mLockLbl",void 0),i([v(sp.Skeleton)],e.prototype,"mUpgradeSk",void 0),i([v(cc.Node)],e.prototype,"mUpgrade1BtnNode",void 0),i([v(a.default)],e.prototype,"mGuideFinger",void 0),i([v(a.default)],e.prototype,"mActiveFinger",void 0),i([_],e)}(s.default);o.default=C,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../MainGame":"MainGame","../../Manager/AudioMgr":"AudioMgr","../../Manager/DataMgr":"DataMgr","../../Manager/MainTaskGuideMgr":"MainTaskGuideMgr","../../Manager/ResMgr":"ResMgr","../../Manager/UserMgr":"UserMgr","../../Proxy/ProxyBackCity":"ProxyBackCity","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../../Proxy/ProxyWork":"ProxyWork","./LoopScrollItem":"LoopScrollItem","./MainTaskGuideFinger":"MainTaskGuideFinger"}],WorkLoopSV:[function(t,e,o){"use strict";cc._RF.push(e,"19003URnrdLy50rbLvVwnfT","WorkLoopSV");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./LoopScrollView"),s=cc._decorator,l=s.ccclass,m=(s.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.UpdateTimeUI=function(){for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateTimeUI()},e.prototype.UpdateUIIfGoldIsEnough=function(){for(var t=0,e=this.mItemArr.length;t<e;++t)this.mItemArr[t].UpdateUIIfGoldIsEnough()},i([l],e)}(a.default));o.default=m,cc._RF.pop()},{"./LoopScrollView":"LoopScrollView"}],WorkWin:[function(t,e,o){"use strict";cc._RF.push(e,"fb2ee9Ig6BB6qTN+rjFWkzj","WorkWin");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./WinBase"),s=t("../Comp/WorkLoopSV"),l=t("../Comp/CDBtn"),m=t("../../Proxy/ProxyWork"),u=t("../../Proxy/ProxyMainTask2"),p=t("../../Platform/PlatformBase"),c=t("../../Manager/WinMgr"),d=t("../../Manager/UserMgr"),f=t("../../Manager/BCMgr"),h=t("../../Manager/AudioMgr"),y=t("../../Common/EnumsDefine"),g=t("../../Common/Common"),I=cc._decorator,S=I.ccclass,_=I.property,v=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mLoopSV=null,e.mGoldCoinLbl=null,e.mAdCoinLbl=null,e.mADCoinBtn=null,e.mGuidePanel=null,e.mGuideDescRT=null,e.mSFArr=[],e}return r(e,t),e.prototype._OnFirstOpen=function(){t.prototype._OnFirstOpen.call(this),this.mLoopSV.Initialize(m.default.MAX_WORK_ID,this)},e.prototype._OnOpen=function(){t.prototype._OnOpen.call(this),this.mLoopSV.UpdateUI(),this._OnMsg_OnUpdateRevenue(),this._AutoScrollToItem(),this.mADCoinBtn.UpdateUI(),this.mGuidePanel.active=!1},e.prototype._AutoScrollToItem=function(){if(null!==u.default.Ins.mCurTaskData){var t=u.default.Ins.mCurTaskData.taskType;if(u.default.Ins.mMainTaskInfo.taskState===u.MainTaskState.Progress&&(t===u.MainTaskType.UnlockWork||t===u.MainTaskType.UpgradeWork||t===u.MainTaskType.DoubleWork||t===u.MainTaskType.AutoWork)){var e=u.default.Ins.mCurTaskData.param[0],o=m.default.Ins.GetWorkSI(1);null!==o&&o.lv<=10?this.mLoopSV.ScrollToID(1):this.mLoopSV.ScrollToID(e)}}},e.prototype._Subscribe=function(){t.prototype._Subscribe.call(this),f.default.Subscribe(y.BCType.WorkWin_UpdateTimeState,this._OnMsg_UpdateTimeInfo,this),f.default.Subscribe(y.BCType.Common_ChangeCoin,this._OnMsg_OnGoldChange,this),f.default.Subscribe(y.BCType.WorkWin_UpdateRevenue,this._OnMsg_OnUpdateRevenue,this),f.default.Subscribe(y.BCType.BackCity,this._OnMsg_BackCity,this),f.default.Subscribe(y.BCType.MainTask2_StartTask,this._OnMsg_StartTask,this),f.default.Subscribe(y.BCType.ShowMainTaskGuidePanel,this._OnMsg_ShowMainGuidePanel,this)},e.prototype._Remove=function(){t.prototype._Remove.call(this),f.default.Remove(y.BCType.WorkWin_UpdateTimeState,this._OnMsg_UpdateTimeInfo,this),f.default.Remove(y.BCType.Common_ChangeCoin,this._OnMsg_OnGoldChange,this),f.default.Remove(y.BCType.WorkWin_UpdateRevenue,this._OnMsg_OnUpdateRevenue,this),f.default.Remove(y.BCType.BackCity,this._OnMsg_BackCity,this),f.default.Remove(y.BCType.MainTask2_StartTask,this._OnMsg_StartTask,this),f.default.Remove(y.BCType.ShowMainTaskGuidePanel,this._OnMsg_ShowMainGuidePanel,this)},e.prototype.Invoke_GoldForCoin=function(){h.default.PlayBtnSound(),c.default.Ins.Open(y.WinType.GoldForCoinWin,function(t){t.SetData()})},e.prototype.Invoke_AdForCoin=function(){this.mADCoinBtn.IsCDing()||(this.mADCoinBtn.StartClickCD(),h.default.PlayBtnSound(),g.default.WatchADForRewards(this._ADCallback.bind(this),p.ADUnitID.WorkCoin,y.ADPoint.WorkForCoin))},e.prototype._ADCallback=function(t){this.mADCoinBtn.StartOKCD();var e=m.default.Ins.mRevenueCoinInSeconds.MultiplySingle(600);d.default.Ins.AddCoin(e),t&&d.default.Ins.GetADExtraRewards(),c.default.Ins.Open(y.WinType.GetRewardsWin,function(o){var n=o;t?n.SetDataWithADCoin(y.ItemType.Coin,e.ToString(1)):n.SetDataSingle(y.ItemType.Coin,e.ToString(1))})},e.prototype._OnMsg_UpdateTimeInfo=function(){this.mLoopSV.UpdateTimeUI()},e.prototype._OnMsg_OnGoldChange=function(){this.mLoopSV.UpdateUIIfGoldIsEnough()},e.prototype._OnMsg_OnUpdateRevenue=function(){this.mAdCoinLbl.string=m.default.Ins.mRevenueCoinInSeconds.MultiplySingle(600).ToString(1),this.mGoldCoinLbl.string=m.default.Ins.mRevenueCoinInSeconds.MultiplySingle(1800).ToString(1)},e.prototype._OnMsg_BackCity=function(){this.mLoopSV.UpdateUI()},e.prototype._OnMsg_StartTask=function(){var t=u.default.Ins.mCurTaskData;if(null!==t){var e=t.taskType,o=t.param;e===u.MainTaskType.UnlockWork?this.mLoopSV.ScrollToID(o[0]):e===u.MainTaskType.UpgradeWork&&this.mLoopSV.ScrollToID(o[0]),5===t.Id?(this.mGuidePanel.position=cc.v3(0,640,0),this.mGuidePanel.active=!0,this.mGuideDescRT.string="<b>\u6253\u5de5\u70b9<color=#F96060>\u6bcf25\u7ea7</color>\uff0c\u53ef\u4ee5\u6fc0\u6d3b<color=#F96060>\u53cc\u500d\u6536\u76ca</color></b>"):8===t.Id&&(this.mGuidePanel.position=cc.v3(0,180,0),this.mGuidePanel.active=!0,this.mGuideDescRT.string="<b>\u7528\u521a\u8d5a\u5230\u7684\u94f6\u5e01\u53bb<color=#F96060>\u5347\u7ea7\u6b66\u5c06</color>\u5427\uff0c\u53ea\u6709\u53d8\u5f97\u66f4\u5f3a\u624d\u80fd<color=#F96060>\u6253\u8d25\u9ec4\u5dfe\u8d3c\uff01</c></b>")}},e.prototype._OnMsg_ShowMainGuidePanel=function(t){this.mGuidePanel.active=!!t},i([_(s.default)],e.prototype,"mLoopSV",void 0),i([_(cc.Label)],e.prototype,"mGoldCoinLbl",void 0),i([_(cc.Label)],e.prototype,"mAdCoinLbl",void 0),i([_(l.default)],e.prototype,"mADCoinBtn",void 0),i([_(cc.Node)],e.prototype,"mGuidePanel",void 0),i([_(cc.RichText)],e.prototype,"mGuideDescRT",void 0),i([_([cc.SpriteFrame])],e.prototype,"mSFArr",void 0),i([S],e)}(a.default);o.default=v,cc._RF.pop()},{"../../Common/Common":"Common","../../Common/EnumsDefine":"EnumsDefine","../../Manager/AudioMgr":"AudioMgr","../../Manager/BCMgr":"BCMgr","../../Manager/UserMgr":"UserMgr","../../Manager/WinMgr":"WinMgr","../../Platform/PlatformBase":"PlatformBase","../../Proxy/ProxyMainTask2":"ProxyMainTask2","../../Proxy/ProxyWork":"ProxyWork","../Comp/CDBtn":"CDBtn","../Comp/WorkLoopSV":"WorkLoopSV","./WinBase":"WinBase"}],XiaoMiChannelPlatform:[function(t,e,o){"use strict";cc._RF.push(e,"50518Ha2GpPooTN2YihEZVQ","XiaoMiChannelPlatform");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./PlatformBase"),a=t("../Proxy/ProxyTask"),s=t("../Manager/WinMgr"),l=t("../Manager/UserMgr"),m=t("../Manager/TimeMgr"),u=t("../Manager/SaveMgr"),p=t("../Manager/PlatformMgr"),c=t("../Common/SwitchConfig"),d=t("../Common/GameRunningData"),f=t("../Common/EnumsDefine"),h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.NeedShowPrivacy=function(){return!0},e.prototype.RequestGameServer=function(t){window.loginAccountResult=function(e){null!==t&&"1"==e&&t()},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","RequestGameServer","()V")},e.prototype.Login=function(t){var e,o=cc.sys.localStorage.getItem("miid2"),n=0;o?(e=o,n=0):(e=Math.floor(1e4*Math.random())+"-"+(new Date).getTime(),cc.sys.localStorage.setItem("miid2",e),n=1,p.default.ReportEvent(f.BIPoint.Guide_NewPlayer));var r=(new Date).getTime(),i=u.default.Get(u.default.LOCAL_OFFLINE_TIME);i&&(r=i),t({ret:0,isNewUser:1===n,systemTime:(new Date).getTime(),lastLogoutTime:r/1e3})},e.prototype.Register=function(){},e.prototype.ReportPay=function(){},e.prototype.ReportEvent=function(){},e.prototype.ReportLevel=function(){},e.prototype.WatchAd=function(t,e,o,n,r){if(void 0===r&&(r=null),c.default.mForceGetRewardsType!==f.GetRewardsType.Direct){var i=this;window.videoResult=function(t){if("101"==t?(p.default.ReportEvent(f.BIPoint.AD_Show,{id:e}),p.default.mCurPlf.ReportHuoShanEvent(f.HuoShanEventType.AD_Show,{id:e})):(o("1"==t),r&&r()),"201"==t)a.default.Ins.UpdateTaskProgress(a.DailyTaskType.VideoClick,1),p.default.mCurPlf.ReportHuoShanEvent(f.HuoShanEventType.AD_Click,{id:e});else if("1001"==t)s.default.Ins.ShowTips("\u4e09\u56fd\u7ebf\u8def\u62e5\u5835\uff0c\u8bf71\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u5427\uff0c\u5956\u52b1\u4f1a\u66f4\u591a\u54e6\uff01",!0);else if("2001"==t)l.default.Ins.ClientInfo.reachedECPM100||(l.default.Ins.ClientInfo.reachedECPM100=!0,l.default.Ins.Save());else if("2002"==t)l.default.Ins.ClientInfo.reachedECPM80||(l.default.Ins.ClientInfo.reachedECPM80=!0,l.default.Ins.Save());else if("2003"===t)l.default.Ins.ClientInfo.reachedECPM150||(l.default.Ins.ClientInfo.reachedECPM150=!0,l.default.Ins.Save());else if("2004"===t)l.default.Ins.ClientInfo.reachedECPM200||(l.default.Ins.ClientInfo.reachedECPM200=!0,l.default.Ins.Save());else{var n=t.split("|");n.length>0&&"ecpm"===n[0]&&n.length>1&&i._HandleReportARPU(Number(n[1]))}},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowAd","(Ljava/lang/String;)V",t)}else o&&o(!0),r&&r()},e.prototype._HandleReportARPU=function(t){var e=l.default.Ins.ClientInfo;if(!(m.default.GetServerTimeInSeconds()-e.firstGameTime>86400)){e.arpu+=.001*t;var o=l.default.Ins.NEED_REPORT_ARPU_ARR;e.curCheckArpuArrIdx<o.length&&e.arpu>=o[e.curCheckArpuArrIdx]&&(this.ReportHuoShanEvent(l.default.Ins.ARPU_REPORT_ARR[e.curCheckArpuArrIdx]),e.curCheckArpuArrIdx++),l.default.Ins.Save()}},e.prototype.Share=function(t){t&&t(!0)},e.prototype.ShowBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowBanner","()V")},e.prototype.HideBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","HideBanner","()V")},e.prototype.RefreshBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","RefreshBanner","()V")},e.prototype.ShowInterstitial=function(t,e){window.interstitialResult=function(t){"101"==t?p.default.ReportEvent(f.BIPoint.InsAD_Show,{id:e}):"1"==t&&p.default.ReportEvent(f.BIPoint.InsAD_Completed,{id:e})},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowInterstitial","(Ljava/lang/String;)V",t)},e.prototype.ShowTemplateInter=function(t){void 0===t&&(t=!1),d.default.Ins.mCanShowTemplateInter&&(jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowTemplateInter","()V"),t||d.default.Ins.OnShowTemplateInter())},e.prototype.HideTemplateInter=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","HideTemplateInter","()V")},e.prototype.ReportTrackingEvent=function(){},e.prototype.ReportHuoShanEvent=function(t,e){void 0===e&&(e=null)},e.prototype.AgreePrivacy=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","AgreePrivacy","()V")},e.prototype.ExitPrivacy=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ExitPrivacy","()V")},e}(i.default);o.default=h,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/GameRunningData":"GameRunningData","../Common/SwitchConfig":"SwitchConfig","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","../Proxy/ProxyTask":"ProxyTask","./PlatformBase":"PlatformBase"}],XiaoMiPlatform:[function(t,e,o){"use strict";cc._RF.push(e,"20bebMUTDpIobhmLrdf/OZ1","XiaoMiPlatform");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)});Object.defineProperty(o,"__esModule",{value:!0});var i=t("./PlatformBase"),a=t("../Proxy/ProxyTask"),s=t("../Manager/WinMgr"),l=t("../Manager/UserMgr"),m=t("../Manager/TimeMgr"),u=t("../Manager/SaveMgr"),p=t("../Manager/PlatformMgr"),c=t("../Common/SwitchConfig"),d=t("../Common/EnumsDefine"),f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return r(e,t),e.prototype.NeedShowPrivacy=function(){return!0},e.prototype.RequestGameServer=function(t){window.loginAccountResult=function(e){null!==t&&"1"==e&&t()},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","RequestGameServer","()V")},e.prototype.Login=function(t){var e,o=cc.sys.localStorage.getItem("miid"),n=0;o?(e=o,n=0):(e=Math.floor(1e4*Math.random())+"-"+(new Date).getTime(),cc.sys.localStorage.setItem("miid",e),n=1,p.default.ReportEvent(d.BIPoint.Guide_NewPlayer));var r=(new Date).getTime(),i=u.default.Get(u.default.LOCAL_OFFLINE_TIME);i&&(r=i),t({ret:0,isNewUser:1===n,systemTime:(new Date).getTime(),lastLogoutTime:r/1e3}),jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","Login","(Ljava/lang/String;Ljava/lang/String;)V",""+e,""+n);var a=l.default.Ins.ClientInfo;jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","InitInfo","(II)V",a.bestLevel,l.default.Ins.GetItemNum(d.ItemType.Gold))},e.prototype.Register=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","Register","()V")},e.prototype.ReportPay=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ReportPay","()V")},e.prototype.ReportEvent=function(){},e.prototype.ReportLevel=function(t){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ReportLevel","(Ljava/lang/String;)V",t)},e.prototype.WatchAd=function(t,e,o,n,r){if(void 0===r&&(r=null),c.default.mForceGetRewardsType!==d.GetRewardsType.Direct){var i=this;window.videoResult=function(t){if("101"==t?(p.default.ReportEvent(d.BIPoint.AD_Show,{id:e}),p.default.mCurPlf.ReportHuoShanEvent(d.HuoShanEventType.AD_Show,{id:e})):(o("1"==t),r&&r()),"201"==t)a.default.Ins.UpdateTaskProgress(a.DailyTaskType.VideoClick,1),p.default.mCurPlf.ReportHuoShanEvent(d.HuoShanEventType.AD_Click,{id:e});else if("1001"==t)s.default.Ins.ShowTips("\u4e09\u56fd\u7ebf\u8def\u62e5\u5835\uff0c\u8bf71\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u5427\uff0c\u5956\u52b1\u4f1a\u66f4\u591a\u54e6\uff01",!0);else if("2001"==t)l.default.Ins.ClientInfo.reachedECPM100||(l.default.Ins.ClientInfo.reachedECPM100=!0,l.default.Ins.Save());else if("2002"==t)l.default.Ins.ClientInfo.reachedECPM80||(l.default.Ins.ClientInfo.reachedECPM80=!0,l.default.Ins.Save());else if("2003"===t)l.default.Ins.ClientInfo.reachedECPM150||(l.default.Ins.ClientInfo.reachedECPM150=!0,l.default.Ins.Save());else if("2004"===t)l.default.Ins.ClientInfo.reachedECPM200||(l.default.Ins.ClientInfo.reachedECPM200=!0,l.default.Ins.Save());else{var n=t.split("|");n.length>0&&"ecpm"===n[0]&&n.length>1&&i._HandleReportARPU(Number(n[1]))}},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowAd","(Ljava/lang/String;)V",t)}else o&&o(!0),r&&r()},e.prototype._HandleReportARPU=function(t){var e=l.default.Ins.ClientInfo;if(!(m.default.GetServerTimeInSeconds()-e.firstGameTime>86400)){e.arpu+=.001*t;var o=l.default.Ins.NEED_REPORT_ARPU_ARR;e.curCheckArpuArrIdx<o.length&&e.arpu>=o[e.curCheckArpuArrIdx]&&(this.ReportHuoShanEvent(l.default.Ins.ARPU_REPORT_ARR[e.curCheckArpuArrIdx]),e.curCheckArpuArrIdx++),l.default.Ins.Save()}},e.prototype.Share=function(t){t&&t(!0)},e.prototype.ShowBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowBanner","()V")},e.prototype.HideBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","HideBanner","()V")},e.prototype.RefreshBanner=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","RefreshBanner","()V")},e.prototype.ShowInterstitial=function(t,e){window.interstitialResult=function(t){"101"==t?p.default.ReportEvent(d.BIPoint.InsAD_Show,{id:e}):"1"==t&&p.default.ReportEvent(d.BIPoint.InsAD_Completed,{id:e})},jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowInterstitial","(Ljava/lang/String;)V",t)},e.prototype.ReportTrackingEvent=function(){},e.prototype.ReportHuoShanEvent=function(t,e){void 0===e&&(e=null),null===e?jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","OnHuoShanEvent","(Ljava/lang/String;Ljava/lang/String;)V",""+t,""):jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","OnHuoShanEvent","(Ljava/lang/String;Ljava/lang/String;)V",""+t,""+JSON.stringify(e))},e.prototype.AgreePrivacy=function(){},e.prototype.ShowExitWin=function(){jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","ShowExit","()V")},e.prototype.AddQQGroup=function(){return jsb.reflection.callStaticMethod("org/cocos2dx/javascript/PolarGame","AddQQGroup","()Z")},e}(i.default);o.default=f,cc._RF.pop()},{"../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/TimeMgr":"TimeMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","../Proxy/ProxyTask":"ProxyTask","./PlatformBase":"PlatformBase"}],iOSPlatform:[function(t,e,o){"use strict";cc._RF.push(e,"fcb08Pe0vtK5Ie3SxHmW/5X","iOSPlatform");var n,r=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])})(t,e)},function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}),i=this&&this.__decorate||function(t,e,o,n){var r,i=arguments.length,a=i<3?e:null===n?n=Object.getOwnPropertyDescriptor(e,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(t,e,o,n);else for(var s=t.length-1;s>=0;s--)(r=t[s])&&(a=(i<3?r(a):i>3?r(e,o,a):r(e,o))||a);return i>3&&a&&Object.defineProperty(e,o,a),a};Object.defineProperty(o,"__esModule",{value:!0});var a=t("./PlatformBase"),s=t("../Proxy/ProxyTask"),l=t("../Manager/WinMgr"),m=t("../Manager/UserMgr"),u=t("../Manager/SaveMgr"),p=t("../Manager/PlatformMgr"),c=t("../Manager/DataMgr"),d=t("../Manager/AudioMgr"),f=t("../Common/SwitchConfig"),h=t("../Common/EnumsDefine"),y=t("../Common/Common"),g=cc._decorator,I=g.ccclass,S=(g.property,function(t){function e(){return t.call(this)||this}return r(e,t),e.prototype.NeedShowPrivacy=function(){return!0},e.prototype.Login=function(t){var e,o=cc.sys.localStorage.getItem("miid"),n=0;o?(e=o,n=0):(e=Math.floor(1e4*Math.random())+"-"+(new Date).getTime(),cc.sys.localStorage.setItem("miid",e),n=1,p.default.ReportEvent(h.BIPoint.Guide_NewPlayer));var r=(new Date).getTime(),i=u.default.Get(u.default.LOCAL_OFFLINE_TIME);i&&(r=i),t({ret:0,isNewUser:1===n,systemTime:(new Date).getTime(),lastLogoutTime:r/1e3}),jsb.reflection.callStaticMethod("PolarGame","login");var a=m.default.Ins.ClientInfo;jsb.reflection.callStaticMethod("PolarGame","initInfo:withGoldNum:",a.bestLevel,m.default.Ins.GetItemNum(h.ItemType.Gold))},e.prototype.Register=function(){jsb.reflection.callStaticMethod("PolarGame","reportRegister")},e.prototype.ReportPay=function(){jsb.reflection.callStaticMethod("PolarGame","reportPay")},e.prototype.ReportEvent=function(){},e.prototype.ReportLevel=function(){},e.prototype.WatchAd=function(t,e,o,n,r){if(void 0===r&&(r=null),f.default.mForceGetRewardsType!==h.GetRewardsType.Direct){var i=this;window.videoResult=function(t){var n=JSON.parse(t).code;if("101"==n?(p.default.ReportEvent(h.BIPoint.AD_Show,{id:e}),p.default.mCurPlf.ReportHuoShanEvent(h.HuoShanEventType.AD_Show,{id:e}),d.default.MuteOnAD()):(o("1"==n),r&&r()),"201"==n)s.default.Ins.UpdateTaskProgress(s.DailyTaskType.VideoClick,1),p.default.mCurPlf.ReportHuoShanEvent(h.HuoShanEventType.AD_Click,{id:e});else if("1001"==n)l.default.Ins.ShowTips("\u4e09\u56fd\u7ebf\u8def\u62e5\u5835\uff0c\u8bf71\u5206\u949f\u540e\u518d\u5c1d\u8bd5\u5427\uff0c\u5956\u52b1\u4f1a\u66f4\u591a\u54e6\uff01",!0);else if("2001"==n)m.default.Ins.ClientInfo.reachedECPM100||(m.default.Ins.ClientInfo.reachedECPM100=!0,m.default.Ins.Save());else if("2002"==n)m.default.Ins.ClientInfo.reachedECPM80||(m.default.Ins.ClientInfo.reachedECPM80=!0,m.default.Ins.Save());else if("2003"===n)m.default.Ins.ClientInfo.reachedECPM150||(m.default.Ins.ClientInfo.reachedECPM150=!0,m.default.Ins.Save());else if("2004"===n)m.default.Ins.ClientInfo.reachedECPM200||(m.default.Ins.ClientInfo.reachedECPM200=!0,m.default.Ins.Save());else{var a=JSON.parse(t);if(a.hasOwnProperty("ecpm")){console.log("POLAR_GAME========");var u=a.ecpm;i._HandleVideoKeyEvent(u)}}},jsb.reflection.callStaticMethod("PolarGame","showVideo")}else o&&o(!0),r&&r()},e.prototype._HandleVideoKeyEvent=function(t){var e=m.default.Ins.ClientInfo;if(e.ipu||(e.ipu=0),e.ipu++,e.hasReportedEventArr||(e.hasReportedEventArr=[]),e.recentECPMArr||(e.recentECPMArr=[]),e.recentECPMArr.push(t),e.recentECPMArr.length>3&&e.recentECPMArr.shift(),e.recentECPMArr.length>=3){for(var o=0,n=0,r=e.recentECPMArr.length;n<r;++n)o+=e.recentECPMArr[n];var i=o/e.recentECPMArr.length;console.log("POLAR_GAME====>>> \u5e73\u5747eCPM\u662f\uff1a"+i),this.ReportKeyEvent(i,e.ipu)}m.default.Ins.Save()},e.prototype.ReportKeyEvent=function(t,e){c.default.Ins.mKeyEventMap.forEach(function(o,n){var r=y.default.Split2NumArr(n);if(r[0]<=t&&t<=r[1])for(var i=0,a=o.length;i<a;++i){var s=o[i];if(e>=s.ipu)return void(m.default.Ins.ClientInfo.hasReportedEventArr.indexOf(s.Id)<0&&p.default.mCurPlf.ReportHuoShanEvent(s.eventName))}})},e.prototype.Share=function(t){t&&t(!0)},e.prototype.ShowBanner=function(){jsb.reflection.callStaticMethod("PolarGame","showBanner")},e.prototype.HideBanner=function(){jsb.reflection.callStaticMethod("PolarGame","hideBanner")},e.prototype.RefreshBanner=function(){jsb.reflection.callStaticMethod("PolarGame","refreshBanner")},e.prototype.ShowInterstitial=function(){},e.prototype.ShowIOSInterAD=function(){jsb.reflection.callStaticMethod("PolarGame","showIOSInterAD")},e.prototype.ShowIOSFullAD=function(){jsb.reflection.callStaticMethod("PolarGame","showIOSFullAD")},e.prototype.ReportTrackingEvent=function(){},e.prototype.ReportHuoShanEvent=function(t,e){void 0===e&&(e=null),null===e?jsb.reflection.callStaticMethod("PolarGame","reportHuoShanEvent:withParam:",""+t,""):jsb.reflection.callStaticMethod("PolarGame","reportHuoShanEvent:withParam:",""+t,""+JSON.stringify(e))},e.prototype.AddQQGroup=function(){return jsb.reflection.callStaticMethod("PolarGame","addQQGroup")},i([I],e)}(a.default));o.default=S,cc._RF.pop()},{"../Common/Common":"Common","../Common/EnumsDefine":"EnumsDefine","../Common/SwitchConfig":"SwitchConfig","../Manager/AudioMgr":"AudioMgr","../Manager/DataMgr":"DataMgr","../Manager/PlatformMgr":"PlatformMgr","../Manager/SaveMgr":"SaveMgr","../Manager/UserMgr":"UserMgr","../Manager/WinMgr":"WinMgr","../Proxy/ProxyTask":"ProxyTask","./PlatformBase":"PlatformBase"}]},{},["EntityState","FightState","BattleCamera","BuffBase","BuffFactory","BuffFire","BuffFrost","BuffPoison","BuffRecoverHP","BuffVertigo","BulletBase","BulletImtLine","BulletLine","BulletPorabolaArrow","BulletPorabolaBomb","Crystal","Enemy","Entity","EntityAttr","Hero","WeaponController","EnemySpawnController","FightModeBase","FightModeImtBoss","FightModeNormal","HeroSpawnController","ImmortalSkillBase","ImtBossLevelController","LevelController","HitBackBehavior","AttackBehaviorBase","AttackBehaviorBullet","AttackBehaviorFactory","AttackBehaviorImtBullet","AttackBehaviorImtSkillRange","AttackBehaviorSpecifyTarget","AttackBehaviorXDist","PassiveCheckBase","PassiveCheckTimes","PassiveAddAttr","PassiveEffectBase","PassiveUseSkill","PassiveSkill","PassiveSkillCtrl","PassiveSkillFactory","SkillCompCtrl","SkillCtrl","Common","CustomSkt","EnumsDefine","GameRunningData","IState","JellyTween","LongPress","PrivacyHandler","SwitchConfig","InitGame","MainGame","AudioMgr","BCMgr","DataMgr","FightMgr","FloatItemMgr","FuncMgr","GameMgr","GuideListener","GuideMgr","ImtBossDmgMgr","MainTaskFingerData","MainTaskGuideMgr","PlatformMgr","PlotMgr","PoolMgr","RedPoint","RedPointMgr","ResMgr","SaveMgr","ShakeMgr","TimeMgr","UserMgr","WinMgr","PCPlatform","PlatformBase","TwoThreeThreePlf","WeChatPlf","XiaoMiChannelPlatform","XiaoMiPlatform","iOSPlatform","ProxyAct","ProxyAllSP","ProxyBackCity","ProxyBattleBox","ProxyBox","ProxyCDBtn","ProxyCrystal","ProxyExplore","ProxyForge","ProxyFreeGoldAct","ProxyHero","ProxyHeroMap","ProxyImmortal","ProxyImtBoss","ProxyImtSkill","ProxyLargeNum","ProxyLevelReward","ProxyLottery","ProxyMainTask2","ProxyOffice","ProxyOffline","ProxySevenDays","ProxyShop","ProxySign","ProxySkin","ProxySmith","ProxySpeed","ProxyTask","ProxyTurntable","ProxyVIP","ProxyWork","AccRewardItem","ActCoinPanel","AllSPHeroPanel","AllSPImtPanel","AllSPScoreRewardItem","AllSPTaskItem","BackCityBoxItem","BackCityBoxPanel","BgMap","BlackSmithItem","BossHPBar","CDBtn","CampBtn","CampLottery","ComicAnimEvent","ComicPanel","CounterFloatNum","CounterPanel","DailySocreItem","DailyTaskItem","EfxBase","ExploreItem","FightItemUI","FloatItem","FloatNum","FlyCoin","FlyCrystal","ForgeLockPanel","FuncHintPanel","GuideBtn","GuideFinger","GuideTip","HPBar","HeroAddItem","HeroAttrPanel","HeroDetailQualityPanel","HeroDetailSkinItem","HeroDetailSkinPanel","HeroDetailStarPanel","HeroDetailTrainPanel","HeroDmgItem","HeroItem","ImmortalItem","ImmortalLoopSV","ImmortalSkillBtn","ImtBossItem","ImtBossLevelItem","ImtBossLoopSV","ImtPictureIcon","ImtSkillPanel","ImtSpeedLine","ItemDetailPanel","LevelItem","LevelPanel","LevelRewardItem","LevelRewardLoopSV","LoopScrollItem","LoopScrollView","LotteryBox","LuckyLottery","MainBackPanel","MainLotteryBox","MainSidePanel","MainTaskGuideFinger","MainTaskPanel","MapHeroItem","MapItem","MedalDetailPanel","MyToggle","MyToggleGroup","OfficeLoopItem","OfficeLvNode","OfflineLevelPanel","OnAnimEvent","PictureHeroIcon","QuickSelectHeroIcon","QuickSelectPanel","RedPointNormal","SevenDayItem","ShopADCoinItem","ShopADCoinPanel","ShopHeroItem","ShopHeroPanel","ShopItemPanel","ShopPanelBase","ShopPropItem","ShopSkinItem","ShopSkinItemGroup","ShopSkinPanel","SignItem","SimpleBattleFloat","SimpleItem","SimpleToggle","SkillDetailPanel","SmithCharacter","SmithForgePanel","SmithLvNode","SmithStepPanel","SmithTrainPanel","TeamActiveSkillIcon","TeamHeroIcon","TeamSkillIcon","TipPanel","TouchEfxPanel","UIEfxBase","UnlockFuncPanel","VIPDescItem","VIPReward","WorkDetailPanel","WorkItem","WorkLoopSV","AddPosWin","AddSkillPosWin","AgeWin","AllSPActWin","BackCityInstructionWin","BackCityRewardWin","BackCityWin","BattleBoxWin","BattleWin","BuyItemWin","CampSelectWin","CampUnlockWin","ChallengeWin","ComicWin","CommonActivity","CommonDialogWin","DailyTaskWin","ExploreWin","FightFailWin","ForgeWin","FreeGoldActWin","FreeRewardWin","FuncUnlockWin","GetImtWin","GetRewardsWin","GetSkinWin","GiftOpenWin","GoldForCoinWin","HeroAdjustTeamWin","HeroDetailWin","HeroMapWin","HeroPictureWin","HeroUnlockWin","HeroWin","ImmortalWin","ImtBossFailWin","ImtBossFightWin","ImtBossLevelIntroduceWin","ImtBossLevelWin","ImtBossVictoryWin","ImtBossWin","ImtDetailWin","ImtInsWin","ImtPictureWin","ImtRefineFailWin","ImtSkillWin","ItemHintWin","LevelRewardWin","LotteryCampInstructionWin","LotteryInstructionWin","LotteryOpenWin","LotteryScoreRewardWin","LotteryWin","LuckyImtWin","MainTaskWin","MainWin","MopResultWin","NewHeroShowWin","OfficePreviewWin","OfficeUpgradeWin","OfficeWin","OfflineCoinWin","OfflineMedalWin","PlotWin","PreloadWin","PrivacyWin","ProblemWin","QualitySuccessWin","RecycleMedalWin","RefreshShopHeroWin","RepeatHeroWin","RewardPreviewWin","SecondDayWin","ServiceWin","SetWin","SevenDaysWin","ShopWin","SignWin","SkinPreviewWin","SmithBookWin","SmithFailWin","SmithWin","StarSuccessWin","TipsWin","TurntableAccRewardsWin","TurntableInsWin","TurntableWin","UnlockLevelLuxuryWin","VIPGiftWin","VIPUpgradeWin","VipWin","WinBase","WorkWin"]);